var t4=Object.defineProperty;var a4=(e,t,a)=>t in e?t4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var cg=(e,t,a)=>(a4(e,typeof t!="symbol"?t+"":t,a),a);function r4(e,t){for(var a=0;a<t.length;a++){const r=t[a];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const n=Object.getOwnPropertyDescriptor(r,s);n&&Object.defineProperty(e,s,n.get?n:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=a(s);fetch(s.href,n)}})();function s4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Db={exports:{}},Z0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n4=Symbol.for("react.transitional.element"),i4=Symbol.for("react.fragment");function Ob(e,t,a){var r=null;if(a!==void 0&&(r=""+a),t.key!==void 0&&(r=""+t.key),"key"in t){a={};for(var s in t)s!=="key"&&(a[s]=t[s])}else a=t;return t=a.ref,{$$typeof:n4,type:e,key:r,ref:t!==void 0?t:null,props:a}}Z0.Fragment=i4;Z0.jsx=Ob;Z0.jsxs=Ob;Db.exports=Z0;var i=Db.exports,Fb={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bm=Symbol.for("react.transitional.element"),l4=Symbol.for("react.portal"),o4=Symbol.for("react.fragment"),c4=Symbol.for("react.strict_mode"),u4=Symbol.for("react.profiler"),d4=Symbol.for("react.consumer"),f4=Symbol.for("react.context"),h4=Symbol.for("react.forward_ref"),m4=Symbol.for("react.suspense"),x4=Symbol.for("react.memo"),Lb=Symbol.for("react.lazy"),ug=Symbol.iterator;function p4(e){return e===null||typeof e!="object"?null:(e=ug&&e[ug]||e["@@iterator"],typeof e=="function"?e:null)}var Mb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ub=Object.assign,Bb={};function pl(e,t,a){this.props=e,this.context=t,this.refs=Bb,this.updater=a||Mb}pl.prototype.isReactComponent={};pl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};pl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ib(){}Ib.prototype=pl.prototype;function Im(e,t,a){this.props=e,this.context=t,this.refs=Bb,this.updater=a||Mb}var Pm=Im.prototype=new Ib;Pm.constructor=Im;Ub(Pm,pl.prototype);Pm.isPureReactComponent=!0;var dg=Array.isArray,ct={H:null,A:null,T:null,S:null,V:null},Pb=Object.prototype.hasOwnProperty;function Vm(e,t,a,r,s,n){return a=n.ref,{$$typeof:Bm,type:e,key:t,ref:a!==void 0?a:null,props:n}}function g4(e,t){return Vm(e.type,t,void 0,void 0,void 0,e.props)}function zm(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bm}function y4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return t[a]})}var fg=/\/+/g;function Id(e,t){return typeof e=="object"&&e!==null&&e.key!=null?y4(""+e.key):t.toString(36)}function hg(){}function v4(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(hg,hg):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function wi(e,t,a,r,s){var n=typeof e;(n==="undefined"||n==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(n){case"bigint":case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Bm:case l4:l=!0;break;case Lb:return l=e._init,wi(l(e._payload),t,a,r,s)}}if(l)return s=s(e),l=r===""?"."+Id(e,0):r,dg(s)?(a="",l!=null&&(a=l.replace(fg,"$&/")+"/"),wi(s,t,a,"",function(u){return u})):s!=null&&(zm(s)&&(s=g4(s,a+(s.key==null||e&&e.key===s.key?"":(""+s.key).replace(fg,"$&/")+"/")+l)),t.push(s)),1;l=0;var o=r===""?".":r+":";if(dg(e))for(var c=0;c<e.length;c++)r=e[c],n=o+Id(r,c),l+=wi(r,t,a,n,s);else if(c=p4(e),typeof c=="function")for(e=c.call(e),c=0;!(r=e.next()).done;)r=r.value,n=o+Id(r,c++),l+=wi(r,t,a,n,s);else if(n==="object"){if(typeof e.then=="function")return wi(v4(e),t,a,r,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return l}function qc(e,t,a){if(e==null)return e;var r=[],s=0;return wi(e,r,"","",function(n){return t.call(a,n,s++)}),r}function b4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var mg=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function w4(){}Le.Children={map:qc,forEach:function(e,t,a){qc(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return qc(e,function(){t++}),t},toArray:function(e){return qc(e,function(t){return t})||[]},only:function(e){if(!zm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Le.Component=pl;Le.Fragment=o4;Le.Profiler=u4;Le.PureComponent=Im;Le.StrictMode=c4;Le.Suspense=m4;Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ct;Le.__COMPILER_RUNTIME={__proto__:null,c:function(e){return ct.H.useMemoCache(e)}};Le.cache=function(e){return function(){return e.apply(null,arguments)}};Le.cloneElement=function(e,t,a){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var r=Ub({},e.props),s=e.key,n=void 0;if(t!=null)for(l in t.ref!==void 0&&(n=void 0),t.key!==void 0&&(s=""+t.key),t)!Pb.call(t,l)||l==="key"||l==="__self"||l==="__source"||l==="ref"&&t.ref===void 0||(r[l]=t[l]);var l=arguments.length-2;if(l===1)r.children=a;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return Vm(e.type,s,void 0,void 0,n,r)};Le.createContext=function(e){return e={$$typeof:f4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:d4,_context:e},e};Le.createElement=function(e,t,a){var r,s={},n=null;if(t!=null)for(r in t.key!==void 0&&(n=""+t.key),t)Pb.call(t,r)&&r!=="key"&&r!=="__self"&&r!=="__source"&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=a;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];s.children=o}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return Vm(e,n,void 0,void 0,null,s)};Le.createRef=function(){return{current:null}};Le.forwardRef=function(e){return{$$typeof:h4,render:e}};Le.isValidElement=zm;Le.lazy=function(e){return{$$typeof:Lb,_payload:{_status:-1,_result:e},_init:b4}};Le.memo=function(e,t){return{$$typeof:x4,type:e,compare:t===void 0?null:t}};Le.startTransition=function(e){var t=ct.T,a={};ct.T=a;try{var r=e(),s=ct.S;s!==null&&s(a,r),typeof r=="object"&&r!==null&&typeof r.then=="function"&&r.then(w4,mg)}catch(n){mg(n)}finally{ct.T=t}};Le.unstable_useCacheRefresh=function(){return ct.H.useCacheRefresh()};Le.use=function(e){return ct.H.use(e)};Le.useActionState=function(e,t,a){return ct.H.useActionState(e,t,a)};Le.useCallback=function(e,t){return ct.H.useCallback(e,t)};Le.useContext=function(e){return ct.H.useContext(e)};Le.useDebugValue=function(){};Le.useDeferredValue=function(e,t){return ct.H.useDeferredValue(e,t)};Le.useEffect=function(e,t,a){var r=ct.H;if(typeof a=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)};Le.useId=function(){return ct.H.useId()};Le.useImperativeHandle=function(e,t,a){return ct.H.useImperativeHandle(e,t,a)};Le.useInsertionEffect=function(e,t){return ct.H.useInsertionEffect(e,t)};Le.useLayoutEffect=function(e,t){return ct.H.useLayoutEffect(e,t)};Le.useMemo=function(e,t){return ct.H.useMemo(e,t)};Le.useOptimistic=function(e,t){return ct.H.useOptimistic(e,t)};Le.useReducer=function(e,t,a){return ct.H.useReducer(e,t,a)};Le.useRef=function(e){return ct.H.useRef(e)};Le.useState=function(e){return ct.H.useState(e)};Le.useSyncExternalStore=function(e,t,a){return ct.H.useSyncExternalStore(e,t,a)};Le.useTransition=function(){return ct.H.useTransition()};Le.version="19.1.0";Fb.exports=Le;var E=Fb.exports;const Vb=s4(E),E4=r4({__proto__:null,default:Vb},[E]);var zb={exports:{}},Q0={},Hb={exports:{}},Gb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,q){var te=F.length;F.push(q);e:for(;0<te;){var H=te-1>>>1,le=F[H];if(0<s(le,q))F[H]=q,F[te]=le,te=H;else break e}}function a(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var q=F[0],te=F.pop();if(te!==q){F[0]=te;e:for(var H=0,le=F.length,W=le>>>1;H<W;){var _=2*(H+1)-1,G=F[_],Y=_+1,z=F[Y];if(0>s(G,te))Y<le&&0>s(z,G)?(F[H]=z,F[Y]=te,H=Y):(F[H]=G,F[_]=te,H=_);else if(Y<le&&0>s(z,te))F[H]=z,F[Y]=te,H=Y;else break e}}return q}function s(F,q){var te=F.sortIndex-q.sortIndex;return te!==0?te:F.id-q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var n=performance;e.unstable_now=function(){return n.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,h=null,f=3,m=!1,p=!1,x=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function w(F){for(var q=a(u);q!==null;){if(q.callback===null)r(u);else if(q.startTime<=F)r(u),q.sortIndex=q.expirationTime,t(c,q);else break;q=a(u)}}function N(F){if(x=!1,w(F),!p)if(a(c)!==null)p=!0,A||(A=!0,j());else{var q=a(u);q!==null&&V(N,q.startTime-F)}}var A=!1,S=-1,C=5,T=-1;function D(){return v?!0:!(e.unstable_now()-T<C)}function R(){if(v=!1,A){var F=e.unstable_now();T=F;var q=!0;try{e:{p=!1,x&&(x=!1,b(S),S=-1),m=!0;var te=f;try{t:{for(w(F),h=a(c);h!==null&&!(h.expirationTime>F&&D());){var H=h.callback;if(typeof H=="function"){h.callback=null,f=h.priorityLevel;var le=H(h.expirationTime<=F);if(F=e.unstable_now(),typeof le=="function"){h.callback=le,w(F),q=!0;break t}h===a(c)&&r(c),w(F)}else r(c);h=a(c)}if(h!==null)q=!0;else{var W=a(u);W!==null&&V(N,W.startTime-F),q=!1}}break e}finally{h=null,f=te,m=!1}q=void 0}}finally{q?j():A=!1}}}var j;if(typeof y=="function")j=function(){y(R)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,X=B.port2;B.port1.onmessage=R,j=function(){X.postMessage(null)}}else j=function(){g(R,0)};function V(F,q){S=g(function(){F(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(F){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var te=f;f=q;try{return F()}finally{f=te}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(F,q){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var te=f;f=F;try{return q()}finally{f=te}},e.unstable_scheduleCallback=function(F,q,te){var H=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?H+te:H):te=H,F){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=te+le,F={id:d++,callback:q,priorityLevel:F,startTime:te,expirationTime:le,sortIndex:-1},te>H?(F.sortIndex=te,t(u,F),a(c)===null&&F===a(u)&&(x?(b(S),S=-1):x=!0,V(N,te-H))):(F.sortIndex=le,t(c,F),p||m||(p=!0,A||(A=!0,j()))),F},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(F){var q=f;return function(){var te=f;f=q;try{return F.apply(this,arguments)}finally{f=te}}}})(Gb);Hb.exports=Gb;var N4=Hb.exports,$b={exports:{}},Ma={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S4=E;function Yb(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Os(){}var ja={d:{f:Os,r:function(){throw Error(Yb(522))},D:Os,C:Os,L:Os,m:Os,X:Os,S:Os,M:Os},p:0,findDOMNode:null},T4=Symbol.for("react.portal");function A4(e,t,a){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T4,key:r==null?null:""+r,children:e,containerInfo:t,implementation:a}}var lo=S4.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function J0(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}Ma.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ja;Ma.createPortal=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(Yb(299));return A4(e,t,null,a)};Ma.flushSync=function(e){var t=lo.T,a=ja.p;try{if(lo.T=null,ja.p=2,e)return e()}finally{lo.T=t,ja.p=a,ja.d.f()}};Ma.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,ja.d.C(e,t))};Ma.prefetchDNS=function(e){typeof e=="string"&&ja.d.D(e)};Ma.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var a=t.as,r=J0(a,t.crossOrigin),s=typeof t.integrity=="string"?t.integrity:void 0,n=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;a==="style"?ja.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:r,integrity:s,fetchPriority:n}):a==="script"&&ja.d.X(e,{crossOrigin:r,integrity:s,fetchPriority:n,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};Ma.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var a=J0(t.as,t.crossOrigin);ja.d.M(e,{crossOrigin:a,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&ja.d.M(e)};Ma.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var a=t.as,r=J0(a,t.crossOrigin);ja.d.L(e,a,{crossOrigin:r,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};Ma.preloadModule=function(e,t){if(typeof e=="string")if(t){var a=J0(t.as,t.crossOrigin);ja.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:a,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else ja.d.m(e)};Ma.requestFormReset=function(e){ja.d.r(e)};Ma.unstable_batchedUpdates=function(e,t){return e(t)};Ma.useFormState=function(e,t,a){return lo.H.useFormState(e,t,a)};Ma.useFormStatus=function(){return lo.H.useHostTransitionStatus()};Ma.version="19.1.0";function qb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qb)}catch(e){console.error(e)}}qb(),$b.exports=Ma;var C4=$b.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gt=N4,Xb=E,k4=C4;function ue(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Kb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function mc(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function Wb(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function xg(e){if(mc(e)!==e)throw Error(ue(188))}function j4(e){var t=e.alternate;if(!t){if(t=mc(e),t===null)throw Error(ue(188));return t!==e?null:e}for(var a=e,r=t;;){var s=a.return;if(s===null)break;var n=s.alternate;if(n===null){if(r=s.return,r!==null){a=r;continue}break}if(s.child===n.child){for(n=s.child;n;){if(n===a)return xg(s),e;if(n===r)return xg(s),t;n=n.sibling}throw Error(ue(188))}if(a.return!==r.return)a=s,r=n;else{for(var l=!1,o=s.child;o;){if(o===a){l=!0,a=s,r=n;break}if(o===r){l=!0,r=s,a=n;break}o=o.sibling}if(!l){for(o=n.child;o;){if(o===a){l=!0,a=n,r=s;break}if(o===r){l=!0,r=n,a=s;break}o=o.sibling}if(!l)throw Error(ue(189))}}if(a.alternate!==r)throw Error(ue(190))}if(a.tag!==3)throw Error(ue(188));return a.stateNode.current===a?e:t}function Zb(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=Zb(e),t!==null)return t;e=e.sibling}return null}var it=Object.assign,_4=Symbol.for("react.element"),Xc=Symbol.for("react.transitional.element"),Kl=Symbol.for("react.portal"),Ai=Symbol.for("react.fragment"),Qb=Symbol.for("react.strict_mode"),eh=Symbol.for("react.profiler"),R4=Symbol.for("react.provider"),Jb=Symbol.for("react.consumer"),fs=Symbol.for("react.context"),Hm=Symbol.for("react.forward_ref"),th=Symbol.for("react.suspense"),ah=Symbol.for("react.suspense_list"),Gm=Symbol.for("react.memo"),Is=Symbol.for("react.lazy"),rh=Symbol.for("react.activity"),D4=Symbol.for("react.memo_cache_sentinel"),pg=Symbol.iterator;function Ul(e){return e===null||typeof e!="object"?null:(e=pg&&e[pg]||e["@@iterator"],typeof e=="function"?e:null)}var O4=Symbol.for("react.client.reference");function sh(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===O4?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ai:return"Fragment";case eh:return"Profiler";case Qb:return"StrictMode";case th:return"Suspense";case ah:return"SuspenseList";case rh:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case Kl:return"Portal";case fs:return(e.displayName||"Context")+".Provider";case Jb:return(e._context.displayName||"Context")+".Consumer";case Hm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Gm:return t=e.displayName||null,t!==null?t:sh(e.type)||"Memo";case Is:t=e._payload,e=e._init;try{return sh(e(t))}catch{}}return null}var Wl=Array.isArray,ke=Xb.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ze=k4.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Un={pending:!1,data:null,method:null,action:null},nh=[],Ci=-1;function rs(e){return{current:e}}function Wt(e){0>Ci||(e.current=nh[Ci],nh[Ci]=null,Ci--)}function ut(e,t){Ci++,nh[Ci]=e.current,e.current=t}var qr=rs(null),Uo=rs(null),en=rs(null),Wu=rs(null);function Zu(e,t){switch(ut(en,t),ut(Uo,e),ut(qr,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?w1(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=w1(t),e=pE(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Wt(qr),ut(qr,e)}function tl(){Wt(qr),Wt(Uo),Wt(en)}function ih(e){e.memoizedState!==null&&ut(Wu,e);var t=qr.current,a=pE(t,e.type);t!==a&&(ut(Uo,e),ut(qr,a))}function Qu(e){Uo.current===e&&(Wt(qr),Wt(Uo)),Wu.current===e&&(Wt(Wu),qo._currentValue=Un)}var lh=Object.prototype.hasOwnProperty,$m=Gt.unstable_scheduleCallback,Pd=Gt.unstable_cancelCallback,F4=Gt.unstable_shouldYield,L4=Gt.unstable_requestPaint,Xr=Gt.unstable_now,M4=Gt.unstable_getCurrentPriorityLevel,e2=Gt.unstable_ImmediatePriority,t2=Gt.unstable_UserBlockingPriority,Ju=Gt.unstable_NormalPriority,U4=Gt.unstable_LowPriority,a2=Gt.unstable_IdlePriority,B4=Gt.log,I4=Gt.unstable_setDisableYieldValue,xc=null,ar=null;function qs(e){if(typeof B4=="function"&&I4(e),ar&&typeof ar.setStrictMode=="function")try{ar.setStrictMode(xc,e)}catch{}}var rr=Math.clz32?Math.clz32:z4,P4=Math.log,V4=Math.LN2;function z4(e){return e>>>=0,e===0?32:31-(P4(e)/V4|0)|0}var Kc=256,Wc=4194304;function Cn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ed(e,t,a){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,l=e.pingedLanes;e=e.warmLanes;var o=r&134217727;return o!==0?(r=o&~n,r!==0?s=Cn(r):(l&=o,l!==0?s=Cn(l):a||(a=o&~e,a!==0&&(s=Cn(a))))):(o=r&~n,o!==0?s=Cn(o):l!==0?s=Cn(l):a||(a=r&~e,a!==0&&(s=Cn(a)))),s===0?0:t!==0&&t!==s&&!(t&n)&&(n=s&-s,a=t&-t,n>=a||n===32&&(a&4194048)!==0)?t:s}function pc(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function H4(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r2(){var e=Kc;return Kc<<=1,!(Kc&4194048)&&(Kc=256),e}function s2(){var e=Wc;return Wc<<=1,!(Wc&62914560)&&(Wc=4194304),e}function Vd(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function gc(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function G4(e,t,a,r,s,n){var l=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var o=e.entanglements,c=e.expirationTimes,u=e.hiddenUpdates;for(a=l&~a;0<a;){var d=31-rr(a),h=1<<d;o[d]=0,c[d]=-1;var f=u[d];if(f!==null)for(u[d]=null,d=0;d<f.length;d++){var m=f[d];m!==null&&(m.lane&=-536870913)}a&=~h}r!==0&&n2(e,r,0),n!==0&&s===0&&e.tag!==0&&(e.suspendedLanes|=n&~(l&~t))}function n2(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-rr(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|a&4194090}function i2(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var r=31-rr(a),s=1<<r;s&t|e[r]&t&&(e[r]|=t),a&=~s}}function Ym(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function qm(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function l2(){var e=Ze.p;return e!==0?e:(e=window.event,e===void 0?32:AE(e.type))}function $4(e,t){var a=Ze.p;try{return Ze.p=e,t()}finally{Ze.p=a}}var vn=Math.random().toString(36).slice(2),xa="__reactFiber$"+vn,$a="__reactProps$"+vn,gl="__reactContainer$"+vn,oh="__reactEvents$"+vn,Y4="__reactListeners$"+vn,q4="__reactHandles$"+vn,gg="__reactResources$"+vn,yc="__reactMarker$"+vn;function Xm(e){delete e[xa],delete e[$a],delete e[oh],delete e[Y4],delete e[q4]}function ki(e){var t=e[xa];if(t)return t;for(var a=e.parentNode;a;){if(t=a[gl]||a[xa]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=S1(e);e!==null;){if(a=e[xa])return a;e=S1(e)}return t}e=a,a=e.parentNode}return null}function yl(e){if(e=e[xa]||e[gl]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function Zl(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(ue(33))}function Gi(e){var t=e[gg];return t||(t=e[gg]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Xt(e){e[yc]=!0}var o2=new Set,c2={};function si(e,t){al(e,t),al(e+"Capture",t)}function al(e,t){for(c2[e]=t,e=0;e<t.length;e++)o2.add(t[e])}var X4=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yg={},vg={};function K4(e){return lh.call(vg,e)?!0:lh.call(yg,e)?!1:X4.test(e)?vg[e]=!0:(yg[e]=!0,!1)}function Cu(e,t,a){if(K4(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function Zc(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function os(e,t,a,r){if(r===null)e.removeAttribute(a);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+r)}}var zd,bg;function Ei(e){if(zd===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);zd=t&&t[1]||"",bg=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zd+e+bg}var Hd=!1;function Gd(e,t){if(!e||Hd)return"";Hd=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(m){var f=m}Reflect.construct(e,[],h)}else{try{h.call()}catch(m){f=m}e.call(h.prototype)}}else{try{throw Error()}catch(m){f=m}(h=e())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(m){if(m&&f&&typeof m.stack=="string")return[m.stack,f.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var n=r.DetermineComponentFrameRoot(),l=n[0],o=n[1];if(l&&o){var c=l.split(`
`),u=o.split(`
`);for(s=r=0;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;for(;s<u.length&&!u[s].includes("DetermineComponentFrameRoot");)s++;if(r===c.length||s===u.length)for(r=c.length-1,s=u.length-1;1<=r&&0<=s&&c[r]!==u[s];)s--;for(;1<=r&&0<=s;r--,s--)if(c[r]!==u[s]){if(r!==1||s!==1)do if(r--,s--,0>s||c[r]!==u[s]){var d=`
`+c[r].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=r&&0<=s);break}}}finally{Hd=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Ei(a):""}function W4(e){switch(e.tag){case 26:case 27:case 5:return Ei(e.type);case 16:return Ei("Lazy");case 13:return Ei("Suspense");case 19:return Ei("SuspenseList");case 0:case 15:return Gd(e.type,!1);case 11:return Gd(e.type.render,!1);case 1:return Gd(e.type,!0);case 31:return Ei("Activity");default:return""}}function wg(e){try{var t="";do t+=W4(e),e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}function mr(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function u2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Z4(e){var t=u2(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var s=a.get,n=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,n.call(this,l)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function e0(e){e._valueTracker||(e._valueTracker=Z4(e))}function d2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),r="";return e&&(r=u2(e)?e.checked?"true":"false":e.value),e=r,e!==a?(t.setValue(e),!0):!1}function t0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Q4=/[\n"\\]/g;function gr(e){return e.replace(Q4,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function ch(e,t,a,r,s,n,l,o){e.name="",l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?e.type=l:e.removeAttribute("type"),t!=null?l==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+mr(t)):e.value!==""+mr(t)&&(e.value=""+mr(t)):l!=="submit"&&l!=="reset"||e.removeAttribute("value"),t!=null?uh(e,l,mr(t)):a!=null?uh(e,l,mr(a)):r!=null&&e.removeAttribute("value"),s==null&&n!=null&&(e.defaultChecked=!!n),s!=null&&(e.checked=s&&typeof s!="function"&&typeof s!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?e.name=""+mr(o):e.removeAttribute("name")}function f2(e,t,a,r,s,n,l,o){if(n!=null&&typeof n!="function"&&typeof n!="symbol"&&typeof n!="boolean"&&(e.type=n),t!=null||a!=null){if(!(n!=="submit"&&n!=="reset"||t!=null))return;a=a!=null?""+mr(a):"",t=t!=null?""+mr(t):a,o||t===e.value||(e.value=t),e.defaultValue=t}r=r??s,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"&&(e.name=l)}function uh(e,t,a){t==="number"&&t0(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function $i(e,t,a,r){if(e=e.options,t){t={};for(var s=0;s<a.length;s++)t["$"+a[s]]=!0;for(a=0;a<e.length;a++)s=t.hasOwnProperty("$"+e[a].value),e[a].selected!==s&&(e[a].selected=s),s&&r&&(e[a].defaultSelected=!0)}else{for(a=""+mr(a),t=null,s=0;s<e.length;s++){if(e[s].value===a){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function h2(e,t,a){if(t!=null&&(t=""+mr(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+mr(a):""}function m2(e,t,a,r){if(t==null){if(r!=null){if(a!=null)throw Error(ue(92));if(Wl(r)){if(1<r.length)throw Error(ue(93));r=r[0]}a=r}a==null&&(a=""),t=a}a=mr(t),e.defaultValue=a,r=e.textContent,r===a&&r!==""&&r!==null&&(e.value=r)}function rl(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var J4=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Eg(e,t,a){var r=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?r?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":r?e.setProperty(t,a):typeof a!="number"||a===0||J4.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function x2(e,t,a){if(t!=null&&typeof t!="object")throw Error(ue(62));if(e=e.style,a!=null){for(var r in a)!a.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var s in t)r=t[s],t.hasOwnProperty(s)&&a[s]!==r&&Eg(e,s,r)}else for(var n in t)t.hasOwnProperty(n)&&Eg(e,n,t[n])}function Km(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ku(e){return tC.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var dh=null;function Wm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ji=null,Yi=null;function Ng(e){var t=yl(e);if(t&&(e=t.stateNode)){var a=e[$a]||null;e:switch(e=t.stateNode,t.type){case"input":if(ch(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+gr(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var r=a[t];if(r!==e&&r.form===e.form){var s=r[$a]||null;if(!s)throw Error(ue(90));ch(r,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(t=0;t<a.length;t++)r=a[t],r.form===e.form&&d2(r)}break e;case"textarea":h2(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&$i(e,!!a.multiple,t,!1)}}}var $d=!1;function p2(e,t,a){if($d)return e(t,a);$d=!0;try{var r=e(t);return r}finally{if($d=!1,(ji!==null||Yi!==null)&&(ud(),ji&&(t=ji,e=Yi,Yi=ji=null,Ng(t),e)))for(t=0;t<e.length;t++)Ng(e[t])}}function Bo(e,t){var a=e.stateNode;if(a===null)return null;var r=a[$a]||null;if(r===null)return null;a=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(ue(231,t,typeof a));return a}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fh=!1;if(Ns)try{var Bl={};Object.defineProperty(Bl,"passive",{get:function(){fh=!0}}),window.addEventListener("test",Bl,Bl),window.removeEventListener("test",Bl,Bl)}catch{fh=!1}var Xs=null,Zm=null,ju=null;function g2(){if(ju)return ju;var e,t=Zm,a=t.length,r,s="value"in Xs?Xs.value:Xs.textContent,n=s.length;for(e=0;e<a&&t[e]===s[e];e++);var l=a-e;for(r=1;r<=l&&t[a-r]===s[n-r];r++);return ju=s.slice(e,1<r?1-r:void 0)}function _u(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Qc(){return!0}function Sg(){return!1}function qa(e){function t(a,r,s,n,l){this._reactName=a,this._targetInst=s,this.type=r,this.nativeEvent=n,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(a=e[o],this[o]=a?a(n):n[o]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?Qc:Sg,this.isPropagationStopped=Sg,this}return it(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Qc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Qc)},persist:function(){},isPersistent:Qc}),t}var ni={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=qa(ni),vc=it({},ni,{view:0,detail:0}),aC=qa(vc),Yd,qd,Il,ad=it({},vc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Il&&(Il&&e.type==="mousemove"?(Yd=e.screenX-Il.screenX,qd=e.screenY-Il.screenY):qd=Yd=0,Il=e),Yd)},movementY:function(e){return"movementY"in e?e.movementY:qd}}),Tg=qa(ad),rC=it({},ad,{dataTransfer:0}),sC=qa(rC),nC=it({},vc,{relatedTarget:0}),Xd=qa(nC),iC=it({},ni,{animationName:0,elapsedTime:0,pseudoElement:0}),lC=qa(iC),oC=it({},ni,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cC=qa(oC),uC=it({},ni,{data:0}),Ag=qa(uC),dC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hC[e])?!!t[e]:!1}function Qm(){return mC}var xC=it({},vc,{key:function(e){if(e.key){var t=dC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=_u(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?fC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qm,charCode:function(e){return e.type==="keypress"?_u(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_u(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),pC=qa(xC),gC=it({},ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cg=qa(gC),yC=it({},vc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qm}),vC=qa(yC),bC=it({},ni,{propertyName:0,elapsedTime:0,pseudoElement:0}),wC=qa(bC),EC=it({},ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),NC=qa(EC),SC=it({},ni,{newState:0,oldState:0}),TC=qa(SC),AC=[9,13,27,32],Jm=Ns&&"CompositionEvent"in window,oo=null;Ns&&"documentMode"in document&&(oo=document.documentMode);var CC=Ns&&"TextEvent"in window&&!oo,y2=Ns&&(!Jm||oo&&8<oo&&11>=oo),kg=String.fromCharCode(32),jg=!1;function v2(e,t){switch(e){case"keyup":return AC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function b2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _i=!1;function kC(e,t){switch(e){case"compositionend":return b2(t);case"keypress":return t.which!==32?null:(jg=!0,kg);case"textInput":return e=t.data,e===kg&&jg?null:e;default:return null}}function jC(e,t){if(_i)return e==="compositionend"||!Jm&&v2(e,t)?(e=g2(),ju=Zm=Xs=null,_i=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return y2&&t.locale!=="ko"?null:t.data;default:return null}}var _C={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!_C[e.type]:t==="textarea"}function w2(e,t,a,r){ji?Yi?Yi.push(r):Yi=[r]:ji=r,t=v0(t,"onChange"),0<t.length&&(a=new td("onChange","change",null,a,r),e.push({event:a,listeners:t}))}var co=null,Io=null;function RC(e){hE(e,0)}function rd(e){var t=Zl(e);if(d2(t))return e}function Rg(e,t){if(e==="change")return t}var E2=!1;if(Ns){var Kd;if(Ns){var Wd="oninput"in document;if(!Wd){var Dg=document.createElement("div");Dg.setAttribute("oninput","return;"),Wd=typeof Dg.oninput=="function"}Kd=Wd}else Kd=!1;E2=Kd&&(!document.documentMode||9<document.documentMode)}function Og(){co&&(co.detachEvent("onpropertychange",N2),Io=co=null)}function N2(e){if(e.propertyName==="value"&&rd(Io)){var t=[];w2(t,Io,e,Wm(e)),p2(RC,t)}}function DC(e,t,a){e==="focusin"?(Og(),co=t,Io=a,co.attachEvent("onpropertychange",N2)):e==="focusout"&&Og()}function OC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return rd(Io)}function FC(e,t){if(e==="click")return rd(t)}function LC(e,t){if(e==="input"||e==="change")return rd(t)}function MC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ir=typeof Object.is=="function"?Object.is:MC;function Po(e,t){if(ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),r=Object.keys(t);if(a.length!==r.length)return!1;for(r=0;r<a.length;r++){var s=a[r];if(!lh.call(t,s)||!ir(e[s],t[s]))return!1}return!0}function Fg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lg(e,t){var a=Fg(e);e=0;for(var r;a;){if(a.nodeType===3){if(r=e+a.textContent.length,e<=t&&r>=t)return{node:a,offset:t-e};e=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Fg(a)}}function S2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?S2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function T2(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=t0(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=t0(e.document)}return t}function ex(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var UC=Ns&&"documentMode"in document&&11>=document.documentMode,Ri=null,hh=null,uo=null,mh=!1;function Mg(e,t,a){var r=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;mh||Ri==null||Ri!==t0(r)||(r=Ri,"selectionStart"in r&&ex(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),uo&&Po(uo,r)||(uo=r,r=v0(hh,"onSelect"),0<r.length&&(t=new td("onSelect","select",null,t,a),e.push({event:t,listeners:r}),t.target=Ri)))}function Sn(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Di={animationend:Sn("Animation","AnimationEnd"),animationiteration:Sn("Animation","AnimationIteration"),animationstart:Sn("Animation","AnimationStart"),transitionrun:Sn("Transition","TransitionRun"),transitionstart:Sn("Transition","TransitionStart"),transitioncancel:Sn("Transition","TransitionCancel"),transitionend:Sn("Transition","TransitionEnd")},Zd={},A2={};Ns&&(A2=document.createElement("div").style,"AnimationEvent"in window||(delete Di.animationend.animation,delete Di.animationiteration.animation,delete Di.animationstart.animation),"TransitionEvent"in window||delete Di.transitionend.transition);function ii(e){if(Zd[e])return Zd[e];if(!Di[e])return e;var t=Di[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in A2)return Zd[e]=t[a];return e}var C2=ii("animationend"),k2=ii("animationiteration"),j2=ii("animationstart"),BC=ii("transitionrun"),IC=ii("transitionstart"),PC=ii("transitioncancel"),_2=ii("transitionend"),R2=new Map,xh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xh.push("scrollEnd");function Br(e,t){R2.set(e,t),si(t,[e])}var Ug=new WeakMap;function yr(e,t){if(typeof e=="object"&&e!==null){var a=Ug.get(e);return a!==void 0?a:(t={value:e,source:t,stack:wg(t)},Ug.set(e,t),t)}return{value:e,source:t,stack:wg(t)}}var hr=[],Oi=0,tx=0;function sd(){for(var e=Oi,t=tx=Oi=0;t<e;){var a=hr[t];hr[t++]=null;var r=hr[t];hr[t++]=null;var s=hr[t];hr[t++]=null;var n=hr[t];if(hr[t++]=null,r!==null&&s!==null){var l=r.pending;l===null?s.next=s:(s.next=l.next,l.next=s),r.pending=s}n!==0&&D2(a,s,n)}}function nd(e,t,a,r){hr[Oi++]=e,hr[Oi++]=t,hr[Oi++]=a,hr[Oi++]=r,tx|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function ax(e,t,a,r){return nd(e,t,a,r),a0(e)}function vl(e,t){return nd(e,null,null,t),a0(e)}function D2(e,t,a){e.lanes|=a;var r=e.alternate;r!==null&&(r.lanes|=a);for(var s=!1,n=e.return;n!==null;)n.childLanes|=a,r=n.alternate,r!==null&&(r.childLanes|=a),n.tag===22&&(e=n.stateNode,e===null||e._visibility&1||(s=!0)),e=n,n=n.return;return e.tag===3?(n=e.stateNode,s&&t!==null&&(s=31-rr(a),e=n.hiddenUpdates,r=e[s],r===null?e[s]=[t]:r.push(t),t.lane=a|536870912),n):null}function a0(e){if(50<wo)throw wo=0,Mh=null,Error(ue(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Fi={};function VC(e,t,a,r){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(e,t,a,r){return new VC(e,t,a,r)}function rx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function vs(e,t){var a=e.alternate;return a===null?(a=er(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function O2(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ru(e,t,a,r,s,n){var l=0;if(r=e,typeof e=="function")rx(e)&&(l=1);else if(typeof e=="string")l=Hk(e,a,qr.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case rh:return e=er(31,a,t,s),e.elementType=rh,e.lanes=n,e;case Ai:return Bn(a.children,s,n,t);case Qb:l=8,s|=24;break;case eh:return e=er(12,a,t,s|2),e.elementType=eh,e.lanes=n,e;case th:return e=er(13,a,t,s),e.elementType=th,e.lanes=n,e;case ah:return e=er(19,a,t,s),e.elementType=ah,e.lanes=n,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case R4:case fs:l=10;break e;case Jb:l=9;break e;case Hm:l=11;break e;case Gm:l=14;break e;case Is:l=16,r=null;break e}l=29,a=Error(ue(130,e===null?"null":typeof e,"")),r=null}return t=er(l,a,t,s),t.elementType=e,t.type=r,t.lanes=n,t}function Bn(e,t,a,r){return e=er(7,e,r,t),e.lanes=a,e}function Qd(e,t,a){return e=er(6,e,null,t),e.lanes=a,e}function Jd(e,t,a){return t=er(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Li=[],Mi=0,r0=null,s0=0,xr=[],pr=0,In=null,hs=1,ms="";function kn(e,t){Li[Mi++]=s0,Li[Mi++]=r0,r0=e,s0=t}function F2(e,t,a){xr[pr++]=hs,xr[pr++]=ms,xr[pr++]=In,In=e;var r=hs;e=ms;var s=32-rr(r)-1;r&=~(1<<s),a+=1;var n=32-rr(t)+s;if(30<n){var l=s-s%5;n=(r&(1<<l)-1).toString(32),r>>=l,s-=l,hs=1<<32-rr(t)+s|a<<s|r,ms=n+e}else hs=1<<n|a<<s|r,ms=e}function sx(e){e.return!==null&&(kn(e,1),F2(e,1,0))}function nx(e){for(;e===r0;)r0=Li[--Mi],Li[Mi]=null,s0=Li[--Mi],Li[Mi]=null;for(;e===In;)In=xr[--pr],xr[pr]=null,ms=xr[--pr],xr[pr]=null,hs=xr[--pr],xr[pr]=null}var ka=null,yt=null,We=!1,Pn=null,$r=!1,ph=Error(ue(519));function Kn(e){var t=Error(ue(418,""));throw Vo(yr(t,e)),ph}function Bg(e){var t=e.stateNode,a=e.type,r=e.memoizedProps;switch(t[xa]=e,t[$a]=r,a){case"dialog":Be("cancel",t),Be("close",t);break;case"iframe":case"object":case"embed":Be("load",t);break;case"video":case"audio":for(a=0;a<Go.length;a++)Be(Go[a],t);break;case"source":Be("error",t);break;case"img":case"image":case"link":Be("error",t),Be("load",t);break;case"details":Be("toggle",t);break;case"input":Be("invalid",t),f2(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),e0(t);break;case"select":Be("invalid",t);break;case"textarea":Be("invalid",t),m2(t,r.value,r.defaultValue,r.children),e0(t)}a=r.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||r.suppressHydrationWarning===!0||xE(t.textContent,a)?(r.popover!=null&&(Be("beforetoggle",t),Be("toggle",t)),r.onScroll!=null&&Be("scroll",t),r.onScrollEnd!=null&&Be("scrollend",t),r.onClick!=null&&(t.onclick=hd),t=!0):t=!1,t||Kn(e)}function Ig(e){for(ka=e.return;ka;)switch(ka.tag){case 5:case 13:$r=!1;return;case 27:case 3:$r=!0;return;default:ka=ka.return}}function Pl(e){if(e!==ka)return!1;if(!We)return Ig(e),We=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||zh(e.type,e.memoizedProps)),a=!a),a&&yt&&Kn(e),Ig(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(a=e.data,a==="/$"){if(t===0){yt=Lr(e.nextSibling);break e}t--}else a!=="$"&&a!=="$!"&&a!=="$?"||t++;e=e.nextSibling}yt=null}}else t===27?(t=yt,bn(e.type)?(e=$h,$h=null,yt=e):yt=t):yt=ka?Lr(e.stateNode.nextSibling):null;return!0}function bc(){yt=ka=null,We=!1}function Pg(){var e=Pn;return e!==null&&(Va===null?Va=e:Va.push.apply(Va,e),Pn=null),e}function Vo(e){Pn===null?Pn=[e]:Pn.push(e)}var gh=rs(null),li=null,xs=null;function Vs(e,t,a){ut(gh,t._currentValue),t._currentValue=a}function bs(e){e._currentValue=gh.current,Wt(gh)}function yh(e,t,a){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===a)break;e=e.return}}function vh(e,t,a,r){var s=e.child;for(s!==null&&(s.return=e);s!==null;){var n=s.dependencies;if(n!==null){var l=s.child;n=n.firstContext;e:for(;n!==null;){var o=n;n=s;for(var c=0;c<t.length;c++)if(o.context===t[c]){n.lanes|=a,o=n.alternate,o!==null&&(o.lanes|=a),yh(n.return,a,e),r||(l=null);break e}n=o.next}}else if(s.tag===18){if(l=s.return,l===null)throw Error(ue(341));l.lanes|=a,n=l.alternate,n!==null&&(n.lanes|=a),yh(l,a,e),l=null}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}}function wc(e,t,a,r){e=null;for(var s=t,n=!1;s!==null;){if(!n){if(s.flags&524288)n=!0;else if(s.flags&262144)break}if(s.tag===10){var l=s.alternate;if(l===null)throw Error(ue(387));if(l=l.memoizedProps,l!==null){var o=s.type;ir(s.pendingProps.value,l.value)||(e!==null?e.push(o):e=[o])}}else if(s===Wu.current){if(l=s.alternate,l===null)throw Error(ue(387));l.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(e!==null?e.push(qo):e=[qo])}s=s.return}e!==null&&vh(t,e,a,r),t.flags|=262144}function n0(e){for(e=e.firstContext;e!==null;){if(!ir(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Wn(e){li=e,xs=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function pa(e){return L2(li,e)}function Jc(e,t){return li===null&&Wn(e),L2(e,t)}function L2(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},xs===null){if(e===null)throw Error(ue(308));xs=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else xs=xs.next=t;return a}var zC=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},HC=Gt.unstable_scheduleCallback,GC=Gt.unstable_NormalPriority,It={$$typeof:fs,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ix(){return{controller:new zC,data:new Map,refCount:0}}function Ec(e){e.refCount--,e.refCount===0&&HC(GC,function(){e.controller.abort()})}var fo=null,bh=0,sl=0,qi=null;function $C(e,t){if(fo===null){var a=fo=[];bh=0,sl=jx(),qi={status:"pending",value:void 0,then:function(r){a.push(r)}}}return bh++,t.then(Vg,Vg),t}function Vg(){if(--bh===0&&fo!==null){qi!==null&&(qi.status="fulfilled");var e=fo;fo=null,sl=0,qi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function YC(e,t){var a=[],r={status:"pending",value:null,reason:null,then:function(s){a.push(s)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var s=0;s<a.length;s++)(0,a[s])(t)},function(s){for(r.status="rejected",r.reason=s,s=0;s<a.length;s++)(0,a[s])(void 0)}),r}var zg=ke.S;ke.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&$C(e,t),zg!==null&&zg(e,t)};var Vn=rs(null);function lx(){var e=Vn.current;return e!==null?e:nt.pooledCache}function Du(e,t){t===null?ut(Vn,Vn.current):ut(Vn,t.pool)}function M2(){var e=lx();return e===null?null:{parent:It._currentValue,pool:e}}var Nc=Error(ue(460)),U2=Error(ue(474)),id=Error(ue(542)),wh={then:function(){}};function Hg(e){return e=e.status,e==="fulfilled"||e==="rejected"}function eu(){}function B2(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(eu,eu),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,$g(e),e;default:if(typeof t.status=="string")t.then(eu,eu);else{if(e=nt,e!==null&&100<e.shellSuspendCounter)throw Error(ue(482));e=t,e.status="pending",e.then(function(r){if(t.status==="pending"){var s=t;s.status="fulfilled",s.value=r}},function(r){if(t.status==="pending"){var s=t;s.status="rejected",s.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,$g(e),e}throw ho=t,Nc}}var ho=null;function Gg(){if(ho===null)throw Error(ue(459));var e=ho;return ho=null,e}function $g(e){if(e===Nc||e===id)throw Error(ue(483))}var Ps=!1;function ox(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Eh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function tn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function an(e,t,a){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Je&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,t=a0(e),D2(e,null,a),t}return nd(e,r,t,a),a0(e)}function mo(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var r=t.lanes;r&=e.pendingLanes,a|=r,t.lanes=a,i2(e,a)}}function ef(e,t){var a=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,a===r)){var s=null,n=null;if(a=a.firstBaseUpdate,a!==null){do{var l={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};n===null?s=n=l:n=n.next=l,a=a.next}while(a!==null);n===null?s=n=t:n=n.next=t}else s=n=t;a={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:n,shared:r.shared,callbacks:r.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Nh=!1;function xo(){if(Nh){var e=qi;if(e!==null)throw e}}function po(e,t,a,r){Nh=!1;var s=e.updateQueue;Ps=!1;var n=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?n=u:l.next=u,l=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(n!==null){var h=s.baseState;l=0,d=u=c=null,o=n;do{var f=o.lane&-536870913,m=f!==o.lane;if(m?(He&f)===f:(r&f)===f){f!==0&&f===sl&&(Nh=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,x=o;f=t;var v=a;switch(x.tag){case 1:if(p=x.payload,typeof p=="function"){h=p.call(v,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=x.payload,f=typeof p=="function"?p.call(v,h,f):p,f==null)break e;h=it({},h,f);break e;case 2:Ps=!0}}f=o.callback,f!==null&&(e.flags|=64,m&&(e.flags|=8192),m=s.callbacks,m===null?s.callbacks=[f]:m.push(f))}else m={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(1);d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,n===null&&(s.shared.lanes=0),hn|=l,e.lanes=l,e.memoizedState=h}}function I2(e,t){if(typeof e!="function")throw Error(ue(191,e));e.call(t)}function P2(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)I2(a[e],t)}var nl=rs(null),i0=rs(0);function Yg(e,t){e=As,ut(i0,e),ut(nl,t),As=e|t.baseLanes}function Sh(){ut(i0,As),ut(nl,nl.current)}function cx(){As=i0.current,Wt(nl),Wt(i0)}var dn=0,Ue=null,tt=null,Ot=null,l0=!1,Xi=!1,Zn=!1,o0=0,zo=0,Ki=null,qC=0;function Nt(){throw Error(ue(321))}function ux(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!ir(e[a],t[a]))return!1;return!0}function dx(e,t,a,r,s,n){return dn=n,Ue=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ke.H=e===null||e.memoizedState===null?gw:yw,Zn=!1,n=a(r,s),Zn=!1,Xi&&(n=z2(t,a,r,s)),V2(e),n}function V2(e){ke.H=c0;var t=tt!==null&&tt.next!==null;if(dn=0,Ot=tt=Ue=null,l0=!1,zo=0,Ki=null,t)throw Error(ue(300));e===null||Kt||(e=e.dependencies,e!==null&&n0(e)&&(Kt=!0))}function z2(e,t,a,r){Ue=e;var s=0;do{if(Xi&&(Ki=null),zo=0,Xi=!1,25<=s)throw Error(ue(301));if(s+=1,Ot=tt=null,e.updateQueue!=null){var n=e.updateQueue;n.lastEffect=null,n.events=null,n.stores=null,n.memoCache!=null&&(n.memoCache.index=0)}ke.H=ek,n=t(a,r)}while(Xi);return n}function XC(){var e=ke.H,t=e.useState()[0];return t=typeof t.then=="function"?Sc(t):t,e=e.useState()[0],(tt!==null?tt.memoizedState:null)!==e&&(Ue.flags|=1024),t}function fx(){var e=o0!==0;return o0=0,e}function hx(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function mx(e){if(l0){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}l0=!1}dn=0,Ot=tt=Ue=null,Xi=!1,zo=o0=0,Ki=null}function Ia(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?Ue.memoizedState=Ot=e:Ot=Ot.next=e,Ot}function Ft(){if(tt===null){var e=Ue.alternate;e=e!==null?e.memoizedState:null}else e=tt.next;var t=Ot===null?Ue.memoizedState:Ot.next;if(t!==null)Ot=t,tt=e;else{if(e===null)throw Ue.alternate===null?Error(ue(467)):Error(ue(310));tt=e,e={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},Ot===null?Ue.memoizedState=Ot=e:Ot=Ot.next=e}return Ot}function xx(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sc(e){var t=zo;return zo+=1,Ki===null&&(Ki=[]),e=B2(Ki,e,t),t=Ue,(Ot===null?t.memoizedState:Ot.next)===null&&(t=t.alternate,ke.H=t===null||t.memoizedState===null?gw:yw),e}function ld(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Sc(e);if(e.$$typeof===fs)return pa(e)}throw Error(ue(438,String(e)))}function px(e){var t=null,a=Ue.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var r=Ue.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(s){return s.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=xx(),Ue.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),r=0;r<e;r++)a[r]=D4;return t.index++,a}function Ss(e,t){return typeof t=="function"?t(e):t}function Ou(e){var t=Ft();return gx(t,tt,e)}function gx(e,t,a){var r=e.queue;if(r===null)throw Error(ue(311));r.lastRenderedReducer=a;var s=e.baseQueue,n=r.pending;if(n!==null){if(s!==null){var l=s.next;s.next=n.next,n.next=l}t.baseQueue=s=n,r.pending=null}if(n=e.baseState,s===null)e.memoizedState=n;else{t=s.next;var o=l=null,c=null,u=t,d=!1;do{var h=u.lane&-536870913;if(h!==u.lane?(He&h)===h:(dn&h)===h){var f=u.revertLane;if(f===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===sl&&(d=!0);else if((dn&f)===f){u=u.next,f===sl&&(d=!0);continue}else h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=h,l=n):c=c.next=h,Ue.lanes|=f,hn|=f;h=u.action,Zn&&a(n,h),n=u.hasEagerState?u.eagerState:a(n,h)}else f={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(o=c=f,l=n):c=c.next=f,Ue.lanes|=h,hn|=h;u=u.next}while(u!==null&&u!==t);if(c===null?l=n:c.next=o,!ir(n,e.memoizedState)&&(Kt=!0,d&&(a=qi,a!==null)))throw a;e.memoizedState=n,e.baseState=l,e.baseQueue=c,r.lastRenderedState=n}return s===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function tf(e){var t=Ft(),a=t.queue;if(a===null)throw Error(ue(311));a.lastRenderedReducer=e;var r=a.dispatch,s=a.pending,n=t.memoizedState;if(s!==null){a.pending=null;var l=s=s.next;do n=e(n,l.action),l=l.next;while(l!==s);ir(n,t.memoizedState)||(Kt=!0),t.memoizedState=n,t.baseQueue===null&&(t.baseState=n),a.lastRenderedState=n}return[n,r]}function H2(e,t,a){var r=Ue,s=Ft(),n=We;if(n){if(a===void 0)throw Error(ue(407));a=a()}else a=t();var l=!ir((tt||s).memoizedState,a);l&&(s.memoizedState=a,Kt=!0),s=s.queue;var o=Y2.bind(null,r,s,e);if(Tc(2048,8,o,[e]),s.getSnapshot!==t||l||Ot!==null&&Ot.memoizedState.tag&1){if(r.flags|=2048,il(9,od(),$2.bind(null,r,s,a,t),null),nt===null)throw Error(ue(349));n||dn&124||G2(r,t,a)}return a}function G2(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Ue.updateQueue,t===null?(t=xx(),Ue.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function $2(e,t,a,r){t.value=a,t.getSnapshot=r,q2(t)&&X2(e)}function Y2(e,t,a){return a(function(){q2(t)&&X2(e)})}function q2(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!ir(e,a)}catch{return!0}}function X2(e){var t=vl(e,2);t!==null&&nr(t,e,2)}function Th(e){var t=Ia();if(typeof e=="function"){var a=e;if(e=a(),Zn){qs(!0);try{a()}finally{qs(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:e},t}function K2(e,t,a,r){return e.baseState=a,gx(e,tt,typeof r=="function"?r:Ss)}function KC(e,t,a,r,s){if(cd(e))throw Error(ue(485));if(e=t.action,e!==null){var n={payload:s,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(l){n.listeners.push(l)}};ke.T!==null?a(!0):n.isTransition=!1,r(n),a=t.pending,a===null?(n.next=t.pending=n,W2(t,n)):(n.next=a.next,t.pending=a.next=n)}}function W2(e,t){var a=t.action,r=t.payload,s=e.state;if(t.isTransition){var n=ke.T,l={};ke.T=l;try{var o=a(s,r),c=ke.S;c!==null&&c(l,o),qg(e,t,o)}catch(u){Ah(e,t,u)}finally{ke.T=n}}else try{n=a(s,r),qg(e,t,n)}catch(u){Ah(e,t,u)}}function qg(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(r){Xg(e,t,r)},function(r){return Ah(e,t,r)}):Xg(e,t,a)}function Xg(e,t,a){t.status="fulfilled",t.value=a,Z2(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,W2(e,a)))}function Ah(e,t,a){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=a,Z2(t),t=t.next;while(t!==r)}e.action=null}function Z2(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Q2(e,t){return t}function Kg(e,t){if(We){var a=nt.formState;if(a!==null){e:{var r=Ue;if(We){if(yt){t:{for(var s=yt,n=$r;s.nodeType!==8;){if(!n){s=null;break t}if(s=Lr(s.nextSibling),s===null){s=null;break t}}n=s.data,s=n==="F!"||n==="F"?s:null}if(s){yt=Lr(s.nextSibling),r=s.data==="F!";break e}}Kn(r)}r=!1}r&&(t=a[0])}}return a=Ia(),a.memoizedState=a.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q2,lastRenderedState:t},a.queue=r,a=mw.bind(null,Ue,r),r.dispatch=a,r=Th(!1),n=wx.bind(null,Ue,!1,r.queue),r=Ia(),s={state:t,dispatch:null,action:e,pending:null},r.queue=s,a=KC.bind(null,Ue,s,n,a),s.dispatch=a,r.memoizedState=e,[t,a,!1]}function Wg(e){var t=Ft();return J2(t,tt,e)}function J2(e,t,a){if(t=gx(e,t,Q2)[0],e=Ou(Ss)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=Sc(t)}catch(l){throw l===Nc?id:l}else r=t;t=Ft();var s=t.queue,n=s.dispatch;return a!==t.memoizedState&&(Ue.flags|=2048,il(9,od(),WC.bind(null,s,a),null)),[r,n,e]}function WC(e,t){e.action=t}function Zg(e){var t=Ft(),a=tt;if(a!==null)return J2(t,a,e);Ft(),t=t.memoizedState,a=Ft();var r=a.queue.dispatch;return a.memoizedState=e,[t,r,!1]}function il(e,t,a,r){return e={tag:e,create:a,deps:r,inst:t,next:null},t=Ue.updateQueue,t===null&&(t=xx(),Ue.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(r=a.next,a.next=e,e.next=r,t.lastEffect=e),e}function od(){return{destroy:void 0,resource:void 0}}function ew(){return Ft().memoizedState}function Fu(e,t,a,r){var s=Ia();r=r===void 0?null:r,Ue.flags|=e,s.memoizedState=il(1|t,od(),a,r)}function Tc(e,t,a,r){var s=Ft();r=r===void 0?null:r;var n=s.memoizedState.inst;tt!==null&&r!==null&&ux(r,tt.memoizedState.deps)?s.memoizedState=il(t,n,a,r):(Ue.flags|=e,s.memoizedState=il(1|t,n,a,r))}function Qg(e,t){Fu(8390656,8,e,t)}function tw(e,t){Tc(2048,8,e,t)}function aw(e,t){return Tc(4,2,e,t)}function rw(e,t){return Tc(4,4,e,t)}function sw(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nw(e,t,a){a=a!=null?a.concat([e]):null,Tc(4,4,sw.bind(null,t,e),a)}function yx(){}function iw(e,t){var a=Ft();t=t===void 0?null:t;var r=a.memoizedState;return t!==null&&ux(t,r[1])?r[0]:(a.memoizedState=[e,t],e)}function lw(e,t){var a=Ft();t=t===void 0?null:t;var r=a.memoizedState;if(t!==null&&ux(t,r[1]))return r[0];if(r=e(),Zn){qs(!0);try{e()}finally{qs(!1)}}return a.memoizedState=[r,t],r}function vx(e,t,a){return a===void 0||dn&1073741824?e.memoizedState=t:(e.memoizedState=a,e=Zw(),Ue.lanes|=e,hn|=e,a)}function ow(e,t,a,r){return ir(a,t)?a:nl.current!==null?(e=vx(e,a,r),ir(e,t)||(Kt=!0),e):dn&42?(e=Zw(),Ue.lanes|=e,hn|=e,t):(Kt=!0,e.memoizedState=a)}function cw(e,t,a,r,s){var n=Ze.p;Ze.p=n!==0&&8>n?n:8;var l=ke.T,o={};ke.T=o,wx(e,!1,t,a);try{var c=s(),u=ke.S;if(u!==null&&u(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=YC(c,r);go(e,t,d,sr(e))}else go(e,t,r,sr(e))}catch(h){go(e,t,{then:function(){},status:"rejected",reason:h},sr())}finally{Ze.p=n,ke.T=l}}function ZC(){}function Ch(e,t,a,r){if(e.tag!==5)throw Error(ue(476));var s=uw(e).queue;cw(e,s,t,Un,a===null?ZC:function(){return dw(e),a(r)})}function uw(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Un,baseState:Un,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:Un},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function dw(e){var t=uw(e).next.queue;go(e,t,{},sr())}function bx(){return pa(qo)}function fw(){return Ft().memoizedState}function hw(){return Ft().memoizedState}function QC(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=sr();e=tn(a);var r=an(t,e,a);r!==null&&(nr(r,t,a),mo(r,t,a)),t={cache:ix()},e.payload=t;return}t=t.return}}function JC(e,t,a){var r=sr();a={lane:r,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},cd(e)?xw(t,a):(a=ax(e,t,a,r),a!==null&&(nr(a,e,r),pw(a,t,r)))}function mw(e,t,a){var r=sr();go(e,t,a,r)}function go(e,t,a,r){var s={lane:r,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(cd(e))xw(t,s);else{var n=e.alternate;if(e.lanes===0&&(n===null||n.lanes===0)&&(n=t.lastRenderedReducer,n!==null))try{var l=t.lastRenderedState,o=n(l,a);if(s.hasEagerState=!0,s.eagerState=o,ir(o,l))return nd(e,t,s,0),nt===null&&sd(),!1}catch{}finally{}if(a=ax(e,t,s,r),a!==null)return nr(a,e,r),pw(a,t,r),!0}return!1}function wx(e,t,a,r){if(r={lane:2,revertLane:jx(),action:r,hasEagerState:!1,eagerState:null,next:null},cd(e)){if(t)throw Error(ue(479))}else t=ax(e,a,r,2),t!==null&&nr(t,e,2)}function cd(e){var t=e.alternate;return e===Ue||t!==null&&t===Ue}function xw(e,t){Xi=l0=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function pw(e,t,a){if(a&4194048){var r=t.lanes;r&=e.pendingLanes,a|=r,t.lanes=a,i2(e,a)}}var c0={readContext:pa,use:ld,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt},gw={readContext:pa,use:ld,useCallback:function(e,t){return Ia().memoizedState=[e,t===void 0?null:t],e},useContext:pa,useEffect:Qg,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,Fu(4194308,4,sw.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Fu(4194308,4,e,t)},useInsertionEffect:function(e,t){Fu(4,2,e,t)},useMemo:function(e,t){var a=Ia();t=t===void 0?null:t;var r=e();if(Zn){qs(!0);try{e()}finally{qs(!1)}}return a.memoizedState=[r,t],r},useReducer:function(e,t,a){var r=Ia();if(a!==void 0){var s=a(t);if(Zn){qs(!0);try{a(t)}finally{qs(!1)}}}else s=t;return r.memoizedState=r.baseState=s,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},r.queue=e,e=e.dispatch=JC.bind(null,Ue,e),[r.memoizedState,e]},useRef:function(e){var t=Ia();return e={current:e},t.memoizedState=e},useState:function(e){e=Th(e);var t=e.queue,a=mw.bind(null,Ue,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:yx,useDeferredValue:function(e,t){var a=Ia();return vx(a,e,t)},useTransition:function(){var e=Th(!1);return e=cw.bind(null,Ue,e.queue,!0,!1),Ia().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var r=Ue,s=Ia();if(We){if(a===void 0)throw Error(ue(407));a=a()}else{if(a=t(),nt===null)throw Error(ue(349));He&124||G2(r,t,a)}s.memoizedState=a;var n={value:a,getSnapshot:t};return s.queue=n,Qg(Y2.bind(null,r,n,e),[e]),r.flags|=2048,il(9,od(),$2.bind(null,r,n,a,t),null),a},useId:function(){var e=Ia(),t=nt.identifierPrefix;if(We){var a=ms,r=hs;a=(r&~(1<<32-rr(r)-1)).toString(32)+a,t="«"+t+"R"+a,a=o0++,0<a&&(t+="H"+a.toString(32)),t+="»"}else a=qC++,t="«"+t+"r"+a.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:bx,useFormState:Kg,useActionState:Kg,useOptimistic:function(e){var t=Ia();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=wx.bind(null,Ue,!0,a),a.dispatch=t,[e,t]},useMemoCache:px,useCacheRefresh:function(){return Ia().memoizedState=QC.bind(null,Ue)}},yw={readContext:pa,use:ld,useCallback:iw,useContext:pa,useEffect:tw,useImperativeHandle:nw,useInsertionEffect:aw,useLayoutEffect:rw,useMemo:lw,useReducer:Ou,useRef:ew,useState:function(){return Ou(Ss)},useDebugValue:yx,useDeferredValue:function(e,t){var a=Ft();return ow(a,tt.memoizedState,e,t)},useTransition:function(){var e=Ou(Ss)[0],t=Ft().memoizedState;return[typeof e=="boolean"?e:Sc(e),t]},useSyncExternalStore:H2,useId:fw,useHostTransitionStatus:bx,useFormState:Wg,useActionState:Wg,useOptimistic:function(e,t){var a=Ft();return K2(a,tt,e,t)},useMemoCache:px,useCacheRefresh:hw},ek={readContext:pa,use:ld,useCallback:iw,useContext:pa,useEffect:tw,useImperativeHandle:nw,useInsertionEffect:aw,useLayoutEffect:rw,useMemo:lw,useReducer:tf,useRef:ew,useState:function(){return tf(Ss)},useDebugValue:yx,useDeferredValue:function(e,t){var a=Ft();return tt===null?vx(a,e,t):ow(a,tt.memoizedState,e,t)},useTransition:function(){var e=tf(Ss)[0],t=Ft().memoizedState;return[typeof e=="boolean"?e:Sc(e),t]},useSyncExternalStore:H2,useId:fw,useHostTransitionStatus:bx,useFormState:Zg,useActionState:Zg,useOptimistic:function(e,t){var a=Ft();return tt!==null?K2(a,tt,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:px,useCacheRefresh:hw},Wi=null,Ho=0;function tu(e){var t=Ho;return Ho+=1,Wi===null&&(Wi=[]),B2(Wi,e,t)}function Vl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function au(e,t){throw t.$$typeof===_4?Error(ue(525)):(e=Object.prototype.toString.call(t),Error(ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Jg(e){var t=e._init;return t(e._payload)}function vw(e){function t(g,b){if(e){var y=g.deletions;y===null?(g.deletions=[b],g.flags|=16):y.push(b)}}function a(g,b){if(!e)return null;for(;b!==null;)t(g,b),b=b.sibling;return null}function r(g){for(var b=new Map;g!==null;)g.key!==null?b.set(g.key,g):b.set(g.index,g),g=g.sibling;return b}function s(g,b){return g=vs(g,b),g.index=0,g.sibling=null,g}function n(g,b,y){return g.index=y,e?(y=g.alternate,y!==null?(y=y.index,y<b?(g.flags|=67108866,b):y):(g.flags|=67108866,b)):(g.flags|=1048576,b)}function l(g){return e&&g.alternate===null&&(g.flags|=67108866),g}function o(g,b,y,w){return b===null||b.tag!==6?(b=Qd(y,g.mode,w),b.return=g,b):(b=s(b,y),b.return=g,b)}function c(g,b,y,w){var N=y.type;return N===Ai?d(g,b,y.props.children,w,y.key):b!==null&&(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Is&&Jg(N)===b.type)?(b=s(b,y.props),Vl(b,y),b.return=g,b):(b=Ru(y.type,y.key,y.props,null,g.mode,w),Vl(b,y),b.return=g,b)}function u(g,b,y,w){return b===null||b.tag!==4||b.stateNode.containerInfo!==y.containerInfo||b.stateNode.implementation!==y.implementation?(b=Jd(y,g.mode,w),b.return=g,b):(b=s(b,y.children||[]),b.return=g,b)}function d(g,b,y,w,N){return b===null||b.tag!==7?(b=Bn(y,g.mode,w,N),b.return=g,b):(b=s(b,y),b.return=g,b)}function h(g,b,y){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=Qd(""+b,g.mode,y),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Xc:return y=Ru(b.type,b.key,b.props,null,g.mode,y),Vl(y,b),y.return=g,y;case Kl:return b=Jd(b,g.mode,y),b.return=g,b;case Is:var w=b._init;return b=w(b._payload),h(g,b,y)}if(Wl(b)||Ul(b))return b=Bn(b,g.mode,y,null),b.return=g,b;if(typeof b.then=="function")return h(g,tu(b),y);if(b.$$typeof===fs)return h(g,Jc(g,b),y);au(g,b)}return null}function f(g,b,y,w){var N=b!==null?b.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return N!==null?null:o(g,b,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Xc:return y.key===N?c(g,b,y,w):null;case Kl:return y.key===N?u(g,b,y,w):null;case Is:return N=y._init,y=N(y._payload),f(g,b,y,w)}if(Wl(y)||Ul(y))return N!==null?null:d(g,b,y,w,null);if(typeof y.then=="function")return f(g,b,tu(y),w);if(y.$$typeof===fs)return f(g,b,Jc(g,y),w);au(g,y)}return null}function m(g,b,y,w,N){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return g=g.get(y)||null,o(b,g,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xc:return g=g.get(w.key===null?y:w.key)||null,c(b,g,w,N);case Kl:return g=g.get(w.key===null?y:w.key)||null,u(b,g,w,N);case Is:var A=w._init;return w=A(w._payload),m(g,b,y,w,N)}if(Wl(w)||Ul(w))return g=g.get(y)||null,d(b,g,w,N,null);if(typeof w.then=="function")return m(g,b,y,tu(w),N);if(w.$$typeof===fs)return m(g,b,y,Jc(b,w),N);au(b,w)}return null}function p(g,b,y,w){for(var N=null,A=null,S=b,C=b=0,T=null;S!==null&&C<y.length;C++){S.index>C?(T=S,S=null):T=S.sibling;var D=f(g,S,y[C],w);if(D===null){S===null&&(S=T);break}e&&S&&D.alternate===null&&t(g,S),b=n(D,b,C),A===null?N=D:A.sibling=D,A=D,S=T}if(C===y.length)return a(g,S),We&&kn(g,C),N;if(S===null){for(;C<y.length;C++)S=h(g,y[C],w),S!==null&&(b=n(S,b,C),A===null?N=S:A.sibling=S,A=S);return We&&kn(g,C),N}for(S=r(S);C<y.length;C++)T=m(S,g,C,y[C],w),T!==null&&(e&&T.alternate!==null&&S.delete(T.key===null?C:T.key),b=n(T,b,C),A===null?N=T:A.sibling=T,A=T);return e&&S.forEach(function(R){return t(g,R)}),We&&kn(g,C),N}function x(g,b,y,w){if(y==null)throw Error(ue(151));for(var N=null,A=null,S=b,C=b=0,T=null,D=y.next();S!==null&&!D.done;C++,D=y.next()){S.index>C?(T=S,S=null):T=S.sibling;var R=f(g,S,D.value,w);if(R===null){S===null&&(S=T);break}e&&S&&R.alternate===null&&t(g,S),b=n(R,b,C),A===null?N=R:A.sibling=R,A=R,S=T}if(D.done)return a(g,S),We&&kn(g,C),N;if(S===null){for(;!D.done;C++,D=y.next())D=h(g,D.value,w),D!==null&&(b=n(D,b,C),A===null?N=D:A.sibling=D,A=D);return We&&kn(g,C),N}for(S=r(S);!D.done;C++,D=y.next())D=m(S,g,C,D.value,w),D!==null&&(e&&D.alternate!==null&&S.delete(D.key===null?C:D.key),b=n(D,b,C),A===null?N=D:A.sibling=D,A=D);return e&&S.forEach(function(j){return t(g,j)}),We&&kn(g,C),N}function v(g,b,y,w){if(typeof y=="object"&&y!==null&&y.type===Ai&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Xc:e:{for(var N=y.key;b!==null;){if(b.key===N){if(N=y.type,N===Ai){if(b.tag===7){a(g,b.sibling),w=s(b,y.props.children),w.return=g,g=w;break e}}else if(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Is&&Jg(N)===b.type){a(g,b.sibling),w=s(b,y.props),Vl(w,y),w.return=g,g=w;break e}a(g,b);break}else t(g,b);b=b.sibling}y.type===Ai?(w=Bn(y.props.children,g.mode,w,y.key),w.return=g,g=w):(w=Ru(y.type,y.key,y.props,null,g.mode,w),Vl(w,y),w.return=g,g=w)}return l(g);case Kl:e:{for(N=y.key;b!==null;){if(b.key===N)if(b.tag===4&&b.stateNode.containerInfo===y.containerInfo&&b.stateNode.implementation===y.implementation){a(g,b.sibling),w=s(b,y.children||[]),w.return=g,g=w;break e}else{a(g,b);break}else t(g,b);b=b.sibling}w=Jd(y,g.mode,w),w.return=g,g=w}return l(g);case Is:return N=y._init,y=N(y._payload),v(g,b,y,w)}if(Wl(y))return p(g,b,y,w);if(Ul(y)){if(N=Ul(y),typeof N!="function")throw Error(ue(150));return y=N.call(y),x(g,b,y,w)}if(typeof y.then=="function")return v(g,b,tu(y),w);if(y.$$typeof===fs)return v(g,b,Jc(g,y),w);au(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,b!==null&&b.tag===6?(a(g,b.sibling),w=s(b,y),w.return=g,g=w):(a(g,b),w=Qd(y,g.mode,w),w.return=g,g=w),l(g)):a(g,b)}return function(g,b,y,w){try{Ho=0;var N=v(g,b,y,w);return Wi=null,N}catch(S){if(S===Nc||S===id)throw S;var A=er(29,S,null,g.mode);return A.lanes=w,A.return=g,A}finally{}}}var ll=vw(!0),bw=vw(!1),Er=rs(null),Kr=null;function zs(e){var t=e.alternate;ut(Pt,Pt.current&1),ut(Er,e),Kr===null&&(t===null||nl.current!==null||t.memoizedState!==null)&&(Kr=e)}function ww(e){if(e.tag===22){if(ut(Pt,Pt.current),ut(Er,e),Kr===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Kr=e)}}else Hs()}function Hs(){ut(Pt,Pt.current),ut(Er,Er.current)}function ps(e){Wt(Er),Kr===e&&(Kr=null),Wt(Pt)}var Pt=rs(0);function u0(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||Gh(a)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function af(e,t,a,r){t=e.memoizedState,a=a(r,t),a=a==null?t:it({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var kh={enqueueSetState:function(e,t,a){e=e._reactInternals;var r=sr(),s=tn(r);s.payload=t,a!=null&&(s.callback=a),t=an(e,s,r),t!==null&&(nr(t,e,r),mo(t,e,r))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var r=sr(),s=tn(r);s.tag=1,s.payload=t,a!=null&&(s.callback=a),t=an(e,s,r),t!==null&&(nr(t,e,r),mo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=sr(),r=tn(a);r.tag=2,t!=null&&(r.callback=t),t=an(e,r,a),t!==null&&(nr(t,e,a),mo(t,e,a))}};function e1(e,t,a,r,s,n,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,n,l):t.prototype&&t.prototype.isPureReactComponent?!Po(a,r)||!Po(s,n):!0}function t1(e,t,a,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,r),t.state!==e&&kh.enqueueReplaceState(t,t.state,null)}function Qn(e,t){var a=t;if("ref"in t){a={};for(var r in t)r!=="ref"&&(a[r]=t[r])}if(e=e.defaultProps){a===t&&(a=it({},a));for(var s in e)a[s]===void 0&&(a[s]=e[s])}return a}var d0=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Ew(e){d0(e)}function Nw(e){console.error(e)}function Sw(e){d0(e)}function f0(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function a1(e,t,a){try{var r=e.onCaughtError;r(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function jh(e,t,a){return a=tn(a),a.tag=3,a.payload={element:null},a.callback=function(){f0(e,t)},a}function Tw(e){return e=tn(e),e.tag=3,e}function Aw(e,t,a,r){var s=a.type.getDerivedStateFromError;if(typeof s=="function"){var n=r.value;e.payload=function(){return s(n)},e.callback=function(){a1(t,a,r)}}var l=a.stateNode;l!==null&&typeof l.componentDidCatch=="function"&&(e.callback=function(){a1(t,a,r),typeof s!="function"&&(rn===null?rn=new Set([this]):rn.add(this));var o=r.stack;this.componentDidCatch(r.value,{componentStack:o!==null?o:""})})}function tk(e,t,a,r,s){if(a.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=a.alternate,t!==null&&wc(t,a,s,!0),a=Er.current,a!==null){switch(a.tag){case 13:return Kr===null?Uh():a.alternate===null&&bt===0&&(bt=3),a.flags&=-257,a.flags|=65536,a.lanes=s,r===wh?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([r]):t.add(r),mf(e,r,s)),!1;case 22:return a.flags|=65536,r===wh?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([r]):a.add(r)),mf(e,r,s)),!1}throw Error(ue(435,a.tag))}return mf(e,r,s),Uh(),!1}if(We)return t=Er.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=s,r!==ph&&(e=Error(ue(422),{cause:r}),Vo(yr(e,a)))):(r!==ph&&(t=Error(ue(423),{cause:r}),Vo(yr(t,a))),e=e.current.alternate,e.flags|=65536,s&=-s,e.lanes|=s,r=yr(r,a),s=jh(e.stateNode,r,s),ef(e,s),bt!==4&&(bt=2)),!1;var n=Error(ue(520),{cause:r});if(n=yr(n,a),bo===null?bo=[n]:bo.push(n),bt!==4&&(bt=2),t===null)return!0;r=yr(r,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=s&-s,a.lanes|=e,e=jh(a.stateNode,r,e),ef(a,e),!1;case 1:if(t=a.type,n=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||n!==null&&typeof n.componentDidCatch=="function"&&(rn===null||!rn.has(n))))return a.flags|=65536,s&=-s,a.lanes|=s,s=Tw(s),Aw(s,e,a,r),ef(a,s),!1}a=a.return}while(a!==null);return!1}var Cw=Error(ue(461)),Kt=!1;function ta(e,t,a,r){t.child=e===null?bw(t,null,a,r):ll(t,e.child,a,r)}function r1(e,t,a,r,s){a=a.render;var n=t.ref;if("ref"in r){var l={};for(var o in r)o!=="ref"&&(l[o]=r[o])}else l=r;return Wn(t),r=dx(e,t,a,l,n,s),o=fx(),e!==null&&!Kt?(hx(e,t,s),Ts(e,t,s)):(We&&o&&sx(t),t.flags|=1,ta(e,t,r,s),t.child)}function s1(e,t,a,r,s){if(e===null){var n=a.type;return typeof n=="function"&&!rx(n)&&n.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=n,kw(e,t,n,r,s)):(e=Ru(a.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(n=e.child,!Ex(e,s)){var l=n.memoizedProps;if(a=a.compare,a=a!==null?a:Po,a(l,r)&&e.ref===t.ref)return Ts(e,t,s)}return t.flags|=1,e=vs(n,r),e.ref=t.ref,e.return=t,t.child=e}function kw(e,t,a,r,s){if(e!==null){var n=e.memoizedProps;if(Po(n,r)&&e.ref===t.ref)if(Kt=!1,t.pendingProps=r=n,Ex(e,s))e.flags&131072&&(Kt=!0);else return t.lanes=e.lanes,Ts(e,t,s)}return _h(e,t,a,r,s)}function jw(e,t,a){var r=t.pendingProps,s=r.children,n=e!==null?e.memoizedState:null;if(r.mode==="hidden"){if(t.flags&128){if(r=n!==null?n.baseLanes|a:a,e!==null){for(s=t.child=e.child,n=0;s!==null;)n=n|s.lanes|s.childLanes,s=s.sibling;t.childLanes=n&~r}else t.childLanes=0,t.child=null;return n1(e,t,r,a)}if(a&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Du(t,n!==null?n.cachePool:null),n!==null?Yg(t,n):Sh(),ww(t);else return t.lanes=t.childLanes=536870912,n1(e,t,n!==null?n.baseLanes|a:a,a)}else n!==null?(Du(t,n.cachePool),Yg(t,n),Hs(),t.memoizedState=null):(e!==null&&Du(t,null),Sh(),Hs());return ta(e,t,s,a),t.child}function n1(e,t,a,r){var s=lx();return s=s===null?null:{parent:It._currentValue,pool:s},t.memoizedState={baseLanes:a,cachePool:s},e!==null&&Du(t,null),Sh(),ww(t),e!==null&&wc(e,t,r,!0),null}function Lu(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(ue(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function _h(e,t,a,r,s){return Wn(t),a=dx(e,t,a,r,void 0,s),r=fx(),e!==null&&!Kt?(hx(e,t,s),Ts(e,t,s)):(We&&r&&sx(t),t.flags|=1,ta(e,t,a,s),t.child)}function i1(e,t,a,r,s,n){return Wn(t),t.updateQueue=null,a=z2(t,r,a,s),V2(e),r=fx(),e!==null&&!Kt?(hx(e,t,n),Ts(e,t,n)):(We&&r&&sx(t),t.flags|=1,ta(e,t,a,n),t.child)}function l1(e,t,a,r,s){if(Wn(t),t.stateNode===null){var n=Fi,l=a.contextType;typeof l=="object"&&l!==null&&(n=pa(l)),n=new a(r,n),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=kh,t.stateNode=n,n._reactInternals=t,n=t.stateNode,n.props=r,n.state=t.memoizedState,n.refs={},ox(t),l=a.contextType,n.context=typeof l=="object"&&l!==null?pa(l):Fi,n.state=t.memoizedState,l=a.getDerivedStateFromProps,typeof l=="function"&&(af(t,a,l,r),n.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(l=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),l!==n.state&&kh.enqueueReplaceState(n,n.state,null),po(t,r,n,s),xo(),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(e===null){n=t.stateNode;var o=t.memoizedProps,c=Qn(a,o);n.props=c;var u=n.context,d=a.contextType;l=Fi,typeof d=="object"&&d!==null&&(l=pa(d));var h=a.getDerivedStateFromProps;d=typeof h=="function"||typeof n.getSnapshotBeforeUpdate=="function",o=t.pendingProps!==o,d||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(o||u!==l)&&t1(t,n,r,l),Ps=!1;var f=t.memoizedState;n.state=f,po(t,r,n,s),xo(),u=t.memoizedState,o||f!==u||Ps?(typeof h=="function"&&(af(t,a,h,r),u=t.memoizedState),(c=Ps||e1(t,a,c,r,f,u,l))?(d||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount()),typeof n.componentDidMount=="function"&&(t.flags|=4194308)):(typeof n.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),n.props=r,n.state=u,n.context=l,r=c):(typeof n.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{n=t.stateNode,Eh(e,t),l=t.memoizedProps,d=Qn(a,l),n.props=d,h=t.pendingProps,f=n.context,u=a.contextType,c=Fi,typeof u=="object"&&u!==null&&(c=pa(u)),o=a.getDerivedStateFromProps,(u=typeof o=="function"||typeof n.getSnapshotBeforeUpdate=="function")||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(l!==h||f!==c)&&t1(t,n,r,c),Ps=!1,f=t.memoizedState,n.state=f,po(t,r,n,s),xo();var m=t.memoizedState;l!==h||f!==m||Ps||e!==null&&e.dependencies!==null&&n0(e.dependencies)?(typeof o=="function"&&(af(t,a,o,r),m=t.memoizedState),(d=Ps||e1(t,a,d,r,f,m,c)||e!==null&&e.dependencies!==null&&n0(e.dependencies))?(u||typeof n.UNSAFE_componentWillUpdate!="function"&&typeof n.componentWillUpdate!="function"||(typeof n.componentWillUpdate=="function"&&n.componentWillUpdate(r,m,c),typeof n.UNSAFE_componentWillUpdate=="function"&&n.UNSAFE_componentWillUpdate(r,m,c)),typeof n.componentDidUpdate=="function"&&(t.flags|=4),typeof n.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof n.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),n.props=r,n.state=m,n.context=c,r=d):(typeof n.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return n=r,Lu(e,t),r=(t.flags&128)!==0,n||r?(n=t.stateNode,a=r&&typeof a.getDerivedStateFromError!="function"?null:n.render(),t.flags|=1,e!==null&&r?(t.child=ll(t,e.child,null,s),t.child=ll(t,null,a,s)):ta(e,t,a,s),t.memoizedState=n.state,e=t.child):e=Ts(e,t,s),e}function o1(e,t,a,r){return bc(),t.flags|=256,ta(e,t,a,r),t.child}var rf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sf(e){return{baseLanes:e,cachePool:M2()}}function nf(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=vr),e}function _w(e,t,a){var r=t.pendingProps,s=!1,n=(t.flags&128)!==0,l;if((l=n)||(l=e!==null&&e.memoizedState===null?!1:(Pt.current&2)!==0),l&&(s=!0,t.flags&=-129),l=(t.flags&32)!==0,t.flags&=-33,e===null){if(We){if(s?zs(t):Hs(),We){var o=yt,c;if(c=o){e:{for(c=o,o=$r;c.nodeType!==8;){if(!o){o=null;break e}if(c=Lr(c.nextSibling),c===null){o=null;break e}}o=c}o!==null?(t.memoizedState={dehydrated:o,treeContext:In!==null?{id:hs,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},c=er(18,null,null,0),c.stateNode=o,c.return=t,t.child=c,ka=t,yt=null,c=!0):c=!1}c||Kn(t)}if(o=t.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return Gh(o)?t.lanes=32:t.lanes=536870912,null;ps(t)}return o=r.children,r=r.fallback,s?(Hs(),s=t.mode,o=h0({mode:"hidden",children:o},s),r=Bn(r,s,a,null),o.return=t,r.return=t,o.sibling=r,t.child=o,s=t.child,s.memoizedState=sf(a),s.childLanes=nf(e,l,a),t.memoizedState=rf,r):(zs(t),Rh(t,o))}if(c=e.memoizedState,c!==null&&(o=c.dehydrated,o!==null)){if(n)t.flags&256?(zs(t),t.flags&=-257,t=lf(e,t,a)):t.memoizedState!==null?(Hs(),t.child=e.child,t.flags|=128,t=null):(Hs(),s=r.fallback,o=t.mode,r=h0({mode:"visible",children:r.children},o),s=Bn(s,o,a,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,ll(t,e.child,null,a),r=t.child,r.memoizedState=sf(a),r.childLanes=nf(e,l,a),t.memoizedState=rf,t=s);else if(zs(t),Gh(o)){if(l=o.nextSibling&&o.nextSibling.dataset,l)var u=l.dgst;l=u,r=Error(ue(419)),r.stack="",r.digest=l,Vo({value:r,source:null,stack:null}),t=lf(e,t,a)}else if(Kt||wc(e,t,a,!1),l=(a&e.childLanes)!==0,Kt||l){if(l=nt,l!==null&&(r=a&-a,r=r&42?1:Ym(r),r=r&(l.suspendedLanes|a)?0:r,r!==0&&r!==c.retryLane))throw c.retryLane=r,vl(e,r),nr(l,e,r),Cw;o.data==="$?"||Uh(),t=lf(e,t,a)}else o.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,yt=Lr(o.nextSibling),ka=t,We=!0,Pn=null,$r=!1,e!==null&&(xr[pr++]=hs,xr[pr++]=ms,xr[pr++]=In,hs=e.id,ms=e.overflow,In=t),t=Rh(t,r.children),t.flags|=4096);return t}return s?(Hs(),s=r.fallback,o=t.mode,c=e.child,u=c.sibling,r=vs(c,{mode:"hidden",children:r.children}),r.subtreeFlags=c.subtreeFlags&65011712,u!==null?s=vs(u,s):(s=Bn(s,o,a,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o===null?o=sf(a):(c=o.cachePool,c!==null?(u=It._currentValue,c=c.parent!==u?{parent:u,pool:u}:c):c=M2(),o={baseLanes:o.baseLanes|a,cachePool:c}),s.memoizedState=o,s.childLanes=nf(e,l,a),t.memoizedState=rf,r):(zs(t),a=e.child,e=a.sibling,a=vs(a,{mode:"visible",children:r.children}),a.return=t,a.sibling=null,e!==null&&(l=t.deletions,l===null?(t.deletions=[e],t.flags|=16):l.push(e)),t.child=a,t.memoizedState=null,a)}function Rh(e,t){return t=h0({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function h0(e,t){return e=er(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function lf(e,t,a){return ll(t,e.child,null,a),e=Rh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function c1(e,t,a){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),yh(e.return,t,a)}function of(e,t,a,r,s){var n=e.memoizedState;n===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:a,tailMode:s}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=r,n.tail=a,n.tailMode=s)}function Rw(e,t,a){var r=t.pendingProps,s=r.revealOrder,n=r.tail;if(ta(e,t,r.children,a),r=Pt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&c1(e,a,t);else if(e.tag===19)c1(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(ut(Pt,r),s){case"forwards":for(a=t.child,s=null;a!==null;)e=a.alternate,e!==null&&u0(e)===null&&(s=a),a=a.sibling;a=s,a===null?(s=t.child,t.child=null):(s=a.sibling,a.sibling=null),of(t,!1,s,a,n);break;case"backwards":for(a=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&u0(e)===null){t.child=s;break}e=s.sibling,s.sibling=a,a=s,s=e}of(t,!0,a,null,n);break;case"together":of(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ts(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),hn|=t.lanes,!(a&t.childLanes))if(e!==null){if(wc(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(ue(153));if(t.child!==null){for(e=t.child,a=vs(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=vs(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Ex(e,t){return e.lanes&t?!0:(e=e.dependencies,!!(e!==null&&n0(e)))}function ak(e,t,a){switch(t.tag){case 3:Zu(t,t.stateNode.containerInfo),Vs(t,It,e.memoizedState.cache),bc();break;case 27:case 5:ih(t);break;case 4:Zu(t,t.stateNode.containerInfo);break;case 10:Vs(t,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(zs(t),t.flags|=128,null):a&t.child.childLanes?_w(e,t,a):(zs(t),e=Ts(e,t,a),e!==null?e.sibling:null);zs(t);break;case 19:var s=(e.flags&128)!==0;if(r=(a&t.childLanes)!==0,r||(wc(e,t,a,!1),r=(a&t.childLanes)!==0),s){if(r)return Rw(e,t,a);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ut(Pt,Pt.current),r)break;return null;case 22:case 23:return t.lanes=0,jw(e,t,a);case 24:Vs(t,It,e.memoizedState.cache)}return Ts(e,t,a)}function Dw(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)Kt=!0;else{if(!Ex(e,a)&&!(t.flags&128))return Kt=!1,ak(e,t,a);Kt=!!(e.flags&131072)}else Kt=!1,We&&t.flags&1048576&&F2(t,s0,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,s=r._init;if(r=s(r._payload),t.type=r,typeof r=="function")rx(r)?(e=Qn(r,e),t.tag=1,t=l1(null,t,r,e,a)):(t.tag=0,t=_h(null,t,r,e,a));else{if(r!=null){if(s=r.$$typeof,s===Hm){t.tag=11,t=r1(null,t,r,e,a);break e}else if(s===Gm){t.tag=14,t=s1(null,t,r,e,a);break e}}throw t=sh(r)||r,Error(ue(306,t,""))}}return t;case 0:return _h(e,t,t.type,t.pendingProps,a);case 1:return r=t.type,s=Qn(r,t.pendingProps),l1(e,t,r,s,a);case 3:e:{if(Zu(t,t.stateNode.containerInfo),e===null)throw Error(ue(387));r=t.pendingProps;var n=t.memoizedState;s=n.element,Eh(e,t),po(t,r,null,a);var l=t.memoizedState;if(r=l.cache,Vs(t,It,r),r!==n.cache&&vh(t,[It],a,!0),xo(),r=l.element,n.isDehydrated)if(n={element:r,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=n,t.memoizedState=n,t.flags&256){t=o1(e,t,r,a);break e}else if(r!==s){s=yr(Error(ue(424)),t),Vo(s),t=o1(e,t,r,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(yt=Lr(e.firstChild),ka=t,We=!0,Pn=null,$r=!0,a=bw(t,null,r,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(bc(),r===s){t=Ts(e,t,a);break e}ta(e,t,r,a)}t=t.child}return t;case 26:return Lu(e,t),e===null?(a=A1(t.type,null,t.pendingProps,null))?t.memoizedState=a:We||(a=t.type,e=t.pendingProps,r=b0(en.current).createElement(a),r[xa]=t,r[$a]=e,na(r,a,e),Xt(r),t.stateNode=r):t.memoizedState=A1(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ih(t),e===null&&We&&(r=t.stateNode=yE(t.type,t.pendingProps,en.current),ka=t,$r=!0,s=yt,bn(t.type)?($h=s,yt=Lr(r.firstChild)):yt=s),ta(e,t,t.pendingProps.children,a),Lu(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&We&&((s=r=yt)&&(r=_k(r,t.type,t.pendingProps,$r),r!==null?(t.stateNode=r,ka=t,yt=Lr(r.firstChild),$r=!1,s=!0):s=!1),s||Kn(t)),ih(t),s=t.type,n=t.pendingProps,l=e!==null?e.memoizedProps:null,r=n.children,zh(s,n)?r=null:l!==null&&zh(s,l)&&(t.flags|=32),t.memoizedState!==null&&(s=dx(e,t,XC,null,null,a),qo._currentValue=s),Lu(e,t),ta(e,t,r,a),t.child;case 6:return e===null&&We&&((e=a=yt)&&(a=Rk(a,t.pendingProps,$r),a!==null?(t.stateNode=a,ka=t,yt=null,e=!0):e=!1),e||Kn(t)),null;case 13:return _w(e,t,a);case 4:return Zu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ll(t,null,r,a):ta(e,t,r,a),t.child;case 11:return r1(e,t,t.type,t.pendingProps,a);case 7:return ta(e,t,t.pendingProps,a),t.child;case 8:return ta(e,t,t.pendingProps.children,a),t.child;case 12:return ta(e,t,t.pendingProps.children,a),t.child;case 10:return r=t.pendingProps,Vs(t,t.type,r.value),ta(e,t,r.children,a),t.child;case 9:return s=t.type._context,r=t.pendingProps.children,Wn(t),s=pa(s),r=r(s),t.flags|=1,ta(e,t,r,a),t.child;case 14:return s1(e,t,t.type,t.pendingProps,a);case 15:return kw(e,t,t.type,t.pendingProps,a);case 19:return Rw(e,t,a);case 31:return r=t.pendingProps,a=t.mode,r={mode:r.mode,children:r.children},e===null?(a=h0(r,a),a.ref=t.ref,t.child=a,a.return=t,t=a):(a=vs(e.child,r),a.ref=t.ref,t.child=a,a.return=t,t=a),t;case 22:return jw(e,t,a);case 24:return Wn(t),r=pa(It),e===null?(s=lx(),s===null&&(s=nt,n=ix(),s.pooledCache=n,n.refCount++,n!==null&&(s.pooledCacheLanes|=a),s=n),t.memoizedState={parent:r,cache:s},ox(t),Vs(t,It,s)):(e.lanes&a&&(Eh(e,t),po(t,null,null,a),xo()),s=e.memoizedState,n=t.memoizedState,s.parent!==r?(s={parent:r,cache:r},t.memoizedState=s,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=s),Vs(t,It,r)):(r=n.cache,Vs(t,It,r),r!==s.cache&&vh(t,[It],a,!0))),ta(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(ue(156,t.tag))}function cs(e){e.flags|=4}function u1(e,t){if(t.type!=="stylesheet"||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!wE(t)){if(t=Er.current,t!==null&&((He&4194048)===He?Kr!==null:(He&62914560)!==He&&!(He&536870912)||t!==Kr))throw ho=wh,U2;e.flags|=8192}}function ru(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?s2():536870912,e.lanes|=t,ol|=t)}function zl(e,t){if(!We)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var r=null;a!==null;)a.alternate!==null&&(r=a),a=a.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,r=0;if(t)for(var s=e.child;s!==null;)a|=s.lanes|s.childLanes,r|=s.subtreeFlags&65011712,r|=s.flags&65011712,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)a|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=a,t}function rk(e,t,a){var r=t.pendingProps;switch(nx(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(t),null;case 1:return xt(t),null;case 3:return a=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),bs(It),tl(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Pl(t)?cs(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Pg())),xt(t),null;case 26:return a=t.memoizedState,e===null?(cs(t),a!==null?(xt(t),u1(t,a)):(xt(t),t.flags&=-16777217)):a?a!==e.memoizedState?(cs(t),xt(t),u1(t,a)):(xt(t),t.flags&=-16777217):(e.memoizedProps!==r&&cs(t),xt(t),t.flags&=-16777217),null;case 27:Qu(t),a=en.current;var s=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==r&&cs(t);else{if(!r){if(t.stateNode===null)throw Error(ue(166));return xt(t),null}e=qr.current,Pl(t)?Bg(t):(e=yE(s,r,a),t.stateNode=e,cs(t))}return xt(t),null;case 5:if(Qu(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&cs(t);else{if(!r){if(t.stateNode===null)throw Error(ue(166));return xt(t),null}if(e=qr.current,Pl(t))Bg(t);else{switch(s=b0(en.current),e){case 1:e=s.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=s.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=s.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=s.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof r.is=="string"?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e=typeof r.is=="string"?s.createElement(a,{is:r.is}):s.createElement(a)}}e[xa]=t,e[$a]=r;e:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=e;e:switch(na(e,a,r),a){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&cs(t)}}return xt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&cs(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ue(166));if(e=en.current,Pl(t)){if(e=t.stateNode,a=t.memoizedProps,r=null,s=ka,s!==null)switch(s.tag){case 27:case 5:r=s.memoizedProps}e[xa]=t,e=!!(e.nodeValue===a||r!==null&&r.suppressHydrationWarning===!0||xE(e.nodeValue,a)),e||Kn(t)}else e=b0(e).createTextNode(r),e[xa]=t,t.stateNode=e}return xt(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(s=Pl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ue(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ue(317));s[xa]=t}else bc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xt(t),s=!1}else s=Pg(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=s),s=!0;if(!s)return t.flags&256?(ps(t),t):(ps(t),null)}if(ps(t),t.flags&128)return t.lanes=a,t;if(a=r!==null,e=e!==null&&e.memoizedState!==null,a){r=t.child,s=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(s=r.alternate.memoizedState.cachePool.pool);var n=null;r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==s&&(r.flags|=2048)}return a!==e&&a&&(t.child.flags|=8192),ru(t,t.updateQueue),xt(t),null;case 4:return tl(),e===null&&_x(t.stateNode.containerInfo),xt(t),null;case 10:return bs(t.type),xt(t),null;case 19:if(Wt(Pt),s=t.memoizedState,s===null)return xt(t),null;if(r=(t.flags&128)!==0,n=s.rendering,n===null)if(r)zl(s,!1);else{if(bt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(n=u0(e),n!==null){for(t.flags|=128,zl(s,!1),e=n.updateQueue,t.updateQueue=e,ru(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)O2(a,e),a=a.sibling;return ut(Pt,Pt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Xr()>x0&&(t.flags|=128,r=!0,zl(s,!1),t.lanes=4194304)}else{if(!r)if(e=u0(n),e!==null){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,ru(t,e),zl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!n.alternate&&!We)return xt(t),null}else 2*Xr()-s.renderingStartTime>x0&&a!==536870912&&(t.flags|=128,r=!0,zl(s,!1),t.lanes=4194304);s.isBackwards?(n.sibling=t.child,t.child=n):(e=s.last,e!==null?e.sibling=n:t.child=n,s.last=n)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xr(),t.sibling=null,e=Pt.current,ut(Pt,r?e&1|2:e&1),t):(xt(t),null);case 22:case 23:return ps(t),cx(),r=t.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?a&536870912&&!(t.flags&128)&&(xt(t),t.subtreeFlags&6&&(t.flags|=8192)):xt(t),a=t.updateQueue,a!==null&&ru(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==a&&(t.flags|=2048),e!==null&&Wt(Vn),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),bs(It),xt(t),null;case 25:return null;case 30:return null}throw Error(ue(156,t.tag))}function sk(e,t){switch(nx(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bs(It),tl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Qu(t),null;case 13:if(ps(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ue(340));bc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wt(Pt),null;case 4:return tl(),null;case 10:return bs(t.type),null;case 22:case 23:return ps(t),cx(),e!==null&&Wt(Vn),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return bs(It),null;case 25:return null;default:return null}}function Ow(e,t){switch(nx(t),t.tag){case 3:bs(It),tl();break;case 26:case 27:case 5:Qu(t);break;case 4:tl();break;case 13:ps(t);break;case 19:Wt(Pt);break;case 10:bs(t.type);break;case 22:case 23:ps(t),cx(),e!==null&&Wt(Vn);break;case 24:bs(It)}}function Ac(e,t){try{var a=t.updateQueue,r=a!==null?a.lastEffect:null;if(r!==null){var s=r.next;a=s;do{if((a.tag&e)===e){r=void 0;var n=a.create,l=a.inst;r=n(),l.destroy=r}a=a.next}while(a!==s)}}catch(o){rt(t,t.return,o)}}function fn(e,t,a){try{var r=t.updateQueue,s=r!==null?r.lastEffect:null;if(s!==null){var n=s.next;r=n;do{if((r.tag&e)===e){var l=r.inst,o=l.destroy;if(o!==void 0){l.destroy=void 0,s=t;var c=a,u=o;try{u()}catch(d){rt(s,c,d)}}}r=r.next}while(r!==n)}}catch(d){rt(t,t.return,d)}}function Fw(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{P2(t,a)}catch(r){rt(e,e.return,r)}}}function Lw(e,t,a){a.props=Qn(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(r){rt(e,t,r)}}function yo(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof a=="function"?e.refCleanup=a(r):a.current=r}}catch(s){rt(e,t,s)}}function Yr(e,t){var a=e.ref,r=e.refCleanup;if(a!==null)if(typeof r=="function")try{r()}catch(s){rt(e,t,s)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(s){rt(e,t,s)}else a.current=null}function Mw(e){var t=e.type,a=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break e;case"img":a.src?r.src=a.src:a.srcSet&&(r.srcset=a.srcSet)}}catch(s){rt(e,e.return,s)}}function cf(e,t,a){try{var r=e.stateNode;Tk(r,e.type,a,t),r[$a]=t}catch(s){rt(e,e.return,s)}}function Uw(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&bn(e.type)||e.tag===4}function uf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Uw(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&bn(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Dh(e,t,a){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=hd));else if(r!==4&&(r===27&&bn(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(Dh(e,t,a),e=e.sibling;e!==null;)Dh(e,t,a),e=e.sibling}function m0(e,t,a){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(r!==4&&(r===27&&bn(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(m0(e,t,a),e=e.sibling;e!==null;)m0(e,t,a),e=e.sibling}function Bw(e){var t=e.stateNode,a=e.memoizedProps;try{for(var r=e.type,s=t.attributes;s.length;)t.removeAttributeNode(s[0]);na(t,r,a),t[xa]=e,t[$a]=a}catch(n){rt(e,e.return,n)}}var ds=!1,At=!1,df=!1,d1=typeof WeakSet=="function"?WeakSet:Set,qt=null;function nk(e,t){if(e=e.containerInfo,Ph=S0,e=T2(e),ex(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var r=a.getSelection&&a.getSelection();if(r&&r.rangeCount!==0){a=r.anchorNode;var s=r.anchorOffset,n=r.focusNode;r=r.focusOffset;try{a.nodeType,n.nodeType}catch{a=null;break e}var l=0,o=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==a||s!==0&&h.nodeType!==3||(o=l+s),h!==n||r!==0&&h.nodeType!==3||(c=l+r),h.nodeType===3&&(l+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===a&&++u===s&&(o=l),f===n&&++d===r&&(c=l),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}a=o===-1||c===-1?null:{start:o,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(Vh={focusedElem:e,selectionRange:a},S0=!1,qt=t;qt!==null;)if(t=qt,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,qt=e;else for(;qt!==null;){switch(t=qt,n=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if(e&1024&&n!==null){e=void 0,a=t,s=n.memoizedProps,n=n.memoizedState,r=a.stateNode;try{var p=Qn(a.type,s,a.elementType===a.type);e=r.getSnapshotBeforeUpdate(p,n),r.__reactInternalSnapshotBeforeUpdate=e}catch(x){rt(a,a.return,x)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Hh(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Hh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(ue(163))}if(e=t.sibling,e!==null){e.return=t.return,qt=e;break}qt=t.return}}function Iw(e,t,a){var r=a.flags;switch(a.tag){case 0:case 11:case 15:Fs(e,a),r&4&&Ac(5,a);break;case 1:if(Fs(e,a),r&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(l){rt(a,a.return,l)}else{var s=Qn(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(s,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){rt(a,a.return,l)}}r&64&&Fw(a),r&512&&yo(a,a.return);break;case 3:if(Fs(e,a),r&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{P2(e,t)}catch(l){rt(a,a.return,l)}}break;case 27:t===null&&r&4&&Bw(a);case 26:case 5:Fs(e,a),t===null&&r&4&&Mw(a),r&512&&yo(a,a.return);break;case 12:Fs(e,a);break;case 13:Fs(e,a),r&4&&zw(e,a),r&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=mk.bind(null,a),Dk(e,a))));break;case 22:if(r=a.memoizedState!==null||ds,!r){t=t!==null&&t.memoizedState!==null||At,s=ds;var n=At;ds=r,(At=t)&&!n?Us(e,a,(a.subtreeFlags&8772)!==0):Fs(e,a),ds=s,At=n}break;case 30:break;default:Fs(e,a)}}function Pw(e){var t=e.alternate;t!==null&&(e.alternate=null,Pw(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Xm(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var lt=null,Pa=!1;function us(e,t,a){for(a=a.child;a!==null;)Vw(e,t,a),a=a.sibling}function Vw(e,t,a){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(xc,a)}catch{}switch(a.tag){case 26:At||Yr(a,t),us(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:At||Yr(a,t);var r=lt,s=Pa;bn(a.type)&&(lt=a.stateNode,Pa=!1),us(e,t,a),Eo(a.stateNode),lt=r,Pa=s;break;case 5:At||Yr(a,t);case 6:if(r=lt,s=Pa,lt=null,us(e,t,a),lt=r,Pa=s,lt!==null)if(Pa)try{(lt.nodeType===9?lt.body:lt.nodeName==="HTML"?lt.ownerDocument.body:lt).removeChild(a.stateNode)}catch(n){rt(a,t,n)}else try{lt.removeChild(a.stateNode)}catch(n){rt(a,t,n)}break;case 18:lt!==null&&(Pa?(e=lt,N1(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),Wo(e)):N1(lt,a.stateNode));break;case 4:r=lt,s=Pa,lt=a.stateNode.containerInfo,Pa=!0,us(e,t,a),lt=r,Pa=s;break;case 0:case 11:case 14:case 15:At||fn(2,a,t),At||fn(4,a,t),us(e,t,a);break;case 1:At||(Yr(a,t),r=a.stateNode,typeof r.componentWillUnmount=="function"&&Lw(a,t,r)),us(e,t,a);break;case 21:us(e,t,a);break;case 22:At=(r=At)||a.memoizedState!==null,us(e,t,a),At=r;break;default:us(e,t,a)}}function zw(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Wo(e)}catch(a){rt(t,t.return,a)}}function ik(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new d1),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new d1),t;default:throw Error(ue(435,e.tag))}}function ff(e,t){var a=ik(e);t.forEach(function(r){var s=xk.bind(null,e,r);a.has(r)||(a.add(r),r.then(s,s))})}function Ka(e,t){var a=t.deletions;if(a!==null)for(var r=0;r<a.length;r++){var s=a[r],n=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 27:if(bn(o.type)){lt=o.stateNode,Pa=!1;break e}break;case 5:lt=o.stateNode,Pa=!1;break e;case 3:case 4:lt=o.stateNode.containerInfo,Pa=!0;break e}o=o.return}if(lt===null)throw Error(ue(160));Vw(n,l,s),lt=null,Pa=!1,n=s.alternate,n!==null&&(n.return=null),s.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Hw(t,e),t=t.sibling}var _r=null;function Hw(e,t){var a=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ka(t,e),Wa(e),r&4&&(fn(3,e,e.return),Ac(3,e),fn(5,e,e.return));break;case 1:Ka(t,e),Wa(e),r&512&&(At||a===null||Yr(a,a.return)),r&64&&ds&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?r:a.concat(r))));break;case 26:var s=_r;if(Ka(t,e),Wa(e),r&512&&(At||a===null||Yr(a,a.return)),r&4){var n=a!==null?a.memoizedState:null;if(r=e.memoizedState,a===null)if(r===null)if(e.stateNode===null){e:{r=e.type,a=e.memoizedProps,s=s.ownerDocument||s;t:switch(r){case"title":n=s.getElementsByTagName("title")[0],(!n||n[yc]||n[xa]||n.namespaceURI==="http://www.w3.org/2000/svg"||n.hasAttribute("itemprop"))&&(n=s.createElement(r),s.head.insertBefore(n,s.querySelector("head > title"))),na(n,r,a),n[xa]=e,Xt(n),r=n;break e;case"link":var l=k1("link","href",s).get(r+(a.href||""));if(l){for(var o=0;o<l.length;o++)if(n=l[o],n.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&n.getAttribute("rel")===(a.rel==null?null:a.rel)&&n.getAttribute("title")===(a.title==null?null:a.title)&&n.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){l.splice(o,1);break t}}n=s.createElement(r),na(n,r,a),s.head.appendChild(n);break;case"meta":if(l=k1("meta","content",s).get(r+(a.content||""))){for(o=0;o<l.length;o++)if(n=l[o],n.getAttribute("content")===(a.content==null?null:""+a.content)&&n.getAttribute("name")===(a.name==null?null:a.name)&&n.getAttribute("property")===(a.property==null?null:a.property)&&n.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&n.getAttribute("charset")===(a.charSet==null?null:a.charSet)){l.splice(o,1);break t}}n=s.createElement(r),na(n,r,a),s.head.appendChild(n);break;default:throw Error(ue(468,r))}n[xa]=e,Xt(n),r=n}e.stateNode=r}else j1(s,e.type,e.stateNode);else e.stateNode=C1(s,r,e.memoizedProps);else n!==r?(n===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):n.count--,r===null?j1(s,e.type,e.stateNode):C1(s,r,e.memoizedProps)):r===null&&e.stateNode!==null&&cf(e,e.memoizedProps,a.memoizedProps)}break;case 27:Ka(t,e),Wa(e),r&512&&(At||a===null||Yr(a,a.return)),a!==null&&r&4&&cf(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Ka(t,e),Wa(e),r&512&&(At||a===null||Yr(a,a.return)),e.flags&32){s=e.stateNode;try{rl(s,"")}catch(m){rt(e,e.return,m)}}r&4&&e.stateNode!=null&&(s=e.memoizedProps,cf(e,s,a!==null?a.memoizedProps:s)),r&1024&&(df=!0);break;case 6:if(Ka(t,e),Wa(e),r&4){if(e.stateNode===null)throw Error(ue(162));r=e.memoizedProps,a=e.stateNode;try{a.nodeValue=r}catch(m){rt(e,e.return,m)}}break;case 3:if(Bu=null,s=_r,_r=w0(t.containerInfo),Ka(t,e),_r=s,Wa(e),r&4&&a!==null&&a.memoizedState.isDehydrated)try{Wo(t.containerInfo)}catch(m){rt(e,e.return,m)}df&&(df=!1,Gw(e));break;case 4:r=_r,_r=w0(e.stateNode.containerInfo),Ka(t,e),Wa(e),_r=r;break;case 12:Ka(t,e),Wa(e);break;case 13:Ka(t,e),Wa(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Cx=Xr()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,ff(e,r)));break;case 22:s=e.memoizedState!==null;var c=a!==null&&a.memoizedState!==null,u=ds,d=At;if(ds=u||s,At=d||c,Ka(t,e),At=d,ds=u,Wa(e),r&8192)e:for(t=e.stateNode,t._visibility=s?t._visibility&-2:t._visibility|1,s&&(a===null||c||ds||At||jn(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){c=a=t;try{if(n=c.stateNode,s)l=n.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,f=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=f==null||typeof f=="boolean"?"":(""+f).trim()}}catch(m){rt(c,c.return,m)}}}else if(t.tag===6){if(a===null){c=t;try{c.stateNode.nodeValue=s?"":c.memoizedProps}catch(m){rt(c,c.return,m)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(a=r.retryQueue,a!==null&&(r.retryQueue=null,ff(e,a))));break;case 19:Ka(t,e),Wa(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,ff(e,r)));break;case 30:break;case 21:break;default:Ka(t,e),Wa(e)}}function Wa(e){var t=e.flags;if(t&2){try{for(var a,r=e.return;r!==null;){if(Uw(r)){a=r;break}r=r.return}if(a==null)throw Error(ue(160));switch(a.tag){case 27:var s=a.stateNode,n=uf(e);m0(e,n,s);break;case 5:var l=a.stateNode;a.flags&32&&(rl(l,""),a.flags&=-33);var o=uf(e);m0(e,o,l);break;case 3:case 4:var c=a.stateNode.containerInfo,u=uf(e);Dh(e,u,c);break;default:throw Error(ue(161))}}catch(d){rt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Gw(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Gw(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Fs(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Iw(e,t.alternate,t),t=t.sibling}function jn(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:fn(4,t,t.return),jn(t);break;case 1:Yr(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&Lw(t,t.return,a),jn(t);break;case 27:Eo(t.stateNode);case 26:case 5:Yr(t,t.return),jn(t);break;case 22:t.memoizedState===null&&jn(t);break;case 30:jn(t);break;default:jn(t)}e=e.sibling}}function Us(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,s=e,n=t,l=n.flags;switch(n.tag){case 0:case 11:case 15:Us(s,n,a),Ac(4,n);break;case 1:if(Us(s,n,a),r=n,s=r.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(u){rt(r,r.return,u)}if(r=n,s=r.updateQueue,s!==null){var o=r.stateNode;try{var c=s.shared.hiddenCallbacks;if(c!==null)for(s.shared.hiddenCallbacks=null,s=0;s<c.length;s++)I2(c[s],o)}catch(u){rt(r,r.return,u)}}a&&l&64&&Fw(n),yo(n,n.return);break;case 27:Bw(n);case 26:case 5:Us(s,n,a),a&&r===null&&l&4&&Mw(n),yo(n,n.return);break;case 12:Us(s,n,a);break;case 13:Us(s,n,a),a&&l&4&&zw(s,n);break;case 22:n.memoizedState===null&&Us(s,n,a),yo(n,n.return);break;case 30:break;default:Us(s,n,a)}t=t.sibling}}function Nx(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&Ec(a))}function Sx(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ec(e))}function Vr(e,t,a,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)$w(e,t,a,r),t=t.sibling}function $w(e,t,a,r){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Vr(e,t,a,r),s&2048&&Ac(9,t);break;case 1:Vr(e,t,a,r);break;case 3:Vr(e,t,a,r),s&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ec(e)));break;case 12:if(s&2048){Vr(e,t,a,r),e=t.stateNode;try{var n=t.memoizedProps,l=n.id,o=n.onPostCommit;typeof o=="function"&&o(l,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(c){rt(t,t.return,c)}}else Vr(e,t,a,r);break;case 13:Vr(e,t,a,r);break;case 23:break;case 22:n=t.stateNode,l=t.alternate,t.memoizedState!==null?n._visibility&2?Vr(e,t,a,r):vo(e,t):n._visibility&2?Vr(e,t,a,r):(n._visibility|=2,Ni(e,t,a,r,(t.subtreeFlags&10256)!==0)),s&2048&&Nx(l,t);break;case 24:Vr(e,t,a,r),s&2048&&Sx(t.alternate,t);break;default:Vr(e,t,a,r)}}function Ni(e,t,a,r,s){for(s=s&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var n=e,l=t,o=a,c=r,u=l.flags;switch(l.tag){case 0:case 11:case 15:Ni(n,l,o,c,s),Ac(8,l);break;case 23:break;case 22:var d=l.stateNode;l.memoizedState!==null?d._visibility&2?Ni(n,l,o,c,s):vo(n,l):(d._visibility|=2,Ni(n,l,o,c,s)),s&&u&2048&&Nx(l.alternate,l);break;case 24:Ni(n,l,o,c,s),s&&u&2048&&Sx(l.alternate,l);break;default:Ni(n,l,o,c,s)}t=t.sibling}}function vo(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,r=t,s=r.flags;switch(r.tag){case 22:vo(a,r),s&2048&&Nx(r.alternate,r);break;case 24:vo(a,r),s&2048&&Sx(r.alternate,r);break;default:vo(a,r)}t=t.sibling}}var Ql=8192;function xi(e){if(e.subtreeFlags&Ql)for(e=e.child;e!==null;)Yw(e),e=e.sibling}function Yw(e){switch(e.tag){case 26:xi(e),e.flags&Ql&&e.memoizedState!==null&&$k(_r,e.memoizedState,e.memoizedProps);break;case 5:xi(e);break;case 3:case 4:var t=_r;_r=w0(e.stateNode.containerInfo),xi(e),_r=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=Ql,Ql=16777216,xi(e),Ql=t):xi(e));break;default:xi(e)}}function qw(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Hl(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var a=0;a<t.length;a++){var r=t[a];qt=r,Kw(r,e)}qw(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Xw(e),e=e.sibling}function Xw(e){switch(e.tag){case 0:case 11:case 15:Hl(e),e.flags&2048&&fn(9,e,e.return);break;case 3:Hl(e);break;case 12:Hl(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Mu(e)):Hl(e);break;default:Hl(e)}}function Mu(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var a=0;a<t.length;a++){var r=t[a];qt=r,Kw(r,e)}qw(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:fn(8,t,t.return),Mu(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Mu(t));break;default:Mu(t)}e=e.sibling}}function Kw(e,t){for(;qt!==null;){var a=qt;switch(a.tag){case 0:case 11:case 15:fn(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var r=a.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Ec(a.memoizedState.cache)}if(r=a.child,r!==null)r.return=a,qt=r;else e:for(a=e;qt!==null;){r=qt;var s=r.sibling,n=r.return;if(Pw(r),r===a){qt=null;break e}if(s!==null){s.return=n,qt=s;break e}qt=n}}}var lk={getCacheForType:function(e){var t=pa(It),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a}},ok=typeof WeakMap=="function"?WeakMap:Map,Je=0,nt=null,Ie=null,He=0,Qe=0,Qa=null,Ks=!1,bl=!1,Tx=!1,As=0,bt=0,hn=0,zn=0,Ax=0,vr=0,ol=0,bo=null,Va=null,Oh=!1,Cx=0,x0=1/0,p0=null,rn=null,sa=0,sn=null,cl=null,Zi=0,Fh=0,Lh=null,Ww=null,wo=0,Mh=null;function sr(){if(Je&2&&He!==0)return He&-He;if(ke.T!==null){var e=sl;return e!==0?e:jx()}return l2()}function Zw(){vr===0&&(vr=!(He&536870912)||We?r2():536870912);var e=Er.current;return e!==null&&(e.flags|=32),vr}function nr(e,t,a){(e===nt&&(Qe===2||Qe===9)||e.cancelPendingCommit!==null)&&(ul(e,0),Ws(e,He,vr,!1)),gc(e,a),(!(Je&2)||e!==nt)&&(e===nt&&(!(Je&2)&&(zn|=a),bt===4&&Ws(e,He,vr,!1)),ss(e))}function Qw(e,t,a){if(Je&6)throw Error(ue(327));var r=!a&&(t&124)===0&&(t&e.expiredLanes)===0||pc(e,t),s=r?dk(e,t):hf(e,t,!0),n=r;do{if(s===0){bl&&!r&&Ws(e,t,0,!1);break}else{if(a=e.current.alternate,n&&!ck(a)){s=hf(e,t,!1),n=!1;continue}if(s===2){if(n=t,e.errorRecoveryDisabledLanes&n)var l=0;else l=e.pendingLanes&-536870913,l=l!==0?l:l&536870912?536870912:0;if(l!==0){t=l;e:{var o=e;s=bo;var c=o.current.memoizedState.isDehydrated;if(c&&(ul(o,l).flags|=256),l=hf(o,l,!1),l!==2){if(Tx&&!c){o.errorRecoveryDisabledLanes|=n,zn|=n,s=4;break e}n=Va,Va=s,n!==null&&(Va===null?Va=n:Va.push.apply(Va,n))}s=l}if(n=!1,s!==2)continue}}if(s===1){ul(e,0),Ws(e,t,0,!0);break}e:{switch(r=e,n=s,n){case 0:case 1:throw Error(ue(345));case 4:if((t&4194048)!==t)break;case 6:Ws(r,t,vr,!Ks);break e;case 2:Va=null;break;case 3:case 5:break;default:throw Error(ue(329))}if((t&62914560)===t&&(s=Cx+300-Xr(),10<s)){if(Ws(r,t,vr,!Ks),ed(r,0,!0)!==0)break e;r.timeoutHandle=gE(f1.bind(null,r,a,Va,p0,Oh,t,vr,zn,ol,Ks,n,2,-0,0),s);break e}f1(r,a,Va,p0,Oh,t,vr,zn,ol,Ks,n,0,-0,0)}}break}while(1);ss(e)}function f1(e,t,a,r,s,n,l,o,c,u,d,h,f,m){if(e.timeoutHandle=-1,h=t.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(Yo={stylesheets:null,count:0,unsuspend:Gk},Yw(t),h=Yk(),h!==null)){e.cancelPendingCommit=h(m1.bind(null,e,t,n,a,r,s,l,o,c,d,1,f,m)),Ws(e,n,l,!u);return}m1(e,t,n,a,r,s,l,o,c)}function ck(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var r=0;r<a.length;r++){var s=a[r],n=s.getSnapshot;s=s.value;try{if(!ir(n(),s))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ws(e,t,a,r){t&=~Ax,t&=~zn,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var s=t;0<s;){var n=31-rr(s),l=1<<n;r[n]=-1,s&=~l}a!==0&&n2(e,a,t)}function ud(){return Je&6?!0:(Cc(0,!1),!1)}function kx(){if(Ie!==null){if(Qe===0)var e=Ie.return;else e=Ie,xs=li=null,mx(e),Wi=null,Ho=0,e=Ie;for(;e!==null;)Ow(e.alternate,e),e=e.return;Ie=null}}function ul(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,Ck(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),kx(),nt=e,Ie=a=vs(e.current,null),He=t,Qe=0,Qa=null,Ks=!1,bl=pc(e,t),Tx=!1,ol=vr=Ax=zn=hn=bt=0,Va=bo=null,Oh=!1,t&8&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var s=31-rr(r),n=1<<s;t|=e[s],r&=~n}return As=t,sd(),a}function Jw(e,t){Ue=null,ke.H=c0,t===Nc||t===id?(t=Gg(),Qe=3):t===U2?(t=Gg(),Qe=4):Qe=t===Cw?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Qa=t,Ie===null&&(bt=1,f0(e,yr(t,e.current)))}function eE(){var e=ke.H;return ke.H=c0,e===null?c0:e}function tE(){var e=ke.A;return ke.A=lk,e}function Uh(){bt=4,Ks||(He&4194048)!==He&&Er.current!==null||(bl=!0),!(hn&134217727)&&!(zn&134217727)||nt===null||Ws(nt,He,vr,!1)}function hf(e,t,a){var r=Je;Je|=2;var s=eE(),n=tE();(nt!==e||He!==t)&&(p0=null,ul(e,t)),t=!1;var l=bt;e:do try{if(Qe!==0&&Ie!==null){var o=Ie,c=Qa;switch(Qe){case 8:kx(),l=6;break e;case 3:case 2:case 9:case 6:Er.current===null&&(t=!0);var u=Qe;if(Qe=0,Qa=null,Ui(e,o,c,u),a&&bl){l=0;break e}break;default:u=Qe,Qe=0,Qa=null,Ui(e,o,c,u)}}uk(),l=bt;break}catch(d){Jw(e,d)}while(1);return t&&e.shellSuspendCounter++,xs=li=null,Je=r,ke.H=s,ke.A=n,Ie===null&&(nt=null,He=0,sd()),l}function uk(){for(;Ie!==null;)aE(Ie)}function dk(e,t){var a=Je;Je|=2;var r=eE(),s=tE();nt!==e||He!==t?(p0=null,x0=Xr()+500,ul(e,t)):bl=pc(e,t);e:do try{if(Qe!==0&&Ie!==null){t=Ie;var n=Qa;t:switch(Qe){case 1:Qe=0,Qa=null,Ui(e,t,n,1);break;case 2:case 9:if(Hg(n)){Qe=0,Qa=null,h1(t);break}t=function(){Qe!==2&&Qe!==9||nt!==e||(Qe=7),ss(e)},n.then(t,t);break e;case 3:Qe=7;break e;case 4:Qe=5;break e;case 7:Hg(n)?(Qe=0,Qa=null,h1(t)):(Qe=0,Qa=null,Ui(e,t,n,7));break;case 5:var l=null;switch(Ie.tag){case 26:l=Ie.memoizedState;case 5:case 27:var o=Ie;if(!l||wE(l)){Qe=0,Qa=null;var c=o.sibling;if(c!==null)Ie=c;else{var u=o.return;u!==null?(Ie=u,dd(u)):Ie=null}break t}}Qe=0,Qa=null,Ui(e,t,n,5);break;case 6:Qe=0,Qa=null,Ui(e,t,n,6);break;case 8:kx(),bt=6;break e;default:throw Error(ue(462))}}fk();break}catch(d){Jw(e,d)}while(1);return xs=li=null,ke.H=r,ke.A=s,Je=a,Ie!==null?0:(nt=null,He=0,sd(),bt)}function fk(){for(;Ie!==null&&!F4();)aE(Ie)}function aE(e){var t=Dw(e.alternate,e,As);e.memoizedProps=e.pendingProps,t===null?dd(e):Ie=t}function h1(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=i1(a,t,t.pendingProps,t.type,void 0,He);break;case 11:t=i1(a,t,t.pendingProps,t.type.render,t.ref,He);break;case 5:mx(t);default:Ow(a,t),t=Ie=O2(t,As),t=Dw(a,t,As)}e.memoizedProps=e.pendingProps,t===null?dd(e):Ie=t}function Ui(e,t,a,r){xs=li=null,mx(t),Wi=null,Ho=0;var s=t.return;try{if(tk(e,s,t,a,He)){bt=1,f0(e,yr(a,e.current)),Ie=null;return}}catch(n){if(s!==null)throw Ie=s,n;bt=1,f0(e,yr(a,e.current)),Ie=null;return}t.flags&32768?(We||r===1?e=!0:bl||He&536870912?e=!1:(Ks=e=!0,(r===2||r===9||r===3||r===6)&&(r=Er.current,r!==null&&r.tag===13&&(r.flags|=16384))),rE(t,e)):dd(t)}function dd(e){var t=e;do{if(t.flags&32768){rE(t,Ks);return}e=t.return;var a=rk(t.alternate,t,As);if(a!==null){Ie=a;return}if(t=t.sibling,t!==null){Ie=t;return}Ie=t=e}while(t!==null);bt===0&&(bt=5)}function rE(e,t){do{var a=sk(e.alternate,e);if(a!==null){a.flags&=32767,Ie=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){Ie=e;return}Ie=e=a}while(e!==null);bt=6,Ie=null}function m1(e,t,a,r,s,n,l,o,c){e.cancelPendingCommit=null;do fd();while(sa!==0);if(Je&6)throw Error(ue(327));if(t!==null){if(t===e.current)throw Error(ue(177));if(n=t.lanes|t.childLanes,n|=tx,G4(e,a,n,l,o,c),e===nt&&(Ie=nt=null,He=0),cl=t,sn=e,Zi=a,Fh=n,Lh=s,Ww=r,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,pk(Ju,function(){return oE(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!==0,t.subtreeFlags&13878||r){r=ke.T,ke.T=null,s=Ze.p,Ze.p=2,l=Je,Je|=4;try{nk(e,t,a)}finally{Je=l,Ze.p=s,ke.T=r}}sa=1,sE(),nE(),iE()}}function sE(){if(sa===1){sa=0;var e=sn,t=cl,a=(t.flags&13878)!==0;if(t.subtreeFlags&13878||a){a=ke.T,ke.T=null;var r=Ze.p;Ze.p=2;var s=Je;Je|=4;try{Hw(t,e);var n=Vh,l=T2(e.containerInfo),o=n.focusedElem,c=n.selectionRange;if(l!==o&&o&&o.ownerDocument&&S2(o.ownerDocument.documentElement,o)){if(c!==null&&ex(o)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(d,o.value.length);else{var h=o.ownerDocument||document,f=h&&h.defaultView||window;if(f.getSelection){var m=f.getSelection(),p=o.textContent.length,x=Math.min(c.start,p),v=c.end===void 0?x:Math.min(c.end,p);!m.extend&&x>v&&(l=v,v=x,x=l);var g=Lg(o,x),b=Lg(o,v);if(g&&b&&(m.rangeCount!==1||m.anchorNode!==g.node||m.anchorOffset!==g.offset||m.focusNode!==b.node||m.focusOffset!==b.offset)){var y=h.createRange();y.setStart(g.node,g.offset),m.removeAllRanges(),x>v?(m.addRange(y),m.extend(b.node,b.offset)):(y.setEnd(b.node,b.offset),m.addRange(y))}}}}for(h=[],m=o;m=m.parentNode;)m.nodeType===1&&h.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var w=h[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}S0=!!Ph,Vh=Ph=null}finally{Je=s,Ze.p=r,ke.T=a}}e.current=t,sa=2}}function nE(){if(sa===2){sa=0;var e=sn,t=cl,a=(t.flags&8772)!==0;if(t.subtreeFlags&8772||a){a=ke.T,ke.T=null;var r=Ze.p;Ze.p=2;var s=Je;Je|=4;try{Iw(e,t.alternate,t)}finally{Je=s,Ze.p=r,ke.T=a}}sa=3}}function iE(){if(sa===4||sa===3){sa=0,L4();var e=sn,t=cl,a=Zi,r=Ww;t.subtreeFlags&10256||t.flags&10256?sa=5:(sa=0,cl=sn=null,lE(e,e.pendingLanes));var s=e.pendingLanes;if(s===0&&(rn=null),qm(a),t=t.stateNode,ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(xc,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=ke.T,s=Ze.p,Ze.p=2,ke.T=null;try{for(var n=e.onRecoverableError,l=0;l<r.length;l++){var o=r[l];n(o.value,{componentStack:o.stack})}}finally{ke.T=t,Ze.p=s}}Zi&3&&fd(),ss(e),s=e.pendingLanes,a&4194090&&s&42?e===Mh?wo++:(wo=0,Mh=e):wo=0,Cc(0,!1)}}function lE(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ec(t)))}function fd(e){return sE(),nE(),iE(),oE()}function oE(){if(sa!==5)return!1;var e=sn,t=Fh;Fh=0;var a=qm(Zi),r=ke.T,s=Ze.p;try{Ze.p=32>a?32:a,ke.T=null,a=Lh,Lh=null;var n=sn,l=Zi;if(sa=0,cl=sn=null,Zi=0,Je&6)throw Error(ue(331));var o=Je;if(Je|=4,Xw(n.current),$w(n,n.current,l,a),Je=o,Cc(0,!1),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(xc,n)}catch{}return!0}finally{Ze.p=s,ke.T=r,lE(e,t)}}function x1(e,t,a){t=yr(a,t),t=jh(e.stateNode,t,2),e=an(e,t,2),e!==null&&(gc(e,2),ss(e))}function rt(e,t,a){if(e.tag===3)x1(e,e,a);else for(;t!==null;){if(t.tag===3){x1(t,e,a);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(rn===null||!rn.has(r))){e=yr(a,e),a=Tw(2),r=an(t,a,2),r!==null&&(Aw(a,r,t,e),gc(r,2),ss(r));break}}t=t.return}}function mf(e,t,a){var r=e.pingCache;if(r===null){r=e.pingCache=new ok;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(a)||(Tx=!0,s.add(a),e=hk.bind(null,e,t,a),t.then(e,e))}function hk(e,t,a){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,nt===e&&(He&a)===a&&(bt===4||bt===3&&(He&62914560)===He&&300>Xr()-Cx?!(Je&2)&&ul(e,0):Ax|=a,ol===He&&(ol=0)),ss(e)}function cE(e,t){t===0&&(t=s2()),e=vl(e,t),e!==null&&(gc(e,t),ss(e))}function mk(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),cE(e,a)}function xk(e,t){var a=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(a=s.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(ue(314))}r!==null&&r.delete(t),cE(e,a)}function pk(e,t){return $m(e,t)}var g0=null,Si=null,Bh=!1,y0=!1,xf=!1,Hn=0;function ss(e){e!==Si&&e.next===null&&(Si===null?g0=Si=e:Si=Si.next=e),y0=!0,Bh||(Bh=!0,yk())}function Cc(e,t){if(!xf&&y0){xf=!0;do for(var a=!1,r=g0;r!==null;){if(!t)if(e!==0){var s=r.pendingLanes;if(s===0)var n=0;else{var l=r.suspendedLanes,o=r.pingedLanes;n=(1<<31-rr(42|e)+1)-1,n&=s&~(l&~o),n=n&201326741?n&201326741|1:n?n|2:0}n!==0&&(a=!0,p1(r,n))}else n=He,n=ed(r,r===nt?n:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),!(n&3)||pc(r,n)||(a=!0,p1(r,n));r=r.next}while(a);xf=!1}}function gk(){uE()}function uE(){y0=Bh=!1;var e=0;Hn!==0&&(Ak()&&(e=Hn),Hn=0);for(var t=Xr(),a=null,r=g0;r!==null;){var s=r.next,n=dE(r,t);n===0?(r.next=null,a===null?g0=s:a.next=s,s===null&&(Si=a)):(a=r,(e!==0||n&3)&&(y0=!0)),r=s}Cc(e,!1)}function dE(e,t){for(var a=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,n=e.pendingLanes&-62914561;0<n;){var l=31-rr(n),o=1<<l,c=s[l];c===-1?(!(o&a)||o&r)&&(s[l]=H4(o,t)):c<=t&&(e.expiredLanes|=o),n&=~o}if(t=nt,a=He,a=ed(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,a===0||e===t&&(Qe===2||Qe===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&Pd(r),e.callbackNode=null,e.callbackPriority=0;if(!(a&3)||pc(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(r!==null&&Pd(r),qm(a)){case 2:case 8:a=t2;break;case 32:a=Ju;break;case 268435456:a=a2;break;default:a=Ju}return r=fE.bind(null,e),a=$m(a,r),e.callbackPriority=t,e.callbackNode=a,t}return r!==null&&r!==null&&Pd(r),e.callbackPriority=2,e.callbackNode=null,2}function fE(e,t){if(sa!==0&&sa!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(fd()&&e.callbackNode!==a)return null;var r=He;return r=ed(e,e===nt?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(Qw(e,r,t),dE(e,Xr()),e.callbackNode!=null&&e.callbackNode===a?fE.bind(null,e):null)}function p1(e,t){if(fd())return null;Qw(e,t,!0)}function yk(){kk(function(){Je&6?$m(e2,gk):uE()})}function jx(){return Hn===0&&(Hn=r2()),Hn}function g1(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ku(""+e)}function y1(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function vk(e,t,a,r,s){if(t==="submit"&&a&&a.stateNode===s){var n=g1((s[$a]||null).action),l=r.submitter;l&&(t=(t=l[$a]||null)?g1(t.formAction):l.getAttribute("formAction"),t!==null&&(n=t,l=null));var o=new td("action","action",null,r,s);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(Hn!==0){var c=l?y1(s,l):new FormData(s);Ch(a,{pending:!0,data:c,method:s.method,action:n},null,c)}}else typeof n=="function"&&(o.preventDefault(),c=l?y1(s,l):new FormData(s),Ch(a,{pending:!0,data:c,method:s.method,action:n},n,c))},currentTarget:s}]})}}for(var pf=0;pf<xh.length;pf++){var gf=xh[pf],bk=gf.toLowerCase(),wk=gf[0].toUpperCase()+gf.slice(1);Br(bk,"on"+wk)}Br(C2,"onAnimationEnd");Br(k2,"onAnimationIteration");Br(j2,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(BC,"onTransitionRun");Br(IC,"onTransitionStart");Br(PC,"onTransitionCancel");Br(_2,"onTransitionEnd");al("onMouseEnter",["mouseout","mouseover"]);al("onMouseLeave",["mouseout","mouseover"]);al("onPointerEnter",["pointerout","pointerover"]);al("onPointerLeave",["pointerout","pointerover"]);si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));si("onBeforeInput",["compositionend","keypress","textInput","paste"]);si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ek=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Go));function hE(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var r=e[a],s=r.event;r=r.listeners;e:{var n=void 0;if(t)for(var l=r.length-1;0<=l;l--){var o=r[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==n&&s.isPropagationStopped())break e;n=o,s.currentTarget=u;try{n(s)}catch(d){d0(d)}s.currentTarget=null,n=c}else for(l=0;l<r.length;l++){if(o=r[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==n&&s.isPropagationStopped())break e;n=o,s.currentTarget=u;try{n(s)}catch(d){d0(d)}s.currentTarget=null,n=c}}}}function Be(e,t){var a=t[oh];a===void 0&&(a=t[oh]=new Set);var r=e+"__bubble";a.has(r)||(mE(t,e,2,!1),a.add(r))}function yf(e,t,a){var r=0;t&&(r|=4),mE(a,e,r,t)}var su="_reactListening"+Math.random().toString(36).slice(2);function _x(e){if(!e[su]){e[su]=!0,o2.forEach(function(a){a!=="selectionchange"&&(Ek.has(a)||yf(a,!1,e),yf(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[su]||(t[su]=!0,yf("selectionchange",!1,t))}}function mE(e,t,a,r){switch(AE(t)){case 2:var s=Kk;break;case 8:s=Wk;break;default:s=Fx}a=s.bind(null,t,a,e),s=void 0,!fh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,a,{capture:!0,passive:s}):e.addEventListener(t,a,!0):s!==void 0?e.addEventListener(t,a,{passive:s}):e.addEventListener(t,a,!1)}function vf(e,t,a,r,s){var n=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===s)break;if(l===4)for(l=r.return;l!==null;){var c=l.tag;if((c===3||c===4)&&l.stateNode.containerInfo===s)return;l=l.return}for(;o!==null;){if(l=ki(o),l===null)return;if(c=l.tag,c===5||c===6||c===26||c===27){r=n=l;continue e}o=o.parentNode}}r=r.return}p2(function(){var u=n,d=Wm(a),h=[];e:{var f=R2.get(e);if(f!==void 0){var m=td,p=e;switch(e){case"keypress":if(_u(a)===0)break e;case"keydown":case"keyup":m=pC;break;case"focusin":p="focus",m=Xd;break;case"focusout":p="blur",m=Xd;break;case"beforeblur":case"afterblur":m=Xd;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Tg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=sC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=vC;break;case C2:case k2:case j2:m=lC;break;case _2:m=wC;break;case"scroll":case"scrollend":m=aC;break;case"wheel":m=NC;break;case"copy":case"cut":case"paste":m=cC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Cg;break;case"toggle":case"beforetoggle":m=TC}var x=(t&4)!==0,v=!x&&(e==="scroll"||e==="scrollend"),g=x?f!==null?f+"Capture":null:f;x=[];for(var b=u,y;b!==null;){var w=b;if(y=w.stateNode,w=w.tag,w!==5&&w!==26&&w!==27||y===null||g===null||(w=Bo(b,g),w!=null&&x.push($o(b,w,y))),v)break;b=b.return}0<x.length&&(f=new m(f,p,null,a,d),h.push({event:f,listeners:x}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&a!==dh&&(p=a.relatedTarget||a.fromElement)&&(ki(p)||p[gl]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(p=a.relatedTarget||a.toElement,m=u,p=p?ki(p):null,p!==null&&(v=mc(p),x=p.tag,p!==v||x!==5&&x!==27&&x!==6)&&(p=null)):(m=null,p=u),m!==p)){if(x=Tg,w="onMouseLeave",g="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(x=Cg,w="onPointerLeave",g="onPointerEnter",b="pointer"),v=m==null?f:Zl(m),y=p==null?f:Zl(p),f=new x(w,b+"leave",m,a,d),f.target=v,f.relatedTarget=y,w=null,ki(d)===u&&(x=new x(g,b+"enter",p,a,d),x.target=y,x.relatedTarget=v,w=x),v=w,m&&p)t:{for(x=m,g=p,b=0,y=x;y;y=pi(y))b++;for(y=0,w=g;w;w=pi(w))y++;for(;0<b-y;)x=pi(x),b--;for(;0<y-b;)g=pi(g),y--;for(;b--;){if(x===g||g!==null&&x===g.alternate)break t;x=pi(x),g=pi(g)}x=null}else x=null;m!==null&&v1(h,f,m,x,!1),p!==null&&v!==null&&v1(h,v,p,x,!0)}}e:{if(f=u?Zl(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var N=Rg;else if(_g(f))if(E2)N=LC;else{N=OC;var A=DC}else m=f.nodeName,!m||m.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?u&&Km(u.elementType)&&(N=Rg):N=FC;if(N&&(N=N(e,u))){w2(h,N,a,d);break e}A&&A(e,f,u),e==="focusout"&&u&&f.type==="number"&&u.memoizedProps.value!=null&&uh(f,"number",f.value)}switch(A=u?Zl(u):window,e){case"focusin":(_g(A)||A.contentEditable==="true")&&(Ri=A,hh=u,uo=null);break;case"focusout":uo=hh=Ri=null;break;case"mousedown":mh=!0;break;case"contextmenu":case"mouseup":case"dragend":mh=!1,Mg(h,a,d);break;case"selectionchange":if(UC)break;case"keydown":case"keyup":Mg(h,a,d)}var S;if(Jm)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else _i?v2(e,a)&&(C="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(C="onCompositionStart");C&&(y2&&a.locale!=="ko"&&(_i||C!=="onCompositionStart"?C==="onCompositionEnd"&&_i&&(S=g2()):(Xs=d,Zm="value"in Xs?Xs.value:Xs.textContent,_i=!0)),A=v0(u,C),0<A.length&&(C=new Ag(C,e,null,a,d),h.push({event:C,listeners:A}),S?C.data=S:(S=b2(a),S!==null&&(C.data=S)))),(S=CC?kC(e,a):jC(e,a))&&(C=v0(u,"onBeforeInput"),0<C.length&&(A=new Ag("onBeforeInput","beforeinput",null,a,d),h.push({event:A,listeners:C}),A.data=S)),vk(h,e,u,a,d)}hE(h,t)})}function $o(e,t,a){return{instance:e,listener:t,currentTarget:a}}function v0(e,t){for(var a=t+"Capture",r=[];e!==null;){var s=e,n=s.stateNode;if(s=s.tag,s!==5&&s!==26&&s!==27||n===null||(s=Bo(e,a),s!=null&&r.unshift($o(e,s,n)),s=Bo(e,t),s!=null&&r.push($o(e,s,n))),e.tag===3)return r;e=e.return}return[]}function pi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function v1(e,t,a,r,s){for(var n=t._reactName,l=[];a!==null&&a!==r;){var o=a,c=o.alternate,u=o.stateNode;if(o=o.tag,c!==null&&c===r)break;o!==5&&o!==26&&o!==27||u===null||(c=u,s?(u=Bo(a,n),u!=null&&l.unshift($o(a,u,c))):s||(u=Bo(a,n),u!=null&&l.push($o(a,u,c)))),a=a.return}l.length!==0&&e.push({event:t,listeners:l})}var Nk=/\r\n?/g,Sk=/\u0000|\uFFFD/g;function b1(e){return(typeof e=="string"?e:""+e).replace(Nk,`
`).replace(Sk,"")}function xE(e,t){return t=b1(t),b1(e)===t}function hd(){}function et(e,t,a,r,s,n){switch(a){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||rl(e,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&rl(e,""+r);break;case"className":Zc(e,"class",r);break;case"tabIndex":Zc(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":Zc(e,a,r);break;case"style":x2(e,r,n);break;case"data":if(t!=="object"){Zc(e,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(a);break}r=ku(""+r),e.setAttribute(a,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof n=="function"&&(a==="formAction"?(t!=="input"&&et(e,t,"name",s.name,s,null),et(e,t,"formEncType",s.formEncType,s,null),et(e,t,"formMethod",s.formMethod,s,null),et(e,t,"formTarget",s.formTarget,s,null)):(et(e,t,"encType",s.encType,s,null),et(e,t,"method",s.method,s,null),et(e,t,"target",s.target,s,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(a);break}r=ku(""+r),e.setAttribute(a,r);break;case"onClick":r!=null&&(e.onclick=hd);break;case"onScroll":r!=null&&Be("scroll",e);break;case"onScrollEnd":r!=null&&Be("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(ue(61));if(a=r.__html,a!=null){if(s.children!=null)throw Error(ue(60));e.innerHTML=a}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}a=ku(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(a,""+r):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":r===!0?e.setAttribute(a,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(a,r):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(a,r):e.removeAttribute(a);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(a):e.setAttribute(a,r);break;case"popover":Be("beforetoggle",e),Be("toggle",e),Cu(e,"popover",r);break;case"xlinkActuate":os(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":os(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":os(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":os(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":os(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":os(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":os(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":os(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":os(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":Cu(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=eC.get(a)||a,Cu(e,a,r))}}function Ih(e,t,a,r,s,n){switch(a){case"style":x2(e,r,n);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(ue(61));if(a=r.__html,a!=null){if(s.children!=null)throw Error(ue(60));e.innerHTML=a}}break;case"children":typeof r=="string"?rl(e,r):(typeof r=="number"||typeof r=="bigint")&&rl(e,""+r);break;case"onScroll":r!=null&&Be("scroll",e);break;case"onScrollEnd":r!=null&&Be("scrollend",e);break;case"onClick":r!=null&&(e.onclick=hd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!c2.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(s=a.endsWith("Capture"),t=a.slice(2,s?a.length-7:void 0),n=e[$a]||null,n=n!=null?n[a]:null,typeof n=="function"&&e.removeEventListener(t,n,s),typeof r=="function")){typeof n!="function"&&n!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,r,s);break e}a in e?e[a]=r:r===!0?e.setAttribute(a,""):Cu(e,a,r)}}}function na(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",e),Be("load",e);var r=!1,s=!1,n;for(n in a)if(a.hasOwnProperty(n)){var l=a[n];if(l!=null)switch(n){case"src":r=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ue(137,t));default:et(e,t,n,l,a,null)}}s&&et(e,t,"srcSet",a.srcSet,a,null),r&&et(e,t,"src",a.src,a,null);return;case"input":Be("invalid",e);var o=n=l=s=null,c=null,u=null;for(r in a)if(a.hasOwnProperty(r)){var d=a[r];if(d!=null)switch(r){case"name":s=d;break;case"type":l=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":n=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(ue(137,t));break;default:et(e,t,r,d,a,null)}}f2(e,n,o,c,u,l,s,!1),e0(e);return;case"select":Be("invalid",e),r=l=n=null;for(s in a)if(a.hasOwnProperty(s)&&(o=a[s],o!=null))switch(s){case"value":n=o;break;case"defaultValue":l=o;break;case"multiple":r=o;default:et(e,t,s,o,a,null)}t=n,a=l,e.multiple=!!r,t!=null?$i(e,!!r,t,!1):a!=null&&$i(e,!!r,a,!0);return;case"textarea":Be("invalid",e),n=s=r=null;for(l in a)if(a.hasOwnProperty(l)&&(o=a[l],o!=null))switch(l){case"value":r=o;break;case"defaultValue":s=o;break;case"children":n=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(ue(91));break;default:et(e,t,l,o,a,null)}m2(e,r,s,n),e0(e);return;case"option":for(c in a)if(a.hasOwnProperty(c)&&(r=a[c],r!=null))switch(c){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:et(e,t,c,r,a,null)}return;case"dialog":Be("beforetoggle",e),Be("toggle",e),Be("cancel",e),Be("close",e);break;case"iframe":case"object":Be("load",e);break;case"video":case"audio":for(r=0;r<Go.length;r++)Be(Go[r],e);break;case"image":Be("error",e),Be("load",e);break;case"details":Be("toggle",e);break;case"embed":case"source":case"link":Be("error",e),Be("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in a)if(a.hasOwnProperty(u)&&(r=a[u],r!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(ue(137,t));default:et(e,t,u,r,a,null)}return;default:if(Km(t)){for(d in a)a.hasOwnProperty(d)&&(r=a[d],r!==void 0&&Ih(e,t,d,r,a,void 0));return}}for(o in a)a.hasOwnProperty(o)&&(r=a[o],r!=null&&et(e,t,o,r,a,null))}function Tk(e,t,a,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,n=null,l=null,o=null,c=null,u=null,d=null;for(m in a){var h=a[m];if(a.hasOwnProperty(m)&&h!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(m)||et(e,t,m,null,r,h)}}for(var f in r){var m=r[f];if(h=a[f],r.hasOwnProperty(f)&&(m!=null||h!=null))switch(f){case"type":n=m;break;case"name":s=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":l=m;break;case"defaultValue":o=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(ue(137,t));break;default:m!==h&&et(e,t,f,m,r,h)}}ch(e,l,o,c,u,d,n,s);return;case"select":m=l=o=f=null;for(n in a)if(c=a[n],a.hasOwnProperty(n)&&c!=null)switch(n){case"value":break;case"multiple":m=c;default:r.hasOwnProperty(n)||et(e,t,n,null,r,c)}for(s in r)if(n=r[s],c=a[s],r.hasOwnProperty(s)&&(n!=null||c!=null))switch(s){case"value":f=n;break;case"defaultValue":o=n;break;case"multiple":l=n;default:n!==c&&et(e,t,s,n,r,c)}t=o,a=l,r=m,f!=null?$i(e,!!a,f,!1):!!r!=!!a&&(t!=null?$i(e,!!a,t,!0):$i(e,!!a,a?[]:"",!1));return;case"textarea":m=f=null;for(o in a)if(s=a[o],a.hasOwnProperty(o)&&s!=null&&!r.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:et(e,t,o,null,r,s)}for(l in r)if(s=r[l],n=a[l],r.hasOwnProperty(l)&&(s!=null||n!=null))switch(l){case"value":f=s;break;case"defaultValue":m=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(ue(91));break;default:s!==n&&et(e,t,l,s,r,n)}h2(e,f,m);return;case"option":for(var p in a)if(f=a[p],a.hasOwnProperty(p)&&f!=null&&!r.hasOwnProperty(p))switch(p){case"selected":e.selected=!1;break;default:et(e,t,p,null,r,f)}for(c in r)if(f=r[c],m=a[c],r.hasOwnProperty(c)&&f!==m&&(f!=null||m!=null))switch(c){case"selected":e.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:et(e,t,c,f,r,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var x in a)f=a[x],a.hasOwnProperty(x)&&f!=null&&!r.hasOwnProperty(x)&&et(e,t,x,null,r,f);for(u in r)if(f=r[u],m=a[u],r.hasOwnProperty(u)&&f!==m&&(f!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(ue(137,t));break;default:et(e,t,u,f,r,m)}return;default:if(Km(t)){for(var v in a)f=a[v],a.hasOwnProperty(v)&&f!==void 0&&!r.hasOwnProperty(v)&&Ih(e,t,v,void 0,r,f);for(d in r)f=r[d],m=a[d],!r.hasOwnProperty(d)||f===m||f===void 0&&m===void 0||Ih(e,t,d,f,r,m);return}}for(var g in a)f=a[g],a.hasOwnProperty(g)&&f!=null&&!r.hasOwnProperty(g)&&et(e,t,g,null,r,f);for(h in r)f=r[h],m=a[h],!r.hasOwnProperty(h)||f===m||f==null&&m==null||et(e,t,h,f,r,m)}var Ph=null,Vh=null;function b0(e){return e.nodeType===9?e:e.ownerDocument}function w1(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pE(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function zh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bf=null;function Ak(){var e=window.event;return e&&e.type==="popstate"?e===bf?!1:(bf=e,!0):(bf=null,!1)}var gE=typeof setTimeout=="function"?setTimeout:void 0,Ck=typeof clearTimeout=="function"?clearTimeout:void 0,E1=typeof Promise=="function"?Promise:void 0,kk=typeof queueMicrotask=="function"?queueMicrotask:typeof E1<"u"?function(e){return E1.resolve(null).then(e).catch(jk)}:gE;function jk(e){setTimeout(function(){throw e})}function bn(e){return e==="head"}function N1(e,t){var a=t,r=0,s=0;do{var n=a.nextSibling;if(e.removeChild(a),n&&n.nodeType===8)if(a=n.data,a==="/$"){if(0<r&&8>r){a=r;var l=e.ownerDocument;if(a&1&&Eo(l.documentElement),a&2&&Eo(l.body),a&4)for(a=l.head,Eo(a),l=a.firstChild;l;){var o=l.nextSibling,c=l.nodeName;l[yc]||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&l.rel.toLowerCase()==="stylesheet"||a.removeChild(l),l=o}}if(s===0){e.removeChild(n),Wo(t);return}s--}else a==="$"||a==="$?"||a==="$!"?s++:r=a.charCodeAt(0)-48;else r=0;a=n}while(a);Wo(t)}function Hh(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Hh(a),Xm(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function _k(e,t,a,r){for(;e.nodeType===1;){var s=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[yc])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(n=e.getAttribute("rel"),n==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(n!==s.rel||e.getAttribute("href")!==(s.href==null||s.href===""?null:s.href)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||e.getAttribute("title")!==(s.title==null?null:s.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(n=e.getAttribute("src"),(n!==(s.src==null?null:s.src)||e.getAttribute("type")!==(s.type==null?null:s.type)||e.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&n&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var n=s.name==null?null:""+s.name;if(s.type==="hidden"&&e.getAttribute("name")===n)return e}else return e;if(e=Lr(e.nextSibling),e===null)break}return null}function Rk(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=Lr(e.nextSibling),e===null))return null;return e}function Gh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Dk(e,t){var a=e.ownerDocument;if(e.data!=="$?"||a.readyState==="complete")t();else{var r=function(){t(),a.removeEventListener("DOMContentLoaded",r)};a.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function Lr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var $h=null;function S1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(t===0)return e;t--}else a==="/$"&&t++}e=e.previousSibling}return null}function yE(e,t,a){switch(t=b0(a),e){case"html":if(e=t.documentElement,!e)throw Error(ue(452));return e;case"head":if(e=t.head,!e)throw Error(ue(453));return e;case"body":if(e=t.body,!e)throw Error(ue(454));return e;default:throw Error(ue(451))}}function Eo(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xm(e)}var Nr=new Map,T1=new Set;function w0(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var _s=Ze.d;Ze.d={f:Ok,r:Fk,D:Lk,C:Mk,L:Uk,m:Bk,X:Pk,S:Ik,M:Vk};function Ok(){var e=_s.f(),t=ud();return e||t}function Fk(e){var t=yl(e);t!==null&&t.tag===5&&t.type==="form"?dw(t):_s.r(e)}var wl=typeof document>"u"?null:document;function vE(e,t,a){var r=wl;if(r&&typeof t=="string"&&t){var s=gr(t);s='link[rel="'+e+'"][href="'+s+'"]',typeof a=="string"&&(s+='[crossorigin="'+a+'"]'),T1.has(s)||(T1.add(s),e={rel:e,crossOrigin:a,href:t},r.querySelector(s)===null&&(t=r.createElement("link"),na(t,"link",e),Xt(t),r.head.appendChild(t)))}}function Lk(e){_s.D(e),vE("dns-prefetch",e,null)}function Mk(e,t){_s.C(e,t),vE("preconnect",e,t)}function Uk(e,t,a){_s.L(e,t,a);var r=wl;if(r&&e&&t){var s='link[rel="preload"][as="'+gr(t)+'"]';t==="image"&&a&&a.imageSrcSet?(s+='[imagesrcset="'+gr(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(s+='[imagesizes="'+gr(a.imageSizes)+'"]')):s+='[href="'+gr(e)+'"]';var n=s;switch(t){case"style":n=dl(e);break;case"script":n=El(e)}Nr.has(n)||(e=it({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),Nr.set(n,e),r.querySelector(s)!==null||t==="style"&&r.querySelector(kc(n))||t==="script"&&r.querySelector(jc(n))||(t=r.createElement("link"),na(t,"link",e),Xt(t),r.head.appendChild(t)))}}function Bk(e,t){_s.m(e,t);var a=wl;if(a&&e){var r=t&&typeof t.as=="string"?t.as:"script",s='link[rel="modulepreload"][as="'+gr(r)+'"][href="'+gr(e)+'"]',n=s;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":n=El(e)}if(!Nr.has(n)&&(e=it({rel:"modulepreload",href:e},t),Nr.set(n,e),a.querySelector(s)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(jc(n)))return}r=a.createElement("link"),na(r,"link",e),Xt(r),a.head.appendChild(r)}}}function Ik(e,t,a){_s.S(e,t,a);var r=wl;if(r&&e){var s=Gi(r).hoistableStyles,n=dl(e);t=t||"default";var l=s.get(n);if(!l){var o={loading:0,preload:null};if(l=r.querySelector(kc(n)))o.loading=5;else{e=it({rel:"stylesheet",href:e,"data-precedence":t},a),(a=Nr.get(n))&&Rx(e,a);var c=l=r.createElement("link");Xt(c),na(c,"link",e),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Uu(l,t,r)}l={type:"stylesheet",instance:l,count:1,state:o},s.set(n,l)}}}function Pk(e,t){_s.X(e,t);var a=wl;if(a&&e){var r=Gi(a).hoistableScripts,s=El(e),n=r.get(s);n||(n=a.querySelector(jc(s)),n||(e=it({src:e,async:!0},t),(t=Nr.get(s))&&Dx(e,t),n=a.createElement("script"),Xt(n),na(n,"link",e),a.head.appendChild(n)),n={type:"script",instance:n,count:1,state:null},r.set(s,n))}}function Vk(e,t){_s.M(e,t);var a=wl;if(a&&e){var r=Gi(a).hoistableScripts,s=El(e),n=r.get(s);n||(n=a.querySelector(jc(s)),n||(e=it({src:e,async:!0,type:"module"},t),(t=Nr.get(s))&&Dx(e,t),n=a.createElement("script"),Xt(n),na(n,"link",e),a.head.appendChild(n)),n={type:"script",instance:n,count:1,state:null},r.set(s,n))}}function A1(e,t,a,r){var s=(s=en.current)?w0(s):null;if(!s)throw Error(ue(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=dl(a.href),a=Gi(s).hoistableStyles,r=a.get(t),r||(r={type:"style",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=dl(a.href);var n=Gi(s).hoistableStyles,l=n.get(e);if(l||(s=s.ownerDocument||s,l={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},n.set(e,l),(n=s.querySelector(kc(e)))&&!n._p&&(l.instance=n,l.state.loading=5),Nr.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Nr.set(e,a),n||zk(s,e,a,l.state))),t&&r===null)throw Error(ue(528,""));return l}if(t&&r!==null)throw Error(ue(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=El(a),a=Gi(s).hoistableScripts,r=a.get(t),r||(r={type:"script",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(ue(444,e))}}function dl(e){return'href="'+gr(e)+'"'}function kc(e){return'link[rel="stylesheet"]['+e+"]"}function bE(e){return it({},e,{"data-precedence":e.precedence,precedence:null})}function zk(e,t,a,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),na(t,"link",a),Xt(t),e.head.appendChild(t))}function El(e){return'[src="'+gr(e)+'"]'}function jc(e){return"script[async]"+e}function C1(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+gr(a.href)+'"]');if(r)return t.instance=r,Xt(r),r;var s=it({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),Xt(r),na(r,"style",s),Uu(r,a.precedence,e),t.instance=r;case"stylesheet":s=dl(a.href);var n=e.querySelector(kc(s));if(n)return t.state.loading|=4,t.instance=n,Xt(n),n;r=bE(a),(s=Nr.get(s))&&Rx(r,s),n=(e.ownerDocument||e).createElement("link"),Xt(n);var l=n;return l._p=new Promise(function(o,c){l.onload=o,l.onerror=c}),na(n,"link",r),t.state.loading|=4,Uu(n,a.precedence,e),t.instance=n;case"script":return n=El(a.src),(s=e.querySelector(jc(n)))?(t.instance=s,Xt(s),s):(r=a,(s=Nr.get(n))&&(r=it({},a),Dx(r,s)),e=e.ownerDocument||e,s=e.createElement("script"),Xt(s),na(s,"link",r),e.head.appendChild(s),t.instance=s);case"void":return null;default:throw Error(ue(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(r=t.instance,t.state.loading|=4,Uu(r,a.precedence,e));return t.instance}function Uu(e,t,a){for(var r=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=r.length?r[r.length-1]:null,n=s,l=0;l<r.length;l++){var o=r[l];if(o.dataset.precedence===t)n=o;else if(n!==s)break}n?n.parentNode.insertBefore(e,n.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function Rx(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Dx(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Bu=null;function k1(e,t,a){if(Bu===null){var r=new Map,s=Bu=new Map;s.set(a,r)}else s=Bu,r=s.get(a),r||(r=new Map,s.set(a,r));if(r.has(e))return r;for(r.set(e,null),a=a.getElementsByTagName(e),s=0;s<a.length;s++){var n=a[s];if(!(n[yc]||n[xa]||e==="link"&&n.getAttribute("rel")==="stylesheet")&&n.namespaceURI!=="http://www.w3.org/2000/svg"){var l=n.getAttribute(t)||"";l=e+l;var o=r.get(l);o?o.push(n):r.set(l,[n])}}return r}function j1(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function Hk(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function wE(e){return!(e.type==="stylesheet"&&!(e.state.loading&3))}var Yo=null;function Gk(){}function $k(e,t,a){if(Yo===null)throw Error(ue(475));var r=Yo;if(t.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var s=dl(a.href),n=e.querySelector(kc(s));if(n){e=n._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(r.count++,r=E0.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=n,Xt(n);return}n=e.ownerDocument||e,a=bE(a),(s=Nr.get(s))&&Rx(a,s),n=n.createElement("link"),Xt(n);var l=n;l._p=new Promise(function(o,c){l.onload=o,l.onerror=c}),na(n,"link",a),t.instance=n}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(r.count++,t=E0.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}function Yk(){if(Yo===null)throw Error(ue(475));var e=Yo;return e.stylesheets&&e.count===0&&Yh(e,e.stylesheets),0<e.count?function(t){var a=setTimeout(function(){if(e.stylesheets&&Yh(e,e.stylesheets),e.unsuspend){var r=e.unsuspend;e.unsuspend=null,r()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(a)}}:null}function E0(){if(this.count--,this.count===0){if(this.stylesheets)Yh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var N0=null;function Yh(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,N0=new Map,t.forEach(qk,e),N0=null,E0.call(e))}function qk(e,t){if(!(t.state.loading&4)){var a=N0.get(e);if(a)var r=a.get(null);else{a=new Map,N0.set(e,a);for(var s=e.querySelectorAll("link[data-precedence],style[data-precedence]"),n=0;n<s.length;n++){var l=s[n];(l.nodeName==="LINK"||l.getAttribute("media")!=="not all")&&(a.set(l.dataset.precedence,l),r=l)}r&&a.set(null,r)}s=t.instance,l=s.getAttribute("data-precedence"),n=a.get(l)||r,n===r&&a.set(null,s),a.set(l,s),this.count++,r=E0.bind(this),s.addEventListener("load",r),s.addEventListener("error",r),n?n.parentNode.insertBefore(s,n.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(s,e.firstChild)),t.state.loading|=4}}var qo={$$typeof:fs,Provider:null,Consumer:null,_currentValue:Un,_currentValue2:Un,_threadCount:0};function Xk(e,t,a,r,s,n,l,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vd(0),this.hiddenUpdates=Vd(null),this.identifierPrefix=r,this.onUncaughtError=s,this.onCaughtError=n,this.onRecoverableError=l,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function EE(e,t,a,r,s,n,l,o,c,u,d,h){return e=new Xk(e,t,a,l,o,c,u,h),t=1,n===!0&&(t|=24),n=er(3,null,null,t),e.current=n,n.stateNode=e,t=ix(),t.refCount++,e.pooledCache=t,t.refCount++,n.memoizedState={element:r,isDehydrated:a,cache:t},ox(n),e}function NE(e){return e?(e=Fi,e):Fi}function SE(e,t,a,r,s,n){s=NE(s),r.context===null?r.context=s:r.pendingContext=s,r=tn(t),r.payload={element:a},n=n===void 0?null:n,n!==null&&(r.callback=n),a=an(e,r,t),a!==null&&(nr(a,e,t),mo(a,e,t))}function _1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Ox(e,t){_1(e,t),(e=e.alternate)&&_1(e,t)}function TE(e){if(e.tag===13){var t=vl(e,67108864);t!==null&&nr(t,e,67108864),Ox(e,67108864)}}var S0=!0;function Kk(e,t,a,r){var s=ke.T;ke.T=null;var n=Ze.p;try{Ze.p=2,Fx(e,t,a,r)}finally{Ze.p=n,ke.T=s}}function Wk(e,t,a,r){var s=ke.T;ke.T=null;var n=Ze.p;try{Ze.p=8,Fx(e,t,a,r)}finally{Ze.p=n,ke.T=s}}function Fx(e,t,a,r){if(S0){var s=qh(r);if(s===null)vf(e,t,r,T0,a),R1(e,r);else if(Qk(s,e,t,a,r))r.stopPropagation();else if(R1(e,r),t&4&&-1<Zk.indexOf(e)){for(;s!==null;){var n=yl(s);if(n!==null)switch(n.tag){case 3:if(n=n.stateNode,n.current.memoizedState.isDehydrated){var l=Cn(n.pendingLanes);if(l!==0){var o=n;for(o.pendingLanes|=2,o.entangledLanes|=2;l;){var c=1<<31-rr(l);o.entanglements[1]|=c,l&=~c}ss(n),!(Je&6)&&(x0=Xr()+500,Cc(0,!1))}}break;case 13:o=vl(n,2),o!==null&&nr(o,n,2),ud(),Ox(n,2)}if(n=qh(r),n===null&&vf(e,t,r,T0,a),n===s)break;s=n}s!==null&&r.stopPropagation()}else vf(e,t,r,null,a)}}function qh(e){return e=Wm(e),Lx(e)}var T0=null;function Lx(e){if(T0=null,e=ki(e),e!==null){var t=mc(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=Wb(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return T0=e,null}function AE(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(M4()){case e2:return 2;case t2:return 8;case Ju:case U4:return 32;case a2:return 268435456;default:return 32}default:return 32}}var Xh=!1,nn=null,ln=null,on=null,Xo=new Map,Ko=new Map,Gs=[],Zk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function R1(e,t){switch(e){case"focusin":case"focusout":nn=null;break;case"dragenter":case"dragleave":ln=null;break;case"mouseover":case"mouseout":on=null;break;case"pointerover":case"pointerout":Xo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ko.delete(t.pointerId)}}function Gl(e,t,a,r,s,n){return e===null||e.nativeEvent!==n?(e={blockedOn:t,domEventName:a,eventSystemFlags:r,nativeEvent:n,targetContainers:[s]},t!==null&&(t=yl(t),t!==null&&TE(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Qk(e,t,a,r,s){switch(t){case"focusin":return nn=Gl(nn,e,t,a,r,s),!0;case"dragenter":return ln=Gl(ln,e,t,a,r,s),!0;case"mouseover":return on=Gl(on,e,t,a,r,s),!0;case"pointerover":var n=s.pointerId;return Xo.set(n,Gl(Xo.get(n)||null,e,t,a,r,s)),!0;case"gotpointercapture":return n=s.pointerId,Ko.set(n,Gl(Ko.get(n)||null,e,t,a,r,s)),!0}return!1}function CE(e){var t=ki(e.target);if(t!==null){var a=mc(t);if(a!==null){if(t=a.tag,t===13){if(t=Wb(a),t!==null){e.blockedOn=t,$4(e.priority,function(){if(a.tag===13){var r=sr();r=Ym(r);var s=vl(a,r);s!==null&&nr(s,a,r),Ox(a,r)}});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Iu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=qh(e.nativeEvent);if(a===null){a=e.nativeEvent;var r=new a.constructor(a.type,a);dh=r,a.target.dispatchEvent(r),dh=null}else return t=yl(a),t!==null&&TE(t),e.blockedOn=a,!1;t.shift()}return!0}function D1(e,t,a){Iu(e)&&a.delete(t)}function Jk(){Xh=!1,nn!==null&&Iu(nn)&&(nn=null),ln!==null&&Iu(ln)&&(ln=null),on!==null&&Iu(on)&&(on=null),Xo.forEach(D1),Ko.forEach(D1)}function nu(e,t){e.blockedOn===t&&(e.blockedOn=null,Xh||(Xh=!0,Gt.unstable_scheduleCallback(Gt.unstable_NormalPriority,Jk)))}var iu=null;function O1(e){iu!==e&&(iu=e,Gt.unstable_scheduleCallback(Gt.unstable_NormalPriority,function(){iu===e&&(iu=null);for(var t=0;t<e.length;t+=3){var a=e[t],r=e[t+1],s=e[t+2];if(typeof r!="function"){if(Lx(r||a)===null)continue;break}var n=yl(a);n!==null&&(e.splice(t,3),t-=3,Ch(n,{pending:!0,data:s,method:a.method,action:r},r,s))}}))}function Wo(e){function t(c){return nu(c,e)}nn!==null&&nu(nn,e),ln!==null&&nu(ln,e),on!==null&&nu(on,e),Xo.forEach(t),Ko.forEach(t);for(var a=0;a<Gs.length;a++){var r=Gs[a];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Gs.length&&(a=Gs[0],a.blockedOn===null);)CE(a),a.blockedOn===null&&Gs.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(r=0;r<a.length;r+=3){var s=a[r],n=a[r+1],l=s[$a]||null;if(typeof n=="function")l||O1(a);else if(l){var o=null;if(n&&n.hasAttribute("formAction")){if(s=n,l=n[$a]||null)o=l.formAction;else if(Lx(s)!==null)continue}else o=l.action;typeof o=="function"?a[r+1]=o:(a.splice(r,3),r-=3),O1(a)}}}function Mx(e){this._internalRoot=e}md.prototype.render=Mx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ue(409));var a=t.current,r=sr();SE(a,r,e,t,null,null)};md.prototype.unmount=Mx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;SE(e.current,2,null,e,null,null),ud(),t[gl]=null}};function md(e){this._internalRoot=e}md.prototype.unstable_scheduleHydration=function(e){if(e){var t=l2();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Gs.length&&t!==0&&t<Gs[a].priority;a++);Gs.splice(a,0,e),a===0&&CE(e)}};var F1=Xb.version;if(F1!=="19.1.0")throw Error(ue(527,F1,"19.1.0"));Ze.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ue(188)):(e=Object.keys(e).join(","),Error(ue(268,e)));return e=j4(t),e=e!==null?Zb(e):null,e=e===null?null:e.stateNode,e};var ej={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ke,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lu.isDisabled&&lu.supportsFiber)try{xc=lu.inject(ej),ar=lu}catch{}}Q0.createRoot=function(e,t){if(!Kb(e))throw Error(ue(299));var a=!1,r="",s=Ew,n=Nw,l=Sw,o=null;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(s=t.onUncaughtError),t.onCaughtError!==void 0&&(n=t.onCaughtError),t.onRecoverableError!==void 0&&(l=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(o=t.unstable_transitionCallbacks)),t=EE(e,1,!1,null,null,a,r,s,n,l,o,null),e[gl]=t.current,_x(e),new Mx(t)};Q0.hydrateRoot=function(e,t,a){if(!Kb(e))throw Error(ue(299));var r=!1,s="",n=Ew,l=Nw,o=Sw,c=null,u=null;return a!=null&&(a.unstable_strictMode===!0&&(r=!0),a.identifierPrefix!==void 0&&(s=a.identifierPrefix),a.onUncaughtError!==void 0&&(n=a.onUncaughtError),a.onCaughtError!==void 0&&(l=a.onCaughtError),a.onRecoverableError!==void 0&&(o=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(c=a.unstable_transitionCallbacks),a.formState!==void 0&&(u=a.formState)),t=EE(e,1,!0,t,a??null,r,s,n,l,o,c,u),t.context=NE(null),a=t.current,r=sr(),r=Ym(r),s=tn(r),s.callback=null,an(a,s,r),a=r,t.current.lanes=a,gc(t,a),ss(t),e[gl]=t.current,_x(e),new md(t)};Q0.version="19.1.0";function kE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kE)}catch(e){console.error(e)}}kE(),zb.exports=Q0;var tj=zb.exports;/**
 * @remix-run/router v1.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zo(){return Zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Zo.apply(this,arguments)}var Zs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Zs||(Zs={}));const L1="popstate";function aj(e){e===void 0&&(e={});function t(r,s){let{pathname:n,search:l,hash:o}=r.location;return Kh("",{pathname:n,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(r,s){return typeof s=="string"?s:jE(s)}return sj(t,a,null,e)}function zt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ux(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function rj(){return Math.random().toString(36).substr(2,8)}function M1(e,t){return{usr:e.state,key:e.key,idx:t}}function Kh(e,t,a,r){return a===void 0&&(a=null),Zo({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Nl(t):t,{state:a,key:t&&t.key||r||rj()})}function jE(e){let{pathname:t="/",search:a="",hash:r=""}=e;return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Nl(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substr(a),e=e.substr(0,a));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function sj(e,t,a,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:n=!1}=r,l=s.history,o=Zs.Pop,c=null,u=d();u==null&&(u=0,l.replaceState(Zo({},l.state,{idx:u}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=Zs.Pop;let v=d(),g=v==null?null:v-u;u=v,c&&c({action:o,location:x.location,delta:g})}function f(v,g){o=Zs.Push;let b=Kh(x.location,v,g);a&&a(b,v),u=d()+1;let y=M1(b,u),w=x.createHref(b);try{l.pushState(y,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(w)}n&&c&&c({action:o,location:x.location,delta:1})}function m(v,g){o=Zs.Replace;let b=Kh(x.location,v,g);a&&a(b,v),u=d();let y=M1(b,u),w=x.createHref(b);l.replaceState(y,"",w),n&&c&&c({action:o,location:x.location,delta:0})}function p(v){let g=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof v=="string"?v:jE(v);return zt(g,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,g)}let x={get action(){return o},get location(){return e(s,l)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(L1,h),c=v,()=>{s.removeEventListener(L1,h),c=null}},createHref(v){return t(s,v)},createURL:p,encodeLocation(v){let g=p(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:m,go(v){return l.go(v)}};return x}var U1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(U1||(U1={}));function nj(e,t,a){a===void 0&&(a="/");let r=typeof t=="string"?Nl(t):t,s=DE(r.pathname||"/",a);if(s==null)return null;let n=_E(e);ij(n);let l=null;for(let o=0;l==null&&o<n.length;++o)l=xj(n[o],yj(s));return l}function _E(e,t,a,r){t===void 0&&(t=[]),a===void 0&&(a=[]),r===void 0&&(r="");let s=(n,l,o)=>{let c={relativePath:o===void 0?n.path||"":o,caseSensitive:n.caseSensitive===!0,childrenIndex:l,route:n};c.relativePath.startsWith("/")&&(zt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Gn([r,c.relativePath]),d=a.concat(c);n.children&&n.children.length>0&&(zt(n.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),_E(n.children,t,d,u)),!(n.path==null&&!n.index)&&t.push({path:u,score:hj(u,n.index),routesMeta:d})};return e.forEach((n,l)=>{var o;if(n.path===""||!((o=n.path)!=null&&o.includes("?")))s(n,l);else for(let c of RE(n.path))s(n,l,c)}),t}function RE(e){let t=e.split("/");if(t.length===0)return[];let[a,...r]=t,s=a.endsWith("?"),n=a.replace(/\?$/,"");if(r.length===0)return s?[n,""]:[n];let l=RE(r.join("/")),o=[];return o.push(...l.map(c=>c===""?n:[n,c].join("/"))),s&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function ij(e){e.sort((t,a)=>t.score!==a.score?a.score-t.score:mj(t.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}const lj=/^:\w+$/,oj=3,cj=2,uj=1,dj=10,fj=-2,B1=e=>e==="*";function hj(e,t){let a=e.split("/"),r=a.length;return a.some(B1)&&(r+=fj),t&&(r+=cj),a.filter(s=>!B1(s)).reduce((s,n)=>s+(lj.test(n)?oj:n===""?uj:dj),r)}function mj(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function xj(e,t){let{routesMeta:a}=e,r={},s="/",n=[];for(let l=0;l<a.length;++l){let o=a[l],c=l===a.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=pj({path:o.relativePath,caseSensitive:o.caseSensitive,end:c},u);if(!d)return null;Object.assign(r,d.params);let h=o.route;n.push({params:r,pathname:Gn([s,d.pathname]),pathnameBase:Tj(Gn([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Gn([s,d.pathnameBase]))}return n}function pj(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,r]=gj(e.path,e.caseSensitive,e.end),s=t.match(a);if(!s)return null;let n=s[0],l=n.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=o[h]||"";l=n.slice(0,n.length-x.length).replace(/(.)\/+$/,"$1")}const p=o[h];return m&&!p?u[f]=void 0:u[f]=vj(p||"",f),u},{}),pathname:n,pathnameBase:l,pattern:e}}function gj(e,t,a){t===void 0&&(t=!1),a===void 0&&(a=!0),Ux(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(l,o,c)=>(r.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function yj(e){try{return decodeURI(e)}catch(t){return Ux(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function vj(e,t){try{return decodeURIComponent(e)}catch(a){return Ux(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+a+").")),e}}function DE(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,r=e.charAt(a);return r&&r!=="/"?null:e.slice(a)||"/"}function bj(e,t){t===void 0&&(t="/");let{pathname:a,search:r="",hash:s=""}=typeof e=="string"?Nl(e):e;return{pathname:a?a.startsWith("/")?a:wj(a,t):t,search:Aj(r),hash:Cj(s)}}function wj(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function wf(e,t,a,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ej(e){return e.filter((t,a)=>a===0||t.route.path&&t.route.path.length>0)}function Nj(e){return Ej(e).map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function Sj(e,t,a,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Nl(e):(s=Zo({},e),zt(!s.pathname||!s.pathname.includes("?"),wf("?","pathname","search",s)),zt(!s.pathname||!s.pathname.includes("#"),wf("#","pathname","hash",s)),zt(!s.search||!s.search.includes("#"),wf("#","search","hash",s)));let n=e===""||s.pathname==="",l=n?"/":s.pathname,o;if(l==null)o=a;else if(r){let h=t[t.length-1].replace(/^\//,"").split("/");if(l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h.pop();s.pathname=f.join("/")}o="/"+h.join("/")}else{let h=t.length-1;if(l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}o=h>=0?t[h]:"/"}let c=bj(s,o),u=l&&l!=="/"&&l.endsWith("/"),d=(n||l===".")&&a.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Gn=e=>e.join("/").replace(/\/\/+/g,"/"),Tj=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Aj=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Cj=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function kj(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const OE=["post","put","patch","delete"];new Set(OE);const jj=["get",...OE];new Set(jj);/**
 * React Router v6.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function A0(){return A0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},A0.apply(this,arguments)}const Bx=E.createContext(null),_j=E.createContext(null),xd=E.createContext(null),pd=E.createContext(null),oi=E.createContext({outlet:null,matches:[],isDataRoute:!1}),FE=E.createContext(null);function gd(){return E.useContext(pd)!=null}function LE(){return gd()||zt(!1),E.useContext(pd).location}function ME(e){E.useContext(xd).static||E.useLayoutEffect(e)}function UE(){let{isDataRoute:e}=E.useContext(oi);return e?Hj():Rj()}function Rj(){gd()||zt(!1);let e=E.useContext(Bx),{basename:t,navigator:a}=E.useContext(xd),{matches:r}=E.useContext(oi),{pathname:s}=LE(),n=JSON.stringify(Nj(r)),l=E.useRef(!1);return ME(()=>{l.current=!0}),E.useCallback(function(c,u){if(u===void 0&&(u={}),!l.current)return;if(typeof c=="number"){a.go(c);return}let d=Sj(c,JSON.parse(n),s,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Gn([t,d.pathname])),(u.replace?a.replace:a.push)(d,u.state,u)},[t,a,n,s,e])}function BE(){let{matches:e}=E.useContext(oi),t=e[e.length-1];return t?t.params:{}}function Dj(e,t){return Oj(e,t)}function Oj(e,t,a){gd()||zt(!1);let{navigator:r}=E.useContext(xd),{matches:s}=E.useContext(oi),n=s[s.length-1],l=n?n.params:{};n&&n.pathname;let o=n?n.pathnameBase:"/";n&&n.route;let c=LE(),u;if(t){var d;let x=typeof t=="string"?Nl(t):t;o==="/"||(d=x.pathname)!=null&&d.startsWith(o)||zt(!1),u=x}else u=c;let h=u.pathname||"/",f=o==="/"?h:h.slice(o.length)||"/",m=nj(e,{pathname:f}),p=Bj(m&&m.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:Gn([o,r.encodeLocation?r.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?o:Gn([o,r.encodeLocation?r.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,a);return t&&p?E.createElement(pd.Provider,{value:{location:A0({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Zs.Pop}},p):p}function Fj(){let e=zj(),t=kj(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},n=null;return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),a?E.createElement("pre",{style:s},a):null,n)}const Lj=E.createElement(Fj,null);class Mj extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,a){return a.location!==t.location||a.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||a.error,location:a.location,revalidation:t.revalidation||a.revalidation}}componentDidCatch(t,a){console.error("React Router caught the following error during render",t,a)}render(){return this.state.error?E.createElement(oi.Provider,{value:this.props.routeContext},E.createElement(FE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Uj(e){let{routeContext:t,match:a,children:r}=e,s=E.useContext(Bx);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),E.createElement(oi.Provider,{value:t},r)}function Bj(e,t,a){var r;if(t===void 0&&(t=[]),a===void 0&&(a=null),e==null){var s;if((s=a)!=null&&s.errors)e=a.matches;else return null}let n=e,l=(r=a)==null?void 0:r.errors;if(l!=null){let o=n.findIndex(c=>c.route.id&&(l==null?void 0:l[c.route.id]));o>=0||zt(!1),n=n.slice(0,Math.min(n.length,o+1))}return n.reduceRight((o,c,u)=>{let d=c.route.id?l==null?void 0:l[c.route.id]:null,h=null;a&&(h=c.route.errorElement||Lj);let f=t.concat(n.slice(0,u+1)),m=()=>{let p;return d?p=h:c.route.Component?p=E.createElement(c.route.Component,null):c.route.element?p=c.route.element:p=o,E.createElement(Uj,{match:c,routeContext:{outlet:o,matches:f,isDataRoute:a!=null},children:p})};return a&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?E.createElement(Mj,{location:a.location,revalidation:a.revalidation,component:h,error:d,children:m(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):m()},null)}var IE=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(IE||{}),C0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(C0||{});function Ij(e){let t=E.useContext(Bx);return t||zt(!1),t}function Pj(e){let t=E.useContext(_j);return t||zt(!1),t}function Vj(e){let t=E.useContext(oi);return t||zt(!1),t}function PE(e){let t=Vj(),a=t.matches[t.matches.length-1];return a.route.id||zt(!1),a.route.id}function zj(){var e;let t=E.useContext(FE),a=Pj(C0.UseRouteError),r=PE(C0.UseRouteError);return t||((e=a.errors)==null?void 0:e[r])}function Hj(){let{router:e}=Ij(IE.UseNavigateStable),t=PE(C0.UseNavigateStable),a=E.useRef(!1);return ME(()=>{a.current=!0}),E.useCallback(function(s,n){n===void 0&&(n={}),a.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,A0({fromRouteId:t},n)))},[e,t])}function Jl(e){zt(!1)}function Gj(e){let{basename:t="/",children:a=null,location:r,navigationType:s=Zs.Pop,navigator:n,static:l=!1}=e;gd()&&zt(!1);let o=t.replace(/^\/*/,"/"),c=E.useMemo(()=>({basename:o,navigator:n,static:l}),[o,n,l]);typeof r=="string"&&(r=Nl(r));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:m="default"}=r,p=E.useMemo(()=>{let x=DE(u,o);return x==null?null:{location:{pathname:x,search:d,hash:h,state:f,key:m},navigationType:s}},[o,u,d,h,f,m,s]);return p==null?null:E.createElement(xd.Provider,{value:c},E.createElement(pd.Provider,{children:a,value:p}))}function $j(e){let{children:t,location:a}=e;return Dj(Wh(t),a)}new Promise(()=>{});function Wh(e,t){t===void 0&&(t=[]);let a=[];return E.Children.forEach(e,(r,s)=>{if(!E.isValidElement(r))return;let n=[...t,s];if(r.type===E.Fragment){a.push.apply(a,Wh(r.props.children,n));return}r.type!==Jl&&zt(!1),!r.props.index||!r.props.children||zt(!1);let l={id:r.props.id||n.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Wh(r.props.children,n)),a.push(l)}),a}/**
 * React Router DOM v6.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Yj="startTransition",I1=E4[Yj];function qj(e){let{basename:t,children:a,future:r,window:s}=e,n=E.useRef();n.current==null&&(n.current=aj({window:s,v5Compat:!0}));let l=n.current,[o,c]=E.useState({action:l.action,location:l.location}),{v7_startTransition:u}=r||{},d=E.useCallback(h=>{u&&I1?I1(()=>c(h)):c(h)},[c,u]);return E.useLayoutEffect(()=>l.listen(d),[l,d]),E.createElement(Gj,{basename:t,children:a,location:o.location,navigationType:o.action,navigator:l})}var P1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(P1||(P1={}));var V1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(V1||(V1={}));const Xj="modulepreload",Kj=function(e){return"/"+e},z1={},ou=function(t,a,r){if(!a||a.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(a.map(n=>{if(n=Kj(n),n in z1)return;z1[n]=!0;const l=n.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===n&&(!l||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${o}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":Xj,l||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),l)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t()).catch(n=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=n,window.dispatchEvent(l),!l.defaultPrevented)throw n})},VE=E.createContext(),Na=()=>{const e=E.useContext(VE);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},Wj=({children:e})=>{const[t,a]=E.useState(null),[r,s]=E.useState(!0);E.useEffect(()=>{(()=>{try{const m=localStorage.getItem("user"),p=localStorage.getItem("token");if(m&&p){const x=JSON.parse(m);a(x)}else localStorage.removeItem("user"),localStorage.removeItem("token")}catch{localStorage.removeItem("user"),localStorage.removeItem("token")}finally{s(!1)}})()},[]);const h={user:t,login:(f,m)=>{localStorage.setItem("user",JSON.stringify(f)),m&&localStorage.setItem("token",m),a(f)},logout:async()=>{try{const{AuthService:f}=await ou(()=>Promise.resolve().then(()=>mu),void 0);await f.logout()}catch{}finally{localStorage.removeItem("user"),localStorage.removeItem("token"),a(null)}},updateUser:f=>{const m={...t,...f};localStorage.setItem("user",JSON.stringify(m)),a(m)},sendOtp:async f=>{const{AuthService:m}=await ou(()=>Promise.resolve().then(()=>mu),void 0);return m.sendOtp(f)},verifyOtp:async(f,m)=>{const{AuthService:p}=await ou(()=>Promise.resolve().then(()=>mu),void 0);return p.verifyOtp(f,m)},resetPasswordWithOtp:async(f,m)=>{const{AuthService:p}=await ou(()=>Promise.resolve().then(()=>mu),void 0);return p.resetPasswordWithOtp(f,m)},loading:r,isAuthenticated:!!t};return i.jsx(VE.Provider,{value:h,children:e})},zE=E.createContext(),Zj=()=>{const e=E.useContext(zE);if(!e)throw new Error("useNotesContext must be used within a NotesProvider");return e},Qj=({children:e})=>{const{user:t}=Na(),[a,r]=E.useState([]),[s,n]=E.useState(!1),[l,o]=E.useState(null),c=t==null?void 0:t.companyId,u=(t==null?void 0:t.userId)||(t==null?void 0:t.id),d=t==null?void 0:t.role,p={allNotes:a,notesLoading:s,notesError:l,updateNotesData:(x,v,g)=>{r(x||[]),n(v),o(g)},getTodayEvents:()=>{if(!a||a.length===0)return[];const x=new Date().toISOString().split("T")[0],v=[];return a.forEach(y=>{if(y.dateTime&&y.status!=="CLOSED"&&y.status!=="COMPLETED")try{const w=new Date(y.dateTime).toISOString().split("T")[0];v.push({...y,noteDate:w,isToday:w===x})}catch{console.warn("Invalid dateTime for note:",y.id,y.dateTime)}}),v.sort((y,w)=>{if(y.isToday&&!w.isToday)return-1;if(!y.isToday&&w.isToday)return 1;const N=new Date(y.dateTime),A=new Date(w.dateTime);return N-A}).filter(y=>y.isToday)},getSortedNotes:()=>{if(!a||a.length===0)return[];const x=new Date().toISOString().split("T")[0],v=[];return a.forEach(b=>{if(b.dateTime&&b.status!=="CLOSED"&&b.status!=="COMPLETED")try{const y=new Date(b.dateTime).toISOString().split("T")[0];v.push({...b,noteDate:y,isToday:y===x})}catch{console.warn("Invalid dateTime for note:",b.id,b.dateTime)}}),v.sort((b,y)=>{if(b.isToday&&!y.isToday)return-1;if(!b.isToday&&y.isToday)return 1;const w=new Date(b.dateTime),N=new Date(y.dateTime);return w-N})},companyId:c,userId:u,role:d};return i.jsx(zE.Provider,{value:p,children:e})},Ix=E.createContext({});function Px(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const Vx=typeof window<"u",HE=Vx?E.useLayoutEffect:E.useEffect,yd=E.createContext(null);function zx(e,t){e.indexOf(t)===-1&&e.push(t)}function Hx(e,t){const a=e.indexOf(t);a>-1&&e.splice(a,1)}const Cs=(e,t,a)=>a>t?t:a<e?e:a;let Gx=()=>{};const ks={},GE=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function $E(e){return typeof e=="object"&&e!==null}const YE=e=>/^0[^.\s]+$/u.test(e);function $x(e){let t;return()=>(t===void 0&&(t=e()),t)}const br=e=>e,Jj=(e,t)=>a=>t(e(a)),_c=(...e)=>e.reduce(Jj),Qo=(e,t,a)=>{const r=t-e;return r===0?1:(a-e)/r};class Yx{constructor(){this.subscriptions=[]}add(t){return zx(this.subscriptions,t),()=>Hx(this.subscriptions,t)}notify(t,a,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,a,r);else for(let n=0;n<s;n++){const l=this.subscriptions[n];l&&l(t,a,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wr=e=>e*1e3,Zr=e=>e/1e3;function qE(e,t){return t?e*(1e3/t):0}const XE=(e,t,a)=>(((1-3*a+3*t)*e+(3*a-6*t))*e+3*t)*e,e_=1e-7,t_=12;function a_(e,t,a,r,s){let n,l,o=0;do l=t+(a-t)/2,n=XE(l,r,s)-e,n>0?a=l:t=l;while(Math.abs(n)>e_&&++o<t_);return l}function Rc(e,t,a,r){if(e===t&&a===r)return br;const s=n=>a_(n,0,1,e,a);return n=>n===0||n===1?n:XE(s(n),t,r)}const KE=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,WE=e=>t=>1-e(1-t),ZE=Rc(.33,1.53,.69,.99),qx=WE(ZE),QE=KE(qx),JE=e=>(e*=2)<1?.5*qx(e):.5*(2-Math.pow(2,-10*(e-1))),Xx=e=>1-Math.sin(Math.acos(e)),eN=WE(Xx),tN=KE(Xx),r_=Rc(.42,0,1,1),s_=Rc(0,0,.58,1),aN=Rc(.42,0,.58,1),n_=e=>Array.isArray(e)&&typeof e[0]!="number",rN=e=>Array.isArray(e)&&typeof e[0]=="number",i_={linear:br,easeIn:r_,easeInOut:aN,easeOut:s_,circIn:Xx,circInOut:tN,circOut:eN,backIn:qx,backInOut:QE,backOut:ZE,anticipate:JE},l_=e=>typeof e=="string",H1=e=>{if(rN(e)){Gx(e.length===4);const[t,a,r,s]=e;return Rc(t,a,r,s)}else if(l_(e))return i_[e];return e},cu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],G1={value:null,addProjectionMetrics:null};function o_(e,t){let a=new Set,r=new Set,s=!1,n=!1;const l=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},c=0;function u(h){l.has(h)&&(d.schedule(h),e()),c++,h(o)}const d={schedule:(h,f=!1,m=!1)=>{const x=m&&s?a:r;return f&&l.add(h),x.has(h)||x.add(h),h},cancel:h=>{r.delete(h),l.delete(h)},process:h=>{if(o=h,s){n=!0;return}s=!0,[a,r]=[r,a],a.forEach(u),t&&G1.value&&G1.value.frameloop[t].push(c),c=0,a.clear(),s=!1,n&&(n=!1,d.process(h))}};return d}const c_=40;function sN(e,t){let a=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},n=()=>a=!0,l=cu.reduce((y,w)=>(y[w]=o_(n,t?w:void 0),y),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:h,preRender:f,render:m,postRender:p}=l,x=()=>{const y=ks.useManualTiming?s.timestamp:performance.now();a=!1,ks.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(y-s.timestamp,c_),1)),s.timestamp=y,s.isProcessing=!0,o.process(s),c.process(s),u.process(s),d.process(s),h.process(s),f.process(s),m.process(s),p.process(s),s.isProcessing=!1,a&&t&&(r=!1,e(x))},v=()=>{a=!0,r=!0,s.isProcessing||e(x)};return{schedule:cu.reduce((y,w)=>{const N=l[w];return y[w]=(A,S=!1,C=!1)=>(a||v(),N.schedule(A,S,C)),y},{}),cancel:y=>{for(let w=0;w<cu.length;w++)l[cu[w]].cancel(y)},state:s,steps:l}}const{schedule:dt,cancel:mn,state:ea,steps:Ef}=sN(typeof requestAnimationFrame<"u"?requestAnimationFrame:br,!0);let Pu;function u_(){Pu=void 0}const Ha={now:()=>(Pu===void 0&&Ha.set(ea.isProcessing||ks.useManualTiming?ea.timestamp:performance.now()),Pu),set:e=>{Pu=e,queueMicrotask(u_)}},nN=e=>t=>typeof t=="string"&&t.startsWith(e),Kx=nN("--"),d_=nN("var(--"),Wx=e=>d_(e)?f_.test(e.split("/*")[0].trim()):!1,f_=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Sl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Jo={...Sl,transform:e=>Cs(0,1,e)},uu={...Sl,default:1},No=e=>Math.round(e*1e5)/1e5,Zx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function h_(e){return e==null}const m_=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Qx=(e,t)=>a=>!!(typeof a=="string"&&m_.test(a)&&a.startsWith(e)||t&&!h_(a)&&Object.prototype.hasOwnProperty.call(a,t)),iN=(e,t,a)=>r=>{if(typeof r!="string")return r;const[s,n,l,o]=r.match(Zx);return{[e]:parseFloat(s),[t]:parseFloat(n),[a]:parseFloat(l),alpha:o!==void 0?parseFloat(o):1}},x_=e=>Cs(0,255,e),Nf={...Sl,transform:e=>Math.round(x_(e))},Dn={test:Qx("rgb","red"),parse:iN("red","green","blue"),transform:({red:e,green:t,blue:a,alpha:r=1})=>"rgba("+Nf.transform(e)+", "+Nf.transform(t)+", "+Nf.transform(a)+", "+No(Jo.transform(r))+")"};function p_(e){let t="",a="",r="",s="";return e.length>5?(t=e.substring(1,3),a=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),a=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,a+=a,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(a,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Zh={test:Qx("#"),parse:p_,transform:Dn.transform},Dc=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Bs=Dc("deg"),Qr=Dc("%"),Ae=Dc("px"),g_=Dc("vh"),y_=Dc("vw"),$1=(()=>({...Qr,parse:e=>Qr.parse(e)/100,transform:e=>Qr.transform(e*100)}))(),Bi={test:Qx("hsl","hue"),parse:iN("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:a,alpha:r=1})=>"hsla("+Math.round(e)+", "+Qr.transform(No(t))+", "+Qr.transform(No(a))+", "+No(Jo.transform(r))+")"},Rt={test:e=>Dn.test(e)||Zh.test(e)||Bi.test(e),parse:e=>Dn.test(e)?Dn.parse(e):Bi.test(e)?Bi.parse(e):Zh.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Dn.transform(e):Bi.transform(e),getAnimatableNone:e=>{const t=Rt.parse(e);return t.alpha=0,Rt.transform(t)}},v_=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function b_(e){var t,a;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Zx))==null?void 0:t.length)||0)+(((a=e.match(v_))==null?void 0:a.length)||0)>0}const lN="number",oN="color",w_="var",E_="var(",Y1="${}",N_=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ec(e){const t=e.toString(),a=[],r={color:[],number:[],var:[]},s=[];let n=0;const o=t.replace(N_,c=>(Rt.test(c)?(r.color.push(n),s.push(oN),a.push(Rt.parse(c))):c.startsWith(E_)?(r.var.push(n),s.push(w_),a.push(c)):(r.number.push(n),s.push(lN),a.push(parseFloat(c))),++n,Y1)).split(Y1);return{values:a,split:o,indexes:r,types:s}}function cN(e){return ec(e).values}function uN(e){const{split:t,types:a}=ec(e),r=t.length;return s=>{let n="";for(let l=0;l<r;l++)if(n+=t[l],s[l]!==void 0){const o=a[l];o===lN?n+=No(s[l]):o===oN?n+=Rt.transform(s[l]):n+=s[l]}return n}}const S_=e=>typeof e=="number"?0:Rt.test(e)?Rt.getAnimatableNone(e):e;function T_(e){const t=cN(e);return uN(e)(t.map(S_))}const xn={test:b_,parse:cN,createTransformer:uN,getAnimatableNone:T_};function Sf(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(t-e)*6*a:a<1/2?t:a<2/3?e+(t-e)*(2/3-a)*6:e}function A_({hue:e,saturation:t,lightness:a,alpha:r}){e/=360,t/=100,a/=100;let s=0,n=0,l=0;if(!t)s=n=l=a;else{const o=a<.5?a*(1+t):a+t-a*t,c=2*a-o;s=Sf(c,o,e+1/3),n=Sf(c,o,e),l=Sf(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(n*255),blue:Math.round(l*255),alpha:r}}function k0(e,t){return a=>a>0?t:e}const pt=(e,t,a)=>e+(t-e)*a,Tf=(e,t,a)=>{const r=e*e,s=a*(t*t-r)+r;return s<0?0:Math.sqrt(s)},C_=[Zh,Dn,Bi],k_=e=>C_.find(t=>t.test(e));function q1(e){const t=k_(e);if(!t)return!1;let a=t.parse(e);return t===Bi&&(a=A_(a)),a}const X1=(e,t)=>{const a=q1(e),r=q1(t);if(!a||!r)return k0(e,t);const s={...a};return n=>(s.red=Tf(a.red,r.red,n),s.green=Tf(a.green,r.green,n),s.blue=Tf(a.blue,r.blue,n),s.alpha=pt(a.alpha,r.alpha,n),Dn.transform(s))},Qh=new Set(["none","hidden"]);function j_(e,t){return Qh.has(e)?a=>a<=0?e:t:a=>a>=1?t:e}function __(e,t){return a=>pt(e,t,a)}function Jx(e){return typeof e=="number"?__:typeof e=="string"?Wx(e)?k0:Rt.test(e)?X1:O_:Array.isArray(e)?dN:typeof e=="object"?Rt.test(e)?X1:R_:k0}function dN(e,t){const a=[...e],r=a.length,s=e.map((n,l)=>Jx(n)(n,t[l]));return n=>{for(let l=0;l<r;l++)a[l]=s[l](n);return a}}function R_(e,t){const a={...e,...t},r={};for(const s in a)e[s]!==void 0&&t[s]!==void 0&&(r[s]=Jx(e[s])(e[s],t[s]));return s=>{for(const n in r)a[n]=r[n](s);return a}}function D_(e,t){const a=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const n=t.types[s],l=e.indexes[n][r[n]],o=e.values[l]??0;a[s]=o,r[n]++}return a}const O_=(e,t)=>{const a=xn.createTransformer(t),r=ec(e),s=ec(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Qh.has(e)&&!s.values.length||Qh.has(t)&&!r.values.length?j_(e,t):_c(dN(D_(r,s),s.values),a):k0(e,t)};function fN(e,t,a){return typeof e=="number"&&typeof t=="number"&&typeof a=="number"?pt(e,t,a):Jx(e)(e,t)}const F_=e=>{const t=({timestamp:a})=>e(a);return{start:(a=!0)=>dt.update(t,a),stop:()=>mn(t),now:()=>ea.isProcessing?ea.timestamp:Ha.now()}},hN=(e,t,a=10)=>{let r="";const s=Math.max(Math.round(t/a),2);for(let n=0;n<s;n++)r+=Math.round(e(n/(s-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},j0=2e4;function ep(e){let t=0;const a=50;let r=e.next(t);for(;!r.done&&t<j0;)t+=a,r=e.next(t);return t>=j0?1/0:t}function L_(e,t=100,a){const r=a({...e,keyframes:[0,t]}),s=Math.min(ep(r),j0);return{type:"keyframes",ease:n=>r.next(s*n).value/t,duration:Zr(s)}}const M_=5;function mN(e,t,a){const r=Math.max(t-M_,0);return qE(a-e(r),t-r)}const gt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Af=.001;function U_({duration:e=gt.duration,bounce:t=gt.bounce,velocity:a=gt.velocity,mass:r=gt.mass}){let s,n,l=1-t;l=Cs(gt.minDamping,gt.maxDamping,l),e=Cs(gt.minDuration,gt.maxDuration,Zr(e)),l<1?(s=u=>{const d=u*l,h=d*e,f=d-a,m=Jh(u,l),p=Math.exp(-h);return Af-f/m*p},n=u=>{const h=u*l*e,f=h*a+a,m=Math.pow(l,2)*Math.pow(u,2)*e,p=Math.exp(-h),x=Jh(Math.pow(u,2),l);return(-s(u)+Af>0?-1:1)*((f-m)*p)/x}):(s=u=>{const d=Math.exp(-u*e),h=(u-a)*e+1;return-Af+d*h},n=u=>{const d=Math.exp(-u*e),h=(a-u)*(e*e);return d*h});const o=5/e,c=I_(s,n,o);if(e=Wr(e),isNaN(c))return{stiffness:gt.stiffness,damping:gt.damping,duration:e};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:l*2*Math.sqrt(r*u),duration:e}}}const B_=12;function I_(e,t,a){let r=a;for(let s=1;s<B_;s++)r=r-e(r)/t(r);return r}function Jh(e,t){return e*Math.sqrt(1-t*t)}const P_=["duration","bounce"],V_=["stiffness","damping","mass"];function K1(e,t){return t.some(a=>e[a]!==void 0)}function z_(e){let t={velocity:gt.velocity,stiffness:gt.stiffness,damping:gt.damping,mass:gt.mass,isResolvedFromDuration:!1,...e};if(!K1(e,V_)&&K1(e,P_))if(e.visualDuration){const a=e.visualDuration,r=2*Math.PI/(a*1.2),s=r*r,n=2*Cs(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:gt.mass,stiffness:s,damping:n}}else{const a=U_(e);t={...t,...a,mass:gt.mass},t.isResolvedFromDuration=!0}return t}function _0(e=gt.visualDuration,t=gt.bounce){const a=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=a;const n=a.keyframes[0],l=a.keyframes[a.keyframes.length-1],o={done:!1,value:n},{stiffness:c,damping:u,mass:d,duration:h,velocity:f,isResolvedFromDuration:m}=z_({...a,velocity:-Zr(a.velocity||0)}),p=f||0,x=u/(2*Math.sqrt(c*d)),v=l-n,g=Zr(Math.sqrt(c/d)),b=Math.abs(v)<5;r||(r=b?gt.restSpeed.granular:gt.restSpeed.default),s||(s=b?gt.restDelta.granular:gt.restDelta.default);let y;if(x<1){const N=Jh(g,x);y=A=>{const S=Math.exp(-x*g*A);return l-S*((p+x*g*v)/N*Math.sin(N*A)+v*Math.cos(N*A))}}else if(x===1)y=N=>l-Math.exp(-g*N)*(v+(p+g*v)*N);else{const N=g*Math.sqrt(x*x-1);y=A=>{const S=Math.exp(-x*g*A),C=Math.min(N*A,300);return l-S*((p+x*g*v)*Math.sinh(C)+N*v*Math.cosh(C))/N}}const w={calculatedDuration:m&&h||null,next:N=>{const A=y(N);if(m)o.done=N>=h;else{let S=N===0?p:0;x<1&&(S=N===0?Wr(p):mN(y,N,A));const C=Math.abs(S)<=r,T=Math.abs(l-A)<=s;o.done=C&&T}return o.value=o.done?l:A,o},toString:()=>{const N=Math.min(ep(w),j0),A=hN(S=>w.next(N*S).value,N,30);return N+"ms "+A},toTransition:()=>{}};return w}_0.applyToOptions=e=>{const t=L_(e,100,_0);return e.ease=t.ease,e.duration=Wr(t.duration),e.type="keyframes",e};function em({keyframes:e,velocity:t=0,power:a=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:n=500,modifyTarget:l,min:o,max:c,restDelta:u=.5,restSpeed:d}){const h=e[0],f={done:!1,value:h},m=C=>o!==void 0&&C<o||c!==void 0&&C>c,p=C=>o===void 0?c:c===void 0||Math.abs(o-C)<Math.abs(c-C)?o:c;let x=a*t;const v=h+x,g=l===void 0?v:l(v);g!==v&&(x=g-h);const b=C=>-x*Math.exp(-C/r),y=C=>g+b(C),w=C=>{const T=b(C),D=y(C);f.done=Math.abs(T)<=u,f.value=f.done?g:D};let N,A;const S=C=>{m(f.value)&&(N=C,A=_0({keyframes:[f.value,p(f.value)],velocity:mN(y,C,f.value),damping:s,stiffness:n,restDelta:u,restSpeed:d}))};return S(0),{calculatedDuration:null,next:C=>{let T=!1;return!A&&N===void 0&&(T=!0,w(C),S(C)),N!==void 0&&C>=N?A.next(C-N):(!T&&w(C),f)}}}function H_(e,t,a){const r=[],s=a||ks.mix||fN,n=e.length-1;for(let l=0;l<n;l++){let o=s(e[l],e[l+1]);if(t){const c=Array.isArray(t)?t[l]||br:t;o=_c(c,o)}r.push(o)}return r}function G_(e,t,{clamp:a=!0,ease:r,mixer:s}={}){const n=e.length;if(Gx(n===t.length),n===1)return()=>t[0];if(n===2&&t[0]===t[1])return()=>t[1];const l=e[0]===e[1];e[0]>e[n-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=H_(t,r,s),c=o.length,u=d=>{if(l&&d<e[0])return t[0];let h=0;if(c>1)for(;h<e.length-2&&!(d<e[h+1]);h++);const f=Qo(e[h],e[h+1],d);return o[h](f)};return a?d=>u(Cs(e[0],e[n-1],d)):u}function $_(e,t){const a=e[e.length-1];for(let r=1;r<=t;r++){const s=Qo(0,t,r);e.push(pt(a,1,s))}}function Y_(e){const t=[0];return $_(t,e.length-1),t}function q_(e,t){return e.map(a=>a*t)}function X_(e,t){return e.map(()=>t||aN).splice(0,e.length-1)}function So({duration:e=300,keyframes:t,times:a,ease:r="easeInOut"}){const s=n_(r)?r.map(H1):H1(r),n={done:!1,value:t[0]},l=q_(a&&a.length===t.length?a:Y_(t),e),o=G_(l,t,{ease:Array.isArray(s)?s:X_(t,s)});return{calculatedDuration:e,next:c=>(n.value=o(c),n.done=c>=e,n)}}const K_=e=>e!==null;function tp(e,{repeat:t,repeatType:a="loop"},r,s=1){const n=e.filter(K_),o=s<0||t&&a!=="loop"&&t%2===1?0:n.length-1;return!o||r===void 0?n[o]:r}const W_={decay:em,inertia:em,tween:So,keyframes:So,spring:_0};function xN(e){typeof e.type=="string"&&(e.type=W_[e.type])}class ap{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,a){return this.finished.then(t,a)}}const Z_=e=>e/100;class rp extends ap{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,s;const{motionValue:a}=this.options;a&&a.updatedAt!==Ha.now()&&this.tick(Ha.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(r=this.options).onStop)==null||s.call(r))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;xN(t);const{type:a=So,repeat:r=0,repeatDelay:s=0,repeatType:n,velocity:l=0}=t;let{keyframes:o}=t;const c=a||So;c!==So&&typeof o[0]!="number"&&(this.mixKeyframes=_c(Z_,fN(o[0],o[1])),o=[0,100]);const u=c({...t,keyframes:o});n==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-l})),u.calculatedDuration===null&&(u.calculatedDuration=ep(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=u}updateTime(t){const a=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(t,a=!1){const{generator:r,totalDuration:s,mixKeyframes:n,mirroredGenerator:l,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return r.next(0);const{delay:u=0,keyframes:d,repeat:h,repeatType:f,repeatDelay:m,type:p,onUpdate:x,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),a?this.currentTime=t:this.updateTime(t);const g=this.currentTime-u*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?g<0:g>s;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let y=this.currentTime,w=r;if(h){const C=Math.min(this.currentTime,s)/o;let T=Math.floor(C),D=C%1;!D&&C>=1&&(D=1),D===1&&T--,T=Math.min(T,h+1),!!(T%2)&&(f==="reverse"?(D=1-D,m&&(D-=m/o)):f==="mirror"&&(w=l)),y=Cs(0,1,D)*o}const N=b?{done:!1,value:d[0]}:w.next(y);n&&(N.value=n(N.value));let{done:A}=N;!b&&c!==null&&(A=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&A);return S&&p!==em&&(N.value=tp(d,this.options,v,this.speed)),x&&x(N.value),S&&this.finish(),N}then(t,a){return this.finished.then(t,a)}get duration(){return Zr(this.calculatedDuration)}get time(){return Zr(this.currentTime)}set time(t){var a;t=Wr(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(a=this.driver)==null||a.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ha.now());const a=this.playbackSpeed!==t;this.playbackSpeed=t,a&&(this.time=Zr(this.currentTime))}play(){var s,n;if(this.isStopped)return;const{driver:t=F_,startTime:a}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),(n=(s=this.options).onPlay)==null||n.call(s);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=a??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ha.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,a;this.notifyFinished(),this.teardown(),this.state="finished",(a=(t=this.options).onComplete)==null||a.call(t)}cancel(){var t,a;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(a=(t=this.options).onCancel)==null||a.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var a;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(a=this.driver)==null||a.stop(),t.observe(this)}}function Q_(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const On=e=>e*180/Math.PI,tm=e=>{const t=On(Math.atan2(e[1],e[0]));return am(t)},J_={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:tm,rotateZ:tm,skewX:e=>On(Math.atan(e[1])),skewY:e=>On(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},am=e=>(e=e%360,e<0&&(e+=360),e),W1=tm,Z1=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Q1=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),e3={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Z1,scaleY:Q1,scale:e=>(Z1(e)+Q1(e))/2,rotateX:e=>am(On(Math.atan2(e[6],e[5]))),rotateY:e=>am(On(Math.atan2(-e[2],e[0]))),rotateZ:W1,rotate:W1,skewX:e=>On(Math.atan(e[4])),skewY:e=>On(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function rm(e){return e.includes("scale")?1:0}function sm(e,t){if(!e||e==="none")return rm(t);const a=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(a)r=e3,s=a;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=J_,s=o}if(!s)return rm(t);const n=r[t],l=s[1].split(",").map(a3);return typeof n=="function"?n(l):l[n]}const t3=(e,t)=>{const{transform:a="none"}=getComputedStyle(e);return sm(a,t)};function a3(e){return parseFloat(e.trim())}const Tl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Al=(()=>new Set(Tl))(),J1=e=>e===Sl||e===Ae,r3=new Set(["x","y","z"]),s3=Tl.filter(e=>!r3.has(e));function n3(e){const t=[];return s3.forEach(a=>{const r=e.getValue(a);r!==void 0&&(t.push([a,r.get()]),r.set(a.startsWith("scale")?1:0))}),t}const $n={width:({x:e},{paddingLeft:t="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(t)-parseFloat(a),height:({y:e},{paddingTop:t="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(t)-parseFloat(a),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>sm(t,"x"),y:(e,{transform:t})=>sm(t,"y")};$n.translateX=$n.x;$n.translateY=$n.y;const Yn=new Set;let nm=!1,im=!1,lm=!1;function pN(){if(im){const e=Array.from(Yn).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),a=new Map;t.forEach(r=>{const s=n3(r);s.length&&(a.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=a.get(r);s&&s.forEach(([n,l])=>{var o;(o=r.getValue(n))==null||o.set(l)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}im=!1,nm=!1,Yn.forEach(e=>e.complete(lm)),Yn.clear()}function gN(){Yn.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(im=!0)})}function i3(){lm=!0,gN(),pN(),lm=!1}class sp{constructor(t,a,r,s,n,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=a,this.name=r,this.motionValue=s,this.element=n,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(Yn.add(this),nm||(nm=!0,dt.read(gN),dt.resolveKeyframes(pN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:a,element:r,motionValue:s}=this;if(t[0]===null){const n=s==null?void 0:s.get(),l=t[t.length-1];if(n!==void 0)t[0]=n;else if(r&&a){const o=r.readValue(a,l);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=l),s&&n===void 0&&s.set(t[0])}Q_(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Yn.delete(this)}cancel(){this.state==="scheduled"&&(Yn.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const l3=e=>e.startsWith("--");function o3(e,t,a){l3(t)?e.style.setProperty(t,a):e.style[t]=a}const c3=$x(()=>window.ScrollTimeline!==void 0),u3={};function d3(e,t){const a=$x(e);return()=>u3[t]??a()}const yN=d3(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),eo=([e,t,a,r])=>`cubic-bezier(${e}, ${t}, ${a}, ${r})`,ey={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:eo([0,.65,.55,1]),circOut:eo([.55,0,1,.45]),backIn:eo([.31,.01,.66,-.59]),backOut:eo([.33,1.53,.69,.99])};function vN(e,t){if(e)return typeof e=="function"?yN()?hN(e,t):"ease-out":rN(e)?eo(e):Array.isArray(e)?e.map(a=>vN(a,t)||ey.easeOut):ey[e]}function f3(e,t,a,{delay:r=0,duration:s=300,repeat:n=0,repeatType:l="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[t]:a};c&&(d.offset=c);const h=vN(o,s);Array.isArray(h)&&(d.easing=h);const f={delay:r,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:n+1,direction:l==="reverse"?"alternate":"normal"};return u&&(f.pseudoElement=u),e.animate(d,f)}function bN(e){return typeof e=="function"&&"applyToOptions"in e}function h3({type:e,...t}){return bN(e)&&yN()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class m3 extends ap{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:a,name:r,keyframes:s,pseudoElement:n,allowFlatten:l=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!n,this.allowFlatten=l,this.options=t,Gx(typeof t.type!="string");const u=h3(t);this.animation=f3(a,r,s,u,n),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!n){const d=tp(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):o3(a,r,d),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,a;(a=(t=this.animation).finish)==null||a.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,a;this.isPseudoElement||(a=(t=this.animation).commitStyles)==null||a.call(t)}get duration(){var a,r;const t=((r=(a=this.animation.effect)==null?void 0:a.getComputedTiming)==null?void 0:r.call(a).duration)||0;return Zr(Number(t))}get time(){return Zr(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Wr(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:a}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&c3()?(this.animation.timeline=t,br):a(this)}}const wN={anticipate:JE,backInOut:QE,circInOut:tN};function x3(e){return e in wN}function p3(e){typeof e.ease=="string"&&x3(e.ease)&&(e.ease=wN[e.ease])}const ty=10;class g3 extends m3{constructor(t){p3(t),xN(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:a,onUpdate:r,onComplete:s,element:n,...l}=this.options;if(!a)return;if(t!==void 0){a.set(t);return}const o=new rp({...l,autoplay:!1}),c=Wr(this.finishedTime??this.time);a.setWithVelocity(o.sample(c-ty).value,o.sample(c).value,ty),o.stop()}}const ay=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(xn.test(e)||e==="0")&&!e.startsWith("url("));function y3(e){const t=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==t)return!0}function v3(e,t,a,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const n=e[e.length-1],l=ay(s,t),o=ay(n,t);return!l||!o?!1:y3(e)||(a==="spring"||bN(a))&&r}function om(e){e.duration=0,e.type}const b3=new Set(["opacity","clipPath","filter","transform"]),w3=$x(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function E3(e){var d;const{motionValue:t,name:a,repeatDelay:r,repeatType:s,damping:n,type:l}=e;if(!(((d=t==null?void 0:t.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return w3()&&a&&b3.has(a)&&(a!=="transform"||!u)&&!c&&!r&&s!=="mirror"&&n!==0&&l!=="inertia"}const N3=40;class S3 extends ap{constructor({autoplay:t=!0,delay:a=0,type:r="keyframes",repeat:s=0,repeatDelay:n=0,repeatType:l="loop",keyframes:o,name:c,motionValue:u,element:d,...h}){var p;super(),this.stop=()=>{var x,v;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Ha.now();const f={autoplay:t,delay:a,type:r,repeat:s,repeatDelay:n,repeatType:l,name:c,motionValue:u,element:d,...h},m=(d==null?void 0:d.KeyframeResolver)||sp;this.keyframeResolver=new m(o,(x,v,g)=>this.onKeyframesResolved(x,v,f,!g),c,u,d),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,a,r,s){this.keyframeResolver=void 0;const{name:n,type:l,velocity:o,delay:c,isHandoff:u,onUpdate:d}=r;this.resolvedAt=Ha.now(),v3(t,n,l,o)||((ks.instantAnimations||!c)&&(d==null||d(tp(t,r,a))),t[0]=t[t.length-1],om(r),r.repeat=0);const f={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>N3?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...r,keyframes:t},m=!u&&E3(f)?new g3({...f,element:f.motionValue.owner.current}):new rp(f);m.finished.then(()=>this.notifyFinished()).catch(br),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,a){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),i3()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const T3=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function A3(e){const t=T3.exec(e);if(!t)return[,];const[,a,r,s]=t;return[`--${a??r}`,s]}function EN(e,t,a=1){const[r,s]=A3(e);if(!r)return;const n=window.getComputedStyle(t).getPropertyValue(r);if(n){const l=n.trim();return GE(l)?parseFloat(l):l}return Wx(s)?EN(s,t,a+1):s}function np(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const NN=new Set(["width","height","top","left","right","bottom",...Tl]),C3={test:e=>e==="auto",parse:e=>e},SN=e=>t=>t.test(e),TN=[Sl,Ae,Qr,Bs,y_,g_,C3],ry=e=>TN.find(SN(e));function k3(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||YE(e):!0}const j3=new Set(["brightness","contrast","saturate","opacity"]);function _3(e){const[t,a]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=a.match(Zx)||[];if(!r)return e;const s=a.replace(r,"");let n=j3.has(t)?1:0;return r!==a&&(n*=100),t+"("+n+s+")"}const R3=/\b([a-z-]*)\(.*?\)/gu,cm={...xn,getAnimatableNone:e=>{const t=e.match(R3);return t?t.map(_3).join(" "):e}},sy={...Sl,transform:Math.round},D3={rotate:Bs,rotateX:Bs,rotateY:Bs,rotateZ:Bs,scale:uu,scaleX:uu,scaleY:uu,scaleZ:uu,skew:Bs,skewX:Bs,skewY:Bs,distance:Ae,translateX:Ae,translateY:Ae,translateZ:Ae,x:Ae,y:Ae,z:Ae,perspective:Ae,transformPerspective:Ae,opacity:Jo,originX:$1,originY:$1,originZ:Ae},ip={borderWidth:Ae,borderTopWidth:Ae,borderRightWidth:Ae,borderBottomWidth:Ae,borderLeftWidth:Ae,borderRadius:Ae,radius:Ae,borderTopLeftRadius:Ae,borderTopRightRadius:Ae,borderBottomRightRadius:Ae,borderBottomLeftRadius:Ae,width:Ae,maxWidth:Ae,height:Ae,maxHeight:Ae,top:Ae,right:Ae,bottom:Ae,left:Ae,padding:Ae,paddingTop:Ae,paddingRight:Ae,paddingBottom:Ae,paddingLeft:Ae,margin:Ae,marginTop:Ae,marginRight:Ae,marginBottom:Ae,marginLeft:Ae,backgroundPositionX:Ae,backgroundPositionY:Ae,...D3,zIndex:sy,fillOpacity:Jo,strokeOpacity:Jo,numOctaves:sy},O3={...ip,color:Rt,backgroundColor:Rt,outlineColor:Rt,fill:Rt,stroke:Rt,borderColor:Rt,borderTopColor:Rt,borderRightColor:Rt,borderBottomColor:Rt,borderLeftColor:Rt,filter:cm,WebkitFilter:cm},AN=e=>O3[e];function CN(e,t){let a=AN(e);return a!==cm&&(a=xn),a.getAnimatableNone?a.getAnimatableNone(t):void 0}const F3=new Set(["auto","none","0"]);function L3(e,t,a){let r=0,s;for(;r<e.length&&!s;){const n=e[r];typeof n=="string"&&!F3.has(n)&&ec(n).values.length&&(s=e[r]),r++}if(s&&a)for(const n of t)e[n]=CN(a,s)}class M3 extends sp{constructor(t,a,r,s,n){super(t,a,r,s,n,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:a,name:r}=this;if(!a||!a.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),Wx(u))){const d=EN(u,a.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!NN.has(r)||t.length!==2)return;const[s,n]=t,l=ry(s),o=ry(n);if(l!==o)if(J1(l)&&J1(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else $n[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:a}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||k3(t[s]))&&r.push(s);r.length&&L3(t,r,a)}measureInitialState(){const{element:t,unresolvedKeyframes:a,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$n[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a[0]=this.measuredOrigin;const s=a[a.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:a,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(a);s&&s.jump(this.measuredOrigin,!1);const n=r.length-1,l=r[n];r[n]=$n[a](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([c,u])=>{t.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function U3(e,t,a){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;t&&(r=t.current);const s=(a==null?void 0:a[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const kN=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function jN(e){return $E(e)&&"offsetHeight"in e}const ny=30,B3=e=>!isNaN(parseFloat(e));class I3{constructor(t,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var n;const s=Ha.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((n=this.events.change)==null||n.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=a.owner}setCurrent(t){this.current=t,this.updatedAt=Ha.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=B3(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,a){this.events[t]||(this.events[t]=new Yx);const r=this.events[t].add(a);return t==="change"?()=>{r(),dt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,a){this.passiveEffect=t,this.stopPassiveEffect=a}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,a,r){this.set(a),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,a=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ha.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>ny)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,ny);return qE(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(t){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=t(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,a;(t=this.dependents)==null||t.clear(),(a=this.events.destroy)==null||a.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function fl(e,t){return new I3(e,t)}const{schedule:lp,cancel:bz}=sN(queueMicrotask,!1),jr={x:!1,y:!1};function _N(){return jr.x||jr.y}function P3(e){return e==="x"||e==="y"?jr[e]?null:(jr[e]=!0,()=>{jr[e]=!1}):jr.x||jr.y?null:(jr.x=jr.y=!0,()=>{jr.x=jr.y=!1})}function RN(e,t){const a=U3(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[a,s,()=>r.abort()]}function iy(e){return!(e.pointerType==="touch"||_N())}function V3(e,t,a={}){const[r,s,n]=RN(e,a),l=o=>{if(!iy(o))return;const{target:c}=o,u=t(c,o);if(typeof u!="function"||!c)return;const d=h=>{iy(h)&&(u(h),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,s)};return r.forEach(o=>{o.addEventListener("pointerenter",l,s)}),n}const DN=(e,t)=>t?e===t?!0:DN(e,t.parentElement):!1,op=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,z3=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function H3(e){return z3.has(e.tagName)||e.tabIndex!==-1}const Vu=new WeakSet;function ly(e){return t=>{t.key==="Enter"&&e(t)}}function Cf(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const G3=(e,t)=>{const a=e.currentTarget;if(!a)return;const r=ly(()=>{if(Vu.has(a))return;Cf(a,"down");const s=ly(()=>{Cf(a,"up")}),n=()=>Cf(a,"cancel");a.addEventListener("keyup",s,t),a.addEventListener("blur",n,t)});a.addEventListener("keydown",r,t),a.addEventListener("blur",()=>a.removeEventListener("keydown",r),t)};function oy(e){return op(e)&&!_N()}function $3(e,t,a={}){const[r,s,n]=RN(e,a),l=o=>{const c=o.currentTarget;if(!oy(o))return;Vu.add(c);const u=t(c,o),d=(m,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),Vu.has(c)&&Vu.delete(c),oy(m)&&typeof u=="function"&&u(m,{success:p})},h=m=>{d(m,c===window||c===document||a.useGlobalTarget||DN(c,m.target))},f=m=>{d(m,!1)};window.addEventListener("pointerup",h,s),window.addEventListener("pointercancel",f,s)};return r.forEach(o=>{(a.useGlobalTarget?window:o).addEventListener("pointerdown",l,s),jN(o)&&(o.addEventListener("focus",u=>G3(u,s)),!H3(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),n}function ON(e){return $E(e)&&"ownerSVGElement"in e}function Y3(e){return ON(e)&&e.tagName==="svg"}const ga=e=>!!(e&&e.getVelocity),q3=[...TN,Rt,xn],X3=e=>q3.find(SN(e)),cp=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class K3 extends E.Component{getSnapshotBeforeUpdate(t){const a=this.props.childRef.current;if(a&&t.isPresent&&!this.props.isPresent){const r=a.offsetParent,s=jN(r)&&r.offsetWidth||0,n=this.props.sizeRef.current;n.height=a.offsetHeight||0,n.width=a.offsetWidth||0,n.top=a.offsetTop,n.left=a.offsetLeft,n.right=s-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function W3({children:e,isPresent:t,anchorX:a,root:r}){const s=E.useId(),n=E.useRef(null),l=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=E.useContext(cp);return E.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:h,right:f}=l.current;if(t||!n.current||!c||!u)return;const m=a==="left"?`left: ${h}`:`right: ${f}`;n.current.dataset.motionPopId=s;const p=document.createElement("style");o&&(p.nonce=o);const x=r??document.head;return x.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${m}px !important;
            top: ${d}px !important;
          }
        `),()=>{x.contains(p)&&x.removeChild(p)}},[t]),i.jsx(K3,{isPresent:t,childRef:n,sizeRef:l,children:E.cloneElement(e,{ref:n})})}const Z3=({children:e,initial:t,isPresent:a,onExitComplete:r,custom:s,presenceAffectsLayout:n,mode:l,anchorX:o,root:c})=>{const u=Px(Q3),d=E.useId();let h=!0,f=E.useMemo(()=>(h=!1,{id:d,initial:t,isPresent:a,custom:s,onExitComplete:m=>{u.set(m,!0);for(const p of u.values())if(!p)return;r&&r()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[a,u,r]);return n&&h&&(f={...f}),E.useMemo(()=>{u.forEach((m,p)=>u.set(p,!1))},[a]),E.useEffect(()=>{!a&&!u.size&&r&&r()},[a]),l==="popLayout"&&(e=i.jsx(W3,{isPresent:a,anchorX:o,root:c,children:e})),i.jsx(yd.Provider,{value:f,children:e})};function Q3(){return new Map}function FN(e=!0){const t=E.useContext(yd);if(t===null)return[!0,null];const{isPresent:a,onExitComplete:r,register:s}=t,n=E.useId();E.useEffect(()=>{if(e)return s(n)},[e]);const l=E.useCallback(()=>e&&r&&r(n),[n,r,e]);return!a&&r?[!1,l]:[!0]}const du=e=>e.key||"";function cy(e){const t=[];return E.Children.forEach(e,a=>{E.isValidElement(a)&&t.push(a)}),t}const Jn=({children:e,custom:t,initial:a=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:n="sync",propagate:l=!1,anchorX:o="left",root:c})=>{const[u,d]=FN(l),h=E.useMemo(()=>cy(e),[e]),f=l&&!u?[]:h.map(du),m=E.useRef(!0),p=E.useRef(h),x=Px(()=>new Map),[v,g]=E.useState(h),[b,y]=E.useState(h);HE(()=>{m.current=!1,p.current=h;for(let A=0;A<b.length;A++){const S=du(b[A]);f.includes(S)?x.delete(S):x.get(S)!==!0&&x.set(S,!1)}},[b,f.length,f.join("-")]);const w=[];if(h!==v){let A=[...h];for(let S=0;S<b.length;S++){const C=b[S],T=du(C);f.includes(T)||(A.splice(S,0,C),w.push(C))}return n==="wait"&&w.length&&(A=w),y(cy(A)),g(h),null}const{forceRender:N}=E.useContext(Ix);return i.jsx(i.Fragment,{children:b.map(A=>{const S=du(A),C=l&&!u?!1:h===b||f.includes(S),T=()=>{if(x.has(S))x.set(S,!0);else return;let D=!0;x.forEach(R=>{R||(D=!1)}),D&&(N==null||N(),y(p.current),l&&(d==null||d()),r&&r())};return i.jsx(Z3,{isPresent:C,initial:!m.current||a?void 0:!1,custom:t,presenceAffectsLayout:s,mode:n,root:c,onExitComplete:C?void 0:T,anchorX:o,children:A},S)})})},LN=E.createContext({strict:!1}),uy={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},hl={};for(const e in uy)hl[e]={isEnabled:t=>uy[e].some(a=>!!t[a])};function J3(e){for(const t in e)hl[t]={...hl[t],...e[t]}}const eR=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function R0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||eR.has(e)}let MN=e=>!R0(e);function tR(e){typeof e=="function"&&(MN=t=>t.startsWith("on")?!R0(t):e(t))}try{tR(require("@emotion/is-prop-valid").default)}catch{}function aR(e,t,a){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(MN(s)||a===!0&&R0(s)||!t&&!R0(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}const vd=E.createContext({});function bd(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function tc(e){return typeof e=="string"||Array.isArray(e)}const up=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dp=["initial",...up];function wd(e){return bd(e.animate)||dp.some(t=>tc(e[t]))}function UN(e){return!!(wd(e)||e.variants)}function rR(e,t){if(wd(e)){const{initial:a,animate:r}=e;return{initial:a===!1||tc(a)?a:void 0,animate:tc(r)?r:void 0}}return e.inherit!==!1?t:{}}function sR(e){const{initial:t,animate:a}=rR(e,E.useContext(vd));return E.useMemo(()=>({initial:t,animate:a}),[dy(t),dy(a)])}function dy(e){return Array.isArray(e)?e.join(" "):e}const ac={};function nR(e){for(const t in e)ac[t]=e[t],Kx(t)&&(ac[t].isCSSVariable=!0)}function BN(e,{layout:t,layoutId:a}){return Al.has(e)||e.startsWith("origin")||(t||a!==void 0)&&(!!ac[e]||e==="opacity")}const iR={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lR=Tl.length;function oR(e,t,a){let r="",s=!0;for(let n=0;n<lR;n++){const l=Tl[n],o=e[l];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(l.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||a){const u=kN(o,ip[l]);if(!c){s=!1;const d=iR[l]||l;r+=`${d}(${u}) `}a&&(t[l]=u)}}return r=r.trim(),a?r=a(t,s?"":r):s&&(r="none"),r}function fp(e,t,a){const{style:r,vars:s,transformOrigin:n}=e;let l=!1,o=!1;for(const c in t){const u=t[c];if(Al.has(c)){l=!0;continue}else if(Kx(c)){s[c]=u;continue}else{const d=kN(u,ip[c]);c.startsWith("origin")?(o=!0,n[c]=d):r[c]=d}}if(t.transform||(l||a?r.transform=oR(t,e.transform,a):r.transform&&(r.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=n;r.transformOrigin=`${c} ${u} ${d}`}}const hp=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function IN(e,t,a){for(const r in t)!ga(t[r])&&!BN(r,a)&&(e[r]=t[r])}function cR({transformTemplate:e},t){return E.useMemo(()=>{const a=hp();return fp(a,t,e),Object.assign({},a.vars,a.style)},[t])}function uR(e,t){const a=e.style||{},r={};return IN(r,a,e),Object.assign(r,cR(e,t)),r}function dR(e,t){const a={},r=uR(e,t);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=r,a}const fR={offset:"stroke-dashoffset",array:"stroke-dasharray"},hR={offset:"strokeDashoffset",array:"strokeDasharray"};function mR(e,t,a=1,r=0,s=!0){e.pathLength=1;const n=s?fR:hR;e[n.offset]=Ae.transform(-r);const l=Ae.transform(t),o=Ae.transform(a);e[n.array]=`${l} ${o}`}function PN(e,{attrX:t,attrY:a,attrScale:r,pathLength:s,pathSpacing:n=1,pathOffset:l=0,...o},c,u,d){if(fp(e,o,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:f}=e;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete h.transformBox),t!==void 0&&(h.x=t),a!==void 0&&(h.y=a),r!==void 0&&(h.scale=r),s!==void 0&&mR(h,s,n,l,!1)}const VN=()=>({...hp(),attrs:{}}),zN=e=>typeof e=="string"&&e.toLowerCase()==="svg";function xR(e,t,a,r){const s=E.useMemo(()=>{const n=VN();return PN(n,t,zN(r),e.transformTemplate,e.style),{...n.attrs,style:{...n.style}}},[t]);if(e.style){const n={};IN(n,e.style,e),s.style={...n,...s.style}}return s}const pR=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function mp(e){return typeof e!="string"||e.includes("-")?!1:!!(pR.indexOf(e)>-1||/[A-Z]/u.test(e))}function gR(e,t,a,{latestValues:r},s,n=!1){const o=(mp(e)?xR:dR)(t,r,s,e),c=aR(t,typeof e=="string",n),u=e!==E.Fragment?{...c,...o,ref:a}:{},{children:d}=t,h=E.useMemo(()=>ga(d)?d.get():d,[d]);return E.createElement(e,{...u,children:h})}function fy(e){const t=[{},{}];return e==null||e.values.forEach((a,r)=>{t[0][r]=a.get(),t[1][r]=a.getVelocity()}),t}function xp(e,t,a,r){if(typeof t=="function"){const[s,n]=fy(r);t=t(a!==void 0?a:e.custom,s,n)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,n]=fy(r);t=t(a!==void 0?a:e.custom,s,n)}return t}function zu(e){return ga(e)?e.get():e}function yR({scrapeMotionValuesFromProps:e,createRenderState:t},a,r,s){return{latestValues:vR(a,r,s,e),renderState:t()}}function vR(e,t,a,r){const s={},n=r(e,{});for(const f in n)s[f]=zu(n[f]);let{initial:l,animate:o}=e;const c=wd(e),u=UN(e);t&&u&&!c&&e.inherit!==!1&&(l===void 0&&(l=t.initial),o===void 0&&(o=t.animate));let d=a?a.initial===!1:!1;d=d||l===!1;const h=d?o:l;if(h&&typeof h!="boolean"&&!bd(h)){const f=Array.isArray(h)?h:[h];for(let m=0;m<f.length;m++){const p=xp(e,f[m]);if(p){const{transitionEnd:x,transition:v,...g}=p;for(const b in g){let y=g[b];if(Array.isArray(y)){const w=d?y.length-1:0;y=y[w]}y!==null&&(s[b]=y)}for(const b in x)s[b]=x[b]}}}return s}const HN=e=>(t,a)=>{const r=E.useContext(vd),s=E.useContext(yd),n=()=>yR(e,t,r,s);return a?n():Px(n)};function pp(e,t,a){var n;const{style:r}=e,s={};for(const l in r)(ga(r[l])||t.style&&ga(t.style[l])||BN(l,e)||((n=a==null?void 0:a.getValue(l))==null?void 0:n.liveStyle)!==void 0)&&(s[l]=r[l]);return s}const bR=HN({scrapeMotionValuesFromProps:pp,createRenderState:hp});function GN(e,t,a){const r=pp(e,t,a);for(const s in e)if(ga(e[s])||ga(t[s])){const n=Tl.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[n]=e[s]}return r}const wR=HN({scrapeMotionValuesFromProps:GN,createRenderState:VN}),ER=Symbol.for("motionComponentSymbol");function Ii(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function NR(e,t,a){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),a&&(typeof a=="function"?a(r):Ii(a)&&(a.current=r))},[t])}const gp=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),SR="framerAppearId",$N="data-"+gp(SR),YN=E.createContext({});function TR(e,t,a,r,s){var x,v;const{visualElement:n}=E.useContext(vd),l=E.useContext(LN),o=E.useContext(yd),c=E.useContext(cp).reducedMotion,u=E.useRef(null);r=r||l.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:n,props:a,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,h=E.useContext(YN);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&AR(u.current,a,s,h);const f=E.useRef(!1);E.useInsertionEffect(()=>{d&&f.current&&d.update(a,o)});const m=a[$N],p=E.useRef(!!m&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return HE(()=>{d&&(f.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),p.current&&d.animationState&&d.animationState.animateChanges())}),E.useEffect(()=>{d&&(!p.current&&d.animationState&&d.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)==null||g.call(window,m)}),p.current=!1))}),d}function AR(e,t,a,r){const{layoutId:s,layout:n,drag:l,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new a(e.latestValues,t["data-framer-portal-id"]?void 0:qN(e.parent)),e.projection.setOptions({layoutId:s,layout:n,alwaysMeasureLayout:!!l||o&&Ii(o),visualElement:e,animationType:typeof n=="string"?n:"both",initialPromotionConfig:r,crossfade:d,layoutScroll:c,layoutRoot:u})}function qN(e){if(e)return e.options.allowProjection!==!1?e.projection:qN(e.parent)}function kf(e,{forwardMotionProps:t=!1}={},a,r){a&&J3(a);const s=mp(e)?wR:bR;function n(o,c){let u;const d={...E.useContext(cp),...o,layoutId:CR(o)},{isStatic:h}=d,f=sR(o),m=s(o,h);if(!h&&Vx){kR();const p=jR(d);u=p.MeasureLayout,f.visualElement=TR(e,m,d,r,p.ProjectionNode)}return i.jsxs(vd.Provider,{value:f,children:[u&&f.visualElement?i.jsx(u,{visualElement:f.visualElement,...d}):null,gR(e,o,NR(m,f.visualElement,c),m,h,t)]})}n.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const l=E.forwardRef(n);return l[ER]=e,l}function CR({layoutId:e}){const t=E.useContext(Ix).id;return t&&e!==void 0?t+"-"+e:e}function kR(e,t){E.useContext(LN).strict}function jR(e){const{drag:t,layout:a}=hl;if(!t&&!a)return{};const r={...t,...a};return{MeasureLayout:t!=null&&t.isEnabled(e)||a!=null&&a.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function _R(e,t){if(typeof Proxy>"u")return kf;const a=new Map,r=(n,l)=>kf(n,l,e,t),s=(n,l)=>r(n,l);return new Proxy(s,{get:(n,l)=>l==="create"?r:(a.has(l)||a.set(l,kf(l,void 0,e,t)),a.get(l))})}function XN({top:e,left:t,right:a,bottom:r}){return{x:{min:t,max:a},y:{min:e,max:r}}}function RR({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function DR(e,t){if(!t)return e;const a=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:r.y,right:r.x}}function jf(e){return e===void 0||e===1}function um({scale:e,scaleX:t,scaleY:a}){return!jf(e)||!jf(t)||!jf(a)}function _n(e){return um(e)||KN(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function KN(e){return hy(e.x)||hy(e.y)}function hy(e){return e&&e!=="0%"}function D0(e,t,a){const r=e-a,s=t*r;return a+s}function my(e,t,a,r,s){return s!==void 0&&(e=D0(e,s,r)),D0(e,a,r)+t}function dm(e,t=0,a=1,r,s){e.min=my(e.min,t,a,r,s),e.max=my(e.max,t,a,r,s)}function WN(e,{x:t,y:a}){dm(e.x,t.translate,t.scale,t.originPoint),dm(e.y,a.translate,a.scale,a.originPoint)}const xy=.999999999999,py=1.0000000000001;function OR(e,t,a,r=!1){const s=a.length;if(!s)return;t.x=t.y=1;let n,l;for(let o=0;o<s;o++){n=a[o],l=n.projectionDelta;const{visualElement:c}=n.options;c&&c.props.style&&c.props.style.display==="contents"||(r&&n.options.layoutScroll&&n.scroll&&n!==n.root&&Vi(e,{x:-n.scroll.offset.x,y:-n.scroll.offset.y}),l&&(t.x*=l.x.scale,t.y*=l.y.scale,WN(e,l)),r&&_n(n.latestValues)&&Vi(e,n.latestValues))}t.x<py&&t.x>xy&&(t.x=1),t.y<py&&t.y>xy&&(t.y=1)}function Pi(e,t){e.min=e.min+t,e.max=e.max+t}function gy(e,t,a,r,s=.5){const n=pt(e.min,e.max,s);dm(e,t,a,n,r)}function Vi(e,t){gy(e.x,t.x,t.scaleX,t.scale,t.originX),gy(e.y,t.y,t.scaleY,t.scale,t.originY)}function ZN(e,t){return XN(DR(e.getBoundingClientRect(),t))}function FR(e,t,a){const r=ZN(e,a),{scroll:s}=t;return s&&(Pi(r.x,s.offset.x),Pi(r.y,s.offset.y)),r}const yy=()=>({translate:0,scale:1,origin:0,originPoint:0}),zi=()=>({x:yy(),y:yy()}),vy=()=>({min:0,max:0}),Tt=()=>({x:vy(),y:vy()}),fm={current:null},QN={current:!1};function LR(){if(QN.current=!0,!!Vx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>fm.current=e.matches;e.addEventListener("change",t),t()}else fm.current=!1}const MR=new WeakMap;function UR(e,t,a){for(const r in t){const s=t[r],n=a[r];if(ga(s))e.addValue(r,s);else if(ga(n))e.addValue(r,fl(s,{owner:e}));else if(n!==s)if(e.hasValue(r)){const l=e.getValue(r);l.liveStyle===!0?l.jump(s):l.hasAnimated||l.set(s)}else{const l=e.getStaticValue(r);e.addValue(r,fl(l!==void 0?l:s,{owner:e}))}}for(const r in a)t[r]===void 0&&e.removeValue(r);return t}const by=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class BR{scrapeMotionValuesFromProps(t,a,r){return{}}constructor({parent:t,props:a,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:n,visualState:l},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=sp,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Ha.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,dt.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=l;this.latestValues=c,this.baseTarget={...c},this.initialValues=a.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=a,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!n,this.isControllingVariants=wd(a),this.isVariantNode=UN(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(a,{},this);for(const f in h){const m=h[f];c[f]!==void 0&&ga(m)&&m.set(c[f])}}mount(t){this.current=t,MR.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,r)=>this.bindToMotionValue(r,a)),QN.current||LR(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:fm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),mn(this.notifyUpdate),mn(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const a=this.features[t];a&&(a.unmount(),a.isMounted=!1)}this.current=null}bindToMotionValue(t,a){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Al.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=a.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&dt.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let n;window.MotionCheckAppearSync&&(n=window.MotionCheckAppearSync(this,t,a)),this.valueSubscriptions.set(t,()=>{s(),n&&n(),a.owner&&a.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in hl){const a=hl[t];if(!a)continue;const{isEnabled:r,Feature:s}=a;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const n=this.features[t];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Tt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,a){this.latestValues[t]=a}update(t,a){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let r=0;r<by.length;r++){const s=by[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const n="on"+s,l=t[n];l&&(this.propEventSubscriptions[s]=this.on(s,l))}this.prevMotionValues=UR(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(t),()=>a.variantChildren.delete(t)}addValue(t,a){const r=this.values.get(t);a!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,a),this.values.set(t,a),this.latestValues[t]=a.get())}removeValue(t){this.values.delete(t);const a=this.valueSubscriptions.get(t);a&&(a(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,a){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&a!==void 0&&(r=fl(a===null?void 0:a,{owner:this}),this.addValue(t,r)),r}readValue(t,a){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(GE(r)||YE(r))?r=parseFloat(r):!X3(r)&&xn.test(a)&&(r=CN(t,a)),this.setBaseTarget(t,ga(r)?r.get():r)),ga(r)?r.get():r}setBaseTarget(t,a){this.baseTarget[t]=a}getBaseTarget(t){var n;const{initial:a}=this.props;let r;if(typeof a=="string"||typeof a=="object"){const l=xp(this.props,a,(n=this.presenceContext)==null?void 0:n.custom);l&&(r=l[t])}if(a&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!ga(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,a){return this.events[t]||(this.events[t]=new Yx),this.events[t].add(a)}notify(t,...a){this.events[t]&&this.events[t].notify(...a)}scheduleRenderMicrotask(){lp.render(this.render)}}class JN extends BR{constructor(){super(...arguments),this.KeyframeResolver=M3}sortInstanceNodePosition(t,a){return t.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(t,a){return t.style?t.style[a]:void 0}removeValueFromRenderState(t,{vars:a,style:r}){delete a[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ga(t)&&(this.childSubscription=t.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function eS(e,{style:t,vars:a},r,s){const n=e.style;let l;for(l in t)n[l]=t[l];s==null||s.applyProjectionStyles(n,r);for(l in a)n.setProperty(l,a[l])}function IR(e){return window.getComputedStyle(e)}class PR extends JN{constructor(){super(...arguments),this.type="html",this.renderInstance=eS}readValueFromInstance(t,a){var r;if(Al.has(a))return(r=this.projection)!=null&&r.isProjecting?rm(a):t3(t,a);{const s=IR(t),n=(Kx(a)?s.getPropertyValue(a):s[a])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:a}){return ZN(t,a)}build(t,a,r){fp(t,a,r.transformTemplate)}scrapeMotionValuesFromProps(t,a,r){return pp(t,a,r)}}const tS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function VR(e,t,a,r){eS(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(tS.has(s)?s:gp(s),t.attrs[s])}class zR extends JN{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Tt}getBaseTargetFromProps(t,a){return t[a]}readValueFromInstance(t,a){if(Al.has(a)){const r=AN(a);return r&&r.default||0}return a=tS.has(a)?a:gp(a),t.getAttribute(a)}scrapeMotionValuesFromProps(t,a,r){return GN(t,a,r)}build(t,a,r){PN(t,a,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,a,r,s){VR(t,a,r,s)}mount(t){this.isSVGTag=zN(t.tagName),super.mount(t)}}const HR=(e,t)=>mp(e)?new zR(t):new PR(t,{allowProjection:e!==E.Fragment});function rc(e,t,a){const r=e.getProps();return xp(r,t,a!==void 0?a:r.custom,e)}const hm=e=>Array.isArray(e);function GR(e,t,a){e.hasValue(t)?e.getValue(t).set(a):e.addValue(t,fl(a))}function $R(e){return hm(e)?e[e.length-1]||0:e}function YR(e,t){const a=rc(e,t);let{transitionEnd:r={},transition:s={},...n}=a||{};n={...n,...r};for(const l in n){const o=$R(n[l]);GR(e,l,o)}}function qR(e){return!!(ga(e)&&e.add)}function mm(e,t){const a=e.getValue("willChange");if(qR(a))return a.add(t);if(!a&&ks.WillChange){const r=new ks.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function aS(e){return e.props[$N]}const XR=e=>e!==null;function KR(e,{repeat:t,repeatType:a="loop"},r){const s=e.filter(XR),n=t&&a!=="loop"&&t%2===1?0:s.length-1;return!n||r===void 0?s[n]:r}const WR={type:"spring",stiffness:500,damping:25,restSpeed:10},ZR=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),QR={type:"keyframes",duration:.8},JR={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},eD=(e,{keyframes:t})=>t.length>2?QR:Al.has(e)?e.startsWith("scale")?ZR(t[1]):WR:JR;function tD({when:e,delay:t,delayChildren:a,staggerChildren:r,staggerDirection:s,repeat:n,repeatType:l,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const yp=(e,t,a,r={},s,n)=>l=>{const o=np(r,e)||{},c=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-Wr(c);const d={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:f=>{t.set(f),o.onUpdate&&o.onUpdate(f)},onComplete:()=>{l(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:n?void 0:s};tD(o)||Object.assign(d,eD(e,d)),d.duration&&(d.duration=Wr(d.duration)),d.repeatDelay&&(d.repeatDelay=Wr(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let h=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(om(d),d.delay===0&&(h=!0)),(ks.instantAnimations||ks.skipAnimations)&&(h=!0,om(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,h&&!n&&t.get()!==void 0){const f=KR(d.keyframes,o);if(f!==void 0){dt.update(()=>{d.onUpdate(f),d.onComplete()});return}}return o.isSync?new rp(d):new S3(d)};function aD({protectedKeys:e,needsAnimating:t},a){const r=e.hasOwnProperty(a)&&t[a]!==!0;return t[a]=!1,r}function rS(e,t,{delay:a=0,transitionOverride:r,type:s}={}){let{transition:n=e.getDefaultTransition(),transitionEnd:l,...o}=t;r&&(n=r);const c=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const d in o){const h=e.getValue(d,e.latestValues[d]??null),f=o[d];if(f===void 0||u&&aD(u,d))continue;const m={delay:a,...np(n||{},d)},p=h.get();if(p!==void 0&&!h.isAnimating&&!Array.isArray(f)&&f===p&&!m.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const g=aS(e);if(g){const b=window.MotionHandoffAnimation(g,d,dt);b!==null&&(m.startTime=b,x=!0)}}mm(e,d),h.start(yp(d,h,f,e.shouldReduceMotion&&NN.has(d)?{type:!1}:m,e,x));const v=h.animation;v&&c.push(v)}return l&&Promise.all(c).then(()=>{dt.update(()=>{l&&YR(e,l)})}),c}function xm(e,t,a={}){var c;const r=rc(e,t,a.type==="exit"?(c=e.presenceContext)==null?void 0:c.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};a.transitionOverride&&(s=a.transitionOverride);const n=r?()=>Promise.all(rS(e,r,a)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:f}=s;return rD(e,t,u,d,h,f,a)}:()=>Promise.resolve(),{when:o}=s;if(o){const[u,d]=o==="beforeChildren"?[n,l]:[l,n];return u().then(()=>d())}else return Promise.all([n(),l(a.delay)])}function rD(e,t,a=0,r=0,s=0,n=1,l){const o=[],c=e.variantChildren.size,u=(c-1)*s,d=typeof r=="function",h=d?f=>r(f,c):n===1?(f=0)=>f*s:(f=0)=>u-f*s;return Array.from(e.variantChildren).sort(sD).forEach((f,m)=>{f.notify("AnimationStart",t),o.push(xm(f,t,{...l,delay:a+(d?0:r)+h(m)}).then(()=>f.notify("AnimationComplete",t)))}),Promise.all(o)}function sD(e,t){return e.sortNodePosition(t)}function nD(e,t,a={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(n=>xm(e,n,a));r=Promise.all(s)}else if(typeof t=="string")r=xm(e,t,a);else{const s=typeof t=="function"?rc(e,t,a.custom):t;r=Promise.all(rS(e,s,a))}return r.then(()=>{e.notify("AnimationComplete",t)})}function sS(e,t){if(!Array.isArray(t))return!1;const a=t.length;if(a!==e.length)return!1;for(let r=0;r<a;r++)if(t[r]!==e[r])return!1;return!0}const iD=dp.length;function nS(e){if(!e)return;if(!e.isControllingVariants){const a=e.parent?nS(e.parent)||{}:{};return e.props.initial!==void 0&&(a.initial=e.props.initial),a}const t={};for(let a=0;a<iD;a++){const r=dp[a],s=e.props[r];(tc(s)||s===!1)&&(t[r]=s)}return t}const lD=[...up].reverse(),oD=up.length;function cD(e){return t=>Promise.all(t.map(({animation:a,options:r})=>nD(e,a,r)))}function uD(e){let t=cD(e),a=wy(),r=!0;const s=c=>(u,d)=>{var f;const h=rc(e,d,c==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(h){const{transition:m,transitionEnd:p,...x}=h;u={...u,...x,...p}}return u};function n(c){t=c(e)}function l(c){const{props:u}=e,d=nS(e.parent)||{},h=[],f=new Set;let m={},p=1/0;for(let v=0;v<oD;v++){const g=lD[v],b=a[g],y=u[g]!==void 0?u[g]:d[g],w=tc(y),N=g===c?b.isActive:null;N===!1&&(p=v);let A=y===d[g]&&y!==u[g]&&w;if(A&&r&&e.manuallyAnimateOnMount&&(A=!1),b.protectedKeys={...m},!b.isActive&&N===null||!y&&!b.prevProp||bd(y)||typeof y=="boolean")continue;const S=dD(b.prevProp,y);let C=S||g===c&&b.isActive&&!A&&w||v>p&&w,T=!1;const D=Array.isArray(y)?y:[y];let R=D.reduce(s(g),{});N===!1&&(R={});const{prevResolvedValues:j={}}=b,B={...j,...R},X=q=>{C=!0,f.has(q)&&(T=!0,f.delete(q)),b.needsAnimating[q]=!0;const te=e.getValue(q);te&&(te.liveStyle=!1)};for(const q in B){const te=R[q],H=j[q];if(m.hasOwnProperty(q))continue;let le=!1;hm(te)&&hm(H)?le=!sS(te,H):le=te!==H,le?te!=null?X(q):f.add(q):te!==void 0&&f.has(q)?X(q):b.protectedKeys[q]=!0}b.prevProp=y,b.prevResolvedValues=R,b.isActive&&(m={...m,...R}),r&&e.blockInitialAnimation&&(C=!1),C&&(!(A&&S)||T)&&h.push(...D.map(q=>({animation:q,options:{type:g}})))}if(f.size){const v={};if(typeof u.initial!="boolean"){const g=rc(e,Array.isArray(u.initial)?u.initial[0]:u.initial);g&&g.transition&&(v.transition=g.transition)}f.forEach(g=>{const b=e.getBaseTarget(g),y=e.getValue(g);y&&(y.liveStyle=!0),v[g]=b??null}),h.push({animation:v})}let x=!!h.length;return r&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(x=!1),r=!1,x?t(h):Promise.resolve()}function o(c,u){var h;if(a[c].isActive===u)return Promise.resolve();(h=e.variantChildren)==null||h.forEach(f=>{var m;return(m=f.animationState)==null?void 0:m.setActive(c,u)}),a[c].isActive=u;const d=l(c);for(const f in a)a[f].protectedKeys={};return d}return{animateChanges:l,setActive:o,setAnimateFunction:n,getState:()=>a,reset:()=>{a=wy(),r=!0}}}function dD(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!sS(t,e):!1}function Tn(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function wy(){return{animate:Tn(!0),whileInView:Tn(),whileHover:Tn(),whileTap:Tn(),whileDrag:Tn(),whileFocus:Tn(),exit:Tn()}}class wn{constructor(t){this.isMounted=!1,this.node=t}update(){}}class fD extends wn{constructor(t){super(t),t.animationState||(t.animationState=uD(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();bd(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:a}=this.node.prevProps||{};t!==a&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let hD=0;class mD extends wn{constructor(){super(...arguments),this.id=hD++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:a}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);a&&!t&&s.then(()=>{a(this.id)})}mount(){const{register:t,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const xD={animation:{Feature:fD},exit:{Feature:mD}};function sc(e,t,a,r={passive:!0}){return e.addEventListener(t,a,r),()=>e.removeEventListener(t,a)}function Oc(e){return{point:{x:e.pageX,y:e.pageY}}}const pD=e=>t=>op(t)&&e(t,Oc(t));function To(e,t,a,r){return sc(e,t,pD(a),r)}const iS=1e-4,gD=1-iS,yD=1+iS,lS=.01,vD=0-lS,bD=0+lS;function _a(e){return e.max-e.min}function wD(e,t,a){return Math.abs(e-t)<=a}function Ey(e,t,a,r=.5){e.origin=r,e.originPoint=pt(t.min,t.max,e.origin),e.scale=_a(a)/_a(t),e.translate=pt(a.min,a.max,e.origin)-e.originPoint,(e.scale>=gD&&e.scale<=yD||isNaN(e.scale))&&(e.scale=1),(e.translate>=vD&&e.translate<=bD||isNaN(e.translate))&&(e.translate=0)}function Ao(e,t,a,r){Ey(e.x,t.x,a.x,r?r.originX:void 0),Ey(e.y,t.y,a.y,r?r.originY:void 0)}function Ny(e,t,a){e.min=a.min+t.min,e.max=e.min+_a(t)}function ED(e,t,a){Ny(e.x,t.x,a.x),Ny(e.y,t.y,a.y)}function Sy(e,t,a){e.min=t.min-a.min,e.max=e.min+_a(t)}function Co(e,t,a){Sy(e.x,t.x,a.x),Sy(e.y,t.y,a.y)}function dr(e){return[e("x"),e("y")]}const oS=({current:e})=>e?e.ownerDocument.defaultView:null,Ty=(e,t)=>Math.abs(e-t);function ND(e,t){const a=Ty(e.x,t.x),r=Ty(e.y,t.y);return Math.sqrt(a**2+r**2)}class cS{constructor(t,a,{transformPagePoint:r,contextWindow:s=window,dragSnapToOrigin:n=!1,distanceThreshold:l=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Rf(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,p=ND(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!p)return;const{point:x}=f,{timestamp:v}=ea;this.history.push({...x,timestamp:v});const{onStart:g,onMove:b}=this.handlers;m||(g&&g(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=_f(m,this.transformPagePoint),dt.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:p,onSessionEnd:x,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=Rf(f.type==="pointercancel"?this.lastMoveEventInfo:_f(m,this.transformPagePoint),this.history);this.startEvent&&p&&p(f,g),x&&x(f,g)},!op(t))return;this.dragSnapToOrigin=n,this.handlers=a,this.transformPagePoint=r,this.distanceThreshold=l,this.contextWindow=s||window;const o=Oc(t),c=_f(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=ea;this.history=[{...u,timestamp:d}];const{onSessionStart:h}=a;h&&h(t,Rf(c,this.history)),this.removeListeners=_c(To(this.contextWindow,"pointermove",this.handlePointerMove),To(this.contextWindow,"pointerup",this.handlePointerUp),To(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),mn(this.updatePoint)}}function _f(e,t){return t?{point:t(e.point)}:e}function Ay(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Rf({point:e},t){return{point:e,delta:Ay(e,uS(t)),offset:Ay(e,SD(t)),velocity:TD(t,.1)}}function SD(e){return e[0]}function uS(e){return e[e.length-1]}function TD(e,t){if(e.length<2)return{x:0,y:0};let a=e.length-1,r=null;const s=uS(e);for(;a>=0&&(r=e[a],!(s.timestamp-r.timestamp>Wr(t)));)a--;if(!r)return{x:0,y:0};const n=Zr(s.timestamp-r.timestamp);if(n===0)return{x:0,y:0};const l={x:(s.x-r.x)/n,y:(s.y-r.y)/n};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function AD(e,{min:t,max:a},r){return t!==void 0&&e<t?e=r?pt(t,e,r.min):Math.max(e,t):a!==void 0&&e>a&&(e=r?pt(a,e,r.max):Math.min(e,a)),e}function Cy(e,t,a){return{min:t!==void 0?e.min+t:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function CD(e,{top:t,left:a,bottom:r,right:s}){return{x:Cy(e.x,a,s),y:Cy(e.y,t,r)}}function ky(e,t){let a=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([a,r]=[r,a]),{min:a,max:r}}function kD(e,t){return{x:ky(e.x,t.x),y:ky(e.y,t.y)}}function jD(e,t){let a=.5;const r=_a(e),s=_a(t);return s>r?a=Qo(t.min,t.max-r,e.min):r>s&&(a=Qo(e.min,e.max-s,t.min)),Cs(0,1,a)}function _D(e,t){const a={};return t.min!==void 0&&(a.min=t.min-e.min),t.max!==void 0&&(a.max=t.max-e.min),a}const pm=.35;function RD(e=pm){return e===!1?e=0:e===!0&&(e=pm),{x:jy(e,"left","right"),y:jy(e,"top","bottom")}}function jy(e,t,a){return{min:_y(e,t),max:_y(e,a)}}function _y(e,t){return typeof e=="number"?e:e[t]||0}const DD=new WeakMap;class OD{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Tt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:a=!1,distanceThreshold:r}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const n=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(Oc(h).point)},l=(h,f)=>{const{drag:m,dragPropagation:p,onDragStart:x}=this.getProps();if(m&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=P3(m),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),dr(g=>{let b=this.getAxisMotionValue(g).get()||0;if(Qr.test(b)){const{projection:y}=this.visualElement;if(y&&y.layout){const w=y.layout.layoutBox[g];w&&(b=_a(w)*(parseFloat(b)/100))}}this.originPoint[g]=b}),x&&dt.postRender(()=>x(h,f)),mm(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},o=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:m,dragDirectionLock:p,onDirectionLock:x,onDrag:v}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:g}=f;if(p&&this.currentDirection===null){this.currentDirection=FD(g),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,g),this.updateAxis("y",f.point,g),this.visualElement.render(),v&&v(h,f)},c=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>dr(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)==null?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new cS(t,{onSessionStart:n,onStart:l,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:r,contextWindow:oS(this.visualElement)})}stop(t,a){const r=t||this.latestPointerEvent,s=a||this.latestPanInfo,n=this.isDragging;if(this.cancel(),!n||!s||!r)return;const{velocity:l}=s;this.startAnimation(l);const{onDragEnd:o}=this.getProps();o&&dt.postRender(()=>o(r,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:a}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(t,a,r){const{drag:s}=this.getProps();if(!r||!fu(t,s,this.currentDirection))return;const n=this.getAxisMotionValue(t);let l=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(l=AD(l,this.constraints[t],this.elastic[t])),n.set(l)}resolveConstraints(){var n;const{dragConstraints:t,dragElastic:a}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(n=this.visualElement.projection)==null?void 0:n.layout,s=this.constraints;t&&Ii(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=CD(r.layoutBox,t):this.constraints=!1,this.elastic=RD(a),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&dr(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=_D(r.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:a}=this.getProps();if(!t||!Ii(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const n=FR(r,s.root,this.visualElement.getTransformPagePoint());let l=kD(s.layout.layoutBox,n);if(a){const o=a(RR(l));this.hasMutatedConstraints=!!o,o&&(l=XN(o))}return l}startAnimation(t){const{drag:a,dragMomentum:r,dragElastic:s,dragTransition:n,dragSnapToOrigin:l,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=dr(d=>{if(!fu(d,a,this.currentDirection))return;let h=c&&c[d]||{};l&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,p={type:"inertia",velocity:r?t[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...n,...h};return this.startAxisValueAnimation(d,p)});return Promise.all(u).then(o)}startAxisValueAnimation(t,a){const r=this.getAxisMotionValue(t);return mm(this.visualElement,t),r.start(yp(t,r,0,a,this.visualElement,!1))}stopAnimation(){dr(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){dr(t=>{var a;return(a=this.getAxisMotionValue(t).animation)==null?void 0:a.pause()})}getAnimationState(t){var a;return(a=this.getAxisMotionValue(t).animation)==null?void 0:a.state}getAxisMotionValue(t){const a=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[a];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){dr(a=>{const{drag:r}=this.getProps();if(!fu(a,r,this.currentDirection))return;const{projection:s}=this.visualElement,n=this.getAxisMotionValue(a);if(s&&s.layout){const{min:l,max:o}=s.layout.layoutBox[a];n.set(t[a]-pt(l,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:a}=this.getProps(),{projection:r}=this.visualElement;if(!Ii(a)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};dr(l=>{const o=this.getAxisMotionValue(l);if(o&&this.constraints!==!1){const c=o.get();s[l]=jD({min:c,max:c},this.constraints[l])}});const{transformTemplate:n}=this.visualElement.getProps();this.visualElement.current.style.transform=n?n({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),dr(l=>{if(!fu(l,t,null))return;const o=this.getAxisMotionValue(l),{min:c,max:u}=this.constraints[l];o.set(pt(c,u,s[l]))})}addListeners(){if(!this.visualElement.current)return;DD.set(this.visualElement,this);const t=this.visualElement.current,a=To(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();Ii(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,n=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),dt.read(r);const l=sc(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(dr(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{l(),a(),n(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:n=!1,dragElastic:l=pm,dragMomentum:o=!0}=t;return{...t,drag:a,dragDirectionLock:r,dragPropagation:s,dragConstraints:n,dragElastic:l,dragMomentum:o}}}function fu(e,t,a){return(t===!0||t===e)&&(a===null||a===e)}function FD(e,t=10){let a=null;return Math.abs(e.y)>t?a="y":Math.abs(e.x)>t&&(a="x"),a}class LD extends wn{constructor(t){super(t),this.removeGroupControls=br,this.removeListeners=br,this.controls=new OD(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||br}unmount(){this.removeGroupControls(),this.removeListeners()}}const Ry=e=>(t,a)=>{e&&dt.postRender(()=>e(t,a))};class MD extends wn{constructor(){super(...arguments),this.removePointerDownListener=br}onPointerDown(t){this.session=new cS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:a,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:Ry(t),onStart:Ry(a),onMove:r,onEnd:(n,l)=>{delete this.session,s&&dt.postRender(()=>s(n,l))}}}mount(){this.removePointerDownListener=To(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Hu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Dy(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const $l={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ae.test(e))e=parseFloat(e);else return e;const a=Dy(e,t.target.x),r=Dy(e,t.target.y);return`${a}% ${r}%`}},UD={correct:(e,{treeScale:t,projectionDelta:a})=>{const r=e,s=xn.parse(e);if(s.length>5)return r;const n=xn.createTransformer(e),l=typeof s[0]!="number"?1:0,o=a.x.scale*t.x,c=a.y.scale*t.y;s[0+l]/=o,s[1+l]/=c;const u=pt(o,c,.5);return typeof s[2+l]=="number"&&(s[2+l]/=u),typeof s[3+l]=="number"&&(s[3+l]/=u),n(s)}};let Oy=!1;class BD extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:a,switchLayoutGroup:r,layoutId:s}=this.props,{projection:n}=t;nR(ID),n&&(a.group&&a.group.add(n),r&&r.register&&s&&r.register(n),Oy&&n.root.didUpdate(),n.addEventListener("animationComplete",()=>{this.safeToRemove()}),n.setOptions({...n.options,onExitComplete:()=>this.safeToRemove()})),Hu.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:a,visualElement:r,drag:s,isPresent:n}=this.props,{projection:l}=r;return l&&(l.isPresent=n,Oy=!0,s||t.layoutDependency!==a||a===void 0||t.isPresent!==n?l.willUpdate():this.safeToRemove(),t.isPresent!==n&&(n?l.promote():l.relegate()||dt.postRender(()=>{const o=l.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),lp.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:a,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function dS(e){const[t,a]=FN(),r=E.useContext(Ix);return i.jsx(BD,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(YN),isPresent:t,safeToRemove:a})}const ID={borderRadius:{...$l,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$l,borderTopRightRadius:$l,borderBottomLeftRadius:$l,borderBottomRightRadius:$l,boxShadow:UD};function PD(e,t,a){const r=ga(e)?e:fl(e);return r.start(yp("",r,t,a)),r.animation}const VD=(e,t)=>e.depth-t.depth;class zD{constructor(){this.children=[],this.isDirty=!1}add(t){zx(this.children,t),this.isDirty=!0}remove(t){Hx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(VD),this.isDirty=!1,this.children.forEach(t)}}function HD(e,t){const a=Ha.now(),r=({timestamp:s})=>{const n=s-a;n>=t&&(mn(r),e(n-t))};return dt.setup(r,!0),()=>mn(r)}const fS=["TopLeft","TopRight","BottomLeft","BottomRight"],GD=fS.length,Fy=e=>typeof e=="string"?parseFloat(e):e,Ly=e=>typeof e=="number"||Ae.test(e);function $D(e,t,a,r,s,n){s?(e.opacity=pt(0,a.opacity??1,YD(r)),e.opacityExit=pt(t.opacity??1,0,qD(r))):n&&(e.opacity=pt(t.opacity??1,a.opacity??1,r));for(let l=0;l<GD;l++){const o=`border${fS[l]}Radius`;let c=My(t,o),u=My(a,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||Ly(c)===Ly(u)?(e[o]=Math.max(pt(Fy(c),Fy(u),r),0),(Qr.test(u)||Qr.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||a.rotate)&&(e.rotate=pt(t.rotate||0,a.rotate||0,r))}function My(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const YD=hS(0,.5,eN),qD=hS(.5,.95,br);function hS(e,t,a){return r=>r<e?0:r>t?1:a(Qo(e,t,r))}function Uy(e,t){e.min=t.min,e.max=t.max}function or(e,t){Uy(e.x,t.x),Uy(e.y,t.y)}function By(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Iy(e,t,a,r,s){return e-=t,e=D0(e,1/a,r),s!==void 0&&(e=D0(e,1/s,r)),e}function XD(e,t=0,a=1,r=.5,s,n=e,l=e){if(Qr.test(t)&&(t=parseFloat(t),t=pt(l.min,l.max,t/100)-l.min),typeof t!="number")return;let o=pt(n.min,n.max,r);e===n&&(o-=t),e.min=Iy(e.min,t,a,o,s),e.max=Iy(e.max,t,a,o,s)}function Py(e,t,[a,r,s],n,l){XD(e,t[a],t[r],t[s],t.scale,n,l)}const KD=["x","scaleX","originX"],WD=["y","scaleY","originY"];function Vy(e,t,a,r){Py(e.x,t,KD,a?a.x:void 0,r?r.x:void 0),Py(e.y,t,WD,a?a.y:void 0,r?r.y:void 0)}function zy(e){return e.translate===0&&e.scale===1}function mS(e){return zy(e.x)&&zy(e.y)}function Hy(e,t){return e.min===t.min&&e.max===t.max}function ZD(e,t){return Hy(e.x,t.x)&&Hy(e.y,t.y)}function Gy(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function xS(e,t){return Gy(e.x,t.x)&&Gy(e.y,t.y)}function $y(e){return _a(e.x)/_a(e.y)}function Yy(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class QD{constructor(){this.members=[]}add(t){zx(this.members,t),t.scheduleRender()}remove(t){if(Hx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(t){const a=this.members.findIndex(s=>t===s);if(a===0)return!1;let r;for(let s=a;s>=0;s--){const n=this.members[s];if(n.isPresent!==!1){r=n;break}}return r?(this.promote(r),!0):!1}promote(t,a){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,a&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:a,resumingFrom:r}=t;a.onExitComplete&&a.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function JD(e,t,a){let r="";const s=e.x.translate/t.x,n=e.y.translate/t.y,l=(a==null?void 0:a.z)||0;if((s||n||l)&&(r=`translate3d(${s}px, ${n}px, ${l}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),a){const{transformPerspective:u,rotate:d,rotateX:h,rotateY:f,skewX:m,skewY:p}=a;u&&(r=`perspective(${u}px) ${r}`),d&&(r+=`rotate(${d}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),m&&(r+=`skewX(${m}deg) `),p&&(r+=`skewY(${p}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(r+=`scale(${o}, ${c})`),r||"none"}const Df=["","X","Y","Z"],e6=1e3;let t6=0;function Of(e,t,a,r){const{latestValues:s}=t;s[e]&&(a[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function pS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const a=aS(t);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:s,layoutId:n}=e.options;window.MotionCancelOptimisedAnimation(a,"transform",dt,!(s||n))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&pS(r)}function gS({attachResizeListener:e,defaultParent:t,measureScroll:a,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(l={},o=t==null?void 0:t()){this.id=t6++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(s6),this.nodes.forEach(o6),this.nodes.forEach(c6),this.nodes.forEach(n6)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new zD)}addEventListener(l,o){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new Yx),this.eventHandlers.get(l).add(o)}notifyListeners(l,...o){const c=this.eventHandlers.get(l);c&&c.notify(...o)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=ON(l)&&!Y3(l),this.instance=l;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let d,h=0;const f=()=>this.root.updateBlockedByResize=!1;dt.read(()=>{h=window.innerWidth}),e(l,()=>{const m=window.innerWidth;m!==h&&(h=m,this.root.updateBlockedByResize=!0,d&&d(),d=HD(f,250),Hu.hasAnimatedSinceResize&&(Hu.hasAnimatedSinceResize=!1,this.nodes.forEach(Ky)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||m6,{onLayoutAnimationStart:x,onLayoutAnimationComplete:v}=u.getProps(),g=!this.targetLayout||!xS(this.targetLayout,m),b=!h&&f;if(this.options.layoutRoot||this.resumeFrom||b||h&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...np(p,"layout"),onPlay:x,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,b)}else h||Ky(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),mn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(u6),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&pS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(qy);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Xy);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(l6),this.nodes.forEach(a6),this.nodes.forEach(r6)):this.nodes.forEach(Xy),this.clearAllSnapshots();const o=Ha.now();ea.delta=Cs(0,1e3/60,o-ea.timestamp),ea.timestamp=o,ea.isProcessing=!0,Ef.update.process(ea),Ef.preRender.process(ea),Ef.render.process(ea),ea.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lp.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(i6),this.sharedNodes.forEach(d6)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,dt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){dt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_a(this.snapshot.measuredBox.x)&&!_a(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Tt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(o=!1),o&&this.instance){const c=r(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:c,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!mS(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;l&&this.instance&&(o||_n(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return l&&(c=this.removeTransform(c)),x6(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:l}=this.options;if(!l)return Tt();const o=l.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(p6))){const{scroll:d}=this.root;d&&(Pi(o.x,d.offset.x),Pi(o.y,d.offset.y))}return o}removeElementScroll(l){var c;const o=Tt();if(or(o,l),(c=this.scroll)!=null&&c.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:h,options:f}=d;d!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&or(o,l),Pi(o.x,h.offset.x),Pi(o.y,h.offset.y))}return o}applyTransform(l,o=!1){const c=Tt();or(c,l);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Vi(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),_n(d.latestValues)&&Vi(c,d.latestValues)}return _n(this.latestValues)&&Vi(c,this.latestValues),c}removeTransform(l){const o=Tt();or(o,l);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!_n(u.latestValues))continue;um(u.latestValues)&&u.updateSnapshot();const d=Tt(),h=u.measurePageBox();or(d,h),Vy(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return _n(this.latestValues)&&Vy(o,this.latestValues),o}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ea.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var f;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(l||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=ea.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tt(),this.relativeTargetOrigin=Tt(),Co(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),or(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Tt(),this.targetWithTransforms=Tt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ED(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):or(this.target,this.layout.layoutBox),WN(this.target,this.targetDelta)):or(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Tt(),this.relativeTargetOrigin=Tt(),Co(this.relativeTargetOrigin,this.target,m.target),or(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||um(this.parent.latestValues)||KN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const l=this.getLead(),o=!!this.resumingFrom||this!==l;let c=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ea.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;or(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;OR(this.layoutCorrected,this.treeScale,this.path,o),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Tt());const{target:m}=l;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(By(this.prevProjectionDelta.x,this.projectionDelta.x),By(this.prevProjectionDelta.y,this.projectionDelta.y)),Ao(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!Yy(this.projectionDelta.x,this.prevProjectionDelta.x)||!Yy(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),l){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=zi(),this.projectionDelta=zi(),this.projectionDeltaWithTransform=zi()}setAnimationOrigin(l,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=zi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const f=Tt(),m=c?c.source:void 0,p=this.layout?this.layout.source:void 0,x=m!==p,v=this.getStack(),g=!v||v.members.length<=1,b=!!(x&&!g&&this.options.crossfade===!0&&!this.path.some(h6));this.animationProgress=0;let y;this.mixTargetDelta=w=>{const N=w/1e3;Wy(h.x,l.x,N),Wy(h.y,l.y,N),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Co(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),f6(this.relativeTarget,this.relativeTargetOrigin,f,N),y&&ZD(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=Tt()),or(y,this.relativeTarget)),x&&(this.animationValues=d,$D(d,u,this.latestValues,N,b,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var o,c,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(mn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=dt.update(()=>{Hu.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=fl(0)),this.currentAnimation=PD(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),l.onUpdate&&l.onUpdate(d)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(e6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=l;if(!(!o||!c||!u)){if(this!==l&&this.layout&&u&&yS(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Tt();const h=_a(this.layout.layoutBox.x);c.x.min=l.target.x.min,c.x.max=c.x.min+h;const f=_a(this.layout.layoutBox.y);c.y.min=l.target.y.min,c.y.max=c.y.min+f}or(o,c),Vi(o,d),Ao(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(l,o){this.sharedNodes.has(l)||this.sharedNodes.set(l,new QD),this.sharedNodes.get(l).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),l&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let o=!1;const{latestValues:c}=l;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&Of("z",l,u,this.animationValues);for(let d=0;d<Df.length;d++)Of(`rotate${Df[d]}`,l,u,this.animationValues),Of(`skew${Df[d]}`,l,u,this.animationValues);l.render();for(const d in u)l.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);l.scheduleRender()}applyProjectionStyles(l,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=zu(o==null?void 0:o.pointerEvents)||"",l.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=zu(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!_n(this.latestValues)&&(l.transform=c?c({},""):"none",this.hasProjected=!1);return}l.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let h=JD(this.projectionDeltaWithTransform,this.treeScale,d);c&&(h=c(d,h)),l.transform=h;const{x:f,y:m}=this.projectionDelta;l.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,u.animationValues?l.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:l.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const p in ac){if(d[p]===void 0)continue;const{correct:x,applyTo:v,isCSSVariable:g}=ac[p],b=h==="none"?d[p]:x(d[p],u);if(v){const y=v.length;for(let w=0;w<y;w++)l[v[w]]=b}else g?this.options.visualElement.renderState.vars[p]=b:l[p]=b}this.options.layoutId&&(l.pointerEvents=u===this?zu(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var o;return(o=l.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(qy),this.root.sharedNodes.clear()}}}function a6(e){e.updateLayout()}function r6(e){var a;const t=((a=e.resumeFrom)==null?void 0:a.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:n}=e.options,l=t.source!==e.layout.source;n==="size"?dr(h=>{const f=l?t.measuredBox[h]:t.layoutBox[h],m=_a(f);f.min=r[h].min,f.max=f.min+m}):yS(n,t.layoutBox,r)&&dr(h=>{const f=l?t.measuredBox[h]:t.layoutBox[h],m=_a(r[h]);f.max=f.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+m)});const o=zi();Ao(o,r,t.layoutBox);const c=zi();l?Ao(c,e.applyTransform(s,!0),t.measuredBox):Ao(c,r,t.layoutBox);const u=!mS(o);let d=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const p=Tt();Co(p,t.layoutBox,f.layoutBox);const x=Tt();Co(x,r,m.layoutBox),xS(p,x)||(d=!0),h.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function s6(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function n6(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function i6(e){e.clearSnapshot()}function qy(e){e.clearMeasurements()}function Xy(e){e.isLayoutDirty=!1}function l6(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Ky(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function o6(e){e.resolveTargetDelta()}function c6(e){e.calcProjection()}function u6(e){e.resetSkewAndRotation()}function d6(e){e.removeLeadSnapshot()}function Wy(e,t,a){e.translate=pt(t.translate,0,a),e.scale=pt(t.scale,1,a),e.origin=t.origin,e.originPoint=t.originPoint}function Zy(e,t,a,r){e.min=pt(t.min,a.min,r),e.max=pt(t.max,a.max,r)}function f6(e,t,a,r){Zy(e.x,t.x,a.x,r),Zy(e.y,t.y,a.y,r)}function h6(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const m6={duration:.45,ease:[.4,0,.1,1]},Qy=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Jy=Qy("applewebkit/")&&!Qy("chrome/")?Math.round:br;function ev(e){e.min=Jy(e.min),e.max=Jy(e.max)}function x6(e){ev(e.x),ev(e.y)}function yS(e,t,a){return e==="position"||e==="preserve-aspect"&&!wD($y(t),$y(a),.2)}function p6(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const g6=gS({attachResizeListener:(e,t)=>sc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ff={current:void 0},vS=gS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ff.current){const e=new g6({});e.mount(window),e.setOptions({layoutScroll:!0}),Ff.current=e}return Ff.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),y6={pan:{Feature:MD},drag:{Feature:LD,ProjectionNode:vS,MeasureLayout:dS}};function tv(e,t,a){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",a==="Start");const s="onHover"+a,n=r[s];n&&dt.postRender(()=>n(t,Oc(t)))}class v6 extends wn{mount(){const{current:t}=this.node;t&&(this.unmount=V3(t,(a,r)=>(tv(this.node,r,"Start"),s=>tv(this.node,s,"End"))))}unmount(){}}class b6 extends wn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=_c(sc(this.node.current,"focus",()=>this.onFocus()),sc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function av(e,t,a){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",a==="Start");const s="onTap"+(a==="End"?"":a),n=r[s];n&&dt.postRender(()=>n(t,Oc(t)))}class w6 extends wn{mount(){const{current:t}=this.node;t&&(this.unmount=$3(t,(a,r)=>(av(this.node,r,"Start"),(s,{success:n})=>av(this.node,s,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const gm=new WeakMap,Lf=new WeakMap,E6=e=>{const t=gm.get(e.target);t&&t(e)},N6=e=>{e.forEach(E6)};function S6({root:e,...t}){const a=e||document;Lf.has(a)||Lf.set(a,{});const r=Lf.get(a),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(N6,{root:e,...t})),r[s]}function T6(e,t,a){const r=S6(t);return gm.set(e,a),r.observe(e),()=>{gm.delete(e),r.unobserve(e)}}const A6={some:0,all:1};class C6 extends wn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:a,margin:r,amount:s="some",once:n}=t,l={root:a?a.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:A6[s]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,n&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return T6(this.node.current,l,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:a}=this.node;["amount","margin","root"].some(k6(t,a))&&this.startObserver()}unmount(){}}function k6({viewport:e={}},{viewport:t={}}={}){return a=>e[a]!==t[a]}const j6={inView:{Feature:C6},tap:{Feature:w6},focus:{Feature:b6},hover:{Feature:v6}},_6={layout:{ProjectionNode:vS,MeasureLayout:dS}},R6={...xD,...j6,...y6,..._6},wt=_R(R6,HR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),O6=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,a,r)=>r?r.toUpperCase():a.toLowerCase()),rv=e=>{const t=O6(e);return t.charAt(0).toUpperCase()+t.slice(1)},bS=(...e)=>e.filter((t,a,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===a).join(" ").trim(),F6=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var L6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:s="",children:n,iconNode:l,...o},c)=>E.createElement("svg",{ref:c,...L6,width:t,height:t,stroke:e,strokeWidth:r?Number(a)*24/Number(t):a,className:bS("lucide",s),...!n&&!F6(o)&&{"aria-hidden":"true"},...o},[...l.map(([u,d])=>E.createElement(u,d)),...Array.isArray(n)?n:[n]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=(e,t)=>{const a=E.forwardRef(({className:r,...s},n)=>E.createElement(M6,{ref:n,iconNode:t,className:bS(`lucide-${D6(rv(e))}`,`lucide-${e}`,r),...s}));return a.displayName=rv(e),a};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],vp=Se("arrow-down",U6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],bp=Se("arrow-left",B6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],wp=Se("arrow-up",I6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Gu=Se("bell",P6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],Fn=Se("building-2",V6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],cn=Se("building",z6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wr=Se("calendar",H6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],$6=Se("camera",G6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ym=Se("chart-column",Y6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],wS=Se("chevron-down",q6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ep=Se("chevron-left",X6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ed=Se("chevron-right",K6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ES=Se("circle-alert",W6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],vm=Se("circle-check-big",Z6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],NS=Se("circle-x",Q6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Cl=Se("clock",J6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],to=Se("crown",eO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tO=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Np=Se("download",tO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],rO=Se("ellipsis",aO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],SS=Se("eye-off",sO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ya=Se("eye",nO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],lO=Se("file-spreadsheet",iO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oO=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Mf=Se("file-text",oO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Nd=Se("funnel",cO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uO=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],TS=Se("house",uO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dO=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],fO=Se("key",dO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],mO=Se("loader-circle",hO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xO=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],AS=Se("lock",xO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pO=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],hu=Se("log-out",pO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gs=Se("mail",gO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],vO=Se("menu",yO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],$u=Se("message-circle",bO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],kl=Se("message-square",wO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EO=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],NO=Se("pen-line",EO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SO=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Jr=Se("phone",SO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],O0=Se("plus",TO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Sd=Se("refresh-cw",AO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],CS=Se("save",CO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],pn=Se("search",kO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],F0=Se("shield",jO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _O=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ya=Se("square-pen",_O);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Fc=Se("trash-2",RO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Uf=Se("trending-up",DO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],sv=Se("upload",OO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Oa=Se("user-check",FO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Lc=Se("user-minus",LO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],es=Se("user-plus",MO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],ts=Se("user-x",UO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Dr=Se("user",BO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ra=Se("users",IO);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],wa=Se("x",PO),VO="/assets/logo-1a5a98c2.png";function nv({userRole:e,activeSection:t,onSectionChange:a,companyName:r,userName:s,userRoleDisplay:n}){const[l,o]=E.useState(!1),u=(()=>{const d=[{id:"ViewDashboard",label:"Dashboard",icon:ym}],h={ADMIN:[{id:"ViewUsers",label:"Users",icon:ra},{id:"ViewLead",label:"Leads",icon:Mf},{id:"ViewProperty",label:"Property",icon:cn},{id:"ViewNotes",label:"Notes/Event",icon:wr},{id:"ViewTask",label:"Calling Data",icon:Jr},{id:"ViewAccount",label:"Account",icon:Dr},{id:"logout",label:"Log Out",icon:hu}],USER:[{id:"ViewLead",label:"Leads",icon:Mf},{id:"ViewProperty",label:"Property",icon:cn},{id:"ViewNotes",label:"Notes/Event",icon:wr},{id:"ViewTask",label:"Calling Data",icon:Jr},{id:"ViewAccount",label:"Account",icon:Dr},{id:"logout",label:"Log Out",icon:hu}],DEVELOPER:[{id:"addCompany",label:"Add Company",icon:O0},{id:"ViewCompany",label:"View Company",icon:ya},{id:"AddAdmin",label:"Add Admin / Users",icon:O0},{id:"ViewAdmins",label:"View Admin",icon:ya},{id:"ViewDirectors",label:"View Directors",icon:ya},{id:"ViewUsers",label:"View Users",icon:ya},{id:"ViewAccount",label:"Account",icon:Dr},{id:"logout",label:"Log Out",icon:hu}],DIRECTOR:[{id:"ViewAdmins",label:"Admins",icon:ra},{id:"ViewUsers",label:"Users",icon:ra},{id:"ViewLead",label:"Leads",icon:Mf},{id:"ViewProperty",label:"Property",icon:cn},{id:"ViewNotes",label:"Notes/Event",icon:wr},{id:"ViewTask",label:"Calling Data",icon:Jr},{id:"ViewAccount",label:"Account",icon:Dr},{id:"logout",label:"Log Out",icon:hu}]};return[...d,...h[e]||[]]})();return i.jsxs("aside",{className:`bg-gray-800 text-white min-h-screen transition-all duration-300 flex flex-col ${l?"w-16":"w-64"} lg:w-64`,children:[i.jsx("div",{className:"p-3 lg:p-4 border-b border-gray-700 flex-shrink-0",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("img",{src:VO,alt:"Logo",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover flex-shrink-0"}),!l&&i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("h2",{className:"text-base lg:text-lg font-semibold truncate",children:"LeadsTracker"}),i.jsx("p",{className:"text-xs text-gray-400 truncate",children:"(By Smartprocare)"})]})]})}),i.jsx("nav",{className:"flex-1 p-2 overflow-y-auto",children:i.jsx("ul",{className:"space-y-1",children:u.map(d=>{const h=d.icon,f=t===d.id;return i.jsx("li",{children:i.jsxs("button",{onClick:()=>a(d.id),className:`sidebar-button w-full flex items-center gap-3 px-3 lg:px-4 py-2.5 lg:py-2 rounded-lg hover:bg-gray-700 transition-colors duration-200 text-sm lg:text-base ${f?"bg-gray-700 font-semibold text-white":"text-gray-300 hover:text-white"} ${l?"justify-center":""}`,title:l?d.label:"",children:[i.jsx(h,{size:18,className:"lg:w-5 lg:h-5 flex-shrink-0"}),!l&&i.jsx("span",{className:"truncate",children:d.label})]})},d.id)})})}),i.jsx("div",{className:"lg:hidden p-3 border-t border-gray-700 flex-shrink-0",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-sm font-medium text-white truncate",children:s||"User"}),i.jsx("div",{className:"text-xs text-gray-400",children:e||"Role"})]})})]})}function kS(e,t){return function(){return e.apply(t,arguments)}}const{toString:zO}=Object.prototype,{getPrototypeOf:Sp}=Object,{iterator:Td,toStringTag:jS}=Symbol,Ad=(e=>t=>{const a=zO.call(t);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Ir=e=>(e=e.toLowerCase(),t=>Ad(t)===e),Cd=e=>t=>typeof t===e,{isArray:jl}=Array,nc=Cd("undefined");function Mc(e){return e!==null&&!nc(e)&&e.constructor!==null&&!nc(e.constructor)&&Ga(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _S=Ir("ArrayBuffer");function HO(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&_S(e.buffer),t}const GO=Cd("string"),Ga=Cd("function"),RS=Cd("number"),Uc=e=>e!==null&&typeof e=="object",$O=e=>e===!0||e===!1,Yu=e=>{if(Ad(e)!=="object")return!1;const t=Sp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(jS in e)&&!(Td in e)},YO=e=>{if(!Uc(e)||Mc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},qO=Ir("Date"),XO=Ir("File"),KO=Ir("Blob"),WO=Ir("FileList"),ZO=e=>Uc(e)&&Ga(e.pipe),QO=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ga(e.append)&&((t=Ad(e))==="formdata"||t==="object"&&Ga(e.toString)&&e.toString()==="[object FormData]"))},JO=Ir("URLSearchParams"),[e5,t5,a5,r5]=["ReadableStream","Request","Response","Headers"].map(Ir),s5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Bc(e,t,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),jl(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(Mc(e))return;const n=a?Object.getOwnPropertyNames(e):Object.keys(e),l=n.length;let o;for(r=0;r<l;r++)o=n[r],t.call(null,e[o],o,e)}}function DS(e,t){if(Mc(e))return null;t=t.toLowerCase();const a=Object.keys(e);let r=a.length,s;for(;r-- >0;)if(s=a[r],t===s.toLowerCase())return s;return null}const Ln=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),OS=e=>!nc(e)&&e!==Ln;function bm(){const{caseless:e}=OS(this)&&this||{},t={},a=(r,s)=>{const n=e&&DS(t,s)||s;Yu(t[n])&&Yu(r)?t[n]=bm(t[n],r):Yu(r)?t[n]=bm({},r):jl(r)?t[n]=r.slice():t[n]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Bc(arguments[r],a);return t}const n5=(e,t,a,{allOwnKeys:r}={})=>(Bc(t,(s,n)=>{a&&Ga(s)?e[n]=kS(s,a):e[n]=s},{allOwnKeys:r}),e),i5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),l5=(e,t,a,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),a&&Object.assign(e.prototype,a)},o5=(e,t,a,r)=>{let s,n,l;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),n=s.length;n-- >0;)l=s[n],(!r||r(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=a!==!1&&Sp(e)}while(e&&(!a||a(e,t))&&e!==Object.prototype);return t},c5=(e,t,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=t.length;const r=e.indexOf(t,a);return r!==-1&&r===a},u5=e=>{if(!e)return null;if(jl(e))return e;let t=e.length;if(!RS(t))return null;const a=new Array(t);for(;t-- >0;)a[t]=e[t];return a},d5=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Sp(Uint8Array)),f5=(e,t)=>{const r=(e&&e[Td]).call(e);let s;for(;(s=r.next())&&!s.done;){const n=s.value;t.call(e,n[0],n[1])}},h5=(e,t)=>{let a;const r=[];for(;(a=e.exec(t))!==null;)r.push(a);return r},m5=Ir("HTMLFormElement"),x5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,r,s){return r.toUpperCase()+s}),iv=(({hasOwnProperty:e})=>(t,a)=>e.call(t,a))(Object.prototype),p5=Ir("RegExp"),FS=(e,t)=>{const a=Object.getOwnPropertyDescriptors(e),r={};Bc(a,(s,n)=>{let l;(l=t(s,n,e))!==!1&&(r[n]=l||s)}),Object.defineProperties(e,r)},g5=e=>{FS(e,(t,a)=>{if(Ga(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const r=e[a];if(Ga(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},y5=(e,t)=>{const a={},r=s=>{s.forEach(n=>{a[n]=!0})};return jl(e)?r(e):r(String(e).split(t)),a},v5=()=>{},b5=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function w5(e){return!!(e&&Ga(e.append)&&e[jS]==="FormData"&&e[Td])}const E5=e=>{const t=new Array(10),a=(r,s)=>{if(Uc(r)){if(t.indexOf(r)>=0)return;if(Mc(r))return r;if(!("toJSON"in r)){t[s]=r;const n=jl(r)?[]:{};return Bc(r,(l,o)=>{const c=a(l,s+1);!nc(c)&&(n[o]=c)}),t[s]=void 0,n}}return r};return a(e,0)},N5=Ir("AsyncFunction"),S5=e=>e&&(Uc(e)||Ga(e))&&Ga(e.then)&&Ga(e.catch),LS=((e,t)=>e?setImmediate:t?((a,r)=>(Ln.addEventListener("message",({source:s,data:n})=>{s===Ln&&n===a&&r.length&&r.shift()()},!1),s=>{r.push(s),Ln.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Ga(Ln.postMessage)),T5=typeof queueMicrotask<"u"?queueMicrotask.bind(Ln):typeof process<"u"&&process.nextTick||LS,A5=e=>e!=null&&Ga(e[Td]),re={isArray:jl,isArrayBuffer:_S,isBuffer:Mc,isFormData:QO,isArrayBufferView:HO,isString:GO,isNumber:RS,isBoolean:$O,isObject:Uc,isPlainObject:Yu,isEmptyObject:YO,isReadableStream:e5,isRequest:t5,isResponse:a5,isHeaders:r5,isUndefined:nc,isDate:qO,isFile:XO,isBlob:KO,isRegExp:p5,isFunction:Ga,isStream:ZO,isURLSearchParams:JO,isTypedArray:d5,isFileList:WO,forEach:Bc,merge:bm,extend:n5,trim:s5,stripBOM:i5,inherits:l5,toFlatObject:o5,kindOf:Ad,kindOfTest:Ir,endsWith:c5,toArray:u5,forEachEntry:f5,matchAll:h5,isHTMLForm:m5,hasOwnProperty:iv,hasOwnProp:iv,reduceDescriptors:FS,freezeMethods:g5,toObjectSet:y5,toCamelCase:x5,noop:v5,toFiniteNumber:b5,findKey:DS,global:Ln,isContextDefined:OS,isSpecCompliantForm:w5,toJSONObject:E5,isAsyncFn:N5,isThenable:S5,setImmediate:LS,asap:T5,isIterable:A5};function Oe(e,t,a,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),a&&(this.config=a),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}re.inherits(Oe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:re.toJSONObject(this.config),code:this.code,status:this.status}}});const MS=Oe.prototype,US={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{US[e]={value:e}});Object.defineProperties(Oe,US);Object.defineProperty(MS,"isAxiosError",{value:!0});Oe.from=(e,t,a,r,s,n)=>{const l=Object.create(MS);return re.toFlatObject(e,l,function(c){return c!==Error.prototype},o=>o!=="isAxiosError"),Oe.call(l,e.message,t,a,r,s),l.cause=e,l.name=e.name,n&&Object.assign(l,n),l};const C5=null;function wm(e){return re.isPlainObject(e)||re.isArray(e)}function BS(e){return re.endsWith(e,"[]")?e.slice(0,-2):e}function lv(e,t,a){return e?e.concat(t).map(function(s,n){return s=BS(s),!a&&n?"["+s+"]":s}).join(a?".":""):t}function k5(e){return re.isArray(e)&&!e.some(wm)}const j5=re.toFlatObject(re,{},null,function(t){return/^is[A-Z]/.test(t)});function kd(e,t,a){if(!re.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,a=re.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,v){return!re.isUndefined(v[x])});const r=a.metaTokens,s=a.visitor||d,n=a.dots,l=a.indexes,c=(a.Blob||typeof Blob<"u"&&Blob)&&re.isSpecCompliantForm(t);if(!re.isFunction(s))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(re.isDate(p))return p.toISOString();if(re.isBoolean(p))return p.toString();if(!c&&re.isBlob(p))throw new Oe("Blob is not supported. Use a Buffer instead.");return re.isArrayBuffer(p)||re.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,x,v){let g=p;if(p&&!v&&typeof p=="object"){if(re.endsWith(x,"{}"))x=r?x:x.slice(0,-2),p=JSON.stringify(p);else if(re.isArray(p)&&k5(p)||(re.isFileList(p)||re.endsWith(x,"[]"))&&(g=re.toArray(p)))return x=BS(x),g.forEach(function(y,w){!(re.isUndefined(y)||y===null)&&t.append(l===!0?lv([x],w,n):l===null?x:x+"[]",u(y))}),!1}return wm(p)?!0:(t.append(lv(v,x,n),u(p)),!1)}const h=[],f=Object.assign(j5,{defaultVisitor:d,convertValue:u,isVisitable:wm});function m(p,x){if(!re.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));h.push(p),re.forEach(p,function(g,b){(!(re.isUndefined(g)||g===null)&&s.call(t,g,re.isString(b)?b.trim():b,x,f))===!0&&m(g,x?x.concat(b):[b])}),h.pop()}}if(!re.isObject(e))throw new TypeError("data must be an object");return m(e),t}function ov(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Tp(e,t){this._pairs=[],e&&kd(e,this,t)}const IS=Tp.prototype;IS.append=function(t,a){this._pairs.push([t,a])};IS.toString=function(t){const a=t?function(r){return t.call(this,r,ov)}:ov;return this._pairs.map(function(s){return a(s[0])+"="+a(s[1])},"").join("&")};function _5(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function PS(e,t,a){if(!t)return e;const r=a&&a.encode||_5;re.isFunction(a)&&(a={serialize:a});const s=a&&a.serialize;let n;if(s?n=s(t,a):n=re.isURLSearchParams(t)?t.toString():new Tp(t,a).toString(r),n){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+n}return e}class R5{constructor(){this.handlers=[]}use(t,a,r){return this.handlers.push({fulfilled:t,rejected:a,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){re.forEach(this.handlers,function(r){r!==null&&t(r)})}}const cv=R5,VS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},D5=typeof URLSearchParams<"u"?URLSearchParams:Tp,O5=typeof FormData<"u"?FormData:null,F5=typeof Blob<"u"?Blob:null,L5={isBrowser:!0,classes:{URLSearchParams:D5,FormData:O5,Blob:F5},protocols:["http","https","file","blob","url","data"]},Ap=typeof window<"u"&&typeof document<"u",Em=typeof navigator=="object"&&navigator||void 0,M5=Ap&&(!Em||["ReactNative","NativeScript","NS"].indexOf(Em.product)<0),U5=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),B5=Ap&&window.location.href||"http://localhost",I5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ap,hasStandardBrowserEnv:M5,hasStandardBrowserWebWorkerEnv:U5,navigator:Em,origin:B5},Symbol.toStringTag,{value:"Module"})),ha={...I5,...L5};function P5(e,t){return kd(e,new ha.classes.URLSearchParams,{visitor:function(a,r,s,n){return ha.isNode&&re.isBuffer(a)?(this.append(r,a.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...t})}function V5(e){return re.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function z5(e){const t={},a=Object.keys(e);let r;const s=a.length;let n;for(r=0;r<s;r++)n=a[r],t[n]=e[n];return t}function zS(e){function t(a,r,s,n){let l=a[n++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=n>=a.length;return l=!l&&re.isArray(s)?s.length:l,c?(re.hasOwnProp(s,l)?s[l]=[s[l],r]:s[l]=r,!o):((!s[l]||!re.isObject(s[l]))&&(s[l]=[]),t(a,r,s[l],n)&&re.isArray(s[l])&&(s[l]=z5(s[l])),!o)}if(re.isFormData(e)&&re.isFunction(e.entries)){const a={};return re.forEachEntry(e,(r,s)=>{t(V5(r),s,a,0)}),a}return null}function H5(e,t,a){if(re.isString(e))try{return(t||JSON.parse)(e),re.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(a||JSON.stringify)(e)}const Cp={transitional:VS,adapter:["xhr","http","fetch"],transformRequest:[function(t,a){const r=a.getContentType()||"",s=r.indexOf("application/json")>-1,n=re.isObject(t);if(n&&re.isHTMLForm(t)&&(t=new FormData(t)),re.isFormData(t))return s?JSON.stringify(zS(t)):t;if(re.isArrayBuffer(t)||re.isBuffer(t)||re.isStream(t)||re.isFile(t)||re.isBlob(t)||re.isReadableStream(t))return t;if(re.isArrayBufferView(t))return t.buffer;if(re.isURLSearchParams(t))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return P5(t,this.formSerializer).toString();if((o=re.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return kd(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return n||s?(a.setContentType("application/json",!1),H5(t)):t}],transformResponse:[function(t){const a=this.transitional||Cp.transitional,r=a&&a.forcedJSONParsing,s=this.responseType==="json";if(re.isResponse(t)||re.isReadableStream(t))return t;if(t&&re.isString(t)&&(r&&!this.responseType||s)){const l=!(a&&a.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(o){if(l)throw o.name==="SyntaxError"?Oe.from(o,Oe.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ha.classes.FormData,Blob:ha.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};re.forEach(["delete","get","head","post","put","patch"],e=>{Cp.headers[e]={}});const kp=Cp,G5=re.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$5=e=>{const t={};let a,r,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),a=l.substring(0,s).trim().toLowerCase(),r=l.substring(s+1).trim(),!(!a||t[a]&&G5[a])&&(a==="set-cookie"?t[a]?t[a].push(r):t[a]=[r]:t[a]=t[a]?t[a]+", "+r:r)}),t},uv=Symbol("internals");function Yl(e){return e&&String(e).trim().toLowerCase()}function qu(e){return e===!1||e==null?e:re.isArray(e)?e.map(qu):String(e)}function Y5(e){const t=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=a.exec(e);)t[r[1]]=r[2];return t}const q5=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Bf(e,t,a,r,s){if(re.isFunction(r))return r.call(this,t,a);if(s&&(t=a),!!re.isString(t)){if(re.isString(r))return t.indexOf(r)!==-1;if(re.isRegExp(r))return r.test(t)}}function X5(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,a,r)=>a.toUpperCase()+r)}function K5(e,t){const a=re.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+a,{value:function(s,n,l){return this[r].call(this,t,s,n,l)},configurable:!0})})}class jd{constructor(t){t&&this.set(t)}set(t,a,r){const s=this;function n(o,c,u){const d=Yl(c);if(!d)throw new Error("header name must be a non-empty string");const h=re.findKey(s,d);(!h||s[h]===void 0||u===!0||u===void 0&&s[h]!==!1)&&(s[h||c]=qu(o))}const l=(o,c)=>re.forEach(o,(u,d)=>n(u,d,c));if(re.isPlainObject(t)||t instanceof this.constructor)l(t,a);else if(re.isString(t)&&(t=t.trim())&&!q5(t))l($5(t),a);else if(re.isObject(t)&&re.isIterable(t)){let o={},c,u;for(const d of t){if(!re.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?re.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}l(o,a)}else t!=null&&n(a,t,r);return this}get(t,a){if(t=Yl(t),t){const r=re.findKey(this,t);if(r){const s=this[r];if(!a)return s;if(a===!0)return Y5(s);if(re.isFunction(a))return a.call(this,s,r);if(re.isRegExp(a))return a.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,a){if(t=Yl(t),t){const r=re.findKey(this,t);return!!(r&&this[r]!==void 0&&(!a||Bf(this,this[r],r,a)))}return!1}delete(t,a){const r=this;let s=!1;function n(l){if(l=Yl(l),l){const o=re.findKey(r,l);o&&(!a||Bf(r,r[o],o,a))&&(delete r[o],s=!0)}}return re.isArray(t)?t.forEach(n):n(t),s}clear(t){const a=Object.keys(this);let r=a.length,s=!1;for(;r--;){const n=a[r];(!t||Bf(this,this[n],n,t,!0))&&(delete this[n],s=!0)}return s}normalize(t){const a=this,r={};return re.forEach(this,(s,n)=>{const l=re.findKey(r,n);if(l){a[l]=qu(s),delete a[n];return}const o=t?X5(n):String(n).trim();o!==n&&delete a[n],a[o]=qu(s),r[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const a=Object.create(null);return re.forEach(this,(r,s)=>{r!=null&&r!==!1&&(a[s]=t&&re.isArray(r)?r.join(", "):r)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,a])=>t+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...a){const r=new this(t);return a.forEach(s=>r.set(s)),r}static accessor(t){const r=(this[uv]=this[uv]={accessors:{}}).accessors,s=this.prototype;function n(l){const o=Yl(l);r[o]||(K5(s,l),r[o]=!0)}return re.isArray(t)?t.forEach(n):n(t),this}}jd.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);re.reduceDescriptors(jd.prototype,({value:e},t)=>{let a=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[a]=r}}});re.freezeMethods(jd);const Mr=jd;function If(e,t){const a=this||kp,r=t||a,s=Mr.from(r.headers);let n=r.data;return re.forEach(e,function(o){n=o.call(a,n,s.normalize(),t?t.status:void 0)}),s.normalize(),n}function HS(e){return!!(e&&e.__CANCEL__)}function _l(e,t,a){Oe.call(this,e??"canceled",Oe.ERR_CANCELED,t,a),this.name="CanceledError"}re.inherits(_l,Oe,{__CANCEL__:!0});function GS(e,t,a){const r=a.config.validateStatus;!a.status||!r||r(a.status)?e(a):t(new Oe("Request failed with status code "+a.status,[Oe.ERR_BAD_REQUEST,Oe.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function W5(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Z5(e,t){e=e||10;const a=new Array(e),r=new Array(e);let s=0,n=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=r[n];l||(l=u),a[s]=c,r[s]=u;let h=n,f=0;for(;h!==s;)f+=a[h++],h=h%e;if(s=(s+1)%e,s===n&&(n=(n+1)%e),u-l<t)return;const m=d&&u-d;return m?Math.round(f*1e3/m):void 0}}function Q5(e,t){let a=0,r=1e3/t,s,n;const l=(u,d=Date.now())=>{a=d,s=null,n&&(clearTimeout(n),n=null),e(...u)};return[(...u)=>{const d=Date.now(),h=d-a;h>=r?l(u,d):(s=u,n||(n=setTimeout(()=>{n=null,l(s)},r-h)))},()=>s&&l(s)]}const L0=(e,t,a=3)=>{let r=0;const s=Z5(50,250);return Q5(n=>{const l=n.loaded,o=n.lengthComputable?n.total:void 0,c=l-r,u=s(c),d=l<=o;r=l;const h={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-l)/u:void 0,event:n,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},a)},dv=(e,t)=>{const a=e!=null;return[r=>t[0]({lengthComputable:a,total:e,loaded:r}),t[1]]},fv=e=>(...t)=>re.asap(()=>e(...t)),J5=ha.hasStandardBrowserEnv?((e,t)=>a=>(a=new URL(a,ha.origin),e.protocol===a.protocol&&e.host===a.host&&(t||e.port===a.port)))(new URL(ha.origin),ha.navigator&&/(msie|trident)/i.test(ha.navigator.userAgent)):()=>!0,eF=ha.hasStandardBrowserEnv?{write(e,t,a,r,s,n){const l=[e+"="+encodeURIComponent(t)];re.isNumber(a)&&l.push("expires="+new Date(a).toGMTString()),re.isString(r)&&l.push("path="+r),re.isString(s)&&l.push("domain="+s),n===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function tF(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function aF(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function $S(e,t,a){let r=!tF(t);return e&&(r||a==!1)?aF(e,t):t}const hv=e=>e instanceof Mr?{...e}:e;function ei(e,t){t=t||{};const a={};function r(u,d,h,f){return re.isPlainObject(u)&&re.isPlainObject(d)?re.merge.call({caseless:f},u,d):re.isPlainObject(d)?re.merge({},d):re.isArray(d)?d.slice():d}function s(u,d,h,f){if(re.isUndefined(d)){if(!re.isUndefined(u))return r(void 0,u,h,f)}else return r(u,d,h,f)}function n(u,d){if(!re.isUndefined(d))return r(void 0,d)}function l(u,d){if(re.isUndefined(d)){if(!re.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function o(u,d,h){if(h in t)return r(u,d);if(h in e)return r(void 0,u)}const c={url:n,method:n,data:n,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,d,h)=>s(hv(u),hv(d),h,!0)};return re.forEach(Object.keys({...e,...t}),function(d){const h=c[d]||s,f=h(e[d],t[d],d);re.isUndefined(f)&&h!==o||(a[d]=f)}),a}const YS=e=>{const t=ei({},e);let{data:a,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:n,headers:l,auth:o}=t;t.headers=l=Mr.from(l),t.url=PS($S(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let c;if(re.isFormData(a)){if(ha.hasStandardBrowserEnv||ha.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((c=l.getContentType())!==!1){const[u,...d]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...d].join("; "))}}if(ha.hasStandardBrowserEnv&&(r&&re.isFunction(r)&&(r=r(t)),r||r!==!1&&J5(t.url))){const u=s&&n&&eF.read(n);u&&l.set(s,u)}return t},rF=typeof XMLHttpRequest<"u",sF=rF&&function(e){return new Promise(function(a,r){const s=YS(e);let n=s.data;const l=Mr.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=s,d,h,f,m,p;function x(){m&&m(),p&&p(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function g(){if(!v)return;const y=Mr.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:y,config:e,request:v};GS(function(S){a(S),x()},function(S){r(S),x()},N),v=null}"onloadend"in v?v.onloadend=g:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(g)},v.onabort=function(){v&&(r(new Oe("Request aborted",Oe.ECONNABORTED,e,v)),v=null)},v.onerror=function(){r(new Oe("Network Error",Oe.ERR_NETWORK,e,v)),v=null},v.ontimeout=function(){let w=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const N=s.transitional||VS;s.timeoutErrorMessage&&(w=s.timeoutErrorMessage),r(new Oe(w,N.clarifyTimeoutError?Oe.ETIMEDOUT:Oe.ECONNABORTED,e,v)),v=null},n===void 0&&l.setContentType(null),"setRequestHeader"in v&&re.forEach(l.toJSON(),function(w,N){v.setRequestHeader(N,w)}),re.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),o&&o!=="json"&&(v.responseType=s.responseType),u&&([f,p]=L0(u,!0),v.addEventListener("progress",f)),c&&v.upload&&([h,m]=L0(c),v.upload.addEventListener("progress",h),v.upload.addEventListener("loadend",m)),(s.cancelToken||s.signal)&&(d=y=>{v&&(r(!y||y.type?new _l(null,e,v):y),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const b=W5(s.url);if(b&&ha.protocols.indexOf(b)===-1){r(new Oe("Unsupported protocol "+b+":",Oe.ERR_BAD_REQUEST,e));return}v.send(n||null)})},nF=(e,t)=>{const{length:a}=e=e?e.filter(Boolean):[];if(t||a){let r=new AbortController,s;const n=function(u){if(!s){s=!0,o();const d=u instanceof Error?u:this.reason;r.abort(d instanceof Oe?d:new _l(d instanceof Error?d.message:d))}};let l=t&&setTimeout(()=>{l=null,n(new Oe(`timeout ${t} of ms exceeded`,Oe.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(n):u.removeEventListener("abort",n)}),e=null)};e.forEach(u=>u.addEventListener("abort",n));const{signal:c}=r;return c.unsubscribe=()=>re.asap(o),c}},iF=nF,lF=function*(e,t){let a=e.byteLength;if(!t||a<t){yield e;return}let r=0,s;for(;r<a;)s=r+t,yield e.slice(r,s),r=s},oF=async function*(e,t){for await(const a of cF(e))yield*lF(a,t)},cF=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:a,value:r}=await t.read();if(a)break;yield r}}finally{await t.cancel()}},mv=(e,t,a,r)=>{const s=oF(e,t);let n=0,l,o=c=>{l||(l=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){o(),c.close();return}let h=d.byteLength;if(a){let f=n+=h;a(f)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},_d=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",qS=_d&&typeof ReadableStream=="function",uF=_d&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),XS=(e,...t)=>{try{return!!e(...t)}catch{return!1}},dF=qS&&XS(()=>{let e=!1;const t=new Request(ha.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),xv=64*1024,Nm=qS&&XS(()=>re.isReadableStream(new Response("").body)),M0={stream:Nm&&(e=>e.body)};_d&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!M0[t]&&(M0[t]=re.isFunction(e[t])?a=>a[t]():(a,r)=>{throw new Oe(`Response type '${t}' is not supported`,Oe.ERR_NOT_SUPPORT,r)})})})(new Response);const fF=async e=>{if(e==null)return 0;if(re.isBlob(e))return e.size;if(re.isSpecCompliantForm(e))return(await new Request(ha.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(re.isArrayBufferView(e)||re.isArrayBuffer(e))return e.byteLength;if(re.isURLSearchParams(e)&&(e=e+""),re.isString(e))return(await uF(e)).byteLength},hF=async(e,t)=>{const a=re.toFiniteNumber(e.getContentLength());return a??fF(t)},mF=_d&&(async e=>{let{url:t,method:a,data:r,signal:s,cancelToken:n,timeout:l,onDownloadProgress:o,onUploadProgress:c,responseType:u,headers:d,withCredentials:h="same-origin",fetchOptions:f}=YS(e);u=u?(u+"").toLowerCase():"text";let m=iF([s,n&&n.toAbortSignal()],l),p;const x=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let v;try{if(c&&dF&&a!=="get"&&a!=="head"&&(v=await hF(d,r))!==0){let N=new Request(t,{method:"POST",body:r,duplex:"half"}),A;if(re.isFormData(r)&&(A=N.headers.get("content-type"))&&d.setContentType(A),N.body){const[S,C]=dv(v,L0(fv(c)));r=mv(N.body,xv,S,C)}}re.isString(h)||(h=h?"include":"omit");const g="credentials"in Request.prototype;p=new Request(t,{...f,signal:m,method:a.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:g?h:void 0});let b=await fetch(p,f);const y=Nm&&(u==="stream"||u==="response");if(Nm&&(o||y&&x)){const N={};["status","statusText","headers"].forEach(T=>{N[T]=b[T]});const A=re.toFiniteNumber(b.headers.get("content-length")),[S,C]=o&&dv(A,L0(fv(o),!0))||[];b=new Response(mv(b.body,xv,S,()=>{C&&C(),x&&x()}),N)}u=u||"text";let w=await M0[re.findKey(M0,u)||"text"](b,e);return!y&&x&&x(),await new Promise((N,A)=>{GS(N,A,{data:w,headers:Mr.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:p})})}catch(g){throw x&&x(),g&&g.name==="TypeError"&&/Load failed|fetch/i.test(g.message)?Object.assign(new Oe("Network Error",Oe.ERR_NETWORK,e,p),{cause:g.cause||g}):Oe.from(g,g&&g.code,e,p)}}),Sm={http:C5,xhr:sF,fetch:mF};re.forEach(Sm,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const pv=e=>`- ${e}`,xF=e=>re.isFunction(e)||e===null||e===!1,KS={getAdapter:e=>{e=re.isArray(e)?e:[e];const{length:t}=e;let a,r;const s={};for(let n=0;n<t;n++){a=e[n];let l;if(r=a,!xF(a)&&(r=Sm[(l=String(a)).toLowerCase()],r===void 0))throw new Oe(`Unknown adapter '${l}'`);if(r)break;s[l||"#"+n]=r}if(!r){const n=Object.entries(s).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=t?n.length>1?`since :
`+n.map(pv).join(`
`):" "+pv(n[0]):"as no adapter specified";throw new Oe("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:Sm};function Pf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new _l(null,e)}function gv(e){return Pf(e),e.headers=Mr.from(e.headers),e.data=If.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),KS.getAdapter(e.adapter||kp.adapter)(e).then(function(r){return Pf(e),r.data=If.call(e,e.transformResponse,r),r.headers=Mr.from(r.headers),r},function(r){return HS(r)||(Pf(e),r&&r.response&&(r.response.data=If.call(e,e.transformResponse,r.response),r.response.headers=Mr.from(r.response.headers))),Promise.reject(r)})}const WS="1.11.0",Rd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Rd[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const yv={};Rd.transitional=function(t,a,r){function s(n,l){return"[Axios v"+WS+"] Transitional option '"+n+"'"+l+(r?". "+r:"")}return(n,l,o)=>{if(t===!1)throw new Oe(s(l," has been removed"+(a?" in "+a:"")),Oe.ERR_DEPRECATED);return a&&!yv[l]&&(yv[l]=!0,console.warn(s(l," has been deprecated since v"+a+" and will be removed in the near future"))),t?t(n,l,o):!0}};Rd.spelling=function(t){return(a,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function pF(e,t,a){if(typeof e!="object")throw new Oe("options must be an object",Oe.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const n=r[s],l=t[n];if(l){const o=e[n],c=o===void 0||l(o,n,e);if(c!==!0)throw new Oe("option "+n+" must be "+c,Oe.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Oe("Unknown option "+n,Oe.ERR_BAD_OPTION)}}const Xu={assertOptions:pF,validators:Rd},zr=Xu.validators;class U0{constructor(t){this.defaults=t||{},this.interceptors={request:new cv,response:new cv}}async request(t,a){try{return await this._request(t,a)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const n=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?n&&!String(r.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+n):r.stack=n}catch{}}throw r}}_request(t,a){typeof t=="string"?(a=a||{},a.url=t):a=t||{},a=ei(this.defaults,a);const{transitional:r,paramsSerializer:s,headers:n}=a;r!==void 0&&Xu.assertOptions(r,{silentJSONParsing:zr.transitional(zr.boolean),forcedJSONParsing:zr.transitional(zr.boolean),clarifyTimeoutError:zr.transitional(zr.boolean)},!1),s!=null&&(re.isFunction(s)?a.paramsSerializer={serialize:s}:Xu.assertOptions(s,{encode:zr.function,serialize:zr.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),Xu.assertOptions(a,{baseUrl:zr.spelling("baseURL"),withXsrfToken:zr.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let l=n&&re.merge(n.common,n[a.method]);n&&re.forEach(["delete","get","head","post","put","patch","common"],p=>{delete n[p]}),a.headers=Mr.concat(l,n);const o=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(a)===!1||(c=c&&x.synchronous,o.unshift(x.fulfilled,x.rejected))});const u=[];this.interceptors.response.forEach(function(x){u.push(x.fulfilled,x.rejected)});let d,h=0,f;if(!c){const p=[gv.bind(this),void 0];for(p.unshift(...o),p.push(...u),f=p.length,d=Promise.resolve(a);h<f;)d=d.then(p[h++],p[h++]);return d}f=o.length;let m=a;for(h=0;h<f;){const p=o[h++],x=o[h++];try{m=p(m)}catch(v){x.call(this,v);break}}try{d=gv.call(this,m)}catch(p){return Promise.reject(p)}for(h=0,f=u.length;h<f;)d=d.then(u[h++],u[h++]);return d}getUri(t){t=ei(this.defaults,t);const a=$S(t.baseURL,t.url,t.allowAbsoluteUrls);return PS(a,t.params,t.paramsSerializer)}}re.forEach(["delete","get","head","options"],function(t){U0.prototype[t]=function(a,r){return this.request(ei(r||{},{method:t,url:a,data:(r||{}).data}))}});re.forEach(["post","put","patch"],function(t){function a(r){return function(n,l,o){return this.request(ei(o||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:n,data:l}))}}U0.prototype[t]=a(),U0.prototype[t+"Form"]=a(!0)});const Ku=U0;class jp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(n){a=n});const r=this;this.promise.then(s=>{if(!r._listeners)return;let n=r._listeners.length;for(;n-- >0;)r._listeners[n](s);r._listeners=null}),this.promise.then=s=>{let n;const l=new Promise(o=>{r.subscribe(o),n=o}).then(s);return l.cancel=function(){r.unsubscribe(n)},l},t(function(n,l,o){r.reason||(r.reason=new _l(n,l,o),a(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const a=this._listeners.indexOf(t);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const t=new AbortController,a=r=>{t.abort(r)};return this.subscribe(a),t.signal.unsubscribe=()=>this.unsubscribe(a),t.signal}static source(){let t;return{token:new jp(function(s){t=s}),cancel:t}}}const gF=jp;function yF(e){return function(a){return e.apply(null,a)}}function vF(e){return re.isObject(e)&&e.isAxiosError===!0}const Tm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Tm).forEach(([e,t])=>{Tm[t]=e});const bF=Tm;function ZS(e){const t=new Ku(e),a=kS(Ku.prototype.request,t);return re.extend(a,Ku.prototype,t,{allOwnKeys:!0}),re.extend(a,t,null,{allOwnKeys:!0}),a.create=function(s){return ZS(ei(e,s))},a}const Lt=ZS(kp);Lt.Axios=Ku;Lt.CanceledError=_l;Lt.CancelToken=gF;Lt.isCancel=HS;Lt.VERSION=WS;Lt.toFormData=kd;Lt.AxiosError=Oe;Lt.Cancel=Lt.CanceledError;Lt.all=function(t){return Promise.all(t)};Lt.spread=yF;Lt.isAxiosError=vF;Lt.mergeConfig=ei;Lt.AxiosHeaders=Mr;Lt.formToJSON=e=>zS(re.isHTMLForm(e)?new FormData(e):e);Lt.getAdapter=KS.getAdapter;Lt.HttpStatusCode=bF;Lt.default=Lt;const wF=Lt,EF={}.VITE_API_BASE_URL||"http://localhost:8083",B0={maxRetries:3,retryDelay:1e3,rateLimit:{maxRequests:100,timeWindow:6e4}};class NF{constructor(t,a){this.maxRequests=t,this.timeWindow=a,this.requests=[]}canMakeRequest(){const t=Date.now();return this.requests=this.requests.filter(a=>t-a<this.timeWindow),this.requests.length<this.maxRequests?(this.requests.push(t),!0):!1}}const SF=new NF(B0.rateLimit.maxRequests,B0.rateLimit.timeWindow),K=wF.create({baseURL:EF,timeout:3e4,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-Client-Version":"1.0.0","X-Platform":"web"}});K.interceptors.request.use(e=>{if(!SF.canMakeRequest())return Promise.reject(new Error("Rate limit exceeded. Please try again later."));e.url&&!e.url.startsWith("https://")&&(e.url=e.url.replace("http://","https://"));const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e.headers["X-Request-Timestamp"]=Date.now().toString(),e},e=>Promise.reject(e));K.interceptors.response.use(e=>(e.data&&typeof e.data=="object"&&e.data.password&&delete e.data.password,e),e=>{var t,a,r,s,n,l,o,c;if(((t=e.response)==null?void 0:t.status)===401){const u=(r=(a=e.config)==null?void 0:a.url)==null?void 0:r.includes("/api/auth/"),d=(n=(s=e.config)==null?void 0:s.url)==null?void 0:n.includes("/followups"),h=window.location.pathname.includes("/login")||window.location.pathname==="/";if(d)return Promise.reject(e);u&&!h&&(localStorage.removeItem("token"),localStorage.removeItem("user"),sessionStorage.clear(),window.location.href="/")}return(l=e.response)==null||l.status,(o=e.response)==null||o.status,(c=e.response)==null||c.status,e.code==="NETWORK_ERROR"||e.code,Promise.reject(e)});K.interceptors.response.use(e=>e,async e=>{const{config:t}=e;if((!t||!t.retry)&&(t.retry=0),t.retry>=B0.maxRetries)return Promise.reject(e);t.retry+=1;const a=B0.retryDelay*Math.pow(2,t.retry-1);return await new Promise(r=>setTimeout(r,a)),K(t)});const J={AUTH:{LOGIN:"/api/auth/login",SEND_OTP:"/api/auth/send-otp",VERIFY_OTP:"/api/auth/verify-otp",RESET_PASSWORD_WITH_OTP:"/api/auth/reset-password-with-otp",LOGOUT:"/api/auth/logout"},USERS:{GET_USERNAME:e=>`/api/users/${e}/username`,GET_USER_ROLE:"/api/users/user-role",GET_DIRECTOR_ROLE:"/api/users/director-role",GET_ADMIN_ROLE:"/api/users/admin-role",GET_BY_ROLE:e=>`/api/users/role/${e}`,GET_ALL_BY_COMPANY:e=>`/api/users/all-users/${e}`,GET_USER_ROLE_BY_COMPANY:e=>`/api/users/user-role/${e}`,GET_ADMIN_ROLE_BY_COMPANY:e=>`/api/users/admin-role/${e}`,GET_BY_ROLE_AND_COMPANY:(e,t)=>`/api/users/role/${e}/${t}`,GET_BY_ID:e=>`/api/users/${e}`,CREATE:"/api/users",UPDATE_PROFILE:e=>`/api/users/update-profile/${e}`,DELETE:e=>`/api/users/${e}`,UPLOAD_AVATAR:e=>`/api/users/${e}/upload-avatar`,GET_AVATAR:e=>`/api/users/${e}/avatar`,GET_BY_COMPANY:e=>`/api/users/company/${e}`,LOGOUT:"/api/users/logout",REVOKE:e=>`/api/users/${e}/revoke`,UNREVOKE:e=>`/api/users/${e}/unrevoke`,GET_BY_ADMIN:e=>`/api/users/admin/${e}/users`,GET_USER_BY_ADMIN:(e,t)=>`/api/users/admin/${e}/user/${t}`,GET_ADMINS_BY_COMPANY:e=>`/api/users/company/${e}/admins`,GET_USERS_BY_COMPANY:e=>`/api/users/company/${e}/users`,ASSIGN_ADMIN:e=>`/api/users/${e}/assign-admin`,UNASSIGN_ADMIN:e=>`/api/users/${e}/unassign-admin`,COUNT_BY_ADMIN:e=>`/api/users/count-by-admin/${e}`,USERS_AND_ADMINS_OVERVIEW:(e,t)=>`/api/users/count-summary/${e}/${t}`,CHECK_SESSION:"/api/users/check-session"},COMPANIES:{ADD:"/api/companies/add",GET_ALL:"/api/companies/all",GET_MY:"/api/companies/my",UPDATE:e=>`/api/companies/update/${e}`,DELETE:e=>`/api/companies/delete/${e}`,REVOKE:e=>`/api/companies/revoke/${e}`,UNREVOKE:e=>`/api/companies/unrevoke/${e}`,GET_NAME:e=>`/api/companies/name/${e}`},CONTACT:{SEND_MESSAGE:"/api/contact"},FOLLOWUPS:{GET_ALL:e=>`/api/${e}/followups`,GET_BY_ID:(e,t)=>`/api/${e}/followups/${t}`,GET_BY_LEAD_ID:(e,t)=>`/api/${e}/followups/lead/${t}`,GET_TODAY:e=>`/api/${e}/followups/today`,CREATE:e=>`/api/${e}/followups`,UPDATE:e=>`/api/${e}/followups`,DELETE:(e,t)=>`/api/${e}/followups/${t}`},LEADS:{GET_ALL:e=>`/api/companies/${e}/leads`,GET_BY_ID:(e,t)=>`/api/companies/${e}/leads/${t}`,CREATE:e=>`/api/companies/${e}/leads`,UPDATE:(e,t)=>`/api/companies/${e}/leads/${t}`,DELETE:(e,t)=>`/api/companies/${e}/leads/${t}`,UPDATE_STATUS:(e,t)=>`/api/companies/${e}/leads/${t}/status`,GET_BY_SOURCE:(e,t)=>`/api/companies/${e}/leads/source/${t}`,GET_BY_ASSIGNED_USER:(e,t)=>`/api/companies/${e}/leads/assigned-to/${t}`,ADD_REMARK:(e,t)=>`/api/companies/${e}/leads/${t}/remarks`,GET_REMARKS:(e,t)=>`/api/companies/${e}/leads/${t}/remarks`,ASSIGN:(e,t,a)=>`/api/companies/${e}/leads/${t}/assign/${a}`,UNASSIGN:(e,t)=>`/api/companies/${e}/leads/${t}/unassign`,GET_BY_CREATED_BY:(e,t)=>`/api/companies/${e}/leads/created-by/${t}`,GET_NAME:(e,t)=>`/api/companies/${e}/leads/${t}/name`,GET_COUNT:e=>`/api/companies/${e}/leads/count`,GET_CLOSED_COUNT:e=>`/api/companies/${e}/leads/count/closed`,GET_CREATED_OR_ASSIGNED:(e,t)=>`/api/companies/${e}/leads/created-or-assigned/${t}`,COUNT_FOR_USER:(e,t)=>`/api/companies/${e}/leads/count-for-user/${t}`,SEARCH:e=>`/api/companies/${e}/leads/search`,SEARCH_CREATED_OR_ASSIGNED:(e,t)=>`/api/companies/${e}/leads/created-or-assigned/${t}/search`,SEARCH_VISIBLE_TO_ADMIN:(e,t)=>`/api/companies/${e}/leads/visible-to-admin/${t}/search`,GET_ADMIN_VISIBLE:(e,t)=>`/api/companies/${e}/leads/admin-visible/${t}`,COUNT_VISIBLE_TO_ADMIN:(e,t)=>`/api/companies/${e}/leads/count-visible-to-admin/${t}`,COUNT_CLOSED_BY_ADMIN:e=>`/api/companies/${e}/leads/count/closed-droped`,COUNT_NEW_CONTACTED:e=>`/api/companies/${e}/leads/count/new-contacted`,COUNT_DEALS_CLOSE:e=>`/api/companies/${e}/leads/count/deals-close`,COUNT_SUMMARY:(e,t)=>`/api/companies/${e}/leads/count/summary/${t}`},NOTES:{CREATE:e=>`/api/companies/${e}/notes`,GET_VISIBLE_TO_USER:(e,t)=>`/api/companies/${e}/notes/visible-to/${t}`,GET_BY_ID:(e,t)=>`/api/companies/${e}/notes/${t}`,GET_BY_USER:(e,t)=>`/api/companies/${e}/notes/user/${t}`,GET_PUBLIC:e=>`/api/companies/${e}/notes/public`,GET_PUBLIC_AND_ADMIN:e=>`/api/companies/${e}/notes/public-and-admin`,GET_DIRECTOR_VISIBLE:(e,t)=>`/api/companies/${e}/notes/director-visible/${t}`,GET_TODAY_EVENTS_ADMIN:e=>`/api/companies/${e}/notes/today-events-admin`,UPDATE:(e,t)=>`/api/companies/${e}/notes/${t}`,DELETE:(e,t)=>`/api/companies/${e}/notes/${t}`,UPDATE_STATUS:(e,t)=>`/api/companies/${e}/notes/${t}/status`,GET_BY_STATUS:(e,t)=>`/api/companies/${e}/notes/status/${t}`,GET_BY_USER_AND_STATUS:(e,t,a)=>`/api/companies/${e}/notes/user/${t}/status/${a}`,GET_BY_STATUS_ONLY:e=>`/api/companies/{companyId}/notes/status-only/${e}`,GET_BY_PRIORITY:(e,t)=>`/api/companies/${e}/notes/priority/${t}`,GET_BY_USER_AND_PRIORITY:(e,t,a)=>`/api/companies/${e}/notes/user/${t}/priority/${a}`,GET_BY_PRIORITY_AND_STATUS:(e,t,a)=>`/api/companies/${e}/notes/priority/${t}/status/${a}`,GET_BY_USER_PRIORITY_STATUS:(e,t,a,r)=>`/api/companies/${e}/notes/user/${t}/priority/${a}/status/${r}`,GET_SORTED_BY_PRIORITY_ASC:e=>`/api/companies/${e}/notes/priority/sort/asc`,GET_SORTED_BY_PRIORITY_DESC:e=>`/api/companies/${e}/notes/priority/sort/desc`,UPDATE_PRIORITY:(e,t)=>`/api/companies/${e}/notes/${t}/priority`,ADD_REMARK:(e,t)=>`/api/companies/${e}/notes/${t}/remarks`,GET_REMARKS:(e,t)=>`/api/companies/${e}/notes/${t}/remarks`,GET_VISIBLE_USERS:(e,t)=>`/api/companies/${e}/notes/${t}/visible-users`,GET_ALL_FOR_USER:(e,t)=>`/api/companies/${e}/notes/all/${t}`},NOTIFICATIONS:{GET_UNREAD_BY_USER_COMPANY:(e,t)=>`/api/notifications/user/${e}/company/${t}/unread`,GET_UNREAD_COUNT:(e,t)=>`/api/notifications/user/${e}/company/${t}/unread-count`,GET_BY_USER_COMPANY:(e,t)=>`/api/notifications/user/${e}/company/${t}`,MARK_ALL_AS_READ:(e,t)=>`/api/notifications/mark-all-as-read/user/${e}/company/${t}`,MARK_AS_READ:e=>`/api/notifications/mark-as-read/${e}`,SEND:"/api/notifications/send"},PROPERTIES:{CREATE:e=>`/api/companies/${e}/properties`,UPDATE:(e,t)=>`/api/companies/${e}/properties/${t}`,ADD_REMARK:(e,t)=>`/api/companies/${e}/properties/${t}/remarks`,GET_REMARKS:(e,t)=>`/api/companies/${e}/properties/${t}/remarks`,UPDATE_GENERAL:e=>`/api/companies/${e}/properties`,GET_PAGED:e=>`/api/companies/${e}/properties/paged`,GET_BY_ID:(e,t)=>`/api/companies/${e}/properties/${t}`,DELETE:(e,t)=>`/api/companies/${e}/properties/${t}`,GET_BY_STATUS:(e,t)=>`/api/companies/${e}/properties/status/${t}`,GET_BY_SECTOR:(e,t)=>`/api/companies/${e}/properties/sector/${t}`,GET_BY_SOURCE:(e,t)=>`/api/companies/${e}/properties/source/${t}`,SEARCH_BY_NAME:e=>`/api/companies/${e}/properties/search`,GET_BY_TYPE:(e,t)=>`/api/companies/${e}/properties/type/${t}`,GET_BY_BHK:(e,t)=>`/api/companies/${e}/properties/bhk/${t}`,GET_BY_OWNER_CONTACT:(e,t)=>`/api/companies/${e}/properties/owner-contact/${t}`,GET_BY_CREATED_BY:(e,t)=>`/api/companies/${e}/properties/created-by/${t}`,GET_NAME:(e,t)=>`/api/companies/${e}/properties/${t}/name`,GET_COUNT:e=>`/api/companies/${e}/properties/count`,GET_OVERVIEW:e=>`/api/companies/${e}/properties/overview`,COUNT_PROPERTY_OVERVIEW:e=>`/api/companies/${e}/properties/count/overview`,COUNT_BY_USER:(e,t)=>`/api/companies/${e}/properties/created-by/${t}/count`,SEARCH_PAGED:e=>`/api/companies/${e}/properties/search-paged`,COUNT_PROPERTY_OVERVIEW:e=>`/api/companies/${e}/properties/count/property-overview`},TASKS:{GET_ALL:"/api/task-files",GET_ASSIGNED:"/api/task-files/assigned",GET_ADMIN_ALL:"/api/task-files/admin-all",GET_UPLOADED:"/api/task-files/uploaded",UPLOAD:"/api/task-files/upload",ASSIGN:e=>`/api/task-files/${e}/assign`,PREVIEW:e=>`/api/task-files/${e}/preview`,DOWNLOAD:e=>`/api/task-files/${e}/download`,UPDATE_CELL:e=>`/api/task-files/${e}/update-cell`,UPDATE_STATUS:e=>`/api/task-files/${e}/status`,ADD_ROW:e=>`/api/task-files/${e}/add-row`,ADD_COLUMN:e=>`/api/task-files/${e}/add-column`,DELETE_COLUMN:e=>`/api/task-files/${e}/delete-column`,DELETE:e=>`/api/task-files/${e}`,UNDO:e=>`/api/task-files/${e}/undo`}},Ba=(e,t={})=>{const a=new URL(e,window.location.origin);return Object.keys(t).forEach(r=>{t[r]!==null&&t[r]!==void 0&&a.searchParams.append(r,t[r])}),a.pathname+a.search};class _p{static async login(t){var a,r;try{const s=await K.post(J.AUTH.LOGIN,t),n=s.data.accessToken||s.data.token,l={userId:s.data.userId,email:s.data.email,name:s.data.name,role:s.data.role,companyName:s.data.companyName,companyId:s.data.companyId,img:s.data.avatar};if(!n)return{success:!1,error:"No authentication token received from server"};if(!l.userId||!l.role)return{success:!1,error:"Incomplete user data received from server"};if(l.role!=="DEVELOPER"&&!l.companyId)return{success:!1,error:"Company information missing for user"};this.saveSession(l,n),K.defaults.headers.common.Authorization=`Bearer ${n}`;const o=localStorage.getItem(this.SESSION_KEYS.USER),c=localStorage.getItem(this.SESSION_KEYS.TOKEN);return{success:!0,data:s.data,user:l,token:n,redirectTo:"/dashboard"}}catch(s){let n="Login failed";if((a=s.response)!=null&&a.data){const l=s.response.data;n=l.message||l.error||l.msg||l.detail||l.description||(typeof l=="string"?l:"Login failed")}else s.message&&(n=s.message);if(((r=s.response)==null?void 0:r.status)===403){const l=s.response.data;if(l.message&&l.message.includes("deactivated"))return{success:!1,error:n,isDeactivated:!0,userEmail:t.email}}return{success:!1,error:n}}}static async sendOtp(t){var a,r,s,n;try{return{success:!0,data:(await K.post(J.AUTH.SEND_OTP,null,{params:{email:t}})).data,message:"OTP sent to your email"}}catch(l){return{success:!1,error:((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.error)||((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to send OTP"}}}static async verifyOtp(t,a){var r,s,n,l;try{const o=await K.post(J.AUTH.VERIFY_OTP,null,{params:{email:t,otp:a}});return{success:!0,data:o.data,valid:o.data.valid}}catch(o){return{success:!1,error:((s=(r=o.response)==null?void 0:r.data)==null?void 0:s.message)||((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.error)||"OTP verification failed"}}}static async resetPasswordWithOtp(t,a){var r,s,n,l;try{return{success:!0,data:(await K.post(J.AUTH.RESET_PASSWORD_WITH_OTP,null,{params:{email:t,newPassword:a}})).data,message:"Password reset successfully"}}catch(o){return{success:!1,error:((s=(r=o.response)==null?void 0:r.data)==null?void 0:s.message)||((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.error)||"Password reset failed"}}}static async logout(){var t,a;try{const r=await K.get(J.AUTH.LOGOUT);return this.clearSession(),{success:!0,data:r.data,message:"Logged out successfully"}}catch(r){return this.clearSession(),{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Logout failed"}}}static clearSession(){Object.values(this.SESSION_KEYS).forEach(t=>{localStorage.removeItem(t)}),delete K.defaults.headers.common.Authorization}static async checkSession(){var t,a;try{return{success:!0,data:(await K.get(J.USERS.CHECK_SESSION)).data,message:"Session active"}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Session expired"}}}static async validateToken(){var t,a;try{return{success:!0,data:(await K.get("/api/auth/validate-token")).data}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Token validation failed"}}}static getCurrentUser(){try{const t=localStorage.getItem(this.SESSION_KEYS.USER);return t?JSON.parse(t):null}catch{return null}}static getToken(){return localStorage.getItem(this.SESSION_KEYS.TOKEN)}static isAuthenticated(){const t=this.getToken(),a=this.getCurrentUser();return!!(t&&a)}static saveSession(t,a){try{if(!t||!a)return;localStorage.setItem(this.SESSION_KEYS.USER,JSON.stringify(t)),localStorage.setItem(this.SESSION_KEYS.TOKEN,a),K.defaults.headers.common.Authorization=`Bearer ${a}`}catch{}}}cg(_p,"SESSION_KEYS",{TOKEN:"token",USER:"user",CURRENT_TASK:"currentTaskId",EXCEL_STATE:"excelEditorState",LAST_ROUTE:"lastRoute"});const mu=Object.freeze(Object.defineProperty({__proto__:null,AuthService:_p},Symbol.toStringTag,{value:"Module"}));class Re{static async getUsernameById(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_USERNAME(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load username"}}}static async getUsersWithUserRole(){var t,a;try{return{success:!0,data:(await K.get(J.USERS.GET_USER_ROLE)).data}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load users"}}}static async getUsersWithDirectorRole(){var t,a;try{return{success:!0,data:(await K.get(J.USERS.GET_DIRECTOR_ROLE)).data}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load directors"}}}static async getUsersWithAdminRole(){var t,a;try{return{success:!0,data:(await K.get(J.USERS.GET_ADMIN_ROLE)).data}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to load admins"}}}static async getUsersByRole(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_BY_ROLE(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load users by role"}}}static async getAllUsersByCompany(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_ALL_BY_COMPANY(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load company users"}}}static async getUserRoleByCompany(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_USER_ROLE_BY_COMPANY(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load company users"}}}static async getAdminRoleByCompany(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_ADMIN_ROLE_BY_COMPANY(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load company admins"}}}static async getUsersByRoleAndCompany(t,a){var r,s;try{return{success:!0,data:(await K.get(J.USERS.GET_BY_ROLE_AND_COMPANY(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load users by role and company"}}}static async getUserById(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_BY_ID(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load user"}}}static async createUser(t){var a;try{return{success:!0,data:(await K.post(J.USERS.CREATE,t)).data,message:"User created successfully"}}catch(r){let s="Failed to create user";return(a=r.response)!=null&&a.data&&(typeof r.response.data=="string"?s=r.response.data:r.response.data.message?s=r.response.data.message:r.response.data.error&&(s=r.response.data.error)),{success:!1,error:s}}}static async updateProfile(t,a){var r,s,n;try{const l=await K.put(J.USERS.UPDATE_PROFILE(t),a);return l.data.newToken&&l.data.tokenUpdated&&(localStorage.setItem("token",l.data.newToken),K.defaults.headers.common.Authorization=`Bearer ${l.data.newToken}`),{success:!0,data:l.data,message:"User updated successfully"}}catch(l){return{success:!1,error:((s=(r=l.response)==null?void 0:r.data)==null?void 0:s.message)||((n=l.response)==null?void 0:n.data)||"Failed to update user"}}}static async deleteUser(t){var a,r;try{return await K.delete(J.USERS.DELETE(t)),{success:!0,message:"User deleted successfully"}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to delete user"}}}static async uploadAvatar(t,a,r){var s,n;try{const l=new FormData;return l.append("avatar",a),l.append("avatarName",r),{success:!0,data:(await K.post(J.USERS.UPLOAD_AVATAR(t),l,{headers:{"Content-Type":"multipart/form-data"}})).data,message:"Avatar uploaded successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to upload avatar"}}}static async getUserAvatar(t){try{const a=await K.get(J.USERS.GET_AVATAR(t),{responseType:"blob"});return{success:!0,data:URL.createObjectURL(a.data)}}catch{return{success:!1,error:"Failed to load avatar"}}}static async getAvatar(t){return this.getUserAvatar(t)}static async getUsersByCompany(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_BY_COMPANY(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load company users"}}}static async logout(){var t,a;try{return{success:!0,data:(await K.post(J.USERS.LOGOUT)).data,message:"Logged out successfully"}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to logout"}}}static async revokeUser(t){var a,r;try{return{success:!0,data:(await K.put(J.USERS.REVOKE(t))).data,message:"User revoked successfully"}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to revoke user"}}}static async unrevokeUser(t){var a,r;try{return{success:!0,data:(await K.put(J.USERS.UNREVOKE(t))).data,message:"User unrevoked successfully"}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to unrevoke user"}}}static async getUsersByAdmin(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_BY_ADMIN(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load admin users"}}}static async getUserByAdmin(t,a){var r,s;try{return{success:!0,data:(await K.get(J.USERS.GET_USER_BY_ADMIN(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load user"}}}static async getAdminsByCompany(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_ADMINS_BY_COMPANY(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load company admins"}}}static async getUsersByCompanyId(t){var a,r;try{return{success:!0,data:(await K.get(J.USERS.GET_USERS_BY_COMPANY(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load company users"}}}static async assignAdmin(t,a){var r,s;try{return{success:!0,data:(await K.put(J.USERS.ASSIGN_ADMIN(t),{adminId:a})).data,message:"Admin assigned successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to assign admin"}}}static async unassignAdmin(t){var a,r;try{return{success:!0,data:(await K.put(J.USERS.UNASSIGN_ADMIN(t))).data,message:"Admin unassigned successfully"}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to unassign admin"}}}static async countUsersByAdmin(t,a){var r,s;try{return{success:!0,data:(await K.get(J.USERS.COUNT_BY_ADMIN(t),{params:{companyId:a}})).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to count users"}}}static async checkSession(){var t,a;try{return{success:!0,data:(await K.get(J.USERS.CHECK_SESSION)).data}}catch(r){return{success:!1,error:((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Session expired"}}}}class Ls{static handleError(t,a){var r,s;return{success:!1,error:((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||a}}static async _request(t,a){var r;try{const s=await t();return{success:!0,data:s==null?void 0:s.data,message:((r=s==null?void 0:s.data)==null?void 0:r.message)||"Operation successful"}}catch(s){return this.handleError(s,a)}}static getAllAdmins(){return this._request(()=>K.get(J.USERS.GET_ADMIN_ROLE),"Failed to load all admins")}static getAdminRoleByCompany(t){return this._request(()=>K.get(J.USERS.GET_ADMIN_ROLE_BY_COMPANY(t)),"Failed to load admins")}static createAdmin(t){return this._request(()=>K.post(J.USERS.CREATE,{...t,role:"ADMIN"}),"Failed to create admin")}static updateAdmin(t,a){return this._request(()=>K.put(J.USERS.UPDATE_PROFILE(t),a),"Failed to update admin")}static deleteAdmin(t){return this._request(()=>K.delete(J.USERS.DELETE(t)),"Failed to delete admin")}static activateAdmin(t){return this._request(()=>K.put(J.USERS.UNREVOKE(t)),"Failed to activate admin")}static revokeAdmin(t){return this._request(()=>K.put(J.USERS.REVOKE(t)),"Failed to revoke admin")}static assignAdmin(t,a){return this._request(()=>K.put(J.USERS.ASSIGN_ADMIN(t),{adminId:a}),"Failed to assign admin")}static unassignAdmin(t){return this._request(()=>K.put(J.USERS.UNASSIGN_ADMIN(t)),"Failed to unassign admin")}static getUsersByAdmin(t){return this._request(()=>K.get(`/users/admin/${t}/users`),"Failed to load users for admin")}static getUserCountByAdmin(t,a){return this._request(()=>K.get(`/users/count-by-admin/${t}?companyId=${a}`),"Failed to get user count")}}class da{static handleError(t,a){var r,s;return{success:!1,error:((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||a}}static async _request(t,a){var r;try{const s=await t();return{success:!0,data:s==null?void 0:s.data,message:((r=s==null?void 0:s.data)==null?void 0:r.message)||"Operation successful"}}catch(s){return this.handleError(s,a)}}static getLeadsCountForUser(t,a){return this._request(()=>K.get(J.LEADS.COUNT_FOR_USER(t,a)),"Failed to load leads count")}static getLeadsCount(t){return this._request(()=>K.get(J.LEADS.GET_COUNT(t)),"Failed to load leads count")}static getClosedLeadsCount(t){return this._request(()=>K.get(J.LEADS.GET_CLOSED_COUNT(t)),"Failed to load closed leads count")}static getClosedLeadsCountByAdmin(t,a){return this._request(()=>K.get(Ba(J.LEADS.COUNT_CLOSED_BY_ADMIN(t),{adminId:a})),"Failed to load closed leads count for admin")}static async getNewContactedLeadsCount(t,a){var r;try{const s=J.LEADS.COUNT_SUMMARY(t,a),n=await K.get(s);return{success:!0,data:n==null?void 0:n.data,message:((r=n==null?void 0:n.data)==null?void 0:r.message)||"Operation successful"}}catch{return{success:!0,data:{totalLeads:0,newLeads:0,contactedLeads:0},message:"Using fallback data"}}}static async getDealsCloseCount(t,a,r){var s,n,l,o;try{let c=0,u=0;try{const h=await this.getNewContactedLeadsCount(t,a);if(h.success)c=((s=h.data)==null?void 0:s.closedLeads)||0,u=((n=h.data)==null?void 0:n.droppedLeads)||0;else if(r==="ADMIN"){const f=await this.getClosedLeadsCountByAdmin(t,a);c=f.success?f.data:0}else if(r==="USER"){const f=await this.getLeadsCountForUser(t,a);c=f.success&&((l=f.data)==null?void 0:l.closedCount)||0}else{const f=await this.getClosedLeadsCount(t);c=f.success?f.data:0}}catch{if(r==="ADMIN"){const f=await this.getClosedLeadsCountByAdmin(t,a);c=f.success?f.data:0}else if(r==="USER"){const f=await this.getLeadsCountForUser(t,a);c=f.success&&((o=f.data)==null?void 0:o.closedCount)||0}else{const f=await this.getClosedLeadsCount(t);c=f.success?f.data:0}}return{success:!0,data:{"total close":c+u,closed:c,dropped:u},message:"Operation successful"}}catch{return{success:!0,data:{"total close":0,closed:0,dropped:0},message:"Using fallback data"}}}static getPropertiesCount(t){return this._request(()=>K.get(J.PROPERTIES.GET_COUNT(t)),"Failed to load properties count")}static async getPropertiesOverview(t){var a;try{const r=J.PROPERTIES.COUNT_PROPERTY_OVERVIEW(t),s=await K.get(r);return{success:!0,data:s==null?void 0:s.data,message:((a=s==null?void 0:s.data)==null?void 0:a.message)||"Operation successful"}}catch{return{success:!0,data:{totalProperties:0,"available for sale":0,"available for rent":0,"sold out":0,"rent out":0},message:"Using fallback data"}}}static getPropertiesCountByUser(t,a){return this._request(()=>K.get(J.PROPERTIES.COUNT_BY_USER(t,a)),"Failed to load properties count for user")}static getUserNotes(t,a){return this._request(()=>K.get(J.NOTES.GET_BY_USER(t,a)),"Failed to load user notes")}static getPublicNotes(t){return this._request(()=>K.get(J.NOTES.GET_PUBLIC(t)),"Failed to load public notes")}static getNotesVisibleToUser(t,a){return this._request(()=>K.get(J.NOTES.GET_VISIBLE_TO_USER(t,a)),"Failed to load visible notes")}static getNotesVisibleToAdmin(t,a){return this._request(()=>K.get(J.NOTES.GET_PUBLIC_AND_ADMIN(t),{params:{adminId:a}}),"Failed to load admin visible notes")}static getTodayEventsForAdmin(t,a){return this._request(()=>K.get(J.NOTES.GET_TODAY_EVENTS_ADMIN(t),{params:{adminId:a}}),"Failed to load today events for admin")}static getUsernameById(t){return this._request(()=>K.get(J.USERS.GET_USERNAME(t)),"Failed to load username")}static getLeadsVisibleToAdmin(t,a){return this._request(()=>K.get(J.LEADS.GET_ADMIN_VISIBLE(t,a)),"Failed to load admin visible leads")}static async getUsersAndAdminsOverview(t,a){var r;try{const s=`/api/users/count-summary/${t}/${a}`,n=await K.get(s);return{success:!0,data:n==null?void 0:n.data,message:((r=n==null?void 0:n.data)==null?void 0:r.message)||"Operation successful"}}catch{return{success:!0,data:{totalNormalUsers:0,activeAdmins:0,totalUsers:0,totalAdmins:0,deactiveAdmins:0,deactiveNormalUsers:0,activeNormalUsers:0},message:"API not available - using fallback data"}}}static getLeadsCountVisibleToAdmin(t,a){return this._request(()=>K.get(J.LEADS.COUNT_VISIBLE_TO_ADMIN(t,a)),"Failed to load admin visible leads count")}static getTotalCompaniesCount(){return this._request(()=>K.get("/api/companies/count"),"Failed to load total companies count")}static getTotalUsersCount(){return this._request(()=>K.get("/api/users/total-count"),"Failed to load total users count")}static getTotalAdminsCount(){return this._request(()=>K.get("/api/users/admins/total-count"),"Failed to load total admins count")}static getTotalDirectorsCount(){return this._request(()=>K.get("/api/users/directors/total-count"),"Failed to load total directors count")}}class Dt{static handleError(t,a){var r,s;return{success:!1,error:((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.message)||a}}static async _request(t,a){var r;try{const s=await t();return{success:!0,data:s==null?void 0:s.data,message:((r=s==null?void 0:s.data)==null?void 0:r.message)||"Operation successful"}}catch(s){return Dt.handleError(s,a)}}static getAllCompanies(){return Dt._request(()=>K.get(J.COMPANIES.GET_ALL),"Failed to load companies")}static getMyCompany(){return Dt._request(()=>K.get(J.COMPANIES.GET_MY),"Failed to load company")}static addCompany(t){return Dt._request(()=>K.post(J.COMPANIES.ADD,t),"Failed to add company")}static updateCompany(t,a){return Dt._request(()=>K.put(J.COMPANIES.UPDATE(t),a),"Failed to update company")}static deleteCompany(t){return Dt._request(()=>K.delete(J.COMPANIES.DELETE(t)),"Failed to delete company")}static revokeCompany(t){return Dt._request(()=>K.put(J.COMPANIES.REVOKE(t)),"Failed to revoke company")}static unrevokeCompany(t){return Dt._request(()=>K.put(J.COMPANIES.UNREVOKE(t)),"Failed to activate company")}static getCompanyName(t){return Dt._request(()=>K.get(J.COMPANIES.GET_NAME(t)),"Failed to get company name")}}class Ua{static async getLeadsByCompany(t,a=0,r=10){var s,n;try{return{success:!0,data:(await K.get(J.LEADS.GET_ALL(t),{params:{page:a,size:r}})).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load leads"}}}static async getLeadById(t,a){var r,s;try{return{success:!0,data:(await K.get(J.LEADS.GET_BY_ID(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load lead"}}}static async createLead(t,a){var r,s;try{const n=await K.post(J.LEADS.CREATE(t),a);return n.status>=200&&n.status<300?{success:!0,data:n.data,message:"Lead created successfully"}:{success:!1,error:((r=n.data)==null?void 0:r.message)||"Failed to create lead"}}catch(n){return n.response?{success:!1,error:((s=n.response.data)==null?void 0:s.message)||n.response.data||`Server error: ${n.response.status}`}:n.request?{success:!1,error:"Network error. Please check your connection."}:{success:!1,error:n.message||"Failed to create lead"}}}static async updateLead(t,a,r){var s,n;try{return{success:!0,data:(await K.put(J.LEADS.UPDATE(t,a),r)).data,message:"Lead updated successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update lead"}}}static async deleteLead(t,a){var r,s;try{return await K.delete(J.LEADS.DELETE(t,a)),{success:!0,message:"Lead deleted successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete lead"}}}static async updateLeadStatus(t,a,r){var s,n;try{return{success:!0,data:(await K.put(J.LEADS.UPDATE_STATUS(t,a),null,{params:{status:r}})).data,message:"Lead status updated successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update lead status"}}}static async getLeadsBySource(t,a){var r,s;try{return{success:!0,data:(await K.get(J.LEADS.GET_BY_SOURCE(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load leads by source"}}}static async getLeadsByAssignedUser(t,a,r={}){var s,n;try{return{success:!0,data:(await K.get(J.LEADS.GET_BY_ASSIGNED_USER(t,a),{params:r})).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load assigned leads"}}}static async addRemarkToLead(t,a,r){var s,n,l;try{const o=`/api/companies/${t}/leads/${a}/remarks`;return{success:!0,data:(await K.post(o,r)).data,message:"Remark added successfully"}}catch(o){return{success:!1,error:((n=(s=o.response)==null?void 0:s.data)==null?void 0:n.message)||((l=o.response)==null?void 0:l.data)||"Failed to add remark"}}}static async getRemarksByLeadId(t,a){var r,s;try{const n=`/api/companies/${t}/leads/${a}/remarks`;return{success:!0,data:(await K.get(n)).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load remarks"}}}static async assignLead(t,a,r,s){var n,l;try{return{success:!0,data:(await K.put(J.LEADS.ASSIGN(t,a,r),null,{params:{assignerId:s}})).data,message:"Lead assigned successfully"}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to assign lead"}}}static async unassignLead(t,a,r){var s,n;try{return{success:!0,data:(await K.put(J.LEADS.UNASSIGN(t,a),null,{params:{unassignerId:r}})).data,message:"Lead unassigned successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to unassign lead"}}}static async getLeadsByCreatedBy(t,a,r={}){var s,n;try{return{success:!0,data:(await K.get(J.LEADS.GET_BY_CREATED_BY(t,a),{params:r})).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load created leads"}}}static async getLeadName(t,a){var r,s;try{return{success:!0,data:(await K.get(J.LEADS.GET_NAME(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to get lead name"}}}static async getTotalLeadCount(t){var a,r;try{return{success:!0,data:(await K.get(J.LEADS.GET_COUNT(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to get lead count"}}}static async getClosedLeadCount(t){var a,r;try{return{success:!0,data:(await K.get(J.LEADS.GET_CLOSED_COUNT(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to get closed lead count"}}}static async getLeadsCreatedOrAssigned(t,a,r=0,s=10){var n,l;try{return{success:!0,data:(await K.get(J.LEADS.GET_CREATED_OR_ASSIGNED(t,a),{params:{page:r,size:s}})).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to load user leads"}}}static async countLeadsForUser(t,a){var r,s;try{return{success:!0,data:(await K.get(J.LEADS.COUNT_FOR_USER(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to count user leads"}}}static async searchLeads(t,a,r={}){var s,n;try{if(!localStorage.getItem("token"))return{success:!1,error:"Authentication required. Please login again."};const o={page:r.page||0,size:r.size||10};a.search&&a.search.trim()&&a.search.trim().split(/\s+/).forEach(m=>{m.trim()&&(o.keywords||(o.keywords=[]),o.keywords.push(m.trim()))}),a.minBudget&&(o.minBudget=a.minBudget),a.maxBudget&&(o.maxBudget=a.maxBudget),a.status&&a.status.trim()&&(o.status=a.status.trim()),a.source&&a.source.trim()&&(o.source=a.source.trim()),a.createdBy&&a.createdBy.trim()&&(o.createdBy=a.createdBy.trim()),a.action&&a.action.trim()&&(o.action=a.action.trim()),Object.keys(o).forEach(f=>{(o[f]===void 0||o[f]===null||o[f]==="")&&delete o[f]});let c=J.LEADS.SEARCH(t);const u=new URLSearchParams;Object.keys(o).forEach(f=>{f!=="keywords"&&u.append(f,o[f])}),o.keywords&&Array.isArray(o.keywords)&&o.keywords.forEach(f=>{u.append("keywords",f)});const d=`${c}?${u.toString()}`;return{success:!0,data:(await K.get(d)).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to search leads"}}}static async searchLeadsCreatedOrAssigned(t,a,r,s={}){var n,l;try{if(!localStorage.getItem("token"))return{success:!1,error:"Authentication required. Please login again."};const c={page:s.page||0,size:s.size||10};r.search&&r.search.trim()&&r.search.trim().split(/\s+/).forEach(p=>{p.trim()&&(c.keywords||(c.keywords=[]),c.keywords.push(p.trim()))}),r.minBudget&&(c.minBudget=r.minBudget),r.maxBudget&&(c.maxBudget=r.maxBudget),r.status&&r.status.trim()&&(c.status=r.status.trim()),r.source&&r.source.trim()&&(c.source=r.source.trim()),r.action&&r.action.trim()&&(c.action=r.action.trim()),Object.keys(c).forEach(m=>{(c[m]===void 0||c[m]===null||c[m]==="")&&delete c[m]});let u=J.LEADS.SEARCH_CREATED_OR_ASSIGNED(t,a);const d=new URLSearchParams;Object.keys(c).forEach(m=>{m!=="keywords"&&d.append(m,c[m])}),c.keywords&&Array.isArray(c.keywords)&&c.keywords.forEach(m=>{d.append("keywords",m)});const h=`${u}?${d.toString()}`;return{success:!0,data:(await K.get(h)).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to search user leads"}}}static async searchLeadsVisibleToAdmin(t,a,r,s={}){var n,l;try{if(!localStorage.getItem("token"))return{success:!1,error:"Authentication required. Please login again."};const c={page:s.page||0,size:s.size||10};r.search&&r.search.trim()&&r.search.trim().split(/\s+/).forEach(p=>{p.trim()&&(c.keywords||(c.keywords=[]),c.keywords.push(p.trim()))}),r.minBudget&&(c.minBudget=r.minBudget),r.maxBudget&&(c.maxBudget=r.maxBudget),r.status&&r.status.trim()&&(c.status=r.status.trim()),r.source&&r.source.trim()&&(c.source=r.source.trim()),r.createdBy&&r.createdBy.trim()&&(c.createdBy=r.createdBy.trim()),r.action&&r.action.trim()&&(c.action=r.action.trim()),Object.keys(c).forEach(m=>{(c[m]===void 0||c[m]===null||c[m]==="")&&delete c[m]});let u=J.LEADS.SEARCH_VISIBLE_TO_ADMIN(t,a);const d=new URLSearchParams;Object.keys(c).forEach(m=>{m!=="keywords"&&d.append(m,c[m])}),c.keywords&&Array.isArray(c.keywords)&&c.keywords.forEach(m=>{d.append("keywords",m)});const h=`${u}?${d.toString()}`;return{success:!0,data:(await K.get(h)).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to search admin leads"}}}static async getLeadsVisibleToAdmin(t,a,r=0,s=10){var n,l;try{return{success:!0,data:(await K.get(J.LEADS.GET_ADMIN_VISIBLE(t,a),{params:{page:r,size:s}})).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to load admin visible leads"}}}static async countLeadsVisibleToAdmin(t,a){var r,s;try{return{success:!0,data:(await K.get(J.LEADS.COUNT_VISIBLE_TO_ADMIN(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to count admin visible leads"}}}static async countClosedLeadsByAdmin(t,a){var r,s;try{return{success:!0,data:(await K.get(Ba(J.LEADS.COUNT_CLOSED_BY_ADMIN(t),{adminId:a}))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to count closed leads by admin"}}}}class $t{static async createNote(t,a){var r,s;try{return{success:!0,data:(await K.post(J.NOTES.CREATE(t),a)).data,message:"Note created successfully"}}catch(n){let l="Failed to create note";return n.response?l=((r=n.response.data)==null?void 0:r.message)||((s=n.response.data)==null?void 0:s.error)||`Server error: ${n.response.status}`:n.request?l="No response from server. Please check your connection.":l=n.message||"Unknown error occurred",{success:!1,error:l}}}static async getNotesVisibleToUser(t,a,r=!1,s=!1){var n,l;try{return{success:!0,data:(await K.get(J.NOTES.GET_VISIBLE_TO_USER(t,a),{params:{isAdmin:r,isDirector:s}})).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to load visible notes"}}}static async getNoteById(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_ID(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load note"}}}static async getNotesByUser(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_USER(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load user notes"}}}static async getPublicNotes(t){var a,r;try{return{success:!0,data:(await K.get(J.NOTES.GET_PUBLIC(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load public notes"}}}static async getNotesVisibleToAdmin(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_PUBLIC_AND_ADMIN(t),{params:{adminId:a}})).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load admin notes"}}}static async getNotesVisibleToDirector(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_DIRECTOR_VISIBLE(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load director notes"}}}static async updateNote(t,a,r){var s,n;try{return{success:!0,data:(await K.put(J.NOTES.UPDATE(t,a),r)).data,message:"Note updated successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update note"}}}static async deleteNote(t,a){var r,s;try{return await K.delete(J.NOTES.DELETE(t,a)),{success:!0,message:"Note deleted successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete note"}}}static async updateNoteStatus(t,a,r){var s,n;try{return{success:!0,data:(await K.patch(J.NOTES.UPDATE_STATUS(t,a),null,{params:{status:r}})).data,message:"Note status updated successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update note status"}}}static async getNotesByStatus(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_STATUS(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load notes by status"}}}static async getNotesByUserAndStatus(t,a,r){var s,n;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_USER_AND_STATUS(t,a,r))).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load user notes by status"}}}static async getNotesByStatusOnly(t){var a,r;try{const s=J.NOTES.GET_BY_STATUS_ONLY(t).replace("{companyId}","0");return{success:!0,data:(await K.get(s)).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load notes by status"}}}static async getNotesByPriority(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_PRIORITY(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load notes by priority"}}}static async getNotesByUserAndPriority(t,a,r){var s,n;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_USER_AND_PRIORITY(t,a,r))).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load user notes by priority"}}}static async getNotesByPriorityAndStatus(t,a,r){var s,n;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_PRIORITY_AND_STATUS(t,a,r))).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load notes by priority and status"}}}static async getNotesByUserPriorityStatus(t,a,r,s){var n,l;try{return{success:!0,data:(await K.get(J.NOTES.GET_BY_USER_PRIORITY_STATUS(t,a,r,s))).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to load user notes by priority and status"}}}static async getNotesSortedByPriorityAsc(t){var a,r;try{return{success:!0,data:(await K.get(J.NOTES.GET_SORTED_BY_PRIORITY_ASC(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load sorted notes"}}}static async getNotesSortedByPriorityDesc(t){var a,r;try{return{success:!0,data:(await K.get(J.NOTES.GET_SORTED_BY_PRIORITY_DESC(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load sorted notes"}}}static async updateNotePriority(t,a,r){var s,n;try{return{success:!0,data:(await K.patch(J.NOTES.UPDATE_PRIORITY(t,a),null,{params:{priority:r}})).data,message:"Note priority updated successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update note priority"}}}static async addRemarkToNote(t,a,r){var s,n;try{return{success:!0,data:(await K.post(J.NOTES.ADD_REMARK(t,a),r)).data,message:"Remark added successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to add remark"}}}static async getRemarksByNoteId(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_REMARKS(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load remarks"}}}static async getVisibleUserIdsForNote(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTES.GET_VISIBLE_USERS(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load visible users"}}}static async getAllNotesForUser(t,a,r=!1,s=0,n=10){var l,o;try{return{success:!0,data:(await K.get(J.NOTES.GET_ALL_FOR_USER(t,a),{params:{isAdmin:r,page:s,size:n}})).data}}catch(c){return{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Failed to load notes"}}}static async getTodayEventsForDashboard(t,a,r){var s,n;try{return{success:!0,data:(await K.get(`/api/companies/${t}/notes/dashboard/today-events`,{params:{userId:a,role:r}})).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load today's events"}}}}class An{static async getPropertiesByCompany(t,a=0,r=10,s={}){var n,l;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_PAGED(t),{params:{page:a,size:r,role:s.role,userId:s.userId}})).data}}catch(o){return{success:!1,error:((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to load properties"}}}static async getPropertyById(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_ID(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load property"}}}static async createProperty(t,a){var r,s;try{const n=await K.post(J.PROPERTIES.CREATE(t),a);return n.status>=200&&n.status<300?{success:!0,data:n.data,message:"Property created successfully"}:{success:!1,error:((r=n.data)==null?void 0:r.message)||"Failed to create property"}}catch(n){return n.response?{success:!1,error:((s=n.response.data)==null?void 0:s.message)||n.response.data||`Server error: ${n.response.status}`}:n.request?{success:!1,error:"Network error. Please check your connection."}:{success:!1,error:n.message||"Failed to create property"}}}static async updateProperty(t,a,r){var s,n;try{return{success:!0,data:(await K.put(J.PROPERTIES.UPDATE(t,a),r)).data,message:"Property updated successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update property"}}}static async deleteProperty(t,a){var r,s;try{return await K.delete(J.PROPERTIES.DELETE(t,a)),{success:!0,message:"Property deleted successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete property"}}}static async getPropertiesByStatus(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_STATUS(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load properties by status"}}}static async getPropertiesByType(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_TYPE(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load properties by type"}}}static async getPropertiesBySector(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_SECTOR(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load properties by sector"}}}static async getPropertiesBySource(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_SOURCE(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load properties by source"}}}static async getPropertiesByBHK(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_BHK(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load properties by BHK"}}}static async getPropertiesByOwnerContact(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_OWNER_CONTACT(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load properties by contact"}}}static async getPropertyName(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_NAME(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to get property name"}}}static async getPropertyCount(t){var a,r;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_COUNT(t))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to get property count"}}}static async getPropertyCountByUser(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.COUNT_BY_USER(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to get property count by user"}}}static async searchProperties(t,a={},r={}){var s,n;try{if(!localStorage.getItem("token"))return{success:!1,error:"Authentication required. Please login again."};const o={page:r.page||0,size:r.size||10,role:a.role,userId:a.userId};if(a.keywords&&a.keywords.trim()&&a.keywords.trim().split(/\s+/).forEach(m=>{m.trim()&&(o.keywords||(o.keywords=[]),o.keywords.push(m.trim()))}),a.budgetRange){const[f,m]=a.budgetRange.split("-").map(Number);isNaN(f)||(o.minPrice=f),isNaN(m)||(o.maxPrice=m)}a.status&&a.status.trim()&&(o.status=a.status.trim()),a.type&&a.type.trim()&&(o.type=a.type.trim()),a.bhk&&a.bhk.trim()&&(o.bhk=a.bhk.trim()),a.source&&a.source.trim()&&(o.source=a.source.trim()),a.createdBy&&a.createdBy.trim()&&(o.createdByName=a.createdBy.trim()),Object.keys(o).forEach(f=>{(o[f]===void 0||o[f]===null||o[f]==="")&&delete o[f]});let c=J.PROPERTIES.SEARCH_PAGED(t);const u=new URLSearchParams;Object.keys(o).forEach(f=>{f!=="keywords"&&u.append(f,o[f])}),o.keywords&&Array.isArray(o.keywords)&&o.keywords.forEach(f=>{u.append("keywords",f)});const d=`${c}?${u.toString()}`;return{success:!0,data:(await K.get(d)).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to search properties"}}}static async addRemarkToProperty(t,a,r){var s,n;try{return{success:!0,data:(await K.post(J.PROPERTIES.ADD_REMARK(t,a),r)).data,message:"Remark added successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to add remark"}}}static async getRemarksByPropertyId(t,a){var r,s;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_REMARKS(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load remarks"}}}static async getPropertiesByCreatedBy(t,a,r={}){var s,n;try{return{success:!0,data:(await K.get(J.PROPERTIES.GET_BY_CREATED_BY(t,a),{params:r})).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load created properties"}}}}class Za{static async getAllTasksByCompany(t){var a,r;try{return{success:!0,data:(await K.get(Ba(J.TASKS.GET_ALL,{companyId:t}))).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to fetch tasks"}}}static async getAllTasksForAdmin(t,a){var r,s;try{return{success:!0,data:(await K.get(Ba(J.TASKS.GET_ADMIN_ALL,{adminId:t,companyId:a}))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch admin tasks"}}}static async getAssignedTasks(t,a){var r,s;try{return{success:!0,data:(await K.get(Ba(J.TASKS.GET_ASSIGNED,{companyId:t,userId:a}))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch assigned tasks"}}}static async getTasksUploadedByUser(t,a){var r,s;try{return{success:!0,data:(await K.get(Ba(J.TASKS.GET_UPLOADED,{uploadedById:t,companyId:a}))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch uploaded tasks"}}}static async deleteTask(t,a){var r,s;console.log("TaskService deleteTask called with:",{taskId:t,companyId:a}),console.log("TaskService deleteTask URL:",Ba(J.TASKS.DELETE(t),{companyId:a}));try{const n=await K.delete(Ba(J.TASKS.DELETE(t),{companyId:a}));return console.log("TaskService deleteTask response:",n),{success:!0,data:n.data}}catch(n){return console.error("TaskService deleteTask error:",n),console.error("TaskService deleteTask error response:",n.response),{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete task"}}}static async deleteColumn(t,a,r){var s,n;try{return{success:!0,data:(await K.delete(Ba(J.TASKS.DELETE_COLUMN(t),{companyId:a,colIndex:r}))).data}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to delete column"}}}static async updateCell(t,a,r,s,n){var l,o;try{return{success:!0,data:(await K.patch(Ba(J.TASKS.UPDATE_CELL(t),{companyId:a,row:r,col:s,newValue:n}))).data}}catch(c){return{success:!1,error:((o=(l=c.response)==null?void 0:l.data)==null?void 0:o.message)||"Failed to update cell"}}}static async previewExcel(t,a){var r,s;try{return{success:!0,data:(await K.get(Ba(J.TASKS.PREVIEW(t),{companyId:a}))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to preview Excel"}}}static async downloadFile(t,a){var r,s;try{return{success:!0,data:(await K.get(Ba(J.TASKS.DOWNLOAD(t),{companyId:a}),{responseType:"blob"})).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to download file"}}}static async uploadExcelFile(t){var a,r,s;try{if(console.log("TaskService: Starting upload with data:",{title:t.title,fileName:(a=t.file)==null?void 0:a.name,fileSize:(r=t.file)==null?void 0:r.size,companyId:t.companyId,uploadedBy:t.uploadedBy}),!t.file)return{success:!1,error:"No file provided"};if(!t.companyId)return{success:!1,error:"Company ID is required"};if(!t.uploadedBy)return{success:!1,error:"Uploader ID is required"};const n=new FormData;n.append("file",t.file),n.append("title",t.title),n.append("companyId",t.companyId.toString()),n.append("uploadedBy",t.uploadedBy.toString()),console.log("TaskService: Sending request to:",J.TASKS.UPLOAD);const l=await K.post(J.TASKS.UPLOAD,n,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});return console.log("TaskService: Upload successful:",l.data),{success:!0,data:l.data}}catch(n){return console.error("TaskService: Upload error:",n),n.response?{success:!1,error:((s=n.response.data)==null?void 0:s.message)||n.response.data||`Server error: ${n.response.status}`}:n.request?{success:!1,error:"Network error: Unable to reach server"}:{success:!1,error:n.message||"Upload failed"}}}static async assignTask(t,a,r=null){var s;try{const n=J.TASKS.ASSIGN(t),l={companyId:a};r!=null&&(l.userId=r);const o=Ba(n,l);return{success:!0,data:(await K.put(o)).data}}catch(n){return{success:!1,error:((s=n.response)==null?void 0:s.data)||"Failed to assign/unassign task"}}}static async updateTaskStatus(t,a,r){var s,n;try{const l=J.TASKS.UPDATE_STATUS(t),c=Ba(l,{companyId:a,status:r}),u=await K.put(c);return u.status===200?{success:!0,data:u.data}:{success:!1,error:`Backend returned status ${u.status}`}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update task status"}}}}class I0{static async getAllFollowUps(t){var a,r;try{return{success:!0,data:(await K.get(`/api/${t}/followups`)).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load follow-ups"}}}static async getFollowUpById(t,a){var r,s;try{return{success:!0,data:(await K.get(`/api/${t}/followups/${a}`)).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load follow-up"}}}static async getTodayFollowUps(t){var a,r;try{return{success:!0,data:(await K.get(`/api/${t}/followups/today`)).data}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to load today's follow-ups"}}}static async createFollowUp(t,a){var r,s;try{return{success:!0,data:(await K.post(`/api/${t}/followups`,a)).data,message:"Follow-up created successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to create follow-up"}}}static async updateFollowUp(t,a){var r,s;try{return{success:!0,data:(await K.put(`/api/${t}/followups`,a)).data,message:"Follow-up updated successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to update follow-up"}}}static async deleteFollowUp(t,a){var r,s;try{return await K.delete(`/api/${t}/followups/${a}`),{success:!0,message:"Follow-up deleted successfully"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to delete follow-up"}}}}class gi{static async getUnreadNotificationsByUserAndCompany(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTIFICATIONS.GET_UNREAD_BY_USER_COMPANY(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load unread notifications"}}}static async getUnreadCount(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTIFICATIONS.GET_UNREAD_COUNT(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load unread count"}}}static async getNotificationsByUserAndCompany(t,a){var r,s;try{return{success:!0,data:(await K.get(J.NOTIFICATIONS.GET_BY_USER_COMPANY(t,a))).data}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to load notifications"}}}static async markAllAsRead(t,a){var r,s;try{return{success:!0,data:(await K.post(J.NOTIFICATIONS.MARK_ALL_AS_READ(t,a))).data,message:"All notifications marked as read"}}catch(n){return{success:!1,error:((s=(r=n.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to mark all notifications as read"}}}static async markAsRead(t){var a,r;try{return{success:!0,data:(await K.post(J.NOTIFICATIONS.MARK_AS_READ(t))).data,message:"Notification marked as read"}}catch(s){return{success:!1,error:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to mark notification as read"}}}static async sendNotification(t,a,r){var s,n;try{return{success:!0,data:(await K.post(J.NOTIFICATIONS.SEND,null,{params:{actorUserId:t,companyId:a,message:r}})).data,message:"Notification sent successfully"}}catch(l){return{success:!1,error:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to send notification"}}}}let Am=null;function TF(e){Am=e}function oe(e){Am?Am(e):alert(e)}const Rs=(e,t,a,r=!1)=>{const[s,n]=E.useState([]),[l,o]=E.useState(!1),[c,u]=E.useState(null),d=E.useCallback(async()=>{if(!(!e&&t!=="DEVELOPER")){o(!0),u(null);try{let W;if(t==="ADMIN"?W=await Re.getUsersByAdmin(a):t==="DIRECTOR"?W=await Re.getAllUsersByCompany(e):t==="DEVELOPER"?W=await Re.getUsersWithUserRole():W=await Re.getAllUsersByCompany(e),W.success){let _=W.data||[];t==="ADMIN"?_=_.filter(G=>G.role==="USER"):t==="DIRECTOR"&&(_=_.filter(G=>G.role==="USER")),n(_)}else u(W.error),oe("❌ "+W.error)}catch{const _="Failed to load users";u(_),oe("❌ "+_)}finally{o(!1)}}},[e,t,a]),h=E.useCallback(async()=>{if(e){o(!0),u(null);try{const W=await Re.getAllUsersByCompany(e);if(W.success){const _=W.data||[];n(_)}else u(W.error),oe("❌ "+W.error)}catch{const _="Failed to load all users";u(_),oe("❌ "+_)}finally{o(!1)}}},[e]),f=E.useCallback(async()=>{if(e){o(!0),u(null);try{const W=await Re.getAdminRoleByCompany(e),_=await Re.getUsersWithDirectorRole();let G=[];W.success&&(G=G.concat(W.data||[])),_.success&&(G=G.concat(_.data||[])),n(G)}catch{const _="Failed to load admin and director users";u(_),oe("❌ "+_)}finally{o(!1)}}},[e]),m=E.useCallback(async()=>{if(e){o(!0),u(null);try{const W=await Re.getUserRoleByCompany(e);if(W.success){const _=W.data||[];n(_)}else u(W.error),oe("❌ "+W.error)}catch{const _="Failed to load user role users";u(_),oe("❌ "+_)}finally{o(!1)}}},[e]),p=E.useCallback(async(W,_,G,Y=!0)=>{try{const z=await W();return z.success?(oe(`✅ ${_}`),Y&&await d(),{success:!0,message:z.message,data:z.data}):(oe(`❌ ${z.error||G}`),{success:!1,error:z.error})}catch{return oe(`❌ ${G}`),{success:!1,error:G}}},[d]),x=E.useCallback(async(W,_)=>{try{return await W()}catch{return{success:!1,error:_}}},[]),v=E.useCallback(async()=>{try{const W=await Re.getAllUsersByCompany(e);return W.success&&n(W.data||[]),W}catch{return{success:!1,error:"Failed to load all company users"}}},[e]),g=E.useCallback(W=>p(()=>Re.createUser(W),"User created successfully","Failed to create user"),[p]),b=E.useCallback((W,_)=>p(()=>Re.updateProfile(W,_),"User updated successfully","Failed to update user"),[p]),y=E.useCallback(W=>p(()=>Re.deleteUser(W),"User deleted successfully","Failed to delete user"),[p]),w=E.useCallback(W=>p(()=>Re.unrevokeUser(W),"User activated successfully","Failed to activate user"),[p]),N=E.useCallback(W=>p(()=>Re.revokeUser(W),"User deactivated successfully","Failed to deactivate user"),[p]),A=E.useCallback((W,_)=>p(()=>Re.assignAdmin(W,_),"Admin assigned successfully","Failed to assign admin"),[p]),S=E.useCallback(W=>p(()=>Re.unassignAdmin(W),"Admin unassigned successfully","Failed to unassign admin"),[p]),C=E.useCallback((W,_,G="avatar")=>p(()=>Re.uploadAvatar(W,_,G),"Avatar uploaded","Avatar upload failed",!1),[p]),T=E.useCallback(W=>x(()=>Re.getAvatar(W),"Failed to load avatar"),[x]),D=E.useCallback(()=>x(()=>Re.logout(),"Logout failed"),[x]),R=E.useCallback(()=>x(()=>Re.checkSession(),"Session invalid"),[x]),j=E.useCallback(W=>x(()=>Re.getUserById(W),"Failed to load user"),[x]),B=E.useCallback(W=>x(()=>Re.getUsernameById(W),"Failed to load username"),[x]),X=E.useCallback(W=>x(()=>Re.getUsersByRole(W),`Failed to load ${W}s`),[x]),V=E.useCallback(async()=>{try{const W=await Re.getUsersWithUserRole();return W.success&&n(W.data||[]),W}catch{return{success:!1,error:"Failed to load users"}}},[]),F=E.useCallback(async W=>{try{const _=await Re.getUsersByRoleAndCompany(e,W);return _.success&&n(_.data||[]),_}catch{return{success:!1,error:`Failed to load ${W}s`}}},[e]),q=E.useCallback(async W=>{try{const _=await Re.getUsersByAdmin(W);return _.success&&n(_.data||[]),_}catch{return{success:!1,error:"Failed to load users"}}},[]),te=E.useCallback((W,_)=>x(()=>Re.getUserByAdmin(W,_),"Failed to load user"),[x]),H=E.useCallback(W=>x(()=>Re.countUsersByAdmin(W,e),"Failed to count users"),[x,e]),le=E.useCallback(async()=>{try{const W=await Re.getAdminsByCompany(e);return W.success&&n(W.data||[]),W}catch{return{success:!1,error:"Failed to load admins"}}},[e]);return E.useEffect(()=>{(e||t==="DEVELOPER")&&(r==="admin-director"?f():r==="user-only"?m():r===!0?h():d())},[d,h,f,m,r,e,t]),{users:s,loading:l,error:c,loadUsers:d,createUser:g,updateUser:b,deleteUser:y,activateUser:w,deactivateUser:N,assignAdmin:A,unassignAdmin:S,uploadAvatar:C,getUserAvatar:T,logout:D,checkSession:R,getUserById:j,getUsernameById:B,getUsersWithRole:X,getUsersWithUserRole:V,getUsersByRoleAndCompany:F,getUsersByAdmin:q,getUserByAdmin:te,countUsersByAdmin:H,getAdminsByCompany:le,getAllUsersByCompany:v,loadAllUsersIncludingAdmins:h,loadAdminAndDirectorUsers:f,loadUserRoleUsers:m}},QS=(e,t,a)=>{const[r,s]=E.useState([]),[n,l]=E.useState(!0),[o,c]=E.useState(null),u=E.useCallback(async()=>{if(t==="DEVELOPER"){if(!t||!a){l(!1);return}}else if(!e||!t||!a){l(!1);return}l(!0),c(null);try{let g;t==="DEVELOPER"?g=await Ls.getAllAdmins():g=await Ls.getAdminRoleByCompany(e),g.success?s(g.data||[]):(c(g.error),oe("❌ "+g.error))}catch{const b="Failed to load admins";c(b),oe("❌ "+b)}finally{l(!1)}},[e,t,a]);E.useEffect(()=>{u()},[u]);const d=E.useCallback(async(g,b,y,w=!0)=>{try{const N=await g();return N.success?(oe(`✅ ${b}`),w&&await u(),{success:!0,message:N.message}):(oe(`❌ ${N.error||y}`),{success:!1,error:N.error})}catch{return oe(`❌ ${y}`),{success:!1,error:y}}},[u]),h=E.useCallback(g=>d(()=>Ls.activateAdmin(g),"Admin activated successfully","Failed to activate admin"),[d]),f=E.useCallback(g=>d(()=>Ls.revokeAdmin(g),"Admin deactivated successfully","Failed to deactivate admin"),[d]),m=E.useCallback((g,b)=>d(()=>Ls.assignAdmin(g,b),"Admin assigned successfully","Failed to assign admin",!0),[d]),p=E.useCallback(g=>d(()=>Ls.unassignAdmin(g),"Admin unassigned successfully","Failed to unassign admin",!0),[d]),x=E.useCallback(async()=>{try{const g=await Ls.getAllAdmins();return g.success&&s(g.data||[]),g}catch{return{success:!1,error:"Failed to load all admins"}}},[]),v=E.useCallback(async()=>{try{const g=await Ls.getAdminRoleByCompany(e);return g.success&&s(g.data||[]),g}catch{return{success:!1,error:"Failed to load company admins"}}},[e]);return{admins:r,loading:n,error:o,loadAdmins:u,activateAdmin:h,revokeAdmin:f,assignAdmin:m,unassignAdmin:p,getAllAdmins:x,getAdminsByRoleAndCompany:v}},AF=(e,t,a)=>{const[r,s]=E.useState({}),[n,l]=E.useState(!0),[o,c]=E.useState(null),u=E.useCallback(async()=>{var d,h,f,m,p,x,v,g,b,y,w,N,A,S;if(!t||!a){l(!1);return}if(a==="DEVELOPER"){l(!0),c(null);try{const[C,T,D,R]=await Promise.allSettled([da.getTotalCompaniesCount(),da.getTotalUsersCount(),da.getTotalAdminsCount(),da.getTotalDirectorsCount()]),j={totalCompanies:C.status==="fulfilled"&&C.value.data||0,totalUsers:T.status==="fulfilled"&&T.value.data||0,totalAdmins:D.status==="fulfilled"&&D.value.data||0,totalDirectors:R.status==="fulfilled"&&R.value.data||0};s(j)}catch(C){s({totalCompanies:0,totalUsers:0,totalAdmins:0,totalDirectors:0}),c(C.message||"Failed to load developer stats")}finally{l(!1)}return}if(!e){s({totalLeads:0,newLeads:0,contactedLeads:0,totalProperties:0,propertyOverview:{totalProperties:0,"available for sale":0,"available for rent":0,"sold out":0,"rent out":0},dealsOverview:{"total close":0,closed:0,dropped:0},usersOverview:{totalNormalUsers:0,activeAdmins:0,totalUsers:0,totalAdmins:0,deactiveAdmins:0,deactiveNormalUsers:0,activeNormalUsers:0}}),l(!1);return}l(!0),c(null);try{let C,T;a==="USER"?(C=await da.getPropertiesCountByUser(e,t),T=await da.getPropertiesOverview(e)):(C=await da.getPropertiesCount(e),T=await da.getPropertiesOverview(e));let D;a==="ADMIN"?D=await da.getClosedLeadsCountByAdmin(e,t):a==="USER"?D={data:((d=(await da.getLeadsCountForUser(e,t)).data)==null?void 0:d.closedCount)||0}:D=await da.getClosedLeadsCount(e);let R;try{R=await da.getNewContactedLeadsCount(e,t)}catch{R={data:{totalLeads:(await da.getLeadsCount(e)).data||0,newLeads:0,contactedLeads:0}}}let j;try{j=await da.getDealsCloseCount(e,t,a)}catch{j={data:{"total close":0,closed:0,dropped:0}}}let B;try{B=await da.getUsersAndAdminsOverview(e,t)}catch{B={data:{totalNormalUsers:0,activeAdmins:0,totalUsers:0,totalAdmins:0,deactiveAdmins:0,deactiveNormalUsers:0,activeNormalUsers:0}}}const X={totalLeads:((h=R.data)==null?void 0:h.totalLeads)||0,newLeads:((f=R.data)==null?void 0:f.newLeads)||0,contactedLeads:((m=R.data)==null?void 0:m.contactedLeads)||0,closedLeads:((p=R.data)==null?void 0:p.closedLeads)||0,droppedLeads:((x=R.data)==null?void 0:x.droppedLeads)||0,totalProperties:C.data||0,propertyOverview:{totalProperties:((v=T.data)==null?void 0:v.totalProperties)||0,"available for sale":((g=T.data)==null?void 0:g["available for sale"])||0,"available for rent":((b=T.data)==null?void 0:b["available for rent"])||0,"sold out":((y=T.data)==null?void 0:y["sold out"])||0,"rent out":((w=T.data)==null?void 0:w["rent out"])||0},dealsOverview:{"total close":((N=j.data)==null?void 0:N["total close"])||0,closed:((A=j.data)==null?void 0:A.closed)||0,dropped:((S=j.data)==null?void 0:S.dropped)||0},usersOverview:B.data};s(X)}catch(C){c(C.message||"Failed to load dashboard stats")}finally{l(!1)}},[e,t,a]);return E.useEffect(()=>{u()},[u]),{stats:r,loading:n,error:o}},CF=()=>{const[e,t]=E.useState([]),[a,r]=E.useState(!1),[s,n]=E.useState(null),l=E.useCallback(async(x,v)=>{r(!0),n(null);try{const g=await x();g.success?t(g.data):(n(g.error),oe(`❌ ${g.error||v}`))}catch{n(v),oe(`❌ ${v}`)}finally{r(!1)}},[]),o=E.useCallback(()=>l(Dt.getAllCompanies,"Failed to load companies"),[l]),c=E.useCallback(()=>l(Dt.getMyCompanies,"Failed to load your companies"),[l]),u=E.useCallback(async(x,v,g,b=!0)=>{r(!0);try{const y=await x();return y.success?(oe(`✅ ${v}`),b&&await o(),{success:!0,message:y.message,data:y.data}):(oe(`❌ ${y.error||g}`),{success:!1,error:y.error})}catch{return oe(`❌ ${g}`),{success:!1,error:g}}finally{r(!1)}},[o]),d=x=>u(()=>Dt.addCompany(x),"Company added successfully","Failed to add company"),h=x=>u(()=>Dt.deleteCompany(x),"Company deleted successfully","Failed to delete company"),f=x=>u(()=>Dt.revokeCompany(x),"Company revoked successfully","Failed to revoke company"),m=x=>u(()=>Dt.unrevokeCompany(x),"Company activated successfully","Failed to activate company"),p=async x=>{try{return await Dt.getCompanyName(x)}catch{return{success:!1,error:"Failed to get company name"}}};return E.useEffect(()=>{o()},[o]),{companies:e,loading:a,error:s,loadAllCompanies:o,loadMyCompanies:c,addCompany:d,deleteCompany:h,revokeCompany:f,unrevokeCompany:m,getCompanyName:p}},JS=(e,t,a)=>{const[r,s]=E.useState([]),[n,l]=E.useState(!1),[o,c]=E.useState(null),[u,d]=E.useState({page:0,size:10,totalElements:0,totalPages:0}),h=E.useMemo(()=>{const T=JSON.parse(localStorage.getItem("user")||"{}");return localStorage.getItem("token"),{companyId:e||T.companyId,userId:t||T.userId||T.id,role:a||T.role}},[e,t,a]),f=E.useCallback(async(T=0,D=10,R=null)=>{var j,B,X,V;if(!h.companyId){c("Company ID is missing.");return}l(!0),c(null);try{let F;const q=R&&Object.keys(R).length>0,te={search:R==null?void 0:R.query,status:R==null?void 0:R.status,source:R==null?void 0:R.source,createdBy:R==null?void 0:R.createdBy,minBudget:(j=R==null?void 0:R.budget)==null?void 0:j.split("-")[0],maxBudget:(B=R==null?void 0:R.budget)==null?void 0:B.split("-")[1]};if(R!=null&&R.assignedTo?R.assignedTo==="assigned"?te.action="ASSIGNED":R.assignedTo==="unassigned"&&(te.action="UNASSIGNED"):R!=null&&R.action&&(te.action=R.action),Object.keys(te).forEach(le=>{(te[le]===void 0||te[le]===null||te[le]==="")&&delete te[le]}),Object.keys(te).length>0?h.role==="DIRECTOR"?F=await Ua.searchLeads(h.companyId,te,{page:T,size:D}):h.role==="ADMIN"?F=await Ua.searchLeadsVisibleToAdmin(h.companyId,h.userId,te,{page:T,size:D}):F=await Ua.searchLeadsCreatedOrAssigned(h.companyId,h.userId,te,{page:T,size:D}):h.role==="DIRECTOR"?F=await Ua.getLeadsByCompany(h.companyId,T,D):h.role==="ADMIN"?F=await Ua.getLeadsVisibleToAdmin(h.companyId,h.userId,T,D):F=await Ua.getLeadsCreatedOrAssigned(h.companyId,h.userId,T,D),F.success){const le=F.data.content||F.data||[],W=q?le:[...le.filter(_=>_.status!=="CLOSED"&&_.status!=="DROPED"),...le.filter(_=>_.status==="DROPED"),...le.filter(_=>_.status==="CLOSED")];s(W),d({page:F.data.number??T,size:F.data.size??D,totalElements:F.data.totalElements??W.length,totalPages:F.data.totalPages??1})}else c(F.error),oe("❌ "+F.error)}catch(F){const q=`Failed to fetch leads: ${((V=(X=F.response)==null?void 0:X.data)==null?void 0:V.message)||F.message}`;c(q),oe("❌ "+q)}finally{l(!1)}},[h]),m=E.useCallback((T=0,D=10)=>f(T,D,null),[f]),p=E.useCallback((T,D=0,R=10)=>f(D,R,T),[f]),x=async(T,D,R,j=!0)=>{var B,X,V;if(!h.companyId)return oe("Company ID is missing."),{success:!1,error:"Company ID missing"};try{const F=await T();if(F.success){if(D&&oe("✅ "+D),j)try{await m(0,10)}catch{}return{success:!0,data:F.data}}else{const q=(F.error||"").toString();if(/Query did not return a unique result/i.test(q)||/unique result: 2 results/i.test(q)){if(oe("⚠️ Created but duplicate match detected."),j)try{await m(0,10)}catch{}return{success:!0,data:F.data}}const H=(q||R||"").replace(/^([❌⚠️✅]\s*)+/,"").trim();return oe("❌ "+H),{success:!1,error:H}}}catch(F){const H=(((X=(B=F.response)==null?void 0:B.data)==null?void 0:X.message)||((V=F.response)==null?void 0:V.data)||F.message||R||"").toString().replace(/^([❌⚠️✅]\s*)+/,"").trim();if(/Query did not return a unique result/i.test(H)||/unique result: 2 results/i.test(H)){if(oe("⚠️ Created but duplicate match detected."),j)try{await m(0,10)}catch{}return{success:!0}}return oe("❌ "+H),{success:!1,error:H}}},v=T=>x(()=>Ua.createLead(h.companyId,T),"Lead created successfully","Failed to create lead"),g=(T,D)=>x(()=>Ua.updateLead(h.companyId,T,D),"Lead updated successfully","Failed to update lead"),b=T=>x(()=>Ua.deleteLead(h.companyId,T),"Lead deleted successfully","Failed to delete lead"),y=(T,D)=>x(()=>Ua.updateLeadStatus(h.companyId,T,D),"Lead status updated successfully","Failed to update status",!1),w=E.useCallback(async(T,D)=>{if(!h.companyId)return oe("Company ID is missing."),{success:!1,error:"Company ID missing"};try{const R=T.map(X=>Ua.updateLeadStatus(h.companyId,X,D)),B=(await Promise.all(R)).filter(X=>!X.success);return B.length===0?(oe(`✅ Updated ${T.length} leads to ${D}`),m(),{success:!0}):(oe(`❌ Failed ${B.length} updates`),{success:!1,error:"Partial failure"})}catch{return oe("❌ Bulk update failed"),{success:!1,error:"Bulk update failed"}}},[h,m]),N=E.useCallback(async(T,D,R)=>{var j,B;if(!h.companyId||!h.userId)return{success:!1,error:"Missing company or assigner ID"};try{const X=await K.put(`/api/companies/${h.companyId}/leads/${T}/assign/${D}?assignerId=${h.userId}`);return oe(`✅ Lead assigned to ${R}`),{success:!0,data:X.data}}catch(X){const V=((B=(j=X.response)==null?void 0:j.data)==null?void 0:B.message)||X.message||"Assignment failed";return oe(`❌ ${V}`),{success:!1,error:V}}},[h]),A=(T,D)=>x(()=>Ua.unassignLead(h.companyId,T,D),"Lead unassigned","Unassign failed"),S=E.useCallback(async(T,D)=>{if(!h.companyId||!h.userId)return{success:!1,error:"Missing company or user ID"};try{const R={...D,userId:h.userId},j=await Ua.addRemarkToLead(h.companyId,T,R);return j.success?(oe("✅ Remark added"),{success:!0,data:j.data}):(oe("❌ "+(j.error||"Failed to add remark")),{success:!1,error:j.error})}catch{return oe("❌ Failed to add remark"),{success:!1,error:"Failed to add remark"}}},[h]),C=T=>x(()=>Ua.getRemarksByLeadId(h.companyId,T),"","",!1);return E.useEffect(()=>{h.companyId&&m()},[h.companyId]),{leads:r,loading:n,error:o,pagination:u,loadLeads:m,searchLeads:p,createLead:v,updateLead:g,deleteLead:b,updateLeadStatus:y,updateBulkLeadStatus:w,assignLead:N,unassignLead:A,addRemark:S,getRemarks:C}},eT=(e,t,a)=>{const[r,s]=E.useState([]),[n,l]=E.useState(!1),[o,c]=E.useState(null),{updateNotesData:u}=Zj(),d=E.useCallback(async()=>{if(!(!e||!t||!a)){l(!0),c(null);try{let f=[];switch(a){case"ADMIN":f.push($t.getNotesVisibleToUser(e,t,!0,!1)),f.push($t.getNotesVisibleToAdmin(e,t));break;case"DIRECTOR":f.push($t.getNotesVisibleToDirector(e,t)),f.push($t.getNotesVisibleToUser(e,t,!1,!0)),f.push($t.getPublicNotes(e));break;case"USER":f.push($t.getNotesByUser(e,t)),f.push($t.getNotesVisibleToUser(e,t)),f.push($t.getPublicNotes(e));break;default:f.push($t.getNotesVisibleToUser(e,t))}const p=(await Promise.all(f)).flatMap(N=>{var A;return N.success?Array.isArray(N.data)?N.data:((A=N.data)==null?void 0:A.notes)||[]:[]}),x=N=>N?new Date(N).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-",v=(N,A=5)=>{const S=(N||"").split(/\s+/),C=[];for(let T=0;T<S.length;T+=A)C.push(S.slice(T,T+A).join(" "));return C},g=[...new Set(p.flatMap(N=>[N.userId,...N.visibleUserIds||[]]).filter(Boolean))],b={};await Promise.all(g.map(async N=>{try{const A=await K.get(`/api/users/${N}/username`);b[N]=A.data||"Unknown"}catch{b[N]="Unknown"}}));const w=Array.from(new Map(p.map(N=>[N.id,N])).values()).map(N=>{const A=N.dateTime?new Date(N.dateTime):null,S=N.createdAt?new Date(N.createdAt):null,C=b[N.userId]||"Unknown",T=(N.visibleUserIds||[]).map(D=>b[D]).filter(Boolean);return{...N,schedStr:A?A.toLocaleDateString()+" "+x(A):"N/A",createdStr:S?S.toLocaleDateString()+" "+x(S):"-",typeStr:A?"Event":"Note",wordChunks:v(N.content),createdBy:{id:N.userId,name:C,username:C},visibleUserNames:T}}).sort((N,A)=>N.status==="COMPLETED"&&A.status!=="COMPLETED"?1:N.status!=="COMPLETED"&&A.status==="COMPLETED"?-1:new Date(A.createdAt)-new Date(N.createdAt));s(w),u(w,!1,null)}catch(f){c("A critical error occurred while loading notes."),u([],!1,f.message)}finally{l(!1)}}},[e,t,a]);E.useEffect(()=>{e&&t&&a&&d()},[e,t,a,d]);const h=E.useCallback(async(f,m,p,x=!0)=>{l(!0);try{const v=await f();if(v!=null&&v.success)return m&&oe(`✅ ${m}`),x&&await d(),v;throw new Error((v==null?void 0:v.error)||p||"Unknown error")}catch(v){return c(v.message),oe(`❌ ${v.message}`),{success:!1,error:v.message}}finally{l(!1)}},[d]);return{notes:r,loading:n,error:o,loadNotes:d,createNote:f=>{if(!e)return Promise.resolve({success:!1,error:"Company ID is required"});if(!t)return Promise.resolve({success:!1,error:"User ID is required"});if(!f.content)return Promise.resolve({success:!1,error:"Note content is required"});const m={...f,userId:t,createdBy:t};return h(()=>$t.createNote(e,m),"Note created successfully","Failed to create note")},updateNote:(f,m)=>h(()=>$t.updateNote(e,f,m),"Note updated","Update failed"),deleteNote:f=>h(()=>$t.deleteNote(e,f),"Note deleted","Delete failed"),updateNoteStatus:(f,m)=>h(()=>$t.updateNoteStatus(e,f,m),"Status updated","Status update failed"),updateNotePriority:(f,m)=>h(()=>$t.updateNotePriority(e,f,m),"Priority updated","Priority update failed"),addRemarkToNote:(f,m)=>h(()=>$t.addRemarkToNote(e,f,{...m,userId:t}),"Remark added","Failed to add remark",!1),getNoteById:f=>h(()=>$t.getNoteById(e,f),null,"Failed to fetch note",!1),getRemarksByNoteId:f=>h(()=>$t.getRemarksByNoteId(e,f),null,"Failed to fetch remarks",!1)}},kF=(e,t,a)=>{const[r,s]=E.useState([]),[n,l]=E.useState(!1),[o,c]=E.useState(null),u=E.useCallback(async()=>{if(!e||!t||!a){s([]),l(!1);return}l(!0),c(null);try{const d=await $t.getTodayEventsForDashboard(e,t,a);if(d.success){const h=await Promise.all(d.data.map(async f=>{try{const m=await da.getUsernameById(f.userId);return{...f,username:m.success?m.data:"Unknown",content:f.content||"No content",dateTime:f.dateTime}}catch{return{...f,username:"Unknown",content:f.content||"No content",dateTime:f.dateTime}}}));s(h)}else c(d.error||"Failed to load today's events"),s([])}catch(d){c(d.message||"Failed to load today's events"),s([])}finally{l(!1)}},[e,t,a]);return E.useEffect(()=>{u()},[u]),{todayEvents:r,loading:n,error:o,refreshEvents:u}},tT=(e,t)=>{const[a,r]=E.useState([]),[s,n]=E.useState(0),[l,o]=E.useState(!1),[c,u]=E.useState(null),d=E.useCallback(async()=>{if(!(!e||!t)){o(!0),u(null);try{const w=await gi.getNotificationsByUserAndCompany(e,t);w.success?r(w.data):(u(w.error),oe(`❌ ${w.error||"Failed to load notifications"}`))}catch{u("Failed to load notifications"),oe("❌ Failed to load notifications")}finally{o(!1)}}},[e,t]),h=E.useCallback(async()=>{if(!(!e||!t))try{const w=await gi.getUnreadCount(e,t);w.success?n(w.data):u(w.error)}catch{u("Failed to load unread count")}},[e,t]),f=E.useCallback(async(w,N,A)=>{if(!e||!t)return{success:!1,error:"User and Company ID are required"};try{const S=await w();return S.success?(await Promise.all([d(),h()]),{success:!0,message:S.message}):(u(S.error),{success:!1,error:S.error})}catch{return u(A),{success:!1,error:A}}},[e,t,d,h]),m=E.useCallback(async(w,N)=>{if(!e||!t)return{success:!1,error:"User and Company ID are required"};try{return await w()}catch{return{success:!1,error:N}}},[e,t]),p=w=>f(()=>gi.markAsRead(w),"Notification marked as read","Failed to mark notification as read"),x=()=>f(()=>gi.markAllAsRead(e,t),"All notifications marked as read","Failed to mark all as read"),v=(w,N)=>m(()=>gi.sendNotification(w,t,N),"Failed to send notification"),g=()=>m(()=>gi.getUnreadNotificationsByUserAndCompany(e,t),"Failed to load unread notifications"),b=E.useCallback(()=>Promise.all([d(),h()]),[d,h]),y=()=>u(null);return E.useEffect(()=>{e&&t&&b()},[e,t,b]),E.useEffect(()=>{if(!e||!t)return;const w=setInterval(h,5e3);return()=>clearInterval(w)},[e,t,h]),{notifications:a,unreadCount:s,loading:l,error:c,loadNotifications:d,loadUnreadNotifications:g,loadUnreadCount:h,markAsRead:p,markAllAsRead:x,sendNotification:v,refreshNotifications:b,clearError:y}},aT=(e,t,a)=>{const[r,s]=E.useState([]),[n,l]=E.useState(!1),[o,c]=E.useState(null),[u,d]=E.useState({page:0,size:10,totalElements:0,totalPages:0}),h=E.useMemo(()=>{const w=JSON.parse(localStorage.getItem("user")||"{}"),N=localStorage.getItem("userId"),A=t||w.userId||w.id||(N?parseInt(N):null);return{companyId:e||w.companyId,userId:A,role:a||w.role}},[e,t,a]),f=E.useCallback(async(w=0,N=10,A=null)=>{if(!h.companyId){c("Company ID is missing.");return}l(!0),c(null);try{let S;const C={userId:h.userId,role:h.role};if(A&&Object.keys(A).some(D=>{const R=A[D];return R&&R.toString().trim()!==""})?S=await An.searchProperties(h.companyId,{...A,...C},{page:w,size:N}):S=await An.getPropertiesByCompany(h.companyId,w,N,C),S.success){const D=S.data.content||S.data||[];s(D);const R={page:S.data.number??w,size:S.data.size??N,totalElements:S.data.totalElements??D.length,totalPages:S.data.totalPages??Math.ceil((S.data.totalElements||D.length)/N)};d(R)}else throw new Error(S.error||"Failed to fetch data.")}catch(S){const C=S.message||"An unknown error occurred while fetching properties.";c(C),oe(`❌ ${C}`)}finally{l(!1)}},[h]),m=async(w,N,A,S=!1)=>{var C,T,D;if(!h.companyId)return oe("Company ID is missing."),{success:!1,error:"Company ID missing"};try{const R=await w();if(R.success){if(oe(`✅ ${N}`),S)try{await f(0,10)}catch{}return{success:!0,data:R.data}}else{const j=(R.error||A||"").toString().replace(/^([❌⚠️✅]\s*)+/,"").trim();if(/Query did not return a unique result/i.test(j)||/unique result: 2 results/i.test(j)){if(oe("⚠️ Created but duplicate match detected."),S)try{await f(0,10)}catch{}return{success:!0}}return oe(`❌ ${j}`),{success:!1,error:j}}}catch(R){const B=(((T=(C=R.response)==null?void 0:C.data)==null?void 0:T.message)||((D=R.response)==null?void 0:D.data)||R.message||A||"").toString().replace(/^([❌⚠️✅]\s*)+/,"").trim();if(/Query did not return a unique result/i.test(B)||/unique result: 2 results/i.test(B)){if(oe("⚠️ Created but duplicate match detected."),S)try{await f(0,10)}catch{}return{success:!0}}return oe(`❌ ${B}`),{success:!1,error:B}}},p=w=>m(()=>An.createProperty(h.companyId,w),"Property created successfully","Failed to create property"),x=(w,N)=>m(()=>An.updateProperty(h.companyId,w,N),"Property updated successfully","Failed to update property"),v=w=>m(()=>An.deleteProperty(h.companyId,w),"Property deleted successfully","Failed to delete property"),g=E.useCallback(async(w,N)=>{if(!h.userId)return{success:!1,error:"User ID is missing."};const A={...N,userId:h.userId.toString()};return m(()=>An.addRemarkToProperty(h.companyId,w,A),"Remark added successfully","Failed to add remark")},[h,m]),b=E.useCallback(async w=>{if(!h.companyId)return{success:!1,data:[],error:"Company ID is missing."};try{return await An.getRemarksByPropertyId(h.companyId,w)}catch{return{success:!1,data:[],error:"Failed to get remarks"}}},[h]),y=E.useCallback(async(w,N=0,A=10)=>f(N,A,w),[f]);return{properties:r,loading:n,error:o,pagination:u,loadProperties:f,searchProperties:y,createProperty:p,updateProperty:x,deleteProperty:v,addRemark:g,getRemarks:b}},Rp=(e,t,a)=>{const[r,s]=E.useState([]),[n,l]=E.useState(!1),[o,c]=E.useState(null),[u,d]=E.useState("ALL"),[h,f]=E.useState("ALL"),m=E.useCallback(async()=>{var j;if(!(!e||!a)){l(!0),c(null);try{let B;if(a==="DIRECTOR")B=await Za.getAllTasksByCompany(e);else if(a==="ADMIN")B=await Za.getAllTasksForAdmin(t,e);else if(a==="USER"){B=await Za.getAssignedTasks(e,t);const X=await Za.getAllTasksByCompany(e);if(X!=null&&X.success){const V=X.data.filter(F=>{var q;return((q=F.assignedTo)==null?void 0:q.userId)===t});V.length>(((j=B.data)==null?void 0:j.length)||0)&&(B={success:!0,data:V})}}else B=await Za.getAllTasksByCompany(e);if(B!=null&&B.success){const X=p(B.data||[],t);s(X)}else c((B==null?void 0:B.error)||"Failed to load tasks")}catch{c("Failed to load tasks")}finally{l(!1)}}},[e,t,a]),p=E.useCallback((j,B)=>B?[...j].sort((X,V)=>{var te,H;const F=((te=X.uploadedBy)==null?void 0:te.userId)===B,q=((H=V.uploadedBy)==null?void 0:H.userId)===B;return F&&!q?-1:!F&&q?1:0}):j,[]),x=E.useCallback(()=>{let j=[...r];return u==="CURRENT_USER"?j=j.filter(B=>{var V;return(((V=B.uploadedBy)==null?void 0:V.userId)||B.uploadedBy)===t}):u!=="ALL"&&(j=j.filter(B=>{var V;return(((V=B.uploadedBy)==null?void 0:V.userId)||B.uploadedBy)===parseInt(u)})),h==="CURRENT_USER"?j=j.filter(B=>{var V;return((V=B.assignedTo)==null?void 0:V.userId)===t}):h==="UNASSIGNED"?j=j.filter(B=>{var X;return!((X=B.assignedTo)!=null&&X.userId)}):h!=="ALL"&&(j=j.filter(B=>{var V;return((V=B.assignedTo)==null?void 0:V.userId)===parseInt(h)})),j},[r,u,h,t]),v=E.useCallback(async()=>{if(!(!e||!t)){l(!0),c(null);try{const j=await Za.getAssignedTasks(e,t);j!=null&&j.success?s(j.data||[]):c((j==null?void 0:j.error)||"Failed to load assigned tasks")}catch{c("Failed to load assigned tasks")}finally{l(!1)}}},[e,t]),g=E.useCallback(async()=>{if(!(!e||!t)){l(!0),c(null);try{const j=await Za.getUploadedTasks(e,t);j!=null&&j.success?s(j.data||[]):c((j==null?void 0:j.error)||"Failed to load uploaded tasks")}catch{c("Failed to load uploaded tasks")}finally{l(!1)}}},[e,t]),b=E.useCallback(async()=>{e&&a&&await m()},[e,a,m]),y=E.useCallback(async(j,B)=>{if(!e)return{success:!1,error:"Company ID is required"};try{const X=await Za.assignTask(j,e,B);return X.success&&await b(),X}catch{return{success:!1,error:"Failed to assign task"}}},[e,b]),w=E.useCallback(async j=>{if(!e)return{success:!1,error:"Company ID is required"};try{const B=await Za.assignTask(j,e,null);return B.success&&await b(),B}catch{return{success:!1,error:"Failed to unassign task"}}},[e,b]),N=E.useCallback(async(j,B)=>{if(!e||!a)return{success:!1,error:"Company ID and role are required"};try{const X=await Za.updateTaskStatus(j,e,B);return X.success&&s(V=>V.map(q=>q.id===j?{...q,status:B}:q)),X}catch{return{success:!1,error:"Failed to update task status"}}},[e,a]),A=E.useCallback(async j=>{if(console.log("useTasks deleteTask called with:",{taskId:j,companyId:e}),!e)return console.error("useTasks deleteTask: Missing companyId"),{success:!1,error:"Company ID is required"};try{console.log("useTasks deleteTask: Calling TaskService.deleteTask");const B=await Za.deleteTask(j,e);return console.log("useTasks deleteTask: Result:",B),B.success&&(s(X=>X.filter(V=>V.id!==j)),console.log("useTasks deleteTask: Task removed from local state")),B}catch(B){return console.error("useTasks deleteTask: Error:",B),{success:!1,error:"Failed to delete task"}}},[e]),S=E.useCallback(async j=>{var B;if(console.log("useTasks: Upload called with:",{title:j.title,fileName:(B=j.file)==null?void 0:B.name,companyId:e,userId:t}),!e)return console.error("useTasks: Missing companyId"),{success:!1,error:"Company ID is required"};if(!t)return console.error("useTasks: Missing userId"),{success:!1,error:"User ID is required"};try{const X={...j,companyId:e,uploadedBy:t};console.log("useTasks: Calling TaskService with:",X);const V=await Za.uploadExcelFile(X);return V.success?(console.log("useTasks: Upload successful, refreshing tasks"),await b()):console.error("useTasks: Upload failed:",V.error),V}catch(X){return console.error("useTasks: Upload error in hook:",X),{success:!1,error:"Failed to upload Excel file"}}},[e,t,b]),C=E.useCallback(async j=>{if(console.log("useTasks downloadExcelFile called with:",{taskId:j,companyId:e}),!e)return console.error("useTasks downloadExcelFile: Missing companyId"),{success:!1,error:"Company ID is required"};try{console.log("useTasks downloadExcelFile: Calling TaskService.downloadFile");const B=await Za.downloadFile(j,e);return console.log("useTasks downloadExcelFile: Result:",B),B}catch(B){return console.error("useTasks downloadExcelFile: Error:",B),{success:!1,error:"Failed to download Excel file"}}},[e]);E.useEffect(()=>{e&&a&&m()},[e,a,m]);const T=E.useCallback(j=>!t||!a?!1:a==="ADMIN"||a==="DIRECTOR"?!0:j===t,[t,a]),D=E.useCallback(j=>t?j===t:!1,[t]),R=E.useCallback(()=>{c(null)},[]);return{tasks:r,loading:n,error:o,createdByFilter:u,setCreatedByFilter:d,assignedToFilter:h,setAssignedToFilter:f,getFilteredTasks:x,loadTasksByRole:m,loadAssignedTasks:v,loadUploadedTasks:g,refreshTasks:b,assignTask:y,unassignTask:w,updateTaskStatus:N,deleteTask:A,uploadExcelFile:S,downloadExcelFile:C,canManageTask:T,isTaskAssignedToUser:D,clearError:R}},jF=(e="ViewDashboard")=>{const[t,a]=E.useState(e),[r,s]=E.useState(null),[n,l]=E.useState([e]),o=E.useCallback(h=>{h!==t?(console.log(`🚀 Navigation: ${t} -> ${h}`),console.log(`📚 Previous section set to: ${t}`),console.log(`📚 Current section set to: ${h}`),s(t),a(h),l(f=>{const m=[...f,h];return console.log("📚 History updated:",m),m})):console.log(`⚠️ Navigation skipped: Already at ${h}`)},[t]),c=E.useCallback(()=>{if(console.log("🔄 goBack called"),console.log(`📚 Current section: ${t}`),console.log(`📚 Previous section: ${r}`),console.log("📚 Full history:",n),r&&r!==t){console.log(`✅ Going back to: ${r}`);const h=n.indexOf(r),f=h>0?n[h-1]:"ViewDashboard";console.log(`📚 New previous section will be: ${f}`),a(r),s(f),l(m=>{const p=m.slice(0,-1);return console.log("📚 History updated after goBack:",p),p})}else console.log("⚠️ No previous section or already at previous, going to dashboard"),a("ViewDashboard"),s(null),l(["ViewDashboard"])},[r,t,n]),u=E.useCallback(h=>{o(h)},[o]),d=E.useCallback(h=>{console.log(`🔄 resetToSection called with: ${h}`),a(h),s(null),l([h])},[]);return{currentSection:t,previousSection:r,sectionHistory:n,navigateToSection:o,goBack:c,goToSection:u,resetToSection:d}},vv=({onSectionChange:e})=>{const{user:t}=Na(),a=(t==null?void 0:t.userId)||(t==null?void 0:t.id),r=t==null?void 0:t.companyId,{unreadCount:s,markAllAsRead:n,loading:l,error:o}=tT(a,r),c=async()=>{try{s>0&&(await n()).success,e&&e("ViewNotification")}catch{}};return i.jsx("div",{className:"relative",children:i.jsxs("button",{onClick:c,className:"p-2 hover:bg-blue-600 rounded-full transition-colors relative",title:`View Notifications ${s>0?`(${s} unread)`:""}`,disabled:l,children:[i.jsx(Gu,{size:20,className:"text-yellow-300"}),s>0&&i.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold z-10",style:{minWidth:"20px",minHeight:"20px"},children:s>99?"99+":s})]})})},_F=(e="U",t=44,a="6B7280",r="FFFFFF")=>{const s=Math.floor(t*.4),n=`
    <svg width="${t}" height="${t}" viewBox="0 0 ${t} ${t}" xmlns="http://www.w3.org/2000/svg">
      <rect width="${t}" height="${t}" fill="#${a}" rx="${t/2}"/>
      <text x="50%" y="50%" text-anchor="middle" dy="0.35em" fill="#${r}" font-family="system-ui, -apple-system, sans-serif" font-size="${s}" font-weight="600">
        ${e.toUpperCase()}
      </text>
    </svg>
  `.trim();return`data:image/svg+xml;base64,${btoa(n)}`},RF=e=>{if(!e||typeof e!="string")return"U";const t=e.trim().split(/\s+/);return t.length===1?t[0].charAt(0).toUpperCase():(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase()},DF=e=>{if(!e)return"6B7280";const t=["3B82F6","10B981","F59E0B","EF4444","8B5CF6","F97316","06B6D4","EC4899","84CC16","6366F1"];let a=0;for(let r=0;r<e.length;r++)a=e.charCodeAt(r)+((a<<5)-a);return t[Math.abs(a)%t.length]},xu=(e,t=44)=>{const a=RF(e),r=DF(e);return _F(a,t,r,"FFFFFF")};function OF({onAddAction:e=()=>{},userName:t="",userRole:a="",companyName:r="",onSidebarToggle:s=()=>{},onSectionChange:n=()=>{}}){const[l,o]=E.useState(!1),[c,u]=E.useState(null),d=E.useRef(null),[h,f]=E.useState(!1),m=E.useRef(null),p=()=>{switch(a.toUpperCase()){case"ADMIN":return[{id:"User",label:"User"},{id:"Lead",label:"Lead"},{id:"Properties",label:"Properties"},{id:"Notes",label:"Notes/Event"},{id:"Task",label:"Calling Data"}];case"USER":return[{id:"Lead",label:"Lead"},{id:"Properties",label:"Properties"},{id:"Notes",label:"Notes/Event"}];case"DIRECTOR":return[{id:"User",label:"User/Admin"},{id:"Lead",label:"Lead"},{id:"Properties",label:"Properties"},{id:"Notes",label:"Notes/Event"},{id:"Task",label:"Calling Data"}];default:return[]}},x=()=>{clearTimeout(d.current),o(!0)},v=()=>{d.current=setTimeout(()=>{o(!1)},1e3)},g=p(),b=async()=>{try{const y=JSON.parse(localStorage.getItem("user")||"{}"),w=y.userId||y.id;if(w){const N=await Re.getAvatar(w);N.success&&N.data?u(N.data):u(null)}}catch{u(null)}};return E.useEffect(()=>{b()},[t]),E.useEffect(()=>{const y=w=>{m.current&&!m.current.contains(w.target)&&f(!1)};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]),i.jsx("header",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg sticky top-0 z-40",children:i.jsxs("div",{className:"px-3 sm:px-4 md:px-6 lg:px-8 py-3 md:py-4",children:[i.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center justify-between w-full lg:w-auto",children:[i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-semibold mb-1 truncate",children:["Welcome ",i.jsx("span",{className:"font-bold",children:r||"Company Name"})]}),i.jsx("p",{className:"text-blue-100 text-sm md:text-base hidden sm:block",children:"Let's take a detailed look at our workplace..."})]}),i.jsx("div",{className:"lg:hidden ml-4 flex-shrink-0",children:i.jsx("button",{className:"p-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors duration-200",onClick:s,"aria-label":"Open menu",children:i.jsx(vO,{size:20})})})]}),i.jsxs("div",{className:"hidden md:flex items-center gap-3 lg:gap-4 flex-wrap justify-end w-full lg:w-auto",children:[i.jsxs("div",{className:"relative hidden xl:block",children:[i.jsx("input",{type:"text",placeholder:"Search here",className:"bg-white text-gray-900 placeholder-gray-500 px-4 py-2 pl-10 rounded-lg w-64 xl:w-72 focus:outline-none focus:ring-2 focus:ring-blue-300 transition-all duration-200"}),i.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18})]}),i.jsx(vv,{onSectionChange:n}),g.length>0&&i.jsxs("div",{className:"relative",onMouseEnter:x,onMouseLeave:v,children:[i.jsxs("button",{className:"flex items-center gap-2 bg-white text-blue-600 px-3 md:px-4 py-2 rounded-full font-medium shadow hover:bg-blue-50 transition-colors duration-200 text-sm md:text-base",children:[i.jsx(O0,{size:16,className:"md:w-[18px] md:h-[18px]"}),i.jsx("span",{className:"hidden sm:inline",children:"Add"}),i.jsx(wS,{size:14,className:"md:w-4 md:h-4"})]}),i.jsx(Jn,{children:l&&i.jsx(wt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 top-full mt-2 bg-white rounded-lg shadow-xl border border-gray-200 py-2 min-w-48 z-50",children:g.map(y=>i.jsx("button",{onClick:()=>{e(y.id),o(!1)},className:"w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 transition",children:y.label},y.id))})})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-medium text-sm md:text-base truncate max-w-32",children:t||"User Name"}),i.jsx("div",{className:"text-xs md:text-sm text-blue-100",children:a||"User"})]}),i.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-full border-2 border-white overflow-hidden bg-gray-300 flex items-center justify-center flex-shrink-0 shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 cursor-pointer",children:i.jsx("img",{src:c||xu(t,48),alt:"Profile",className:"w-full h-full object-cover",onError:()=>u(xu(t,48))})})]})]})]}),i.jsxs("div",{className:"md:hidden mt-4 flex items-center justify-between gap-3",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx("input",{type:"text",placeholder:"Search...",className:"bg-white text-gray-900 placeholder-gray-500 px-3 py-2 pl-9 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-300 text-sm"}),i.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx(vv,{onSectionChange:n})}),i.jsxs("div",{className:"flex items-center gap-2 bg-blue-600 px-3 py-2 rounded-lg",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-medium text-xs truncate max-w-20",children:t||"User"}),i.jsx("div",{className:"text-xs text-blue-200",children:a||"Role"})]}),i.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white overflow-hidden bg-gray-300 flex items-center justify-center flex-shrink-0",children:i.jsx("img",{src:c||xu(t,32),alt:"Profile",className:"w-full h-full object-cover",onError:()=>u(xu(t,32))})})]})]}),g.length>0&&i.jsxs("div",{className:"md:hidden fixed bottom-6 right-6 z-50",ref:m,children:[i.jsxs("button",{className:"mobile-plus-btn flex items-center justify-center w-14 h-14 bg-gradient-to-br from-green-400 to-green-600 text-white rounded-full shadow-2xl transition-all duration-300 transform active:scale-95 relative overflow-hidden",onClick:()=>f(!h),"aria-label":"Quick Add Menu",children:[i.jsx("div",{className:"plus-icon-container transition-transform duration-300",children:i.jsx(O0,{size:24,className:"transition-all duration-300"})}),i.jsx("div",{className:"ripple-effect absolute inset-0 rounded-full bg-white opacity-0 scale-0 transition-all duration-300"})]}),i.jsx(Jn,{children:h&&i.jsxs(wt.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{duration:.2},className:"absolute bottom-full right-0 mb-3 bg-white rounded-lg shadow-2xl border border-gray-200 py-2 min-w-48 z-50",children:[i.jsx("div",{className:"px-3 py-2 border-b border-gray-100",children:i.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Quick Add"})}),g.map(y=>i.jsxs("button",{onClick:()=>{e(y.id),f(!1)},className:"w-full text-left px-3 py-2 text-gray-700 hover:bg-gray-50 transition-colors duration-150 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("span",{className:"text-sm",children:y.label})]},y.id))]})})]})]})})}const FF=({currentSection:e,onSectionClick:t})=>{const a=s=>({ViewDashboard:"Dashboard",ViewUsers:"Users",ViewLead:"Leads",ViewProperty:"Properties",ViewNotes:"Notes/Events",ViewTask:"Calling Data",ViewNotification:"Notifications",ViewAccount:"Account",ViewCompany:"Companies",ViewAdmins:"Admins",ViewDirectors:"Directors",addCompany:"Add Company",User:"Add User",AddAdmin:"Add Admin",Lead:"Add Lead",Properties:"Add Property",Notes:"Add Note/Event",Task:"Add Task"})[s]||s,r=s=>({ViewDashboard:"🏠",ViewUsers:"👥",ViewLead:"📋",ViewProperty:"🏢",ViewNotes:"📝",ViewTask:"📞",ViewNotification:"🔔",ViewAccount:"👤",ViewCompany:"🏢",ViewAdmins:"👑",ViewDirectors:"👨‍💼",addCompany:"➕",User:"➕",AddAdmin:"➕",Lead:"➕",Properties:"➕",Notes:"➕",Task:"➕"})[s]||"📄";return i.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-4",children:[i.jsxs("button",{onClick:()=>t("ViewDashboard"),className:"flex items-center hover:text-blue-600 transition-colors",children:[i.jsx(TS,{size:16,className:"mr-1"}),"Dashboard"]}),e!=="ViewDashboard"&&i.jsxs(i.Fragment,{children:[i.jsx(Ed,{size:16}),i.jsxs("span",{className:"flex items-center",children:[i.jsx("span",{className:"mr-2",children:r(e)}),a(e)]})]})]})},LF=e=>{const[t,a]=E.useState([]),[r,s]=E.useState(!1),[n,l]=E.useState(null),o=E.useCallback(()=>e||JSON.parse(localStorage.getItem("user")||"{}").companyId,[e]),c=E.useCallback(async()=>{const u=o();if(!u){l("Company ID is required");return}s(!0),l(null);try{const d=await I0.getTodayFollowUps(u);d.success?a(d.data):l(d.error)}catch{l("Failed to load today's follow-ups")}finally{s(!1)}},[o]);return E.useEffect(()=>{c()},[c]),{todayFollowUps:t,loading:r,error:n,loadTodayFollowUps:c}},MF=()=>{try{const{user:e}=Na(),t=e==null?void 0:e.companyId,a=(e==null?void 0:e.userId)||(e==null?void 0:e.id),r=e==null?void 0:e.role;if(!e||!a||!r)return i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Authentication Required"}),i.jsx("p",{className:"text-yellow-700",children:"Please log in to view dashboard statistics."})]})});const{stats:s,loading:n,error:l}=AF(t,a,r),{todayEvents:o,loading:c,error:u}=kF(t,a,r),{todayFollowUps:d,loading:h,error:f}=LF(t),m=n||c||h;if(m)return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[...Array(3)].map((v,g)=>i.jsx("div",{className:"bg-gray-200 animate-pulse h-32 rounded-xl"},g))}),i.jsx("div",{className:"bg-gray-200 animate-pulse h-64 rounded-xl"})]});let p=null;try{const v=localStorage.getItem("user");if(v){const g=JSON.parse(v);p=g.userId||g.id}}catch{}const x=(d||[]).filter(v=>v.userId===p);return i.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[r==="DEVELOPER"?i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[i.jsx(pu,{title:"Total Companies",count:(s==null?void 0:s.totalCompanies)||0,icon:cn,color:"blue"}),i.jsx(pu,{title:"Total Users",count:(s==null?void 0:s.totalUsers)||0,icon:ra,color:"green"}),i.jsx(pu,{title:"Total Admins",count:(s==null?void 0:s.totalAdmins)||0,icon:F0,color:"purple"}),i.jsx(pu,{title:"Total Directors",count:(s==null?void 0:s.totalDirectors)||0,icon:Oa,color:"orange"})]}):r==="USER"?i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:[i.jsx(bv,{totalLeads:s==null?void 0:s.totalLeads,newLeads:s==null?void 0:s.newLeads,contactedLeads:s==null?void 0:s.contactedLeads}),i.jsx(Ev,{propertyOverview:s==null?void 0:s.propertyOverview}),i.jsx(wv,{dealsOverview:s==null?void 0:s.dealsOverview})]}):i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4 sm:gap-6",children:[i.jsx(bv,{totalLeads:s==null?void 0:s.totalLeads,newLeads:s==null?void 0:s.newLeads,contactedLeads:s==null?void 0:s.contactedLeads}),i.jsx(Ev,{propertyOverview:s==null?void 0:s.propertyOverview}),i.jsx(wv,{dealsOverview:s==null?void 0:s.dealsOverview}),i.jsx(UF,{usersOverview:s==null?void 0:s.usersOverview})]}),r!=="DEVELOPER"&&i.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(wr,{className:"text-blue-600 mr-2 sm:mr-3 flex-shrink-0",size:20}),i.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:"Your Events for Today"})]}),!o||o.length===0?i.jsx(BF,{}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full min-w-[500px]",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-2 sm:py-3 px-2 sm:px-4 font-medium text-gray-700 text-sm sm:text-base",children:"Content"}),i.jsx("th",{className:"text-left py-2 sm:py-3 px-2 sm:px-4 font-medium text-gray-700 text-sm sm:text-base",children:"Time"}),i.jsx("th",{className:"text-left py-2 sm:py-3 px-2 sm:px-4 font-medium text-gray-700 text-sm sm:text-base hidden sm:table-cell",children:"Created By"})]})}),i.jsx("tbody",{children:(o||[]).map(v=>i.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsx("td",{className:"py-2 sm:py-3 px-2 sm:px-4 text-sm sm:text-base",children:i.jsx("div",{className:"truncate max-w-[200px] sm:max-w-none",children:(v==null?void 0:v.content)||"No content"})}),i.jsx("td",{className:"py-2 sm:py-3 px-2 sm:px-4 text-sm sm:text-base",children:v!=null&&v.dateTime?new Date(v.dateTime).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Kolkata"}):"No time"}),i.jsx("td",{className:"py-2 sm:py-3 px-2 sm:px-4 text-sm sm:text-base hidden sm:table-cell",children:(v==null?void 0:v.username)||"Unknown"})]},(v==null?void 0:v.id)||Math.random()))})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[i.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[i.jsx(Cl,{className:"text-green-600 mr-2 sm:mr-3 flex-shrink-0",size:20}),i.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:"Today's Follow-ups"})]}),i.jsxs("div",{className:"text-xs sm:text-sm text-green-600 bg-green-50 px-2 sm:px-3 py-1 rounded-full whitespace-nowrap",children:["🔔 ",i.jsx("span",{className:"hidden sm:inline",children:"Auto "}),"Notifications"]})]}),!d||d.length===0?i.jsx(IF,{}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-gray-200",children:[i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Lead"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Note"}),i.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Time"})]})}),i.jsx("tbody",{children:x.map(v=>{var g,b;return i.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"font-medium text-gray-900",children:((g=v==null?void 0:v.lead)==null?void 0:g.name)||"Unknown Lead"}),i.jsx("div",{className:"text-sm text-gray-500",children:((b=v==null?void 0:v.lead)==null?void 0:b.phone)||"No phone"})]}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"max-w-xs truncate",children:(v==null?void 0:v.note)||"No note"})}),i.jsx("td",{className:"py-3 px-4",children:v!=null&&v.followupDate?new Date(v.followupDate).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Kolkata"}):"No time"})]},(v==null?void 0:v.id)||Math.random())})})]})})]})]})]})}catch{return i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Error Loading Dashboard"}),i.jsx("p",{className:"text-red-700",children:"Something went wrong while loading dashboard statistics. Please try refreshing the page."})]})})}},bv=({totalLeads:e,newLeads:t,contactedLeads:a})=>{const r=t||0,s=a||0,n=r+s;return i.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-100",children:"Leads Overview"}),i.jsx(ym,{size:32,className:"text-blue-200"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ym,{size:16,className:"text-blue-200"}),i.jsx("span",{className:"text-sm font-medium text-blue-100",children:"Total"})]}),i.jsx("span",{className:"text-2xl font-bold",children:n})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ra,{size:16,className:"text-blue-200"}),i.jsx("span",{className:"text-sm font-medium text-blue-100",children:"New"})]}),i.jsx("span",{className:"text-xl font-semibold",children:r})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Jr,{size:16,className:"text-blue-200"}),i.jsx("span",{className:"text-sm font-medium text-blue-100",children:"Contacted"})]}),i.jsx("span",{className:"text-xl font-semibold",children:s})]})]})]})},UF=({usersOverview:e})=>{if(!e)return i.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-purple-100",children:"Users & Admins"}),i.jsx(ra,{size:32,className:"text-purple-200"})]}),i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-purple-200",children:"Loading user data..."})})]});if(e.hasOwnProperty("totalAssignedUsers")){const{totalAssignedUsers:a=0,activeAssignedUsers:r=0,deactiveAssignedUsers:s=0}=e;return i.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-purple-100",children:"Assigned Users"}),i.jsx(ra,{size:32,className:"text-purple-200"})]}),i.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-purple-400",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ra,{size:18,className:"text-purple-200"}),i.jsx("span",{className:"text-base font-medium text-purple-100",children:"Total Assigned"})]}),i.jsx("span",{className:"text-3xl font-bold",children:a})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(Oa,{size:14,className:"text-purple-200"}),i.jsx("span",{className:"text-xs font-medium text-purple-100",children:"Active Users"})]}),i.jsx("span",{className:"text-xl font-bold",children:r})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(NS,{size:14,className:"text-purple-200"}),i.jsx("span",{className:"text-xs font-medium text-purple-100",children:"Inactive Users"})]}),i.jsx("span",{className:"text-xl font-bold",children:s})]})]})]})}else{const{totalUsers:a=0,activeNormalUsers:r=0,activeAdmins:s=0,totalNormalUsers:n=0,totalAdmins:l=0}=e;return i.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-purple-100",children:"Users & Admins"}),i.jsx(ra,{size:32,className:"text-purple-200"})]}),i.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-purple-400",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ra,{size:18,className:"text-purple-200"}),i.jsx("span",{className:"text-base font-medium text-purple-100",children:"Total Users"})]}),i.jsx("span",{className:"text-3xl font-bold",children:a})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(Oa,{size:14,className:"text-purple-200"}),i.jsx("span",{className:"text-xs font-medium text-purple-100",children:"Active Users"})]}),i.jsx("span",{className:"text-xl font-bold",children:r})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(F0,{size:14,className:"text-purple-200"}),i.jsx("span",{className:"text-xs font-medium text-purple-100",children:"Active Admins"})]}),i.jsx("span",{className:"text-xl font-bold",children:s})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(ra,{size:14,className:"text-purple-200"}),i.jsx("span",{className:"text-xs font-medium text-purple-100",children:"Normal Users"})]}),i.jsx("span",{className:"text-xl font-bold",children:n})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(F0,{size:14,className:"text-purple-200"}),i.jsx("span",{className:"text-xs font-medium text-purple-100",children:"Total Admins"})]}),i.jsx("span",{className:"text-xl font-bold",children:l})]})]})]})}},wv=({dealsOverview:e})=>{if(!e)return i.jsxs("div",{className:"bg-gradient-to-r from-violet-500 to-violet-600 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white-100",children:"Deals Overview"}),i.jsx(Uf,{size:32,className:"text-white/80"})]}),i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-white/80",children:"Loading deals data..."})})]});const{"total close":t=0,closed:a=0,dropped:r=0}=e;return i.jsxs("div",{className:"bg-gradient-to-r from-violet-500 to-violet-600 text-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-white-100",children:"Deals Overview"}),i.jsx(Uf,{size:32,className:"text-white/80"})]}),i.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-violet-400",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Uf,{size:18,className:"text-white/80"}),i.jsx("span",{className:"text-base font-medium text-white/90",children:"Total Deals"})]}),i.jsx("span",{className:"text-3xl font-bold",children:t})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(vm,{size:14,className:"text-white/80"}),i.jsx("span",{className:"text-xs font-medium text-white/90",children:"Closed"})]}),i.jsx("span",{className:"text-xl font-bold",children:a})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(NS,{size:14,className:"text-white/80"}),i.jsx("span",{className:"text-xs font-medium text-white/90",children:"Dropped"})]}),i.jsx("span",{className:"text-xl font-bold",children:r})]})]})]})},Ev=({propertyOverview:e})=>{if(!e)return i.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-green-100",children:"Property Overview"}),i.jsx(cn,{size:32,className:"text-green-200"})]}),i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-green-200",children:"Loading property data..."})})]});const{totalProperties:t=0,"available for sale":a=0,"available for rent":r=0,"sold out":s=0,"rent out":n=0}=e;return i.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-green-100",children:"Property Overview"}),i.jsx(cn,{size:32,className:"text-green-200"})]}),i.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-green-400",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(cn,{size:18,className:"text-green-200"}),i.jsx("span",{className:"text-base font-medium text-green-100",children:"Total"})]}),i.jsx("span",{className:"text-3xl font-bold",children:t})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(TS,{size:14,className:"text-green-200"}),i.jsx("span",{className:"text-xs font-medium text-green-100",children:"Available for Sale"})]}),i.jsx("span",{className:"text-xl font-bold",children:a})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(fO,{size:14,className:"text-green-200"}),i.jsx("span",{className:"text-xs font-medium text-green-100",children:"Available for Rent"})]}),i.jsx("span",{className:"text-xl font-bold",children:r})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(vm,{size:14,className:"text-green-200"}),i.jsx("span",{className:"text-xs font-medium text-green-100",children:"Sold Out"})]}),i.jsx("span",{className:"text-xl font-bold",children:s})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[i.jsx(vm,{size:14,className:"text-green-200"}),i.jsx("span",{className:"text-xs font-medium text-green-100",children:"Rent Out"})]}),i.jsx("span",{className:"text-xl font-bold",children:n})]})]})]})]})},pu=({title:e,count:t,icon:a,color:r})=>{const s={blue:{bg:"from-blue-500 to-blue-600",text:"text-blue-100",icon:"text-blue-200"},green:{bg:"from-green-500 to-green-600",text:"text-green-100",icon:"text-green-200"},purple:{bg:"from-purple-500 to-purple-600",text:"text-purple-100",icon:"text-purple-200"},orange:{bg:"from-orange-500 to-orange-600",text:"text-orange-100",icon:"text-orange-200"}},n=s[r]||s.blue;return i.jsx("div",{className:`bg-gradient-to-r ${n.bg} text-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:`text-sm font-medium ${n.text} mb-2`,children:e}),i.jsx("div",{className:"text-3xl font-bold",children:t})]}),i.jsx(a,{size:32,className:n.icon})]})})},BF=()=>i.jsxs("div",{className:"text-center py-12",children:[i.jsx(wr,{className:"mx-auto text-gray-400 mb-4",size:48}),i.jsx("h4",{className:"text-lg font-medium text-gray-600 mb-2",children:"No events scheduled for today"}),i.jsx("p",{className:"text-gray-500",children:"Your schedule is clear. Great time to catch up on other tasks!"})]}),IF=()=>i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Cl,{className:"mx-auto text-gray-400 mb-4",size:48}),i.jsx("h4",{className:"text-lg font-medium text-gray-600 mb-2",children:"No follow-ups scheduled for today"}),i.jsx("p",{className:"text-gray-500",children:"All your follow-ups are up to date. Great job staying organized!"})]}),Dp=({user:e,onClose:t})=>{const{user:a}=Na(),{updateUser:r}=Rs(a==null?void 0:a.companyId),[s,n]=E.useState({userId:"",name:"",email:"",phone:"",role:"USER"}),[l,o]=E.useState(!1);E.useEffect(()=>{e&&n({userId:e.userId||"",name:e.name||"",email:e.email||"",phone:e.phone||"",role:e.role||"USER"})},[e]);const c=d=>{const{name:h,value:f}=d.target;n(m=>({...m,[h]:f}))},u=async d=>{if(d.preventDefault(),!s.name||!s.email||!s.phone){oe("❌ Please fill in all required fields.");return}o(!0);const h={name:s.name,email:s.email,phone:s.phone,role:s.role};(await r(s.userId,h)).success?(oe("✅ User updated successfully"),t()):oe("❌ Failed to update user"),o(!1)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 modal",style:{zIndex:9999},children:i.jsxs("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-md relative animate-fadeIn modal-content1",style:{zIndex:1e4},children:[i.jsx("button",{onClick:t,className:"absolute top-2 right-3 text-gray-500 hover:text-red-600 text-2xl font-bold","aria-label":"Close",children:"×"}),i.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Update User"}),i.jsxs("form",{onSubmit:u,className:"space-y-4",children:[i.jsx("input",{type:"hidden",name:"userId",value:s.userId}),i.jsx("input",{name:"name",type:"text",placeholder:"Name",value:s.name,onChange:c,className:"w-full border px-3 py-2 rounded",required:!0}),i.jsx("input",{name:"email",type:"email",placeholder:"Email",value:s.email,onChange:c,className:"w-full border px-3 py-2 rounded",required:!0}),i.jsx("input",{name:"phone",type:"text",placeholder:"Phone",value:s.phone,onChange:c,className:"w-full border px-3 py-2 rounded",required:!0}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"role",className:"block font-medium mb-1",children:"Role:"}),i.jsxs("select",{name:"role",value:s.role,onChange:c,className:"w-full border px-3 py-2 rounded",required:!0,children:[i.jsx("option",{value:"USER",children:"USER"}),i.jsx("option",{value:"ADMIN",children:"ADMIN"})]})]}),i.jsx("button",{type:"submit",disabled:l,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white py-2 rounded",children:l?"Updating...":"Update"})]})]})})},PF=({user:e,userId:t,onClose:a,onAssigned:r})=>{const s=t||(e==null?void 0:e.userId),{user:n}=Na(),{admins:l,loading:o,assignAdmin:c}=QS(n==null?void 0:n.companyId,n==null?void 0:n.role,(n==null?void 0:n.userId)||(n==null?void 0:n.id)),[u,d]=E.useState(""),[h,f]=E.useState(!1),m=async()=>{if(!u){oe("⚠️ Please select an admin.");return}f(!0);try{(await c(s,u)).success?(oe("✅ Admin assigned successfully"),r==null||r(),a==null||a()):oe("❌ Failed to assign admin")}catch{oe("❌ Failed to assign admin")}finally{f(!1)}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md text-black relative shadow-lg",children:[i.jsx("button",{className:"absolute top-2 right-3 text-gray-700 hover:text-red-600 text-xl",onClick:a,children:"×"}),i.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Assign Admin"}),i.jsx("label",{className:"block mb-2",children:"Select Admin:"}),o?i.jsx("div",{className:"w-full border p-2 rounded mb-4 text-gray-500",children:"Loading admins..."}):l.length===0?i.jsx("div",{className:"w-full border p-2 rounded mb-4 text-red-500",children:"No admins found. Please check if there are any admin users in your company."}):i.jsxs("select",{className:"w-full border p-2 rounded mb-4",value:u,onChange:p=>d(p.target.value),children:[i.jsx("option",{value:"",children:"-- Select Admin --"}),l.map(p=>i.jsxs("option",{value:p.userId,children:[p.name," (",p.email,")"]},p.userId))]}),i.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-4 py-2 rounded w-full",onClick:m,disabled:h||!u,children:h?"Assigning...":"Assign"})]})})},Fa=({item:e,actions:t=[],className:a=""})=>{const[r,s]=E.useState(!1),[n,l]=E.useState("bottom-right"),o=E.useRef(null),c=E.useRef(null);E.useEffect(()=>{const f=m=>{o.current&&!o.current.contains(m.target)&&s(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const u=()=>{if(c.current){const f=c.current.getBoundingClientRect(),m=window.innerWidth,p=window.innerHeight,x=180,v=t.length*48+16,g=m-f.right,b=f.left,y=p-f.bottom,w=f.top;let N="right";g<x&&b>=x&&(N="left");let A="bottom";y<v&&w>=v&&(A="top"),l(`${A}-${N}`)}},d=f=>{typeof f=="function"&&f(e),s(!1)},h=()=>{r||u(),s(!r)};return i.jsxs("div",{className:`relative inline-block text-left ${a}`,ref:o,children:[i.jsx("button",{ref:c,onClick:h,className:`p-1.5 text-gray-500 hover:text-gray-700 rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 ${r?"bg-gray-100 text-gray-700 shadow-sm":""}`,title:"More actions","aria-haspopup":"true","aria-expanded":r,children:i.jsx(rO,{size:16})}),r&&i.jsx("div",{className:`fixed z-[9999] bg-white border border-gray-200 rounded-xl shadow-2xl min-w-[180px] ${n.startsWith("top")?"bottom-auto top-auto":"top-auto bottom-auto"} ${n.endsWith("left"),"right-auto left-auto"}`,role:"menu","aria-orientation":"vertical",style:{boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",top:c.current?n.startsWith("top")?c.current.getBoundingClientRect().top-8:c.current.getBoundingClientRect().bottom+8:"auto",left:c.current?n.endsWith("left")?c.current.getBoundingClientRect().right-180:c.current.getBoundingClientRect().left:"auto",transform:n.startsWith("top")?"translateY(-100%)":"none"},children:i.jsx("div",{className:"py-2",children:t.map((f,m)=>i.jsxs("button",{onClick:()=>d(f.onClick),className:`flex w-full items-center px-4 py-3 text-sm text-left hover:bg-gray-50 transition-all duration-200 first:rounded-t-lg last:rounded-b-lg ${f.danger?"text-red-600 hover:bg-red-50 hover:text-red-700":"text-gray-700 hover:text-gray-900"}`,children:[f.icon&&i.jsx("span",{className:`mr-3 flex-shrink-0 ${f.danger?"text-red-500":"text-gray-500"}`,children:f.icon}),i.jsx("span",{className:"truncate font-medium",children:f.label})]},m))})})]})},VF=({user:e,searchTerm:t,onUpdate:a,onActivate:r,onDeactivate:s,onAssignAdmin:n,onUnassignAdmin:l,isDirector:o,isDeveloper:c=!1,showCompanyColumn:u=!1})=>{const[d,h]=E.useState(!1),f=E.useRef(null),m=(v,g)=>{if(!g||!v)return v;const b=new RegExp(`(${g})`,"gi");return v.toString().split(b).map((w,N)=>b.test(w)?i.jsx("mark",{className:"bg-yellow-200 px-1 rounded",children:w},N):w)};E.useEffect(()=>{const v=g=>{f.current&&!f.current.contains(g.target)&&h(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const p=e.status===!0||e.status==="active",x=e.adminName&&e.adminName!=="No Admin";return i.jsxs("tr",{className:"text-sm text-gray-700 hover:bg-blue-50",children:[i.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:m(e.name,t)}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:m(e.email,t)}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:m(e.phone,t)}),u&&i.jsx("td",{className:"px-6 py-4 text-gray-600",children:e.companyName||"N/A"}),i.jsx("td",{className:"px-6 py-4 text-purple-700 font-medium",children:e.role}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${p?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p?"Active":"Inactive"})}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:e.adminName||"No Admin"}),i.jsx("td",{className:"px-2 py-2 text-center",children:c?i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"}):i.jsx(Fa,{item:e,actions:[{label:"Update User",icon:i.jsx(Ya,{size:14}),onClick:()=>a(e)},p?{label:"Deactivate",icon:i.jsx(ts,{size:14}),onClick:()=>s(e.userId),danger:!0}:{label:"Activate",icon:i.jsx(Oa,{size:14}),onClick:()=>r(e.userId)},...o?[x?{label:"Unassign Admin",icon:i.jsx(Lc,{size:14}),onClick:()=>l(e.userId)}:{label:"Assign Admin",icon:i.jsx(es,{size:14}),onClick:()=>n(e)}]:[]]})})]})},zF=()=>{const{user:e}=Na(),t=e==null?void 0:e.companyId,a=e==null?void 0:e.role,r=(e==null?void 0:e.userId)||(e==null?void 0:e.id),{users:s,loading:n,error:l,loadUsers:o,activateUser:c,deactivateUser:u,unassignAdmin:d,getUsersByRoleAndCompany:h,getUsersByAdmin:f,getUsersWithRole:m,getUsersWithUserRole:p}=Rs(a==="DEVELOPER"?null:t,a,r),[x,v]=E.useState(""),[g,b]=E.useState(null),[y,w]=E.useState(null),N=async()=>{if(a==="DEVELOPER"){if(!a||!r)return}else if(!t||!a||!r)return;try{a==="DEVELOPER"?await p():a==="DIRECTOR"?await h("USER"):a==="ADMIN"&&await f(r)}catch{}};E.useEffect(()=>{N()},[t,a,r]);const A=async V=>{(await c(V)).success},S=async V=>{(await u(V)).success},C=async V=>{(await d(V)).success},T=()=>{b(null),N()},D=()=>{w(null)},R=()=>{N()},j=s.filter(V=>{var q,te,H,le,W,_,G,Y,z,ie;const F=x.toLowerCase();return a==="DEVELOPER"?((q=V.name)==null?void 0:q.toLowerCase().includes(F))||((te=V.email)==null?void 0:te.toLowerCase().includes(F))||((H=V.userId)==null?void 0:H.toString().includes(F))||((W=((le=V.company)==null?void 0:le.name)||V.companyName||"")==null?void 0:W.toLowerCase().includes(F)):((_=V.name)==null?void 0:_.toLowerCase().includes(F))||((G=V.email)==null?void 0:G.toLowerCase().includes(F))||((Y=V.phone)==null?void 0:Y.toLowerCase().includes(F))||((z=V.role)==null?void 0:z.toLowerCase().includes(F))||((ie=V.adminName)==null?void 0:ie.toLowerCase().includes(F))}),B=a==="DIRECTOR",X=()=>i.jsx("div",{className:"space-y-4 animate-pulse",children:[...Array(3)].map((V,F)=>i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 p-4 bg-gray-100 rounded-lg",children:[i.jsx("div",{className:"h-4 w-1/3 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-20 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]},F))});return i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",initial:{opacity:0,y:-60},animate:{opacity:1,y:0},transition:{duration:.6,type:"spring"},children:[a==="DEVELOPER"?i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Users"}),i.jsx("input",{type:"text",placeholder:"Search users...",value:x,onChange:V=>v(V.target.value),className:"px-4 py-2 border border-gray-300 rounded w-full max-w-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}):i.jsxs("div",{className:"sticky top-0 bg-white z-10 pb-4",children:[i.jsxs("div",{className:"flex justify-center items-center gap-3 mb-3",children:[i.jsx(ra,{className:"text-gray-500",size:28}),i.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Users Management"})]}),i.jsx("div",{className:"flex justify-center",children:i.jsx("input",{type:"text",placeholder:"Search users...",value:x,onChange:V=>v(V.target.value),className:"mb-4 px-4 py-2 border border-gray-300 rounded w-full max-w-md"})})]}),n?X():i.jsx(i.Fragment,{children:a==="DEVELOPER"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{id:"userTable",className:"min-w-full border border-gray-300",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"User ID"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Name"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Email"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Phone"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Company"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Status"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Actions"})]})}),i.jsx("tbody",{children:j.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"6",className:"border border-gray-300 px-4 py-8 text-center text-gray-500",children:"No users found."})}):j.map(V=>{var te;const F=((te=V.company)==null?void 0:te.name)||V.companyName||"No Company",q=V.status===!0||V.status==="active";return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:V.userId}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:V.name}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:V.email}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:V.phone}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:F}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${q?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:q?"Active":"Inactive"})}),i.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"})})]},V.userId)})})]})}),i.jsx("div",{className:"space-y-4 md:hidden",children:j.length===0?i.jsx("p",{className:"text-gray-500 text-center",children:"No users found."}):j.map(V=>{var te;const F=((te=V.company)==null?void 0:te.name)||V.companyName||"No Company",q=V.status===!0||V.status==="active";return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"font-semibold text-lg text-gray-800",children:V.name}),i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"ID:"}),i.jsx("span",{className:"text-gray-700",children:V.userId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:V.email})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Company:"}),i.jsx("span",{className:"text-gray-700",children:F})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${q?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:q?"Active":"Inactive"})]})]})]},V.userId)})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block max-h-[500px] overflow-y-auto rounded-lg border border-gray-200 shadow-sm",children:i.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-sm text-gray-800 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Name"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Email"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Phone"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Role"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Status"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Admin"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-center font-semibold",children:"Actions"})]})}),i.jsx("tbody",{children:j.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"7",className:"text-center py-6 text-gray-500",children:"No users found."})}):j.map(V=>i.jsx(VF,{user:V,searchTerm:x,onUpdate:b,onActivate:A,onDeactivate:S,onAssignAdmin:w,onUnassignAdmin:C,isDirector:B,isDeveloper:a==="DEVELOPER",showCompanyColumn:!1},V.userId))})]})}),i.jsx("div",{className:"space-y-4 md:hidden",children:j.length===0?i.jsx("p",{className:"text-gray-500 text-center",children:"No users found."}):j.map(V=>{const F=V.status===!0||V.status==="active",q=V.adminName&&V.adminName!=="No Admin";return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"font-semibold text-lg text-gray-800",children:V.name}),i.jsx(Fa,{item:V,actions:[{label:"Update User",icon:i.jsx(Ya,{size:14}),onClick:()=>b(V)},F?{label:"Deactivate",icon:i.jsx(ts,{size:14}),onClick:()=>S(V.userId),danger:!0}:{label:"Activate",icon:i.jsx(Oa,{size:14}),onClick:()=>A(V.userId)},...B?[q?{label:"Unassign Admin",icon:i.jsx(Lc,{size:14}),onClick:()=>C(V.userId),danger:!0}:{label:"Assign Admin",icon:i.jsx(es,{size:14}),onClick:()=>w(V)}]:[]]})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:V.email})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Phone:"}),i.jsx("span",{className:"text-gray-700",children:V.phone})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Role:"}),i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:V.role})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${F?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:F?"Active":"Inactive"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Admin:"}),i.jsx("span",{className:"text-gray-700",children:V.adminName||"No Admin"})]})]})]},V.userId)})})]})}),g&&((a==null?void 0:a.toUpperCase())==="DIRECTOR"||(a==null?void 0:a.toUpperCase())==="ADMIN"||(a==null?void 0:a.toUpperCase())==="DEVELOPER")&&i.jsx(Dp,{user:g,onClose:T}),y&&a==="DIRECTOR"&&i.jsx(PF,{user:y,onClose:D,onAssigned:R})]})},HF=()=>{const[e,t]=E.useState(""),[a,r]=E.useState([]),[s,n]=E.useState({status:"",budget:"",source:"",assignedTo:"",createdBy:"",dateRange:""}),[l,o]=E.useState(!1),[c,u]=E.useState(null),d=E.useMemo(()=>{const T={},D=[...a];return e.trim()&&D.push(e.trim()),D.length>0&&(T.query=D.join(" ")),Object.entries(s).forEach(([R,j])=>{if(j&&j.trim())switch(R){case"assignedTo":T.assignedTo=j.trim();break;case"createdBy":T.createdBy=j.trim();break;case"status":T.status=j.trim();break;case"source":T.source=j.trim();break;case"budget":T.budget=j.trim();break;case"dateRange":T.dateRange=j.trim();break;default:T[R]=j.trim()}}),T},[e,a,s]),h=E.useMemo(()=>e.trim()||a.length>0||Object.values(s).some(T=>T&&T.trim()),[e,a,s]),f=E.useCallback((T,D)=>{n(R=>({...R,[T]:D}))},[]),m=E.useCallback(T=>{n(D=>({...D,...T}))},[]),p=E.useCallback(()=>{t(""),r([]),n({status:"",budget:"",source:"",assignedTo:"",createdBy:"",dateRange:""}),o(!1),u(null)},[]),x=E.useCallback(()=>{t(""),r([])},[]),v=E.useCallback(T=>{const D=T.trim();D&&!a.includes(D)&&(r(R=>[...R,D]),t(""))},[a]),g=E.useCallback(T=>{r(D=>D.filter(R=>R!==T))},[]),b=E.useCallback(()=>{e.trim()&&v(e)},[e,v]),y=E.useCallback(()=>{n({status:"",budget:"",source:"",assignedTo:"",createdBy:"",dateRange:""})},[]),w=E.useCallback(()=>{h?(u(d),o(!0)):(u(null),o(!1))},[h,d]),N=E.useCallback(()=>{const T=setTimeout(()=>{w()},300);return()=>clearTimeout(T)},[w]),A=E.useCallback(T=>{t(""),r([]),n({status:"",budget:"",source:"",assignedTo:"",createdBy:"",dateRange:""}),n(R=>({...R,...T}));const D={...T};return u(D),o(!0),D},[]),S=E.useCallback(T=>({"0-500000":"Below ₹5 Lakh","500000-1000000":"₹5-10 Lakh","1000000-2000000":"₹10-20 Lakh","2000000-5000000":"₹20-50 Lakh","5000000-10000000":"₹50L-1 Crore","10000000-99999999":"Above ₹1 Crore"})[T]||T,[]),C=E.useCallback(()=>{const T=[];return a.length>0&&T.push(`Search: ${a.join(", ")}`),Object.entries(s).forEach(([D,R])=>{if(R&&R.trim())switch(D){case"budget":T.push(`Budget: ${S(R)}`);break;case"status":T.push(`Status: ${R}`);break;case"source":T.push(`Source: ${R}`);break;case"assignedTo":T.push(`Assigned: ${R}`);break;case"createdBy":T.push(`Created By: ${R}`);break;default:T.push(`${D}: ${R}`)}}),T},[a,s,S]);return{searchTerm:e,searchTags:a,filters:s,isSearchActive:l,activeSearchParams:c,hasActiveFilters:h,searchParams:d,setSearchTerm:t,addSearchTag:v,removeSearchTag:g,handleSearchEnter:b,updateFilter:f,updateFilters:m,clearAll:p,clearSearch:x,clearFilters:y,applySearch:w,autoApplySearch:N,applyQuickFilters:A,getActiveFiltersSummary:C,getBudgetRangeText:S}},GF=(e,t)=>{if(e==null)return"";if(t==="createdAt"&&e)try{return new Date(e).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch{return String(e)}if((t==="budget"||t==="price")&&e)try{return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(e)}catch{return String(e)}return t==="status"&&e?{NEW:"New",CONTACTED:"Contacted",CLOSED:"Closed",DROPED:"Dropped",AVAILABLE_FOR_SALE:"For Sale",AVAILABLE_FOR_RENT:"For Rent",SOLD_OUT:"Sold Out",RENT_OUT:"Rented Out"}[e]||e:String(e)},$F=(e,t)=>{if(!e||e.length===0)return"";const a=t.map(s=>`"${s.header}"`).join(","),r=e.map(s=>t.map(n=>{let l=s[n.key];return n.key.includes(".")&&(l=n.key.split(".").reduce((u,d)=>u==null?void 0:u[d],s)),`"${GF(l,n.key).replace(/"/g,'""')}"`}).join(","));return[a,...r].join(`
`)},YF=(e,t)=>{const a=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const s=URL.createObjectURL(a);r.setAttribute("href",s),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},rT=(e,t,a)=>{try{if(!Array.isArray(e))throw new Error("Data must be an array");if(!Array.isArray(t)||t.length===0)throw new Error("Columns must be a non-empty array");if(!a||typeof a!="string")throw new Error("Filename must be a non-empty string");const r=$F(e,t),s=new Date().toISOString().split("T")[0],n=`${a}_${s}.csv`;return YF(r,n),{success:!0,message:`Exported ${e.length} records to ${n}`}}catch(r){return{success:!1,message:`Export failed: ${r.message}`}}},sT={leads:[{key:"name",header:"Lead Name"},{key:"phone",header:"Phone"},{key:"status",header:"Status"},{key:"budget",header:"Budget"},{key:"requirement",header:"Requirement"},{key:"location",header:"Location"},{key:"source",header:"Source"},{key:"createdAt",header:"Created Date"},{key:"assignedToSummary.name",header:"Assigned To"}],properties:[{key:"propertyName",header:"Property Name"},{key:"status",header:"Status"},{key:"type",header:"Type"},{key:"price",header:"Price"},{key:"location",header:"Location"},{key:"sector",header:"Sector"},{key:"bhk",header:"BHK"},{key:"unitDetails",header:"Unit Details"},{key:"floor",header:"Floor"},{key:"ownerContact",header:"Owner Contact"},{key:"source",header:"Source"},{key:"createdAt",header:"Created Date"}]},qF=e=>rT(e,sT.leads,"leads_export"),XF=e=>rT(e,sT.properties,"properties_export"),KF=({searchTerm:e,searchTags:t=[],onSearchTermChange:a,onSearchEnter:r,onRemoveSearchTag:s,onSearch:n,onExport:l,onToggleMobileFilters:o,onClearSearch:c,onRefresh:u,isSearchActive:d=!1,isLoading:h=!1,autoSearch:f=!1})=>{const m=v=>{const g=v.target.value;a(g)},p=v=>{v.key==="Enter"&&(v.preventDefault(),r?r():n())},x=()=>{c()};return i.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[i.jsxs("div",{className:"flex-1 min-w-[300px] relative",children:[t.length>0&&i.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.map((v,g)=>i.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full border",children:[i.jsx("span",{children:v}),i.jsx("button",{onClick:()=>s&&s(v),className:"text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full p-0.5",title:`Remove "${v}" tag`,children:i.jsx(wa,{size:12})})]},g))}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:t.length>0?"Add more search terms...":"Search by name, phone, email, location, requirement, reference, source, status, budget, assigned user... (Press Enter to add as tag)",value:e,onChange:m,onKeyDown:p,className:"w-full px-3 py-2 pr-10 text-sm border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"}),(e||t.length>0)&&i.jsx("button",{onClick:x,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"Clear all search terms",children:i.jsx(wa,{size:16})})]}),d&&i.jsx("div",{className:"absolute -bottom-5 left-0 text-xs text-blue-600",children:"Search active"})]}),!f&&i.jsxs("button",{onClick:n,disabled:h,className:"bg-blue-600 text-white px-4 py-2 text-sm rounded hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[i.jsx(pn,{size:14}),h?"Searching...":"Search"]}),i.jsxs("button",{onClick:u,disabled:h,className:"bg-gray-600 text-white px-4 py-2 text-sm rounded hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",title:"Refresh leads",children:[i.jsx(Sd,{size:14,className:h?"animate-spin":""}),"Refresh"]}),i.jsxs("button",{onClick:l,disabled:h,className:"bg-green-600 text-white px-4 py-2 text-sm rounded hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",title:"Export leads",children:[i.jsx(Np,{size:14}),"Export"]}),i.jsxs("button",{onClick:o,className:"md:hidden bg-gray-500 text-white px-4 py-2 text-sm rounded hover:bg-gray-600 transition-colors flex items-center gap-2",title:"Toggle filters",children:[i.jsx(Nd,{size:14}),"Filters"]})]})},Nv=({filters:e,onFilterChange:t,onClearFilters:a,isMobile:r=!1,hasActiveFilters:s=!1,autoApply:n=!1,userRole:l=null,userId:o=null,companyId:c=null,availableUsers:u=[]})=>{const d=(b,y)=>t(b,y),h="border rounded-md bg-white focus:outline-none focus:ring-blue-500",f=`w-full px-3 py-2 ${h}`,m=`px-3 py-2 text-sm min-w-[120px] ${h}`,p={status:[{value:"",label:"All Status"},{value:"NEW",label:"New"},{value:"CONTACTED",label:"Contacted"},{value:"CLOSED",label:"Closed"},{value:"DROPED",label:"Dropped"}],budget:[{value:"",label:"All Budgets"},{value:"0-500000",label:"Below ₹5L"},{value:"500000-1000000",label:"₹5L–10L"},{value:"1000000-2000000",label:"₹10L–20L"},{value:"2000000-5000000",label:"₹20L–50L"},{value:"5000000-10000000",label:"₹50L–1Cr"},{value:"10000000-99999999",label:"Above ₹1Cr"}],source:[{value:"",label:"All Sources"},{value:"INSTAGRAM",label:"Instagram"},{value:"FACEBOOK",label:"Facebook"},{value:"YOUTUBE",label:"YouTube"},{value:"REFERENCE",label:"Reference"},{value:"NINETY_NINE_ACRES",label:"99acres"},{value:"MAGIC_BRICKS",label:"MagicBricks"}],assignedTo:[{value:"",label:"All Assignments"},{value:"assigned",label:"Assigned"},{value:"unassigned",label:"Unassigned"}]},v=(()=>{const b=[{value:"",label:"All Created By",key:"all"}];return l==="USER"?[]:((l==="ADMIN"||l==="DIRECTOR")&&b.push({value:o==null?void 0:o.toString(),label:"Me",key:`me-${o}`}),u==null||u.forEach((y,w)=>{const N=y.userId||y.id;N!==o&&b.push({value:N==null?void 0:N.toString(),label:y.name||y.username||`User ${N}`,key:`user-${N}-${w}`})}),b)})(),g=l!=="USER"&&v.length>1;return i.jsxs("div",{className:r?"bg-gray-50 border p-4 rounded-lg mb-4 space-y-3":"mb-4",children:[i.jsxs("div",{className:r?"space-y-3":"flex flex-wrap gap-2",children:[Object.entries(p).map(([b,y])=>i.jsx("select",{value:e[b]||"",onChange:w=>d(b,w.target.value),className:r?f:m,children:y.map(w=>i.jsx("option",{value:w.value,children:w.label},w.value))},b)),g&&i.jsx("select",{value:e.createdBy||"",onChange:b=>d("createdBy",b.target.value),className:r?f:m,children:v.map(b=>i.jsx("option",{value:b.value,children:b.label},b.key))}),s&&i.jsxs("button",{onClick:a,className:`${r?"w-full justify-center gap-2":"text-sm gap-1"} text-red-600 border border-red-500 px-3 py-2 rounded hover:bg-red-50 transition-colors flex items-center`,children:[i.jsx(wa,{size:r?16:14}),r?"Clear All Filters":"Clear"]})]}),n&&s&&i.jsxs("div",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Filters applied automatically"]})]})},WF=({lead:e,searchTerm:t,onStatusUpdate:a,onAddRemark:r,onGetRemarks:s,onAssign:n,onUnassign:l,onUpdate:o,onAddFollowUp:c,onViewFollowUps:u,companyId:d})=>{var D,R,j;if(!e)return null;const[h,f]=E.useState(!1),[m,p]=E.useState(!1),x=E.useRef(null),v=E.useRef(null),g=e.leadId||e.id,b=(B,X)=>{if(!X||!B)return B;const V=new RegExp(`(${X})`,"gi");return B.toString().split(V).map((q,te)=>V.test(q)?i.jsx("mark",{className:"bg-yellow-200 px-1 rounded",children:q},te):q)},y=B=>B?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(B):"N/A",w=B=>B?new Date(B).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",N=B=>B?{INSTAGRAM:"Instagram",FACEBOOK:"Facebook",YOUTUBE:"YouTube",REFERENCE:"Reference",NINETY_NINE_ACRES:"99acres",MAGIC_BRICKS:"MagicBricks"}[B]||B:"",A=(B,X="badge")=>{const V={NEW:{badge:"bg-yellow-100 text-yellow-800",button:"bg-yellow-500 hover:bg-yellow-600 text-white"},CONTACTED:{badge:"bg-blue-100 text-blue-800",button:"bg-blue-500 hover:bg-blue-600 text-white"},CLOSED:{badge:"bg-green-100 text-green-800",button:"bg-green-500 hover:bg-green-600 text-white"},DROPED:{badge:"bg-red-100 text-red-800",button:"bg-red-500 hover:bg-red-600 text-white"},DEFAULT:{badge:"bg-gray-100 text-gray-800",button:"bg-gray-500 hover:bg-gray-600 text-white"}};return(V[B]||V.DEFAULT)[X]},S=["NEW","CONTACTED","CLOSED","DROPED"],C=B=>{a(g,B),p(!1)};E.useEffect(()=>{const B=X=>{x.current&&!x.current.contains(X.target)&&f(!1),v.current&&!v.current.contains(X.target)&&p(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]);const T=((D=e.assignedToSummary)==null?void 0:D.name)||e.assignToName==="Assigned";return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:b(e.name,t)}),i.jsx("div",{className:"text-sm text-gray-500",children:e.source&&`Source: ${N(e.source)}`})]}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:b(e.phone,t)||"N/A"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"relative",ref:v,children:[i.jsxs("button",{onClick:()=>p(!m),className:`w-28 flex items-center justify-between px-2.5 py-1 rounded text-xs font-medium transition-colors ${A(e.status,"button")}`,children:[i.jsx("span",{children:e.status||"N/A"}),i.jsx(wS,{size:14})]}),m&&i.jsx("div",{className:"absolute w-28 bg-white rounded-md shadow-lg border border-gray-200 z-20 top-full mt-1 flex flex-col",children:S.map(B=>i.jsx("button",{onClick:()=>C(B),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 ${e.status===B?"font-bold text-blue-600":"text-gray-700"}`,children:B},B))})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:y(e.budget)}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:b(e.requirement,t)||"N/A"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:b(e.location,t)||"N/A"}),i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[w(e.createdAt),((R=e.createdBy)==null?void 0:R.name)&&i.jsxs("div",{className:"text-xs text-gray-400",children:["by ",e.createdBy.name]})]}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:T?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:((j=e.assignedToSummary)==null?void 0:j.name)||"Assigned"}):i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Unassigned"})}),i.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-sm font-medium",children:i.jsx(Fa,{item:e,actions:[{label:"Update Lead",icon:i.jsx(Ya,{size:14}),onClick:()=>o(e)},{label:"Add Remark",icon:i.jsx(kl,{size:14}),onClick:()=>r(e)},{label:"Add Follow-Up",icon:i.jsx(wr,{size:14}),onClick:()=>c(e)},{label:"View Follow-ups",icon:i.jsx(Cl,{size:14}),onClick:()=>u(e)},{label:"View Remarks",icon:i.jsx(ya,{size:14}),onClick:()=>s(e)},T?{label:"Unassign Lead",icon:i.jsx(Lc,{size:14}),onClick:()=>l(g)}:{label:"Assign Lead",icon:i.jsx(es,{size:14}),onClick:()=>n(g)}]})})]})},ZF=({leads:e,searchTerm:t,onStatusUpdate:a,onBulkStatusUpdate:r,onDelete:s,onAddRemark:n,onGetRemarks:l,onAssign:o,onUnassign:c,onUpdate:u,onAddFollowUp:d,onViewFollowUps:h,companyId:f})=>{const[m,p]=E.useState({key:null,direction:"asc"}),x=b=>{let y="asc";m.key===b&&m.direction==="asc"&&(y="desc"),p({key:b,direction:y})},v=[...e].sort((b,y)=>{if(!m.key)return 0;const w=b[m.key],N=y[m.key];return w<N?m.direction==="asc"?-1:1:w>N?m.direction==="asc"?1:-1:0}),g=b=>m.key!==b?"↕️":m.direction==="asc"?"↑":"↓";return i.jsx("div",{className:"hidden md:block overflow-x-auto max-h-[45vh] overflow-y-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg sticky-header",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("name"),children:["Lead Name ",g("name")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("phone"),children:["Phone ",g("phone")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("status"),children:["Status ",g("status")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("budget"),children:["Budget ",g("budget")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("requirement"),children:["Requirement ",g("requirement")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("location"),children:["Location ",g("location")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("createdAt"),children:["Created ",g("createdAt")]}),i.jsxs("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>x("assignedTo"),children:["Assigned To ",g("assignedTo")]}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(b=>i.jsx(WF,{lead:b,searchTerm:t,onStatusUpdate:a,onDelete:s,onAddRemark:n,onGetRemarks:l,onAssign:o,onUnassign:c,onUpdate:u,onAddFollowUp:d,onViewFollowUps:h,companyId:f},b.leadId||b.id))})]})})},QF=({lead:e,onStatusUpdate:t,onAddRemark:a,onViewRemarks:r,onAssign:s,onUnassign:n,onUpdate:l,onAddFollowUp:o,onViewFollowUps:c})=>{var v,g,b;if(!e)return null;const u=(e==null?void 0:e.leadId)??(e==null?void 0:e.id);if(!u)return null;const d=((v=e.assignedToSummary)==null?void 0:v.name)||e.assignToName==="Assigned",h=y=>y?new Date(y).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",f=y=>y?new Intl.NumberFormat("en-IN",{maximumFractionDigits:0}).format(y):"N/A",m=y=>y?{INSTAGRAM:"Instagram",FACEBOOK:"Facebook",YOUTUBE:"YouTube",REFERENCE:"Reference",NINETY_NINE_ACRES:"99acres",MAGIC_BRICKS:"MagicBricks"}[y]||y:"N/A",p=y=>{switch(y){case"NEW":return"bg-yellow-100 text-yellow-800";case"CONTACTED":return"bg-cyan-100 text-cyan-800";case"CLOSED":return"bg-green-100 text-green-800";case"DROPED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},x=[{label:"Update Lead",icon:i.jsx(Ya,{size:14}),onClick:()=>l(e)},{label:"Add Remark",icon:i.jsx(kl,{size:14}),onClick:()=>a(e)},{label:"Add Follow-Up",icon:i.jsx(wr,{size:14}),onClick:()=>o(e)},{label:"View Follow-ups",icon:i.jsx(Cl,{size:14}),onClick:()=>c(e)},{label:"View Remarks",icon:i.jsx(ya,{size:14}),onClick:()=>r(e)},...d?[{label:"Unassign",icon:i.jsx(Lc,{size:14}),onClick:()=>n(u)}]:[{label:"Assign",icon:i.jsx(es,{size:14}),onClick:()=>s(u)}]];return i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 relative",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:e.name||"Unnamed Lead"}),i.jsx("p",{className:"text-gray-600 text-sm",children:((g=e.assignedToSummary)==null?void 0:g.name)||"Unassigned"})]}),i.jsx(Fa,{item:e,actions:x,position:"right-0"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Phone"}),i.jsx("p",{className:"text-sm font-medium",children:e.phone||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Budget"}),i.jsxs("p",{className:"text-sm font-medium",children:["₹",f(e.budget)]})]}),e.requirement&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Requirement"}),i.jsx("p",{className:"text-sm font-medium",children:e.requirement})]})}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Source"}),i.jsx("p",{className:"text-sm font-medium",children:m(e.source)})]})]}),i.jsx("div",{className:"mb-3",children:i.jsxs("select",{value:e.status,onChange:y=>t(u,y.target.value),className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border-0 ${p(e.status)}`,children:[i.jsx("option",{value:"NEW",children:"New"}),i.jsx("option",{value:"CONTACTED",children:"Contacted"}),i.jsx("option",{value:"CLOSED",children:"Closed"}),i.jsx("option",{value:"DROPED",children:"Dropped"})]})}),i.jsxs("div",{className:"pt-3 border-t border-gray-100 text-xs text-gray-500",children:[i.jsxs("div",{className:"font-medium text-gray-700",children:["Created ",h(e.createdAt)]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["by ",((b=e.createdBy)==null?void 0:b.name)||e.createdByName||"Unknown"]})]})]})},JF=({leads:e=[],onStatusUpdate:t,onDelete:a,onAddRemark:r,onGetRemarks:s,onAssign:n,onUnassign:l,onUpdate:o,onAddFollowUp:c,onViewFollowUps:u})=>{const d=f=>(f==null?void 0:f.leadId)??(f==null?void 0:f.id),h=e.filter(f=>d(f));return i.jsx("div",{className:"md:hidden space-y-4",children:h.map(f=>{const m=d(f);return i.jsx(QF,{lead:f,onStatusUpdate:t,onAddRemark:r,onViewRemarks:s,onAssign:n,onUnassign:l,onUpdate:o,onAddFollowUp:c,onViewFollowUps:u},m)})})},e8=({currentPage:e,pagination:t,onPageChange:a})=>{const{totalPages:r,totalElements:s,size:n=10}=t;if(r<=1)return null;const o=(()=>{const d=new Set;d.add(1);for(let p=-1;p<=1;p++){const x=e+1+p;x>1&&x<r&&d.add(x)}d.add(r);const h=Array.from(d).sort((p,x)=>p-x),f=[];let m=0;for(const p of h)m&&p-m>1&&f.push("..."),f.push(p),m=p;return f})(),c=e*n+1,u=Math.min((e+1)*n,s);return i.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-6",children:[i.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[i.jsx("button",{onClick:()=>a(e-1),disabled:e===0,className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),i.jsx("button",{onClick:()=>a(e+1),disabled:e>=r-1,className:"ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:c})," to ",i.jsx("span",{className:"font-medium",children:u})," of"," ",i.jsx("span",{className:"font-medium",children:s})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"inline-flex items-center -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[i.jsx("button",{onClick:()=>a(e-1),disabled:e===0,className:"inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-blue-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:i.jsx(Ep,{className:"h-5 w-5"})}),o.map((d,h)=>d==="..."?i.jsx("span",{className:"inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-500 ring-1 ring-inset ring-gray-300",children:"..."},`ellipsis-${h}`):i.jsx("button",{onClick:()=>a(d-1),className:`inline-flex items-center px-4 py-2 text-sm font-medium ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-blue-600 ${e===d-1?"z-10 bg-blue-600 text-white":"text-gray-900"}`,"aria-current":e===d-1?"page":void 0,children:d},d)),i.jsx("button",{onClick:()=>a(e+1),disabled:e>=r-1,className:"inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-blue-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:i.jsx(Ed,{className:"h-5 w-5"})})]})})]})]})},t8=()=>i.jsx("tr",{className:"animate-pulse",children:["w-32","w-28","w-20","w-24","w-36","w-28","w-20","w-24","w-8"].map((e,t)=>i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsx("div",{className:`h-4 bg-gray-200 rounded ${e}`})},t))}),a8=()=>i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:["Lead Name","Phone","Status","Budget","Requirement","Location","Created","Assigned To","Actions"].map(e=>i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},e))})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:[...Array(8)].map((e,t)=>i.jsx(t8,{},t))})]})}),r8=()=>i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 animate-pulse space-y-4",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("div",{className:"flex-1 space-y-2",children:[i.jsx("div",{className:"h-5 bg-gray-200 rounded w-40"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-16"}),i.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-20"})]})]}),i.jsx("div",{className:"h-6 w-6 bg-gray-200 rounded"})]}),i.jsx("div",{className:"space-y-2",children:[24,32,28].map((e,t)=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"h-4 w-4 bg-gray-200 rounded"}),i.jsx("div",{className:`h-4 bg-gray-200 rounded w-${e}`})]},t))}),i.jsx("div",{className:"pt-3 border-t border-gray-100",children:i.jsx("div",{className:"h-3 w-48 bg-gray-200 rounded"})})]}),s8=()=>i.jsx("div",{className:"md:hidden space-y-4",children:[...Array(6)].map((e,t)=>i.jsx(r8,{},t))}),n8=({loading:e,error:t,isEmpty:a})=>e?i.jsxs("div",{className:"space-y-4",children:[i.jsx(a8,{}),i.jsx(s8,{}),i.jsx("div",{className:"flex justify-center py-4",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Loading leads..."]})})]}):t?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ES,{className:"mx-auto text-red-500 mb-4",size:48}),i.jsx("p",{className:"text-red-600 font-medium mb-2",children:"Error loading leads"}),i.jsx("p",{className:"text-gray-600 text-sm",children:t}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Retry"})]})}):a?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ra,{className:"mx-auto text-gray-400 mb-4",size:48}),i.jsx("p",{className:"text-gray-600 font-medium mb-2",children:"No leads found"}),i.jsx("p",{className:"text-gray-500 text-sm",children:"Try adjusting your search criteria or add new leads."})]})}):null,i8=({totalResults:e,currentPage:t,pageSize:a,activeFiltersSummary:r=[],onClearAll:s})=>{const n=Math.min(t*a+1,e),l=Math.min((t+1)*a,e),o=e>0&&n<=l;return i.jsxs("section",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 space-y-3",children:[i.jsxs("header",{className:"flex flex-wrap justify-between items-center gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-blue-800 text-sm font-semibold",children:[i.jsx(pn,{size:18,className:"text-blue-600"}),o?i.jsxs(i.Fragment,{children:["Showing ",i.jsxs("span",{className:"font-bold",children:[n,"-",l]})," of"," ",i.jsx("span",{className:"font-bold",children:e})," results"]}):i.jsx(i.Fragment,{children:"No results found"})]}),i.jsxs("button",{onClick:s,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-600 bg-white border border-red-300 rounded-md hover:bg-red-50 transition-colors",children:[i.jsx(wa,{size:14}),"Clear All Filters"]})]}),r.length>0&&i.jsxs("div",{className:"border-t border-blue-200 pt-3 space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Nd,{size:14,className:"text-blue-700"}),i.jsx("h4",{className:"text-xs font-bold text-blue-800 uppercase tracking-wide",children:"Active Filters:"})]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((c,u)=>i.jsx("span",{className:"inline-flex items-center px-2.5 py-1 bg-white border border-blue-300 text-blue-800 text-xs font-medium rounded-full",children:c},u))})]})]})},nT=({isOpen:e,onClose:t,onConfirm:a,title:r,message:s,confirmText:n="Confirm",cancelText:l="Cancel"})=>{if(!e)return null;const o=()=>{a(),t()},c=()=>{t()};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[i.jsx("div",{className:"p-4 border-b",children:i.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:r||"Confirm Action"})}),i.jsx("div",{className:"p-4",children:i.jsx("p",{className:"text-gray-600",children:s||"Are you sure you want to proceed?"})}),i.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[i.jsx("button",{onClick:c,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-400",children:l}),i.jsx("button",{onClick:o,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",children:n})]})]})})},l8=({isOpen:e,onClose:t,onAssign:a,leadId:r,companyId:s,userRole:n,currentUserId:l})=>{const{users:o,loading:c,error:u}=Rs(s,n,l),h=(()=>!o||o.length===0?[]:n==="DIRECTOR"?o.filter(m=>m.role==="ADMIN"||m.role==="USER"):n==="ADMIN"?o.filter(m=>m.role==="USER"):[])(),f=m=>{const p=m.id||m.userId;a(r,p,m.name),t()};return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",onClick:t,children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[80vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Assign Lead #",r]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 text-3xl font-light",children:"×"})]}),i.jsxs("div",{className:"p-4 overflow-y-auto",children:[c&&i.jsx("p",{className:"text-center text-gray-500",children:"Loading users..."}),u&&i.jsx("p",{className:"text-center text-red-500",children:u}),!c&&!u&&i.jsx("div",{className:"space-y-2",children:h.length>0?h.map(m=>i.jsxs("div",{onClick:()=>f(m),className:"p-3 border rounded-lg hover:bg-blue-100 hover:border-blue-400 cursor-pointer transition-colors",children:[i.jsx("p",{className:"font-semibold text-gray-900",children:m.name}),i.jsx("p",{className:"text-sm text-gray-500",children:m.email||"No email available"})]},m.id||m.userId)):i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-gray-500",children:"No users available for assignment"})})})]})]})}):null},ql=({id:e,label:t,value:a,onChange:r,...s})=>i.jsxs("div",{children:[i.jsx("label",{htmlFor:e,className:"block mb-2 text-sm font-medium text-gray-800",children:t}),i.jsx("input",{id:e,name:e,value:a,onChange:r,className:"w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out",...s})]});function o8({isOpen:e,onClose:t,lead:a,onUpdate:r}){const[s,n]=E.useState(a||{});E.useEffect(()=>{n(a||{})},[a]);const l=d=>{const{name:h,value:f}=d.target;n(m=>({...m,[h]:f}))},o=d=>{d.preventDefault(),r(s)},c={hidden:{opacity:0,y:-50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:30,scale:.95}},u=["NEW","CONTACTED","CLOSED","DROPED"];return i.jsx(Jn,{children:e&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",onClick:t,children:i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-2xl p-8 relative w-full max-w-lg max-h-[90vh] overflow-y-auto",variants:c,initial:"hidden",animate:"visible",exit:"exit",transition:{type:"spring",stiffness:300,damping:30},onClick:d=>d.stopPropagation(),children:[i.jsx("button",{onClick:t,"aria-label":"Close",className:"absolute top-4 right-4 text-gray-400 hover:text-red-600 transition-colors",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-900",children:"Update Lead 📝"}),i.jsxs("form",{onSubmit:o,className:"space-y-4",children:[i.jsx(ql,{id:"name",label:"Name",value:s.name||"",onChange:l,placeholder:"Enter full name",required:!0}),i.jsx(ql,{id:"email",label:"Email",type:"email",value:s.email||"",onChange:l,placeholder:"example@email.com"}),i.jsx(ql,{id:"phone",label:"Phone",type:"tel",value:s.phone||"",onChange:l,placeholder:"10-digit mobile number",required:!0}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"status",className:"block mb-2 text-sm font-medium text-gray-800",children:"Status"}),i.jsx("select",{id:"status",name:"status",value:s.status||"NEW",onChange:l,className:"w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out",required:!0,children:u.map(d=>i.jsx("option",{value:d,children:d},d))})]}),i.jsx(ql,{id:"budget",label:"Budget (₹)",type:"number",value:s.budget||"",onChange:l,placeholder:"e.g., 50000",step:"100"}),i.jsx(ql,{id:"location",label:"Location",value:s.location||"",onChange:l,placeholder:"e.g., Delhi, India"}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"requirement",className:"block mb-2 text-sm font-medium text-gray-800",children:"Requirement"}),i.jsx("textarea",{id:"requirement",name:"requirement",value:s.requirement||"",onChange:l,rows:"4",className:"w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out",placeholder:"Describe the lead's requirement..."})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105",children:"Update Lead"})]})]})})})}const c8=({isOpen:e,onClose:t,lead:a,onAddRemark:r})=>{const[s,n]=E.useState(""),[l,o]=E.useState(!1);if(!e||!a)return null;const c=async d=>{if(d.preventDefault(),!!s.trim()){o(!0);try{await r({remark:s.trim()}),n(""),t()}catch{}finally{o(!1)}}},u=()=>{n(""),t()};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Add Remark for: ",i.jsx("span",{className:"text-blue-600",children:a.name})]}),i.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-800 text-3xl font-light leading-none","aria-label":"Close modal",children:"×"})]}),i.jsxs("form",{onSubmit:c,className:"p-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{htmlFor:"remark",className:"block text-sm font-medium text-gray-700 mb-2",children:"Remark *"}),i.jsx("textarea",{id:"remark",value:s,onChange:d=>n(d.target.value),placeholder:"Enter your remark here...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:4,disabled:l,required:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:u,disabled:l,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-400 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:l||!s.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Adding...":"Add Remark"})]})]})]})})},u8=({isOpen:e,onClose:t,lead:a,onGetRemarks:r})=>{const[s,n]=E.useState([]),[l,o]=E.useState(!1),[c,u]=E.useState(null),d=(a==null?void 0:a.id)||(a==null?void 0:a.leadId);E.useEffect(()=>{e&&d&&r&&h()},[e,d]);const h=async()=>{o(!0),u(null);try{const m=await r(d);m.success?n(m.data||[]):u(m.error||"Failed to load remarks")}catch{u("Failed to load remarks")}finally{o(!1)}};if(!e||!a)return null;const f=[...s].sort((m,p)=>new Date(p.createdAt)-new Date(m.createdAt));return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Remarks for: ",i.jsx("span",{className:"text-blue-600",children:a.name})]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 text-3xl font-light leading-none","aria-label":"Close modal",children:"×"})]}),i.jsx("div",{className:"p-4 overflow-y-auto",children:l?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("p",{className:"mt-2 text-gray-500",children:"Loading remarks..."})]}):c?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-red-500",children:c}),i.jsx("button",{onClick:h,className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Retry"})]}):f.length===0?i.jsx("p",{className:"text-center text-gray-500 py-8",children:"No remarks found for this lead."}):i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{className:"sticky top-0 bg-gray-100 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b",children:"Remark"}),i.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b whitespace-nowrap",children:"Date & Time"}),i.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b whitespace-nowrap",children:"Created By"})]})}),i.jsx("tbody",{children:f.map((m,p)=>{var g;const x=m.createdAt?new Date(m.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"N/A",v=((g=m.createdBy)==null?void 0:g.name)||"Unknown";return i.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[i.jsx("td",{className:"p-3 text-gray-700",style:{wordBreak:"break-word"},children:m.remark}),i.jsx("td",{className:"p-3 text-gray-600 whitespace-nowrap",children:x}),i.jsx("td",{className:"p-3 text-gray-600 whitespace-nowrap",children:v})]},m.id||p)})})]})}),i.jsx("div",{className:"p-4 border-t text-right bg-gray-50",children:i.jsx("button",{onClick:t,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",children:"Close"})})]})})},d8=({isOpen:e,onClose:t,onAddFollowUp:a,lead:r})=>{const[s,n]=E.useState(""),[l,o]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!1),[f,m]=E.useState(null);E.useEffect(()=>{if(e){const x=new Date;x.setDate(x.getDate()+1),o(x.toISOString().slice(0,16)),n(""),u(""),m(null)}},[e]);const p=async x=>{if(x.preventDefault(),!s.trim()||!l){oe("⚠️ Please fill in all required fields");return}h(!0),m(null);try{const v=JSON.parse(localStorage.getItem("user")||"{}"),g=v.companyId;if(!g)throw new Error("Company ID not found");const b={followUpDate:l.includes(":")&&l.split(":").length===2?l+":00":l,note:s.trim(),leadId:parseInt((r==null?void 0:r.leadId)||(r==null?void 0:r.id)),userId:parseInt(v.userId||v.id||1)},y=await I0.createFollowUp(g,b);if(y.success){const w=(r==null?void 0:r.name)||"Lead",N=new Date(b.followUpDate),A=N.toLocaleDateString("en-IN"),S=N.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!1});oe(`✅ Follow-up created successfully for ${w}!
📅 Scheduled for: ${A} at ${S}
🔔 Notification will be sent on the scheduled date.`),a&&await a(b),t()}else m(y.error),oe("❌ Failed to create follow-up: "+y.error)}catch{const g="Failed to add follow-up. Please try again.";m(g),oe("❌ "+g)}finally{h(!1)}};return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(wr,{className:"text-blue-600",size:20})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Follow-Up"}),i.jsx("p",{className:"text-sm text-gray-500",children:r!=null&&r.name?`for ${r.name}`:"for this lead"})]})]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(wa,{size:20})})]}),f&&i.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[i.jsx("p",{className:"text-sm text-red-700",children:f}),i.jsx("button",{onClick:()=>m(null),className:"mt-2 text-xs text-red-500 hover:text-red-700 underline",children:"Dismiss"})]}),i.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(kl,{className:"inline mr-2",size:16}),"Follow-up Note *"]}),i.jsx("div",{className:"relative",children:i.jsx("textarea",{value:s,onChange:x=>n(x.target.value),rows:4,placeholder:"Enter your follow-up notes...",required:!0,disabled:d,autoFocus:!0,style:{width:"100%",padding:"12px",border:"2px solid #d1d5db",borderRadius:"8px",fontSize:"14px",fontFamily:"Arial, sans-serif",color:"#000000",backgroundColor:"#ffffff",resize:"none",outline:"none"},onFocus:x=>{x.target.style.borderColor="#3b82f6",x.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:x=>{x.target.style.borderColor="#d1d5db",x.target.style.boxShadow="none"}})})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(wr,{className:"inline mr-2",size:16}),"Follow-up Date & Time *"]}),i.jsx("input",{type:"datetime-local",value:l,onChange:x=>o(x.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",style:{color:"#000000 !important",backgroundColor:"#ffffff !important",fontSize:"14px"},required:!0,disabled:d})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:t,disabled:d,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:d||!s.trim()||!l,className:`flex-1 px-4 py-2 text-white font-medium rounded-lg transition-colors ${d||!s.trim()||!l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:d?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):"Add Follow-Up"})]})]})]})}):null},f8=({isOpen:e,onClose:t,lead:a,companyId:r})=>{const[s,n]=E.useState([]),[l,o]=E.useState(!1),[c,u]=E.useState(null),d=E.useRef(!1),h=E.useRef(null),f=()=>r||JSON.parse(localStorage.getItem("user")||"{}").companyId,m=async()=>{const b=f();if(!b){u("Company ID is required");return}o(!0),u(null);try{const y=await I0.getAllFollowUps(b);y.success?n(y.data):u(y.error)}catch{u("Failed to load follow-ups")}finally{o(!1)}};E.useEffect(()=>{const b=(a==null?void 0:a.leadId)||(a==null?void 0:a.id);e&&a&&(!d.current||h.current!==b)&&(d.current=!0,h.current=b,m()),e||(d.current=!1,h.current=null,u(null))},[e,(a==null?void 0:a.leadId)||(a==null?void 0:a.id)]);const p=async b=>{if(window.confirm("Are you sure you want to delete this follow-up?")){const y=f();if(!y){u("Company ID is required");return}o(!0);try{const w=await I0.deleteFollowUp(y,b);w.success?await m():u(w.error)}catch{u("Failed to delete follow-up")}finally{o(!1)}}},x=()=>{u(null)},v=b=>b?new Date(b).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Kolkata"}):"N/A",g=s.filter(b=>{var N;const y=(N=b.lead)==null?void 0:N.leadId,w=(a==null?void 0:a.leadId)||(a==null?void 0:a.id);return y===w}).sort((b,y)=>new Date(y.followupDate||0)-new Date(b.followupDate||0));return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(wr,{className:"text-blue-600",size:20})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Follow-ups"}),i.jsx("p",{className:"text-sm text-gray-500",children:a!=null&&a.name?`for ${a.name}`:"for this lead"})]})]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(wa,{size:20})})]}),c&&i.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[i.jsx("p",{className:"text-sm text-red-700",children:c}),i.jsx("button",{onClick:x,className:"mt-2 text-xs text-red-500 hover:text-red-700 underline",children:"Dismiss"})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsxs("div",{children:[i.jsxs("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:["Follow-up History (",g.length,")"]}),l&&g.length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-2 text-gray-500",children:"Loading follow-ups..."})]}):g.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(wr,{className:"mx-auto mb-4 text-gray-400",size:48}),i.jsx("p",{className:"text-lg font-medium",children:"No follow-ups found"}),i.jsx("p",{className:"text-sm",children:"Add your first follow-up to get started."})]}):i.jsx("div",{className:"space-y-4",children:g.map(b=>i.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"flex items-center gap-2 mb-2",children:i.jsx("span",{className:"text-xs text-gray-500",children:v(b.followupDate)})}),i.jsx("p",{className:"text-gray-900 mb-2",children:b.note}),b.nextFollowup&&i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx(Cl,{size:14,className:"inline mr-1"}),"Next: ",v(b.nextFollowup)]})]}),i.jsx("div",{className:"flex items-center gap-2 ml-4",children:i.jsx("button",{onClick:()=>p(b.followupId),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Delete follow-up",children:i.jsx(Fc,{size:16})})})]})},b.followupId))})]})})]})}):null},h8=({userRole:e,userId:t,companyId:a})=>{const[r,s]=E.useState(!1),[n,l]=E.useState(0),[o]=E.useState(!0),[c,u]=E.useState(0),[d,h]=E.useState(null),[f,m]=E.useState(null),[p,x]=E.useState(null),[v,g]=E.useState(null),[b,y]=E.useState(null),[w,N]=E.useState({isOpen:!1,leadId:null}),[A,S]=E.useState({isOpen:!1,title:"",message:"",onConfirm:null}),C=10,{searchTerm:T,searchTags:D,filters:R,isSearchActive:j,activeSearchParams:B,hasActiveFilters:X,searchParams:V,getActiveFiltersSummary:F,setSearchTerm:q,removeSearchTag:te,handleSearchEnter:H,updateFilter:le,clearAll:W,clearSearch:_,applySearch:G}=HF(),{leads:Y,loading:z,error:ie,pagination:xe,loadLeads:ne,searchLeads:he,updateLeadStatus:ce,updateLead:Te,deleteLead:P,addRemark:Ke,assignLead:Fe,unassignLead:$e,getRemarks:Ne}=JS(a,t,e),{users:ge}=Rs(a),Me=E.useCallback(()=>{u(be=>be+1)},[]);E.useEffect(()=>{a&&(j&&B?he(B,n,C):ne(n,C))},[a,n,j,B,c,he,ne]),E.useEffect(()=>{if(o){const be=setTimeout(()=>{G()},500);return()=>clearTimeout(be)}},[o,V,G]);const Mt=be=>h(be),Qt=async be=>{d&&(await Te(d.id||d.leadId,be),h(null),Me())},oa=be=>m(be),Ye=async be=>{if(!f)return;const qe=f.id||f.leadId;await Ke(qe,be),m(null),Me()},Jt=be=>x(be),ft=be=>g(be),Ta=be=>y(be),Ut=async be=>{if(v){v.id||v.leadId;try{g(null),Me()}catch{}}},Pr=async(be,qe)=>{await ce(be,qe),Me()},Ct=be=>{N({isOpen:!0,leadId:be})},fe=be=>{de("Unassign Lead","Are you sure you want to unassign this lead?",async()=>{await $e(be,t),Me()})},de=(be,qe,Xa)=>{S({isOpen:!0,title:be,message:qe,onConfirm:Xa})},ye=()=>{if(!Y||Y.length===0){customAlert("❌ No leads to export");return}const be=qF(Y);be.success?customAlert(`✅ ${be.message}`):customAlert(`❌ ${be.message}`)},Pe={onStatusUpdate:Pr,onAssign:Ct,onUnassign:fe,onUpdate:Mt,onAddRemark:oa,onGetRemarks:Jt,onAddFollowUp:ft,onViewFollowUps:Ta,companyId:a};return i.jsxs("div",{className:"flex justify-center items-start min-h-screen p-2 sm:p-4",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-xl border shadow-sm w-full max-w-[1200px] h-fit",children:[i.jsx("h2",{className:"text-center text-xl p-2 font-bold text-gray-800",children:"Lead Management"}),i.jsx(KF,{searchTerm:T,searchTags:D,onSearchTermChange:q,onSearchEnter:H,onRemoveSearchTag:te,onSearch:G,onExport:ye,onRefresh:Me,onClearSearch:_,onToggleMobileFilters:()=>s(!r),isSearchActive:j,isLoading:z,autoSearch:o}),i.jsx("div",{className:"hidden md:block",children:i.jsx(Nv,{filters:R,onFilterChange:le,onClearFilters:W,isMobile:!1,hasActiveFilters:X,activeFiltersSummary:F(),autoApply:o,userRole:e,userId:t,companyId:a,availableUsers:ge})}),r&&i.jsx("div",{className:"md:hidden",children:i.jsx(Nv,{filters:R,onFilterChange:le,onClearFilters:W,isMobile:!0,hasActiveFilters:X,activeFiltersSummary:F(),autoApply:o,userRole:e,userId:t,companyId:a,availableUsers:ge})}),j&&i.jsx(i8,{isSearchActive:j,totalResults:(xe==null?void 0:xe.totalElements)||0,currentPage:n,pageSize:C,hasActiveFilters:X,activeFiltersSummary:F(),onClearAll:W}),i.jsx(n8,{loading:z,error:ie,isEmpty:!z&&Y.length===0}),!z&&!ie&&Y.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(ZF,{leads:Y,searchTerm:T,...Pe}),i.jsx(JF,{leads:Y,...Pe})]}),!z&&!ie&&xe&&xe.totalPages>1&&i.jsx(e8,{currentPage:n,pagination:xe,onPageChange:l})]}),i.jsx(o8,{isOpen:!!d,onClose:()=>h(null),lead:d,onUpdate:Qt}),i.jsx(c8,{isOpen:!!f,onClose:()=>m(null),onAddRemark:Ye,lead:f}),i.jsx(u8,{isOpen:!!p,onClose:()=>x(null),lead:p,companyId:a,onGetRemarks:Ne}),i.jsx(d8,{isOpen:!!v,onClose:()=>g(null),onAddFollowUp:Ut,lead:v}),i.jsx(f8,{isOpen:!!b,onClose:()=>y(null),lead:b,companyId:a}),i.jsx(l8,{isOpen:w.isOpen,onClose:()=>N({isOpen:!1,leadId:null}),onAssign:async(be,qe,Xa)=>{await Fe(be,qe,Xa),Me()},leadId:w.leadId,companyId:a,userRole:e,currentUserId:t}),i.jsx(nT,{isOpen:A.isOpen,onClose:()=>S({isOpen:!1,title:"",message:"",onConfirm:null}),onConfirm:A.onConfirm,title:A.title,message:A.message})]})},m8=()=>{const[e,t]=E.useState(""),[a,r]=E.useState([]),[s,n]=E.useState(0),[l,o]=E.useState({budgetRange:"",status:"",type:"",bhk:"",source:"",createdBy:""}),c=E.useMemo(()=>Object.values(l).some(w=>w&&w.trim()),[l]),u=E.useMemo(()=>a.length>0||c,[a.length,c]),d=E.useMemo(()=>{const w=[...a];e.trim()&&w.push(e.trim());const N={keywords:w.join(" "),...l};return Object.keys(N).forEach(A=>{const S=N[A];!S||typeof S=="string"&&S.trim()===""?delete N[A]:typeof S=="string"&&(N[A]=S.trim())}),N},[a,e,l]),h=E.useMemo(()=>u?d:null,[u,d]);E.useEffect(()=>{(c||a.length>0)&&n(w=>w+1)},[l,a,c]);const f=E.useCallback(()=>{if(e.trim()){const N=e.trim().split(/\s+/).filter(A=>A.trim()&&!a.includes(A.trim()));N.length>0&&(r(A=>[...A,...N]),t(""))}},[e,a]),m=E.useCallback(w=>{r(N=>N.filter(A=>A!==w))},[]),p=E.useCallback((w,N)=>{o(A=>({...A,[w]:N}))},[]),x=E.useCallback(()=>{t(""),r([])},[]),v=E.useCallback(()=>{o({budgetRange:"",status:"",type:"",bhk:"",source:"",createdBy:""})},[]),g=E.useCallback(()=>{x(),v()},[x,v]),b=E.useCallback(()=>{n(w=>w+1)},[]),y=E.useCallback((w=null,N=[])=>{const A=[];if(a.length>0&&A.push(`Keywords: ${a.join(", ")}`),l.budgetRange){const[S,C]=l.budgetRange.split("-"),T=D=>{const R=parseInt(D);return R>=1e7?`₹${(R/1e7).toFixed(1)} Cr`:R>=1e5?`₹${(R/1e5).toFixed(1)} Lakh`:`₹${R.toLocaleString()}`};A.push(`Budget: ${T(S)} - ${T(C)}`)}if(l.status){const S={AVAILABLE_FOR_SALE:"For Sale",AVAILABLE_FOR_RENT:"For Rent",RENT_OUT:"Rented Out",SOLD_OUT:"Sold Out"};A.push(`Status: ${S[l.status]||l.status}`)}if(l.type&&A.push(`Type: ${l.type}`),l.bhk&&A.push(`BHK: ${l.bhk}`),l.source&&A.push(`Source: ${l.source}`),l.createdBy){let S=l.createdBy;if(w&&l.createdBy===w.toString())S="Me";else if(N.length>0){const C=N.find(T=>{var D;return((D=T.id||T.userId)==null?void 0:D.toString())===l.createdBy});C&&(S=C.name||C.username||`User ${C.id||C.userId}`)}A.push(`Created By: ${S}`)}return A.join(", ")},[a,l]);return{searchTerm:e,searchTags:a,filters:l,isSearchActive:u,hasActiveFilters:c,searchParams:d,activeSearchParams:h,searchTrigger:s,setSearchTerm:t,handleSearchEnter:f,removeSearchTag:m,updateFilter:p,clearSearch:x,clearFilters:v,clearAll:g,applySearch:b,getActiveFiltersSummary:y}},x8=({searchTerm:e,searchTags:t=[],onSearchTermChange:a,onSearchEnter:r,onRemoveSearchTag:s,onSearch:n,onExport:l,onToggleMobileFilters:o,onClearSearch:c,onRefresh:u,isSearchActive:d=!1,isLoading:h=!1,autoSearch:f=!1})=>{const m=g=>{const b=g.target.value;a(b)},p=g=>{g.key==="Enter"&&(g.preventDefault(),r?r():n())},x=()=>{c()},v=()=>{e.trim()&&r(),n()};return i.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 mb-4",children:[i.jsxs("div",{className:"flex-1 min-w-[300px] relative",children:[t.length>0&&i.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:t.map((g,b)=>i.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full border",children:[i.jsx("span",{children:g}),i.jsx("button",{onClick:()=>s&&s(g),className:"text-blue-600 hover:text-blue-800 hover:bg-blue-200 rounded-full p-0.5",title:`Remove "${g}" tag`,children:i.jsx(wa,{size:12})})]},b))}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:t.length>0?"Add more search terms...":"Search by property name, location, owner contact... (Press Enter to add multiple keywords)",value:e,onChange:m,onKeyDown:p,className:"w-full px-3 py-2 pr-10 text-sm border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"}),(e||t.length>0)&&i.jsx("button",{onClick:x,className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"Clear all search terms",children:i.jsx(wa,{size:16})})]}),d&&i.jsx("div",{className:"absolute -bottom-5 left-0 text-xs text-blue-600",children:"Search active"})]}),(!f||e||t.length>0)&&i.jsxs("button",{onClick:v,disabled:h,className:"bg-blue-600 text-white px-3 sm:px-4 py-2 text-sm rounded hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[i.jsx(pn,{size:14}),h?"Searching...":"Search"]}),i.jsxs("button",{onClick:u,disabled:h,className:"bg-gray-600 text-white px-3 sm:px-4 py-2 text-sm rounded hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",title:"Refresh properties",children:[i.jsx(Sd,{size:14,className:h?"animate-spin":""}),"Refresh"]}),i.jsxs("button",{onClick:l,className:"bg-green-600 text-white px-3 sm:px-4 py-2 text-sm rounded hover:bg-green-700 transition-colors flex items-center gap-2",title:"Export to Excel",children:[i.jsx(Np,{size:14}),"Export"]}),i.jsxs("button",{onClick:o,className:"bg-gray-200 md:hidden px-3 py-2 rounded text-sm hover:bg-gray-300 transition-colors flex items-center gap-2",title:"Show filters",children:[i.jsx(Nd,{size:14}),"Filters"]}),f&&i.jsxs("div",{className:"hidden md:flex items-center text-xs text-gray-500",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),"Auto-search"]})]})},Sv=({filters:e,onFilterChange:t,onClearFilters:a,companyId:r,userId:s,isMobile:n=!1,hasActiveFilters:l=!1,activeFiltersSummary:o="",autoApply:c=!0,availableUsers:u=[]})=>{const{users:d}=Rs(r),h=(x,v)=>{t(x,v)},f=()=>{a()},m=n?"bg-gray-50 p-3 rounded-lg mb-4 border":"bg-gray-50 p-4 rounded-lg mb-6 border",p=n?"grid grid-cols-1 gap-3":"flex flex-wrap gap-3 items-center";return i.jsxs("div",{className:m,children:[l&&!n&&i.jsx("div",{className:"mb-3 p-2 bg-blue-50 rounded border-l-4 border-blue-400",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-blue-700",children:[i.jsx("span",{className:"font-medium",children:"Active filters:"})," ",o]}),i.jsx("button",{onClick:f,className:"text-xs text-blue-600 hover:text-blue-800 underline",children:"Clear all"})]})}),i.jsxs("div",{className:p,children:[i.jsxs("select",{value:e.budgetRange||"",onChange:x=>h("budgetRange",x.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Budget"}),i.jsx("option",{value:"0-500000",children:"Below ₹5 Lakh"}),i.jsx("option",{value:"500000-1000000",children:"₹5 Lakh - ₹10 Lakh"}),i.jsx("option",{value:"1000000-1500000",children:"₹10 Lakh - ₹15 Lakh"}),i.jsx("option",{value:"1500000-2000000",children:"₹15 Lakh - ₹20 Lakh"}),i.jsx("option",{value:"2000000-2500000",children:"₹20 Lakh - ₹25 Lakh"}),i.jsx("option",{value:"2500000-3000000",children:"₹25 Lakh - ₹30 Lakh"}),i.jsx("option",{value:"3000000-3500000",children:"₹30 Lakh - ₹35 Lakh"}),i.jsx("option",{value:"3500000-4000000",children:"₹35 Lakh - ₹40 Lakh"}),i.jsx("option",{value:"4000000-4500000",children:"₹40 Lakh - ₹45 Lakh"}),i.jsx("option",{value:"4500000-5000000",children:"₹45 Lakh - ₹50 Lakh"}),i.jsx("option",{value:"5000000-10000000",children:"₹50 Lakh - ₹1 Cr"}),i.jsx("option",{value:"10000000-20000000",children:"₹1 Cr - ₹2 Cr"}),i.jsx("option",{value:"20000000-30000000",children:"₹2 Cr - ₹3 Cr"}),i.jsx("option",{value:"30000000-40000000",children:"₹3 Cr - ₹4 Cr"}),i.jsx("option",{value:"40000000-50000000",children:"₹4 Cr - ₹5 Cr"}),i.jsx("option",{value:"50000000-100000000",children:"₹5 Cr - ₹10 Cr"}),i.jsx("option",{value:"100000000-200000000",children:"₹10 Cr - ₹20 Cr"}),i.jsx("option",{value:"200000000-300000000",children:"₹20 Cr - ₹30 Cr"}),i.jsx("option",{value:"300000000-400000000",children:"₹30 Cr - ₹40 Cr"}),i.jsx("option",{value:"400000000-500000000",children:"₹40 Cr - ₹50 Cr"}),i.jsx("option",{value:"500000000-600000000",children:"₹50 Cr - ₹60 Cr"}),i.jsx("option",{value:"600000000-700000000",children:"₹60 Cr - ₹70 Cr"}),i.jsx("option",{value:"700000000-800000000",children:"₹70 Cr - ₹80 Cr"}),i.jsx("option",{value:"800000000-900000000",children:"₹80 Cr - ₹90 Cr"}),i.jsx("option",{value:"900000000-1000000000",children:"₹90 Cr - ₹100 Cr"})]}),i.jsxs("select",{value:e.status||"",onChange:x=>h("status",x.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Status"}),i.jsx("option",{value:"AVAILABLE_FOR_SALE",children:"For Sale"}),i.jsx("option",{value:"AVAILABLE_FOR_RENT",children:"For Rent"}),i.jsx("option",{value:"RENT_OUT",children:"Rented Out"}),i.jsx("option",{value:"SOLD_OUT",children:"Sold Out"})]}),i.jsxs("select",{value:e.type||"",onChange:x=>h("type",x.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Type"}),i.jsx("option",{value:"Office",children:"Office"}),i.jsx("option",{value:"Retail",children:"Retail"}),i.jsx("option",{value:"Residential",children:"Residential"}),i.jsx("option",{value:"Plot",children:"Plot"})]}),i.jsxs("select",{value:e.bhk||"",onChange:x=>h("bhk",x.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"BHK"}),i.jsx("option",{value:"1",children:"1 BHK"}),i.jsx("option",{value:"2",children:"2 BHK"}),i.jsx("option",{value:"3",children:"3 BHK"}),i.jsx("option",{value:"4",children:"4 BHK"})]}),i.jsxs("select",{value:e.source||"",onChange:x=>h("source",x.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Source"}),i.jsx("option",{value:"Social Media",children:"Social Media"}),i.jsx("option",{value:"Cold Call",children:"Cold Call"}),i.jsx("option",{value:"Project Call",children:"Project Call"}),i.jsx("option",{value:"Reference",children:"Reference"}),i.jsx("option",{value:"Broker",children:"Broker"})]}),i.jsxs("select",{value:e.createdBy||"",onChange:x=>h("createdBy",x.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Created By"}),(()=>{const x=u.length>0?u:d,v=x.find(y=>{const w=y.id||y.userId;return s&&(w==null?void 0:w.toString())===(s==null?void 0:s.toString())}),g=x.filter(y=>{const w=y.id||y.userId;return!(s&&(w==null?void 0:w.toString())===(s==null?void 0:s.toString()))});return(v?[v,...g]:x).map(y=>{const w=y.id||y.userId,A=s&&(w==null?void 0:w.toString())===(s==null?void 0:s.toString())?"Me":y.name||y.username||`User ${w}`;return i.jsx("option",{value:w,children:A},w)})})()]}),!c&&i.jsx("button",{onClick:f,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md transition duration-300",children:"Clear All Filters"})]}),n&&l&&i.jsxs("div",{className:"mt-3 p-2 bg-blue-50 rounded border-l-4 border-blue-400",children:[i.jsxs("div",{className:"text-sm text-blue-700",children:[i.jsx("span",{className:"font-medium",children:"Active filters:"})," ",o]}),i.jsx("button",{onClick:f,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 underline",children:"Clear all filters"})]})]})},p8=({property:e,onDelete:t,onAddRemark:a,onViewRemarks:r,onUpdate:s,onStatusChange:n,onOutOfBox:l})=>{var f;E.useState(!1);const o=[{value:"AVAILABLE_FOR_SALE",label:"For Sale"},{value:"AVAILABLE_FOR_RENT",label:"For Rent"},{value:"SOLD_OUT",label:"Sold Out"},{value:"RENT_OUT",label:"Rented Out"}],c=m=>m?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(m):"N/A",u=m=>m?new Date(m).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",d=m=>{switch(m){case"AVAILABLE_FOR_SALE":return"bg-green-100 text-green-800 border-green-200 focus:ring-green-500";case"AVAILABLE_FOR_RENT":return"bg-blue-100 text-blue-800 border-blue-200 focus:ring-blue-500";case"SOLD_OUT":return"bg-red-100 text-red-800 border-red-200 focus:ring-red-500";case"RENT_OUT":return"bg-yellow-100 text-yellow-800 border-yellow-200 focus:ring-yellow-500";default:return"bg-gray-100 text-gray-800 border-gray-200 focus:ring-gray-500"}},h=m=>{const p=m.target.value;n(e.propertyId||e.id,p)};return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",title:e.propertyName,children:e.propertyName}),i.jsx("div",{className:"text-sm text-gray-500",children:e.source&&`Source: ${e.source}`})]}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsx("select",{value:e.status,onChange:h,className:`px-2 py-1 border rounded-full text-xs font-semibold appearance-none focus:outline-none focus:ring-2 ${d(e.status)}`,onClick:m=>m.stopPropagation(),children:o.map(m=>i.jsx("option",{value:m.value,children:m.label},m.value))})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 truncate",children:e.type||"N/A"})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate",children:c(e.price)}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate text-center",children:e.bhk||"N/A"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate text-center",children:e.size||"N/A"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate",children:e.unit||e.unitDetails||"N/A"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate text-center",children:e.floor||"N/A"}),i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate",children:[i.jsx("div",{className:"font-medium",title:e.ownerName,children:e.ownerName||"N/A"}),e.ownerName&&i.jsx("div",{className:"text-xs text-gray-500",children:e.referenceName?`Ref: ${e.referenceName}`:"Direct"})]}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate",children:e.ownerContact||e.ownerNumber||"N/A"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 truncate text-center",children:e.sector||"N/A"}),i.jsx("td",{className:"px-4 py-4 text-sm text-gray-900 truncate",title:e.location,children:e.location||"N/A"}),i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.jsx("div",{className:"text-sm text-gray-900",children:u(e.createdAt)}),i.jsxs("div",{className:"text-xs text-gray-500",children:["by ",((f=e.createdBy)==null?void 0:f.name)||e.createdByName||"Unknown"]})]}),i.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-sm font-medium",children:i.jsx(Fa,{item:e,actions:[{label:"Update Property",icon:i.jsx(Ya,{size:14}),onClick:()=>s(e)},{label:"Add Remark",icon:i.jsx(kl,{size:14}),onClick:()=>a(e)},{label:"View Remarks",icon:i.jsx(ya,{size:14}),onClick:()=>r(e)}]})})]})},g8=({properties:e,onDelete:t,onAddRemark:a,onViewRemarks:r,onUpdate:s,onStatusChange:n,onOutOfBox:l})=>{const[o,c]=E.useState({key:"createdAt",direction:"desc"}),u=m=>{let p="asc";o.key===m&&o.direction==="asc"&&(p="desc"),c({key:m,direction:p})},d=E.useMemo(()=>o.key?[...e].sort((m,p)=>{const x=(b,y)=>y.split(".").reduce((w,N)=>w?w[N]:null,b),v=x(m,o.key),g=x(p,o.key);return v==null?1:g==null?-1:v<g?o.direction==="asc"?-1:1:v>g?o.direction==="asc"?1:-1:0}):e,[e,o]),h=m=>o.key!==m?null:o.direction==="asc"?i.jsx(wp,{className:"h-4 w-4 ml-1 inline"}):i.jsx(vp,{className:"h-4 w-4 ml-1 inline"}),f=({columnKey:m,title:p,className:x=""})=>i.jsxs("th",{className:`px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 whitespace-nowrap ${x}`,onClick:()=>u(m),children:[p,h(m)]});return i.jsx("div",{className:"hidden md:block overflow-x-auto max-h-[45vh] overflow-y-auto border border-gray-200 rounded-lg",children:i.jsxs("table",{className:"min-w-[1200px] w-full table-auto text-sm text-left text-gray-700",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx(f,{columnKey:"propertyName",title:"Project Name"}),i.jsx(f,{columnKey:"status",title:"Status"}),i.jsx(f,{columnKey:"type",title:"Type"}),i.jsx(f,{columnKey:"price",title:"Price"}),i.jsx(f,{columnKey:"bhk",title:"BHK"}),i.jsx(f,{columnKey:"size",title:"Size"}),i.jsx(f,{columnKey:"unitDetails",title:"Unit"}),i.jsx(f,{columnKey:"floor",title:"Floor"}),i.jsx(f,{columnKey:"ownerName",title:"Owner/Broker"}),i.jsx(f,{columnKey:"ownerNumber",title:"Owner No."}),i.jsx(f,{columnKey:"sector",title:"Sector"}),i.jsx(f,{columnKey:"location",title:"Location"}),i.jsx(f,{columnKey:"createdAt",title:"Created"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(m=>i.jsx(p8,{property:m,onAddRemark:a,onViewRemarks:r,onUpdate:s,onStatusChange:n,onOutOfBox:l},m.propertyId||m.id))})]})})},y8=({properties:e,onUpdate:t,onAddRemark:a,onViewRemarks:r,onDelete:s,onOutOfBox:n})=>{const[l,o]=E.useState(null),c=m=>m?new Date(m).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",u=m=>{switch(m){case"AVAILABLE_FOR_SALE":return"bg-green-100 text-green-800";case"AVAILABLE_FOR_RENT":return"bg-blue-100 text-blue-800";case"RENT_OUT":return"bg-yellow-100 text-yellow-800";case"SOLD_OUT":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},d=m=>{switch(m){case"AVAILABLE_FOR_SALE":return"For Sale";case"AVAILABLE_FOR_RENT":return"For Rent";case"RENT_OUT":return"Rented Out";case"SOLD_OUT":return"Sold Out";default:return m||"N/A"}},h=m=>{n&&n(m),o(null)},f=[{label:"Update Property",icon:i.jsx(Ya,{size:14}),onClick:m=>{t(m),o(null)}},{label:"Add Remark",icon:i.jsx(kl,{size:14}),onClick:m=>{a(m),o(null)}},{label:"View Remarks",icon:i.jsx(ya,{size:14}),onClick:m=>{r(m),o(null)}}];return i.jsx("div",{className:"md:hidden space-y-4",children:e.map(m=>{var x;const p=m.propertyId||m.id;return i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 relative",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:m.propertyName||m.name||"N/A"}),i.jsx("p",{className:"text-gray-600 text-sm",children:m.location||m.address||"N/A"})]}),i.jsx(Fa,{item:m,actions:f,onOutOfBox:h,position:"right-0"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Type"}),i.jsx("p",{className:"text-sm font-medium",children:m.type||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"BHK"}),i.jsx("p",{className:"text-sm font-medium",children:m.bhk?`${m.bhk} BHK`:"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Size"}),i.jsx("p",{className:"text-sm font-medium",children:m.size||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Price"}),i.jsx("p",{className:"text-sm font-medium",children:m.price?`₹${m.price.toLocaleString()}`:"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Owner/Broker"}),i.jsx("p",{className:"text-sm font-medium",children:m.ownerName||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Contact"}),i.jsx("p",{className:"text-sm font-medium",children:m.ownerContact||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Source"}),i.jsx("p",{className:"text-sm font-medium",children:m.source||"N/A"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Unit Details"}),i.jsx("p",{className:"text-sm font-medium",children:m.unitDetails||"N/A"})]})]}),i.jsx("div",{className:"mb-3",children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${u(m.status)}`,children:d(m.status)})}),i.jsxs("div",{className:"pt-3 border-t border-gray-100 text-xs text-gray-500",children:[i.jsxs("div",{className:"font-medium text-gray-700",children:["Created ",c(m.createdAt)]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["by ",((x=m.createdBy)==null?void 0:x.name)||m.createdByName||"Unknown"]})]})]},p)})})},v8=({currentPage:e,pagination:t,onPageChange:a})=>{const{totalPages:r,totalElements:s,size:n=10}=t;if(r<=1)return null;const o=(()=>{const d=new Set;d.add(1);for(let p=-1;p<=1;p++){const x=e+1+p;x>1&&x<r&&d.add(x)}d.add(r);const h=Array.from(d).sort((p,x)=>p-x),f=[];let m=0;for(const p of h)m&&p-m>1&&f.push("..."),f.push(p),m=p;return f})(),c=e*n+1,u=Math.min((e+1)*n,s);return i.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-6",children:[i.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[i.jsx("button",{onClick:()=>a(e-1),disabled:e===0,className:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),i.jsx("button",{onClick:()=>a(e+1),disabled:e>=r-1,className:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:c})," to"," ",i.jsx("span",{className:"font-medium",children:u})," of"," ",i.jsx("span",{className:"font-medium",children:s})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>a(e-1),disabled:e===0,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50",children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(Ep,{className:"h-5 w-5"})]}),o.map((d,h)=>d==="..."?i.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-500",children:"..."},`dots-${h}`):i.jsx("button",{onClick:()=>a(d-1),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset ring-gray-300 focus:z-20 focus:outline-offset-0 ${e===d-1?"z-10 bg-blue-600 text-white":"text-gray-700 hover:bg-gray-50"}`,"aria-current":e===d-1?"page":void 0,children:d},d)),i.jsxs("button",{onClick:()=>a(e+1),disabled:e>=r-1,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50",children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(Ed,{className:"h-5 w-5"})]})]})})]})]})},b8=()=>i.jsx("tr",{className:"animate-pulse",children:[...Array(11)].map((e,t)=>i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})},t))}),w8=()=>i.jsx("div",{className:"hidden md:block overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border border-gray-200 rounded-lg",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Property Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sector"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"BHK"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Size"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Floor"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created By"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:[...Array(6)].map((e,t)=>i.jsx(b8,{},t))})]})}),E8=()=>i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 animate-pulse",children:[i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),i.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"})]}),N8=()=>i.jsx("div",{className:"md:hidden space-y-4",children:[...Array(5)].map((e,t)=>i.jsx(E8,{},t))}),S8=({loading:e,error:t,isEmpty:a,onRetry:r})=>e?i.jsxs("div",{className:"space-y-4","aria-busy":"true",role:"status",children:[i.jsx(w8,{}),i.jsx(N8,{}),i.jsx("div",{className:"flex items-center justify-center py-4",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Loading properties..."]})})]}):t?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ES,{className:"mx-auto text-red-500 mb-4",size:48}),i.jsx("p",{className:"text-red-600 font-medium text-lg",children:"Error loading properties"}),i.jsx("p",{className:"text-gray-600 text-sm",children:t}),i.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Retry"})]})}):a?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(cn,{className:"mx-auto text-gray-400 mb-4",size:48}),i.jsx("p",{className:"text-gray-700 font-medium text-lg",children:"No properties found"}),i.jsx("p",{className:"text-gray-500 text-sm",children:"Try adjusting your search or filters."})]})}):null,T8=({totalResults:e,currentPage:t,pageSize:a,searchFilters:r,onClearFilters:s})=>{if(!(r&&Object.values(r).some(u=>u&&u.trim())))return null;const l=t*a+1,o=Math.min((t+1)*a,e),c=()=>{const u=[];if(r.keywords&&u.push(`Keywords: "${r.keywords}"`),r.budgetRange){const[d,h]=r.budgetRange.split("-"),f=m=>{const p=parseInt(m);return p>=1e7?`₹${(p/1e7).toFixed(1)} Cr`:p>=1e5?`₹${(p/1e5).toFixed(1)} Lakh`:`₹${p.toLocaleString()}`};u.push(`Budget: ${f(d)} - ${f(h)}`)}if(r.status){const d={AVAILABLE_FOR_SALE:"For Sale",AVAILABLE_FOR_RENT:"For Rent",RENT_OUT:"Rented Out",SOLD_OUT:"Sold Out"};u.push(`Status: ${d[r.status]||r.status}`)}return r.type&&u.push(`Type: ${r.type}`),r.bhk&&u.push(`BHK: ${r.bhk}`),r.source&&u.push(`Source: ${r.source}`),r.createdBy&&u.push(`Created By: ${r.createdBy}`),u.join(", ")};return i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),i.jsxs("span",{className:"font-semibold text-blue-800",children:["Search Results: ",e," properties found"]})]}),e>0&&i.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:["Showing ",l,"-",o," of ",e," results"]}),i.jsxs("div",{className:"text-sm text-blue-600",children:[i.jsx("span",{className:"font-medium",children:"Active filters:"})," ",c()]})]}),i.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 text-sm font-medium",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear All Filters"]})]})})},A8=({isOpen:e,onClose:t,property:a,onAddRemark:r})=>{const[s,n]=E.useState(""),[l,o]=E.useState(!1);if(!e||!a)return null;const c=async d=>{if(d.preventDefault(),!!s.trim()){o(!0);try{await r({remark:s.trim()}),n(""),t()}catch{}finally{o(!1)}}},u=()=>{n(""),t()};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Add Remark for: ",i.jsx("span",{className:"text-blue-600",children:a.propertyName||a.name})]}),i.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-800 text-3xl font-light leading-none","aria-label":"Close modal",children:"×"})]}),i.jsxs("form",{onSubmit:c,className:"p-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{htmlFor:"remark",className:"block text-sm font-medium text-gray-700 mb-2",children:"Remark *"}),i.jsx("textarea",{id:"remark",value:s,onChange:d=>n(d.target.value),placeholder:"Enter your remark here...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:4,disabled:l,required:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{type:"button",onClick:u,disabled:l,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-400 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:l||!s.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Adding...":"Add Remark"})]})]})]})})},C8=({isOpen:e,onClose:t,property:a,onGetRemarks:r})=>{const[s,n]=E.useState([]),[l,o]=E.useState(!1),[c,u]=E.useState(null),d=(a==null?void 0:a.id)||(a==null?void 0:a.propertyId);E.useEffect(()=>{e&&d&&r&&h()},[e,d]);const h=async()=>{o(!0),u(null);try{const m=await r(d);m.success?n(m.data||[]):u(m.error||"Failed to load remarks")}catch{u("Failed to load remarks")}finally{o(!1)}};if(!e||!a)return null;const f=[...s].sort((m,p)=>new Date(p.createdAt)-new Date(m.createdAt));return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Remarks for: ",i.jsx("span",{className:"text-blue-600",children:a.propertyName||a.name})]}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-800 text-3xl font-light leading-none","aria-label":"Close modal",children:"×"})]}),i.jsx("div",{className:"p-4 overflow-y-auto",children:l?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("p",{className:"mt-2 text-gray-500",children:"Loading remarks..."})]}):c?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-red-500",children:c}),i.jsx("button",{onClick:h,className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Retry"})]}):f.length===0?i.jsx("p",{className:"text-center text-gray-500 py-8",children:"No remarks found for this property."}):i.jsxs("table",{className:"w-full border-collapse",children:[i.jsx("thead",{className:"sticky top-0 bg-gray-100 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b",children:"Remark"}),i.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b whitespace-nowrap",children:"Date & Time"}),i.jsx("th",{className:"p-3 text-left font-semibold text-gray-700 border-b whitespace-nowrap",children:"Created By"})]})}),i.jsx("tbody",{children:f.map((m,p)=>{var g;const x=m.createdAt?new Date(m.createdAt).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"N/A",v=((g=m.createdBy)==null?void 0:g.name)||"Unknown";return i.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[i.jsx("td",{className:"p-3 text-gray-700",style:{wordBreak:"break-word"},children:m.remark}),i.jsx("td",{className:"p-3 text-gray-600 whitespace-nowrap",children:x}),i.jsx("td",{className:"p-3 text-gray-600 whitespace-nowrap",children:v})]},m.id||p)})})]})}),i.jsx("div",{className:"p-4 border-t text-right bg-gray-50",children:i.jsx("button",{onClick:t,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",children:"Close"})})]})})},Ar=({label:e,name:t,value:a,onChange:r,placeholder:s="",type:n="text",required:l=!1,disabled:o=!1})=>i.jsxs("div",{children:[i.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("input",{type:n,id:t,name:t,value:a||"",onChange:r,placeholder:s,required:l,disabled:o,className:`w-full p-2 border rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent ${o?"bg-gray-100 cursor-not-allowed":"border-gray-300"}`})]}),Vf=({label:e,name:t,value:a,onChange:r,options:s,required:n=!1})=>i.jsxs("div",{children:[i.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),i.jsx("select",{id:t,name:t,value:a||"",onChange:r,required:n,className:"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:s.map(l=>i.jsx("option",{value:l.value,children:l.label},l.value))})]}),k8=({isOpen:e,onClose:t,propertyToUpdate:a,onUpdate:r})=>{const[s,n]=E.useState({}),[l,o]=E.useState(!1),[c,u]=E.useState(!1);if(E.useEffect(()=>{e&&a&&n(a)},[e,a]),E.useEffect(()=>{(s.type==="Office"||s.type==="Retail")&&s.bhk&&n(v=>({...v,bhk:""}))},[s.type,s.bhk]),E.useEffect(()=>{const v=s.source;o(v==="Reference"),u(v==="Broker")},[s.source]),!e||!a)return null;const d=v=>{const{name:g,value:b}=v.target;n(y=>({...y,[g]:b}))},h=async v=>{v.preventDefault();const g={propertyName:s.propertyName,type:s.type,bhk:s.bhk,unitDetails:s.unitDetails,floor:s.floor,size:s.size?parseInt(s.size):null,location:s.location,ownerContact:s.ownerContact,ownerName:s.ownerName,price:s.price,sector:s.sector,status:s.status,source:s.source,referenceName:s.source==="Reference"&&s.referenceName||""};await r(g),t()},f=[{value:"Office",label:"Office"},{value:"Retail",label:"Retail"},{value:"Residential",label:"Residential"},{value:"Plot",label:"Plot"}],m=[{value:"AVAILABLE_FOR_SALE",label:"Available for Sale"},{value:"AVAILABLE_FOR_RENT",label:"Available for Rent"},{value:"RENT_OUT",label:"Rent Out"},{value:"SOLD_OUT",label:"Sold Out"}],p=[{value:"Social Media",label:"Social Media"},{value:"Cold Call",label:"Cold Call"},{value:"Project Call",label:"Project Call"},{value:"Reference",label:"Reference"},{value:"Broker",label:"Broker"}],x=s.type==="Office"||s.type==="Retail";return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",onClick:t,children:i.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",onClick:v=>v.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Update Property"}),i.jsx("button",{onClick:t,className:"p-2 rounded-full text-gray-500 hover:bg-gray-100",children:i.jsx(wa,{size:24})})]}),i.jsx("form",{id:"updatePropertyForm",onSubmit:h,className:"p-6 overflow-y-auto",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(Ar,{label:"Property Name",name:"propertyName",value:s.propertyName,onChange:d,required:!0}),i.jsx(Vf,{label:"Type",name:"type",value:s.type,onChange:d,options:f,required:!0}),i.jsx(Ar,{label:"BHK",name:"bhk",value:s.bhk,onChange:d,placeholder:"e.g., 2BHK",disabled:x}),i.jsx(Ar,{label:"Unit Details",name:"unitDetails",value:s.unitDetails,onChange:d}),i.jsx(Ar,{label:"Floor",name:"floor",value:s.floor,onChange:d}),i.jsx(Ar,{label:"Size (sqft)",name:"size",value:s.size,onChange:d,type:"text"}),i.jsx(Ar,{label:c?"Broker Name":"Owner Name",name:"ownerName",value:s.ownerName,onChange:d}),i.jsx(Ar,{label:c?"Broker Contact":"Owner Contact",name:"ownerContact",value:s.ownerContact,onChange:d}),i.jsx(Ar,{label:"Location",name:"location",value:s.location,onChange:d}),i.jsx(Ar,{label:"Price",name:"price",value:s.price,onChange:d,type:"text"}),i.jsx(Vf,{label:"Status",name:"status",value:s.status,onChange:d,options:m,required:!0}),i.jsx(Ar,{label:"Sector",name:"sector",value:s.sector,onChange:d,required:!0}),i.jsx(Vf,{label:"Source",name:"source",value:s.source,onChange:d,options:p}),l&&i.jsx(Ar,{label:"Reference Name",name:"referenceName",value:s.referenceName,onChange:d})]})}),i.jsxs("div",{className:"flex items-center justify-end p-4 border-t mt-auto",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 mr-2",children:"Cancel"}),i.jsx("button",{type:"submit",form:"updatePropertyForm",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Update Property"})]})]})})},j8=({userRole:e,userId:t,companyId:a})=>{const[r,s]=E.useState(!1),[n,l]=E.useState(0),[o]=E.useState(!0),[c,u]=E.useState(0),[d,h]=E.useState(null),[f,m]=E.useState(null),[p,x]=E.useState(null),[v,g]=E.useState({isOpen:!1,title:"",message:"",onConfirm:null}),b=10,{searchTerm:y,searchTags:w,filters:N,isSearchActive:A,activeSearchParams:S,hasActiveFilters:C,searchParams:T,getActiveFiltersSummary:D,setSearchTerm:R,removeSearchTag:j,handleSearchEnter:B,updateFilter:X,searchTrigger:V,clearAll:F,clearSearch:q,applySearch:te}=m8(),{properties:H,loading:le,error:W,pagination:_,loadProperties:G,searchProperties:Y,updateProperty:z,deleteProperty:ie,addRemark:xe,getRemarks:ne}=aT(a,t,e),{users:he}=Rs(a),ce=E.useCallback(()=>{u(Ye=>Ye+1)},[]),Te=E.useCallback(()=>{F(),l(0),setTimeout(()=>{G(0,b)},0)},[F,G,b]);E.useEffect(()=>{a&&G(n,b)},[a,n,c,G]),E.useEffect(()=>{a&&(A&&S?Y(S,n,b):A||G(n,b))},[a,A,S,n,Y,V,G,b]),E.useEffect(()=>{if(o&&a&&C){const Ye=setTimeout(()=>{te()},500);return()=>clearTimeout(Ye)}},[o,a,N,C,te]);const P=E.useCallback(()=>{a&&(w.length>0||C||y.trim())&&te()},[a,w.length,C,y,te]),Ke=Ye=>h(Ye),Fe=async Ye=>{d&&(await z(d.id||d.propertyId,Ye),h(null),ce())},$e=Ye=>m(Ye),Ne=async Ye=>{if(!f)return;const Jt=f.id||f.propertyId;await xe(Jt,Ye),m(null),ce()},ge=Ye=>x(Ye),Me=async(Ye,Jt)=>{try{const ft=await z(Ye,{status:Jt});ft.success?oe(`✅ Property status updated to: ${Jt}`):oe(`❌ Failed to update property status: ${ft.error}`),ce()}catch(ft){oe(`❌ Failed to update property status: ${ft.message}`)}},Mt=Ye=>{oe(`🚀 Out of Box action triggered for: ${Ye.propertyName||Ye.name}`)},Qt=()=>{if(!H||H.length===0){oe("❌ No properties to export");return}const Ye=XF(H);Ye.success?oe(`✅ ${Ye.message}`):oe(`❌ ${Ye.message}`)},oa={onStatusChange:Me,onUpdate:Ke,onAddRemark:$e,onViewRemarks:ge,onOutOfBox:Mt,companyId:a};return i.jsxs("div",{className:"flex justify-center items-start min-h-screen p-2 sm:p-4",children:[i.jsxs("div",{className:"bg-white p-3 sm:p-4 md:p-6 rounded-xl border shadow-sm w-full max-w-[1200px] h-fit",children:[i.jsx("h2",{className:"text-center text-xl p-2 font-bold text-gray-800",children:"Property Management"}),i.jsx(x8,{searchTerm:y,searchTags:w,onSearchTermChange:R,onSearchEnter:B,onRemoveSearchTag:j,onSearch:P,onExport:Qt,onRefresh:ce,onClearSearch:q,onToggleMobileFilters:()=>s(!r),isSearchActive:A,isLoading:le,autoSearch:o}),i.jsx("div",{className:"hidden md:block",children:i.jsx(Sv,{filters:N,onFilterChange:X,onClearFilters:Te,isMobile:!1,hasActiveFilters:C,activeFiltersSummary:D(t,he),autoApply:o,companyId:a,userId:t,availableUsers:he})}),r&&i.jsx("div",{className:"md:hidden",children:i.jsx(Sv,{filters:N,onFilterChange:X,onClearFilters:Te,isMobile:!0,hasActiveFilters:C,activeFiltersSummary:D(t,he),autoApply:o,companyId:a,userId:t,availableUsers:he})}),A&&i.jsx(T8,{isSearchActive:A,totalResults:(_==null?void 0:_.totalElements)||0,currentPage:n,pageSize:b,hasActiveFilters:C,activeFiltersSummary:D(),onClearAll:Te}),i.jsx(S8,{loading:le,error:W,isEmpty:!le&&H.length===0}),!le&&!W&&H.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(g8,{properties:H,searchTerm:y,...oa}),i.jsx(y8,{properties:H,...oa})]}),!le&&!W&&_&&_.totalPages>1&&i.jsx(v8,{currentPage:n,pagination:_,onPageChange:l})]}),i.jsx(k8,{isOpen:!!d,onClose:()=>h(null),propertyToUpdate:d,onUpdate:Fe}),i.jsx(A8,{isOpen:!!f,onClose:()=>m(null),onAddRemark:Ne,property:f}),i.jsx(C8,{isOpen:!!p,onClose:()=>x(null),property:p,companyId:a,onGetRemarks:ne}),i.jsx(nT,{isOpen:v.isOpen,onClose:()=>g({isOpen:!1,title:"",message:"",onConfirm:null}),onConfirm:v.onConfirm,title:v.title,message:v.message})]})},_8=({note:e,onEdit:t,onDelete:a,onAddRemark:r,onViewRemarks:s})=>i.jsx(Fa,{item:e,actions:[{label:"Edit Note",icon:i.jsx(Ya,{size:16}),onClick:()=>t(e.id)},{label:"Add Remark",icon:i.jsx($u,{size:16}),onClick:()=>r(e.id)},{label:"View Remarks",icon:i.jsx(ya,{size:16}),onClick:()=>s(e.id)},{label:"Delete Note",icon:i.jsx(Fc,{size:16}),onClick:()=>a(e.id),danger:!0}]}),R8=({notes:e=[],onEdit:t,onDelete:a,onUpdateStatus:r,onUpdatePriority:s,onAddRemark:n,onViewRemarks:l})=>{const[o,c]=E.useState({key:null,direction:"asc"}),[u,d]=E.useState(!1),[h,f]=E.useState(""),[m,p]=E.useState(!1),[x,v]=E.useState({title:"",message:"",type:"info",onConfirm:null,onCancel:null,showCancel:!1}),g=F=>{let q="asc";o.key===F&&o.direction==="asc"&&(q="desc"),c({key:F,direction:q})},b=[...e].sort((F,q)=>{var le,W;if(!o.key)return 0;let te=F[o.key],H=q[o.key];return o.key==="createdBy"&&(te=((le=F.createdBy)==null?void 0:le.name)||"Unknown",H=((W=q.createdBy)==null?void 0:W.name)||"Unknown"),(o.key==="createdAt"||o.key==="dateTime")&&(te=new Date(te||0),H=new Date(H||0)),te<H?o.direction==="asc"?-1:1:te>H?o.direction==="asc"?1:-1:0}),y=F=>o.key!==F?null:o.direction==="asc"?i.jsx(wp,{className:"h-4 w-4 ml-1 inline"}):i.jsx(vp,{className:"h-4 w-4 ml-1 inline"}),w=(F,q=10)=>{if(!F)return"No content";const te=F.split(" ");return te.length<=q?F:te.slice(0,q).join(" ")+"..."},N=F=>{f(F||"No content"),d(!0)},A=F=>{v({title:F.title||"Alert",message:F.message||"",type:F.type||"info",onConfirm:F.onConfirm||null,onCancel:F.onCancel||null,showCancel:F.showCancel||!1}),p(!0)},S=()=>{x.onConfirm&&x.onConfirm(),p(!1)},C=()=>{x.onCancel&&x.onCancel(),p(!1)},T=()=>u?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex justify-center items-center",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full m-4 max-h-[80vh] overflow-y-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Note Content"}),i.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"text-gray-700 whitespace-pre-wrap break-words",children:h})]})}):null,D=()=>{if(!m)return null;const F=()=>{switch(x.type){case"success":return"text-green-600 bg-green-50 border-green-200";case"error":return"text-red-600 bg-red-50 border-red-200";case"warning":return"text-yellow-600 bg-yellow-50 border-yellow-200";default:return"text-blue-600 bg-blue-50 border-blue-200"}},q=()=>{switch(x.type){case"success":return"text-green-500";case"error":return"text-red-500";case"warning":return"text-yellow-500";default:return"text-blue-500"}},te=()=>{switch(x.type){case"success":return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})});case"error":return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})});case"warning":return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});default:return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex justify-center items-center",children:i.jsxs("div",{className:`bg-white p-6 rounded-lg shadow-xl max-w-md w-full m-4 border-2 ${F()}`,children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:`mr-3 ${q()}`,children:te()}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:x.title})]}),i.jsx("div",{className:"text-gray-700 mb-6",children:x.message}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[x.showCancel&&i.jsx("button",{onClick:C,className:"px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),i.jsx("button",{onClick:S,className:`px-4 py-2 text-white rounded-md transition-colors ${x.type==="error"?"bg-red-600 hover:bg-red-700":x.type==="success"?"bg-green-600 hover:bg-green-700":x.type==="warning"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"}`,children:"OK"})]})]})})},R=F=>{switch(F){case"NEW":return"bg-yellow-100 text-yellow-800 border-yellow-200 focus:ring-yellow-500";case"PROCESSING":return"bg-blue-100 text-blue-800 border-blue-200 focus:ring-blue-500";case"COMPLETED":return"bg-green-100 text-green-800 border-green-200 focus:ring-green-500";default:return"bg-gray-100 text-gray-800 border-gray-200 focus:ring-gray-500"}},j=F=>{switch(F){case"PRIORITY_A":return"bg-red-100 text-red-800 border-red-200 focus:ring-red-500";case"PRIORITY_B":return"bg-orange-100 text-orange-800 border-orange-200 focus:ring-orange-500";case"PRIORITY_C":return"bg-green-100 text-green-800 border-green-200 focus:ring-green-500";default:return"bg-gray-100 text-gray-800 border-gray-200 focus:ring-gray-500"}},B=F=>F?new Date(F).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",X=F=>{if(!F.visibility)return"Unknown";switch(F.visibility){case"ONLY_ME":return"Only Me";case"ALL_USERS":return"All Users";case"ALL_ADMIN":return"All Admins";case"SPECIFIC_USERS":case"SPECIFIC_ADMIN":return F.visibleUserNames&&F.visibleUserNames.length>0?F.visibleUserNames.join(", "):F.visibleUserIds&&F.visibleUserIds.length>0?`${F.visibleUserIds.length} user(s)`:"Specific Users";default:return F.visibility}},V=({columnKey:F,title:q,className:te=""})=>i.jsxs("th",{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 whitespace-nowrap ${te}`,onClick:()=>g(F),children:[q,y(F)]});return i.jsxs("div",{className:"hidden md:block overflow-x-auto max-h-[45vh] overflow-y-auto border border-gray-200 rounded-lg",children:[i.jsxs("table",{className:"min-w-[1200px] w-full table-auto text-sm text-left text-gray-700",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx(V,{columnKey:"content",title:"Content"}),i.jsx(V,{columnKey:"status",title:"Status"}),i.jsx(V,{columnKey:"priority",title:"Priority"}),i.jsx(V,{columnKey:"typeStr",title:"Type"}),i.jsx(V,{columnKey:"createdBy",title:"Created By"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created For"}),i.jsx(V,{columnKey:"createdAt",title:"Created At"}),i.jsx(V,{columnKey:"dateTime",title:"Scheduled"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"9",className:"text-center py-6 text-gray-400",children:"No notes found."})}):b.map(F=>{var q,te,H;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900 cursor-pointer hover:text-blue-600 hover:underline max-w-xs truncate",onClick:()=>N(F.content),title:"Click to view full content",children:w(F.content)})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsxs("select",{value:F.status||"NEW",onChange:le=>{const W=le.target.value;W==="COMPLETED"?A({title:"Confirm Status Change",message:`Are you sure you want to mark this note as ${W}?`,type:"warning",showCancel:!0,onConfirm:()=>{r(F.id,W),A({title:"Success",message:"Note status updated successfully!",type:"success"})},onCancel:()=>{le.target.value=F.status||"NEW"}}):r(F.id,W)},className:`px-2 py-1 border rounded-full text-xs font-semibold appearance-none focus:outline-none focus:ring-2 ${R(F.status)}`,onClick:le=>le.stopPropagation(),children:[i.jsx("option",{value:"NEW",children:"NEW"}),i.jsx("option",{value:"PROCESSING",children:"PROCESSING"}),i.jsx("option",{value:"COMPLETED",children:"COMPLETED"})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsxs("select",{value:F.priority||"PRIORITY_C",onChange:le=>s(F.id,le.target.value),className:`px-2 py-1 border rounded-full text-xs font-semibold appearance-none focus:outline-none focus:ring-2 ${j(F.priority)}`,onClick:le=>le.stopPropagation(),children:[i.jsx("option",{value:"PRIORITY_A",children:"Priority A"}),i.jsx("option",{value:"PRIORITY_B",children:"Priority B"}),i.jsx("option",{value:"PRIORITY_C",children:"Priority C"})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:F.typeStr||"Note"})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:((q=F.createdBy)==null?void 0:q.name)||((te=F.createdBy)==null?void 0:te.username)||"Unknown"}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:X(F)}),i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.jsx("div",{className:"text-sm text-gray-900",children:B(F.createdAt)}),((H=F.createdBy)==null?void 0:H.name)&&i.jsxs("div",{className:"text-xs text-gray-400",children:["by ",F.createdBy.name]})]}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:B(F.dateTime)}),i.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-right text-sm font-medium",children:F.id&&i.jsx(_8,{note:F,onEdit:t,onDelete:a,onAddRemark:n,onViewRemarks:l})})]},F.id)})})]}),i.jsx(T,{}),i.jsx(D,{})]})},D8=({note:e,onEdit:t,onDelete:a,onUpdateStatus:r,onUpdatePriority:s,onAddRemark:n,onViewRemarks:l})=>{var m,p;const o=x=>"text-white border-none",c=x=>{switch(x){case"PRIORITY_A":return"#f44336";case"PRIORITY_B":return"#ff9800";case"PRIORITY_C":return"#4caf50";default:return"#777"}},u=x=>"text-white border-none",d=x=>{switch(x){case"NEW":return"#f0ad4e";case"PROCESSING":return"#5bc0de";case"COMPLETED":return"#d9534f";default:return"#ccc"}},h=x=>{if(!x)return"N/A";const v=new Date(x);return`${v.toLocaleDateString()} ${v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`},f=x=>{if(!x.visibility)return"Unknown";switch(x.visibility){case"ONLY_ME":return"Only Me";case"ALL_USERS":return"All Users";case"ALL_ADMIN":return"All Admins";case"SPECIFIC_USERS":case"SPECIFIC_ADMIN":return x.visibleUserNames&&x.visibleUserNames.length>0?x.visibleUserNames.join(", "):x.visibleUserIds&&x.visibleUserIds.length>0?`${x.visibleUserIds.length} user(s)`:"Specific Users";default:return x.visibility}};return i.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border border-gray-200",children:[i.jsx("p",{className:"text-gray-800 mb-3 whitespace-pre-wrap break-words",children:(e==null?void 0:e.content)||"No content available"}),i.jsxs("div",{className:"flex justify-between items-center mb-3 flex-wrap gap-2",children:[i.jsxs("select",{value:(e==null?void 0:e.status)||"NEW",onChange:x=>r(e.id,x.target.value),className:`p-2 rounded text-sm ${u(e==null?void 0:e.status)}`,style:{backgroundColor:d(e==null?void 0:e.status)},children:[i.jsx("option",{value:"NEW",children:"NEW"}),i.jsx("option",{value:"PROCESSING",children:"PROCESSING"}),i.jsx("option",{value:"COMPLETED",children:"COMPLETED"})]}),i.jsxs("select",{value:(e==null?void 0:e.priority)||"PRIORITY_C",onChange:x=>s(e.id,x.target.value),className:`p-2 rounded text-sm ${o(e==null?void 0:e.priority)}`,style:{backgroundColor:c(e==null?void 0:e.priority)},children:[i.jsx("option",{value:"PRIORITY_A",children:"Priority A"}),i.jsx("option",{value:"PRIORITY_B",children:"Priority B"}),i.jsx("option",{value:"PRIORITY_C",children:"Priority C"})]})]}),i.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[i.jsxs("p",{children:["Type: ",i.jsx("span",{className:"font-medium",children:(e==null?void 0:e.typeStr)||"Note"})]}),i.jsxs("p",{children:["Created By: ",i.jsx("span",{className:"font-medium",children:((m=e==null?void 0:e.createdBy)==null?void 0:m.name)||((p=e==null?void 0:e.createdBy)==null?void 0:p.username)||"Unknown"})]}),i.jsxs("p",{children:["Created For: ",i.jsx("span",{className:"font-medium",children:f(e)})]}),i.jsxs("p",{children:["Created At: ",i.jsx("span",{className:"font-medium",children:h(e==null?void 0:e.createdAt)})]}),i.jsxs("p",{children:["Scheduled: ",i.jsx("span",{className:"font-medium",children:h(e==null?void 0:e.dateTime)})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx(Fa,{item:e,actions:[{label:"Edit Note",icon:i.jsx(Ya,{size:14}),onClick:()=>t(e.id)},{label:"Add Remark",icon:i.jsx(kl,{size:14}),onClick:()=>n(e.id)},{label:"View Remarks",icon:i.jsx(ya,{size:14}),onClick:()=>l(e.id)},{label:"Delete Note",icon:i.jsx(Fc,{size:14}),onClick:()=>a(e.id),danger:!0}]})})]})},O8=({notes:e=[],onEdit:t,onDelete:a,onUpdateStatus:r,onUpdatePriority:s,onAddRemark:n,onViewRemarks:l})=>i.jsx("div",{className:"space-y-4",children:e.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500 bg-gray-50 p-6 rounded-lg border border-gray-200",children:[i.jsx("svg",{className:"w-12 h-12 mb-2 text-gray-300",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-3 -3v6m-9 4.5a2.25 2.25 0 0 0 2.25 2.25h13.5A2.25 2.25 0 0 0 21.75 18V6A2.25 2.25 0 0 0 19.5 3.75h-13.5A2.25 2.25 0 0 0 3.75 6v12z"})}),i.jsx("p",{children:"No notes available."})]}):e.map(o=>i.jsx(D8,{note:o,onEdit:t,onDelete:a,onUpdateStatus:r,onUpdatePriority:s,onAddRemark:n,onViewRemarks:l},o.id))}),F8={DIRECTOR:[{value:"ONLY_ME",label:"🔒 Only Me"},{value:"ALL_USERS",label:"👥 All Users"},{value:"SPECIFIC_USERS",label:"👤 Specific Users"},{value:"ALL_ADMIN",label:"🛡️ All Admins"},{value:"SPECIFIC_ADMIN",label:"👨‍💼 Specific Admins"}],ADMIN:[{value:"ONLY_ME",label:"🔒 Only Me"},{value:"ME_AND_DIRECTOR",label:"🎯 Me and Director"},{value:"ALL_USERS",label:"👥 All Users"},{value:"SPECIFIC_USERS",label:"👤 Specific Users"}],USER:[{value:"ONLY_ME",label:"🔒 Only Me"},{value:"ME_AND_DIRECTOR",label:"🎯 Me and Director"},{value:"ME_AND_ADMIN",label:"🛡️ Me and Admin"}]},L8=({role:e,value:t,onChange:a,disabled:r})=>{const s=F8[e==null?void 0:e.toUpperCase()]||[];return i.jsxs("div",{className:"space-y-2 animate-slideUp",style:{animationDelay:"0.2s"},children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center gap-2 transition-colors duration-200 hover:text-green-600",children:[i.jsxs("svg",{className:"w-4 h-4 text-green-500 transition-transform duration-200 hover:scale-110",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Visibility"]}),i.jsx("select",{value:t,onChange:n=>a(n.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all duration-300 bg-white shadow-sm hover:shadow-md transform hover:-translate-y-0.5",disabled:r,children:s.map(n=>i.jsx("option",{value:n.value,children:n.label},n.value))})]})},M8=`
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
@keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
.animate-fadeIn { animation: fadeIn 0.6s ease-out; }
.animate-slideDown { animation: slideDown 0.6s ease-out; }
.animate-slideUp { animation: slideUp 0.6s ease-out; animation-fill-mode: both; }
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=M8,document.head.appendChild(e)}const iT=({onSubmit:e,onCancel:t})=>{const a=JSON.parse(localStorage.getItem("user")||"{}"),r=a.role,s=a.userId,n=a.companyId,[l,o]=E.useState({content:"",date:"",time:"",priority:"PRIORITY_C",status:"NEW",type:"NOTE",visibility:"ONLY_ME"}),[c,u]=E.useState([]),[d,h]=E.useState([]),[f,m]=E.useState(!1),{users:p,loading:x,loadUsers:v,getUsersByRoleAndCompany:g,getAdminsByCompany:b}=Rs(n,r,s);E.useEffect(()=>{const C=l.visibility;C==="SPECIFIC_USERS"?(async()=>await g("USER"))():C==="SPECIFIC_ADMIN"?(async()=>await b())():(h([]),u([]))},[l.visibility,n,g,b]),E.useEffect(()=>{p.length>0&&h(p)},[p]);const y=(C,T)=>{o(D=>({...D,[C]:T}))},w=()=>{c.length===d.length?u([]):u(d.map(C=>C.userId))},N=C=>{u(T=>T.includes(C)?T.filter(D=>D!==C):[...T,C])},A=async()=>{if(!l.content.trim())return alert("Please enter note content");if(l.type==="EVENT"&&(!l.date||!l.time))return alert("Please select both date and time");const C=l.visibility;if((C==="SPECIFIC_USERS"||C==="SPECIFIC_ADMIN")&&c.length===0)return alert("Please select at least one user/admin");const T={content:l.content,priority:l.priority,status:l.status,type:l.type,dateTime:l.type==="EVENT"?`${l.date}T${l.time}:00`:null,visibility:C,visibleUserIds:C==="SPECIFIC_USERS"||C==="SPECIFIC_ADMIN"?c:[]};m(!0);try{await e(T)&&S()}finally{m(!1)}},S=()=>{o({content:"",date:"",time:"",priority:"PRIORITY_C",status:"NEW",type:"NOTE",visibility:"ONLY_ME"}),u([]),h([])};return i.jsxs("div",{className:"max-h-[85vh] overflow-y-auto animate-fadeIn",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6 animate-slideDown",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:l.type==="NOTE"?"📝 Create Note":"📅 Schedule Event"}),i.jsx("div",{className:"w-12 h-1 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full animate-pulse"})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-2 animate-slideUp",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Type"}),i.jsxs("select",{value:l.type,onChange:C=>y("type",C.target.value),className:"w-full px-4 py-3 border rounded-lg",disabled:f,children:[i.jsx("option",{value:"NOTE",children:"📝 Note"}),i.jsx("option",{value:"EVENT",children:"📅 Event"})]})]}),l.type==="EVENT"&&i.jsx("div",{className:"p-4 bg-blue-50 border rounded-lg animate-slideDown",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"animate-slideUp",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Date"}),i.jsx("input",{type:"date",value:l.date,onChange:C=>y("date",C.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border rounded-lg",disabled:f})]}),i.jsxs("div",{className:"animate-slideUp",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Time"}),i.jsx("input",{type:"time",value:l.time,onChange:C=>y("time",C.target.value),className:"w-full px-3 py-2 border rounded-lg",disabled:f})]})]})}),i.jsx(L8,{role:r,value:l.visibility,onChange:C=>y("visibility",C),disabled:f}),(l.visibility==="SPECIFIC_USERS"||l.visibility==="SPECIFIC_ADMIN")&&i.jsxs("div",{className:"p-4 bg-gray-50 border rounded-lg",children:[i.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Select ",l.visibility==="SPECIFIC_USERS"?"Users":"Admin Users"]}),d.length>0&&i.jsxs("label",{className:"flex items-center mb-2 space-x-2",children:[i.jsx("input",{type:"checkbox",checked:c.length===d.length,onChange:w,disabled:f}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Select All"})]}),i.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:x?i.jsx("div",{className:"text-gray-500 text-sm",children:"Loading users..."}):d.length>0?d.map(C=>i.jsxs("label",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",checked:c.includes(C.userId),onChange:()=>N(C.userId),disabled:f}),i.jsx("span",{children:C.name||"Unnamed"})]},C.userId)):i.jsx("div",{className:"text-gray-500 text-sm",children:"No users found"})})]}),i.jsxs("div",{className:"space-y-2 animate-slideUp",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Priority"}),i.jsxs("select",{value:l.priority,onChange:C=>y("priority",C.target.value),className:"w-full px-4 py-3 border rounded-lg",disabled:f,children:[i.jsx("option",{value:"PRIORITY_A",children:"Priority A"}),i.jsx("option",{value:"PRIORITY_B",children:"Priority B"}),i.jsx("option",{value:"PRIORITY_C",children:"Priority C"})]})]}),i.jsxs("div",{className:"space-y-2 animate-slideUp",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:l.type==="NOTE"?"Note Content":"Event Description"}),i.jsx("textarea",{value:l.content,onChange:C=>y("content",C.target.value),placeholder:l.type==="NOTE"?"Write your note content...":"Describe the event details...",className:"w-full px-4 py-3 border rounded-lg resize-none",rows:4,disabled:f})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-6 mt-6 border-t",children:[i.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",disabled:f,children:"Cancel"}),i.jsx("button",{onClick:A,className:"px-6 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg",disabled:f,children:f?l.type==="NOTE"?"Creating...":"Scheduling...":l.type==="NOTE"?"Create Note":"Schedule Event"})]})]})},U8=`
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes scaleIn {
    from { 
      opacity: 0; 
      transform: scale(0.9) translateY(-20px); 
    }
    to { 
      opacity: 1; 
      transform: scale(1) translateY(0); 
    }
  }
  
  .animate-fadeIn {
    animation: fadeIn 0.3s ease-out;
  }
  
  .animate-scaleIn {
    animation: scaleIn 0.4s ease-out;
  }
`;if(typeof document<"u"&&!document.getElementById("modal-animations")){const t=document.createElement("style");t.id="modal-animations",t.textContent=U8,document.head.appendChild(t)}const gu=({children:e,onClose:t})=>i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[9999] flex justify-center items-center backdrop-blur-sm animate-fadeIn",children:i.jsxs("div",{className:"relative bg-white p-6 rounded-xl shadow-2xl w-full max-w-2xl m-4 max-h-[90vh] overflow-hidden animate-scaleIn transform transition-all duration-300",children:[i.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-all duration-200 z-10 hover:rotate-90 hover:scale-110","aria-label":"Close Modal",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e]})}),B8=({isEditModalOpen:e,closeEditModal:t,selectedNote:a,updateNote:r,isAddModalOpen:s,closeAddModal:n,createNote:l,isRemarkModalOpen:o,closeRemarkModal:c,addRemarkToNote:u,isViewRemarksModalOpen:d,closeViewRemarksModal:h,remarks:f=[]})=>{const[m,p]=E.useState(""),[x,v]=E.useState(""),[g,b]=E.useState(""),[y,w]=E.useState("");E.useEffect(()=>{if(a)if(p(a.content||""),a.dateTime){const C=new Date(a.dateTime);v(C.toISOString().split("T")[0]),b(C.toTimeString().slice(0,5))}else v(""),b("")},[a]);const N=()=>{if(!a||!a.id)return;const C={content:m,dateTime:x&&g?`${x}T${g}:00`:null};r(a.id,C),t()},A=async()=>{if(!a||!a.id||!y.trim()){alert("Please enter a remark");return}const C=JSON.parse(localStorage.getItem("user")||"{}"),T=C.userId||C.id;if(!T){alert("User session not found. Please login again.");return}try{(await u(a.id,{remark:y,userId:T})).success&&(w(""),c())}catch{}},S=async C=>{try{const T=await l(C);return T&&T.success?(n(),!0):(alert(`Failed to create note: ${(T==null?void 0:T.error)||"Unknown error"}`),!1)}catch(T){return alert(`Error creating note: ${T.message}`),!1}};return s?i.jsx(gu,{onClose:n,children:i.jsx(iT,{onSubmit:S,onCancel:n})}):e&&a?i.jsxs(gu,{onClose:t,children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Edit Note"}),i.jsx("textarea",{value:m,onChange:C=>p(C.target.value),placeholder:"Update your note content",className:"w-full p-2 border rounded mb-4",rows:4}),i.jsxs("div",{className:"flex gap-2 mb-4",children:[i.jsx("input",{type:"date",value:x,onChange:C=>v(C.target.value),className:"w-1/2 p-2 border rounded",min:new Date().toISOString().split("T")[0]}),i.jsx("input",{type:"time",value:g,onChange:C=>b(C.target.value),className:"w-1/2 p-2 border rounded",step:"60"})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{onClick:N,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"Update"}),i.jsx("button",{onClick:t,className:"bg-gray-300 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]}):o&&a?i.jsxs(gu,{onClose:c,children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Add Remark"}),i.jsx("textarea",{value:y,onChange:C=>w(C.target.value),placeholder:"Write a remark...",className:"w-full p-2 border rounded mb-4",rows:3}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx("button",{onClick:A,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Add"}),i.jsx("button",{onClick:c,className:"bg-gray-300 px-4 py-2 rounded hover:bg-gray-400",children:"Cancel"})]})]}):d&&a?i.jsxs(gu,{onClose:h,children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Remarks"}),i.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:f.length===0?i.jsx("p",{className:"text-gray-500",children:"No remarks found for this note."}):f.map(C=>{var T;return i.jsxs("div",{className:"p-2 border-b",children:[i.jsx("p",{className:"text-gray-800",children:C.remark}),i.jsxs("small",{className:"text-gray-500 block mt-1",children:["by ",((T=C.createdBy)==null?void 0:T.name)||"Unknown"," at ",new Date(C.createdAt).toLocaleString()]})]},C.id)})}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsx("button",{onClick:h,className:"bg-gray-300 px-4 py-2 rounded hover:bg-gray-400",children:"Close"})})]}):null},at=({className:e="",width:t="100%",height:a="20px"})=>i.jsx("div",{className:`bg-gray-200 rounded animate-pulse ${e}`,style:{width:t,height:a}}),I8=()=>i.jsx("div",{className:"overflow-x-auto bg-white h-screen rounded-lg shadow relative z-10",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Content"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created For"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scheduled"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:[...Array(8)].map((e,t)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx(at,{width:"80%",height:"16px"}),i.jsx(at,{width:"60%",height:"16px"})]})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"80px",height:"32px",className:"rounded-md"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"90px",height:"32px",className:"rounded-md"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"60px",height:"16px"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"100px",height:"16px"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"110px",height:"16px"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"120px",height:"16px"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx(at,{width:"120px",height:"16px"})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(at,{width:"24px",height:"24px",className:"rounded"}),i.jsx(at,{width:"24px",height:"24px",className:"rounded"}),i.jsx(at,{width:"24px",height:"24px",className:"rounded"})]})})]},t))})]})}),P8=()=>i.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border border-gray-200",children:[i.jsxs("div",{className:"mb-3 space-y-2",children:[i.jsx(at,{width:"100%",height:"16px"}),i.jsx(at,{width:"85%",height:"16px"}),i.jsx(at,{width:"70%",height:"16px"})]}),i.jsxs("div",{className:"flex justify-between items-center mb-3 gap-2",children:[i.jsx(at,{width:"80px",height:"32px",className:"rounded-md"}),i.jsx(at,{width:"90px",height:"32px",className:"rounded-md"})]}),i.jsxs("div",{className:"mb-4 space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(at,{width:"40px",height:"14px"}),i.jsx(at,{width:"60px",height:"14px"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(at,{width:"70px",height:"14px"}),i.jsx(at,{width:"100px",height:"14px"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(at,{width:"60px",height:"14px"}),i.jsx(at,{width:"120px",height:"14px"})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx(at,{width:"50px",height:"28px",className:"rounded"}),i.jsx(at,{width:"60px",height:"28px",className:"rounded"}),i.jsx(at,{width:"80px",height:"28px",className:"rounded"}),i.jsx(at,{width:"90px",height:"28px",className:"rounded"})]})]}),V8=()=>i.jsx("div",{className:"space-y-4",children:[...Array(6)].map((e,t)=>i.jsx(P8,{},t))}),z8=()=>{const[e,t]=E.useState({companyId:null,userId:null,role:null}),[a,r]=E.useState(""),[s,n]=E.useState(""),[l,o]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!1);E.useEffect(()=>{const ne=localStorage.getItem("companyId"),he=localStorage.getItem("company_id"),ce=JSON.parse(localStorage.getItem("user")||"{}");let Te=null;ne?Te=parseInt(ne,10):ce.companyId?Te=parseInt(ce.companyId,10):he&&(Te=parseInt(he,10));const P=ce.id||ce.userId,Ke=ce.role||"USER";t({companyId:Te,userId:P,role:Ke})},[]);const{notes:f,loading:m,error:p,loadNotes:x,createNote:v,updateNote:g,deleteNote:b,updateNoteStatus:y,updateNotePriority:w,addRemarkToNote:N,getNoteById:A,getRemarksByNoteId:S}=eT(e.companyId,e.userId,e.role),[C,T]=E.useState(null),[D,R]=E.useState(!1),[j,B]=E.useState(!1),[X,V]=E.useState(!1),[F,q]=E.useState(!1),[te,H]=E.useState([]),le=async ne=>{const{success:he,data:ce}=await A(ne);he&&(T(ce),R(!0))},W=()=>{if(!localStorage.getItem("token")){alert("No authentication token found. Please login again.");return}if(!e.companyId||!e.userId){alert("Missing user session data. Please login again.");return}T(null),B(!0)},_=ne=>{T({id:ne}),V(!0)},G=async ne=>{const{success:he,data:ce}=await S(ne);he&&(H(ce),T({id:ne}),q(!0))},z=[...f.filter(ne=>{const he=a===""||ne.content&&ne.content.toLowerCase().includes(a.toLowerCase())||ne.typeStr&&ne.typeStr.toLowerCase().includes(a.toLowerCase()),ce=s===""||ne.status===s,Te=l===""||ne.priority===l,P=c===""||ne.typeStr===c;return he&&ce&&Te&&P})].sort((ne,he)=>{const ce={NEW:1,PROCESSING:2,COMPLETED:3},Te=(ne.status||"COMPLETED").toUpperCase(),P=(he.status||"COMPLETED").toUpperCase(),Ke=ce[Te]||4,Fe=ce[P]||4;return Ke-Fe}),ie=[...new Set(f.map(ne=>ne.typeStr).filter(Boolean))],xe=()=>{r(""),n(""),o(""),u("")};return i.jsxs("div",{className:"flex justify-center items-start min-h-screen p-4",children:[i.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl border shadow-sm w-full max-w-[1200px] h-fit",children:[i.jsx("h2",{className:"text-center text-xl p-2 font-bold text-gray-800",children:"Notes Management"}),i.jsx("div",{className:"flex flex-col sm:flex-row gap-3 mb-4 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.jsxs("button",{onClick:W,className:"bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 flex items-center gap-2",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Add Note"]}),i.jsx("button",{onClick:x,className:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:m,children:m?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Refreshing..."]}):"Refresh"}),i.jsxs("button",{onClick:()=>h(!d),className:"md:hidden bg-gray-500 text-white px-4 py-2 text-sm rounded hover:bg-gray-600 transition-colors flex items-center gap-2",title:"Toggle filters",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]})]})}),i.jsxs("div",{className:"hidden md:block mb-4 p-4 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx("div",{children:i.jsx("input",{type:"text",placeholder:"Search by content or type...",value:a,onChange:ne=>r(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),i.jsx("div",{children:i.jsxs("select",{value:s,onChange:ne=>n(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"NEW",children:"New"}),i.jsx("option",{value:"PROCESSING",children:"Processing"}),i.jsx("option",{value:"COMPLETED",children:"Completed"})]})}),i.jsx("div",{children:i.jsxs("select",{value:l,onChange:ne=>o(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Priority"}),i.jsx("option",{value:"PRIORITY_A",children:"Priority A"}),i.jsx("option",{value:"PRIORITY_B",children:"Priority B"}),i.jsx("option",{value:"PRIORITY_C",children:"Priority C"})]})}),i.jsx("div",{children:i.jsxs("select",{value:c,onChange:ne=>u(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Types"}),ie.map(ne=>i.jsx("option",{value:ne,children:ne},ne))]})})]}),i.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-gray-200",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",z.length," of ",f.length," notes"]}),(a||s||l||c)&&i.jsx("button",{onClick:xe,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:"Clear Filters"})]})]}),d&&i.jsxs("div",{className:"md:hidden mb-4 p-4 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.jsx("div",{children:i.jsx("input",{type:"text",placeholder:"Search by content or type...",value:a,onChange:ne=>r(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),i.jsx("div",{children:i.jsxs("select",{value:s,onChange:ne=>n(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Status"}),i.jsx("option",{value:"NEW",children:"New"}),i.jsx("option",{value:"PROCESSING",children:"Processing"}),i.jsx("option",{value:"COMPLETED",children:"Completed"})]})}),i.jsx("div",{children:i.jsxs("select",{value:l,onChange:ne=>o(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Priority"}),i.jsx("option",{value:"PRIORITY_A",children:"Priority A"}),i.jsx("option",{value:"PRIORITY_B",children:"Priority B"}),i.jsx("option",{value:"PRIORITY_C",children:"Priority C"})]})}),i.jsx("div",{children:i.jsxs("select",{value:c,onChange:ne=>u(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Types"}),ie.map(ne=>i.jsx("option",{value:ne,children:ne},ne))]})})]}),i.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-gray-200",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",z.length," of ",f.length," notes"]}),(a||s||l||c)&&i.jsx("button",{onClick:xe,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors",children:"Clear Filters"})]})]}),m&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block",children:i.jsx(I8,{})}),i.jsx("div",{className:"block md:hidden",children:i.jsx(V8,{})})]}),p&&i.jsxs("div",{className:"text-center p-4 text-red-500 bg-red-50 rounded-lg",children:["Error: ",p]}),!m&&!p&&z.length===0&&i.jsxs("div",{className:"text-center p-8 text-gray-500",children:[i.jsx("div",{className:"text-lg font-medium",children:"No notes found"}),i.jsx("div",{className:"text-sm mt-1",children:f.length===0?"Create your first note to get started":"Try adjusting your filters"})]}),!m&&!p&&z.length>0&&i.jsxs(i.Fragment,{children:[i.jsx(R8,{notes:z,onEdit:le,onDelete:b,onUpdateStatus:y,onUpdatePriority:w,onAddRemark:_,onViewRemarks:G}),i.jsx("div",{className:"block md:hidden",children:i.jsx(O8,{notes:z,onEdit:le,onDelete:b,onUpdateStatus:y,onUpdatePriority:w,onAddRemark:_,onViewRemarks:G})})]})]}),i.jsx(B8,{isEditModalOpen:D,closeEditModal:()=>R(!1),selectedNote:C,updateNote:g,isAddModalOpen:j,closeAddModal:()=>B(!1),createNote:v,isRemarkModalOpen:X,closeRemarkModal:()=>V(!1),addRemarkToNote:N,isViewRemarksModalOpen:F,closeViewRemarksModal:()=>q(!1),remarks:te})]})},Tv=({task:e,onOpen:t,onDownload:a,onAssign:r,onUnassign:s,onDelete:n,role:l,canManageTask:o,isTaskAssignedToUser:c,loading:u=!1})=>{var p,x;const d=o==null?void 0:o((p=e.uploadedBy)==null?void 0:p.userId),h=c==null?void 0:c((x=e.assignedTo)==null?void 0:x.userId),f=l==="ADMIN"||l==="DIRECTOR",m=[{label:"Preview Task",icon:i.jsx(ya,{size:16}),onClick:()=>t(e.id)},...h||d?[{label:"Download File",icon:i.jsx(Np,{size:16}),onClick:()=>a(e.id)}]:[],...f?[e.assignedTo?{label:"Unassign Task",icon:i.jsx(Lc,{size:16}),onClick:()=>s(e.id)}:{label:"Assign Task",icon:i.jsx(es,{size:16}),onClick:()=>r(e.id)},{label:"Delete Task",icon:i.jsx(Fc,{size:16}),onClick:()=>{console.log("Delete action clicked for task:",e.id),n(e.id)},danger:!0}]:[]];return i.jsx(Fa,{item:e,actions:m})},H8=({tasks:e=[],onOpen:t,onDelete:a,onAssign:r,onUnassign:s,onDownload:n,onStatusUpdate:l,role:o,canManageTask:c,isTaskAssignedToUser:u,loading:d,error:h})=>{const[f,m]=E.useState({key:"uploadDate",direction:"desc"}),p=y=>{let w="asc";f.key===y&&f.direction==="asc"&&(w="desc"),m({key:y,direction:w})},x=[...e].sort((y,w)=>{var S,C;if(!f.key)return 0;let N=y[f.key],A=w[f.key];return f.key==="assignedTo"&&(N=((S=y.assignedTo)==null?void 0:S.name)||"Unassigned",A=((C=w.assignedTo)==null?void 0:C.name)||"Unassigned"),f.key==="uploadedBy"&&(N=y.uploadedByName||"Unknown",A=w.uploadedByName||"Unknown"),f.key==="uploadDate"&&(N=new Date(N||0),A=new Date(A||0)),f.key==="assignedToDate"&&(N=new Date(N||0),A=new Date(A||0)),N<A?f.direction==="asc"?-1:1:N>A?f.direction==="asc"?1:-1:0}),v=y=>f.key!==y?null:f.direction==="asc"?i.jsx(wp,{className:"h-4 w-4 ml-1 inline"}):i.jsx(vp,{className:"h-4 w-4 ml-1 inline"}),g=y=>y?new Date(y).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",b=({columnKey:y,title:w,className:N=""})=>i.jsxs("th",{className:`px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 whitespace-nowrap ${N}`,onClick:()=>p(y),children:[w,v(y)]});return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto border border-gray-200 rounded-lg",children:i.jsxs("table",{className:"min-w-[1000px] w-full table-auto text-sm text-left text-gray-700",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx(b,{columnKey:"title",title:"Title"}),i.jsx(b,{columnKey:"uploadDate",title:"Created"}),i.jsx(b,{columnKey:"assignedTo",title:"Assigned To"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:"text-center py-6 text-gray-400",children:"No tasks found."})}):x.map(y=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",title:y.title,children:y.title})}),i.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.jsx("div",{className:"text-sm text-gray-900",children:g(y.uploadDate)}),i.jsxs("div",{className:"text-xs text-gray-400",children:["by ",y.uploadedByName||"Unknown"]})]}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:y.assignedTo?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:y.assignedTo.name}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:y.assignedToDate?g(y.assignedToDate):"Date not set"})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Unassigned"}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Not assigned"})]})}),i.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:i.jsxs("select",{value:y.status||"NEW",onChange:w=>{const N=w.target.value;N==="COMPLETED"?window.confirm(`Are you sure you want to mark this task as ${N}?`)?l(y.id,N):w.target.value=y.status||"NEW":l(y.id,N)},className:`px-2 py-1 border rounded-full text-xs font-semibold appearance-none focus:outline-none focus:ring-2 ${y.status==="NEW"?"bg-yellow-100 text-yellow-800 border-yellow-300":y.status==="UNDER_PROCESS"?"bg-blue-100 text-blue-800 border-blue-300":y.status==="COMPLETED"?"bg-green-100 text-green-800 border-green-300":"bg-gray-100 text-gray-800 border-gray-300"}`,onClick:w=>w.stopPropagation(),children:[i.jsx("option",{value:"NEW",children:"NEW"}),i.jsx("option",{value:"UNDER_PROCESS",children:"UNDER PROCESS"}),i.jsx("option",{value:"COMPLETED",children:"COMPLETED"})]})}),i.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-center hover:bg-gray-50 transition-colors duration-150",children:i.jsx("div",{className:"flex justify-center",children:i.jsx(Tv,{task:y,onOpen:t,onDownload:n,onAssign:r,onUnassign:s,onDelete:a,role:o,canManageTask:c,isTaskAssignedToUser:u,loading:d})})})]},y.id))})]})}),i.jsx("div",{className:"md:hidden space-y-4",children:x.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-400",children:[i.jsx("div",{className:"text-lg font-medium",children:"No tasks found"}),i.jsx("div",{className:"text-sm mt-1",children:"Try adjusting your filters"})]}):x.map(y=>i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",title:y.title,children:y.title}),i.jsxs("div",{className:"flex items-center mt-1 text-xs text-gray-500",children:[i.jsx(wr,{className:"h-3 w-3 mr-1"}),g(y.uploadDate),i.jsxs("span",{className:"ml-2",children:["by ",y.uploadedByName||"Unknown"]})]})]}),i.jsx("div",{className:"ml-2 flex-shrink-0",children:i.jsx(Tv,{task:y,onOpen:t,onDownload:n,onAssign:r,onUnassign:s,onDelete:a,role:o,canManageTask:c,isTaskAssignedToUser:u,loading:d})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(Oa,{className:"h-4 w-4 text-gray-400 mr-2"}),i.jsx("span",{className:"text-gray-600",children:"Assigned to:"}),y.assignedTo?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:y.assignedTo.name}),i.jsx("span",{className:"ml-2 text-xs text-gray-400",children:y.assignedToDate?g(y.assignedToDate):"Date not set"})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Unassigned"}),i.jsx("span",{className:"ml-2 text-xs text-gray-400",children:"Not assigned"})]})]}),i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(Cl,{className:"h-4 w-4 text-gray-400 mr-2"}),i.jsx("span",{className:"text-gray-600",children:"Status:"}),i.jsxs("select",{value:y.status||"NEW",onChange:w=>{const N=w.target.value;N==="COMPLETED"?window.confirm(`Are you sure you want to mark this task as ${N}?`)?l(y.id,N):w.target.value=y.status||"NEW":l(y.id,N)},className:`ml-1 px-2 py-1 border rounded-full text-xs font-semibold appearance-none focus:outline-none focus:ring-2 ${y.status==="NEW"?"bg-yellow-100 text-yellow-800 border-yellow-300":y.status==="UNDER_PROCESS"?"bg-blue-100 text-blue-800 border-blue-300":y.status==="COMPLETED"?"bg-green-100 text-green-800 border-green-300":"bg-gray-100 text-gray-800 border-gray-300"}`,children:[i.jsx("option",{value:"NEW",children:"NEW"}),i.jsx("option",{value:"UNDER_PROCESS",children:"UNDER PROCESS"}),i.jsx("option",{value:"COMPLETED",children:"COMPLETED"})]})]})]})]},y.id))})]})},G8=({onRefresh:e,searchTerm:t,onSearchChange:a,loading:r=!1,taskCount:s=0,creatorFilter:n=null,availableCreators:l=[]})=>{const c=(()=>{if(!n||n==="ALL")return null;if(n==="CURRENT_USER")return"Me";const u=l.find(d=>d.id===parseInt(n));return u?`Created by: ${u.name}`:null})();return i.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Task Management"}),i.jsxs("span",{className:"ml-3 px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:[s," tasks"]}),c&&i.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800 rounded-full",children:c})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Search tasks...",value:t,onChange:u=>a(u.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full sm:w-64"})]}),i.jsxs("button",{onClick:e,disabled:r,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Sd,{className:`h-4 w-4 mr-2 ${r?"animate-spin":""}`}),"Refresh"]})]})]})})},$8=()=>{var Pr,Ct;const[e,t]=E.useState({companyId:null,userId:null,role:null}),[a,r]=E.useState(!0),[s,n]=E.useState(null),[l,o]=E.useState(!1),[c,u]=E.useState([]),[d,h]=E.useState([]);E.useEffect(()=>{try{const fe=localStorage.getItem("user");if(!fe)throw new Error("No user data found");const de=JSON.parse(fe),ye=localStorage.getItem("token");if(!ye)throw new Error("No authentication token found");const Pe=localStorage.getItem("companyId"),be=localStorage.getItem("company_id");if(!ye)return;let qe=null;Pe?qe=parseInt(Pe,10):de.companyId?qe=parseInt(de.companyId,10):be&&(qe=parseInt(be,10));const Xa=de.id||de.userId,$c=de.role||"USER";t({companyId:qe,userId:Xa,role:$c}),o(!0)}catch{n("Failed to load user data. Please log in again.")}finally{r(!1)}},[]);const{tasks:f,loading:m,error:p,loadTasksByRole:x,deleteTask:v,assignTask:g,unassignTask:b,updateTaskStatus:y,downloadExcelFile:w,canManageTask:N,isTaskAssignedToUser:A,refreshTasks:S,clearError:C,createdByFilter:T,setCreatedByFilter:D,assignedToFilter:R,setAssignedToFilter:j}=Rp(l?e.companyId:null,l?e.userId:null,l?e.role:null);E.useEffect(()=>{p&&(G({title:"Error",message:p,type:"error"}),C())},[p,C]);const[B,X]=E.useState(!1),[V,F]=E.useState({title:"",message:"",type:"info",onConfirm:null,onCancel:null,showCancel:!1}),[q,te]=E.useState(!1),[H,le]=E.useState({users:[],taskId:null,action:"assign"}),[W,_]=E.useState(null);E.useEffect(()=>{x&&e.companyId&&e.userId&&e.role&&x()},[x,e.companyId,e.userId,e.role]);const G=fe=>{F({title:fe.title||"Alert",message:fe.message||"",type:fe.type||"info",onConfirm:fe.onConfirm||null,onCancel:fe.onCancel||null,showCancel:fe.showCancel||!1}),X(!0)},Y=()=>{V.onConfirm&&V.onConfirm(),X(!1)},z=()=>{V.onCancel&&V.onCancel(),X(!1)},ie=(fe,de,ye)=>{le({users:fe,taskId:de,action:ye}),te(!0)},xe=async fe=>{if(W!==fe){_(fe);try{const de=await g(H.taskId,fe);if(de.success)te(!1),_(null),await S(),G({title:"Success",message:"Task assigned successfully!",type:"success"});else throw new Error(de.error||"Failed to assign task")}catch(de){_(null),G({title:"Error",message:de.message||"Failed to assign task. Please try again.",type:"error"})}}},ne=()=>{if(!B)return null;const fe=()=>{switch(V.type){case"success":return"text-green-600 bg-green-50 border-green-200";case"error":return"text-red-600 bg-red-50 border-red-200";case"warning":return"text-yellow-600 bg-yellow-50 border-yellow-200";default:return"text-blue-600 bg-blue-50 border-blue-200"}},de=()=>{switch(V.type){case"success":return"text-green-500";case"error":return"text-red-500";case"warning":return"text-yellow-500";default:return"text-blue-500"}},ye=()=>{switch(V.type){case"success":return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})});case"error":return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})});case"warning":return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});default:return i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex justify-center items-center",children:i.jsxs("div",{className:`bg-white p-6 rounded-lg shadow-xl max-w-md w-full m-4 border-2 ${fe()}`,children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:`mr-3 ${de()}`,children:ye()}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:V.title})]}),i.jsx("div",{className:"text-gray-700 mb-6",children:V.message}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[V.showCancel&&i.jsx("button",{onClick:z,className:"px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),i.jsx("button",{onClick:Y,className:`px-4 py-2 text-white rounded-md transition-colors ${V.type==="error"?"bg-red-600 hover:bg-red-700":V.type==="success"?"bg-green-600 hover:bg-green-700":V.type==="warning"?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"}`,children:"OK"})]})]})})},he=()=>q?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex justify-center items-center",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full m-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select User to Assign"}),i.jsx("button",{onClick:()=>te(!1),disabled:W!==null,className:`${W!==null?"text-gray-300 cursor-not-allowed":"text-gray-400 hover:text-gray-600"}`,children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"max-h-64 overflow-y-auto",children:H.users.map(fe=>{const de=fe.userId||fe.id,ye=W===de;return i.jsxs("div",{onClick:()=>!ye&&xe(de),className:`flex items-center p-3 rounded-md border-b border-gray-100 last:border-b-0 ${ye?"bg-blue-50 cursor-not-allowed opacity-75":"hover:bg-gray-50 cursor-pointer"}`,children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-medium text-gray-900",children:fe.name||fe.username}),i.jsx("div",{className:"text-sm text-gray-500",children:"USER"})]}),i.jsx("div",{className:"text-blue-600",children:ye?i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}):i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]},de)})}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsx("button",{onClick:()=>te(!1),disabled:W!==null,className:`px-4 py-2 rounded-md transition-colors ${W!==null?"text-gray-400 bg-gray-50 cursor-not-allowed":"text-gray-600 bg-gray-100 hover:bg-gray-200"}`,children:"Cancel"})})]})}):null,ce=async fe=>{const de=localStorage.getItem("user"),ye=localStorage.getItem("token");if(!de||!ye){G({title:"Error",message:"Please login first to access Excel data.",type:"error"});return}try{const Pe=JSON.parse(de),be=Pe.userId||Pe.id,qe=Pe.companyId,Xa=Pe.role,Md=`${window.location.origin}/excel-preview.html?taskId=${fe}&companyId=${qe}&userId=${be}&userRole=${Xa}`;window.open(Md,"_blank")}catch{G({title:"Error",message:"Failed to open Excel preview. Please try again.",type:"error"})}},Te=async fe=>{try{const de=await w(fe);if(de.success){const ye=new Blob([de.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Pe=window.URL.createObjectURL(ye),be=document.createElement("a");be.href=Pe,be.download=`task-${fe}.xlsx`,document.body.appendChild(be),be.click(),document.body.removeChild(be),window.URL.revokeObjectURL(Pe),G({title:"Success",message:"Task file downloaded successfully!",type:"success"})}else throw new Error(de.error||"Failed to download file")}catch(de){console.error("Download error:",de),G({title:"Error",message:de.message||"Failed to download task file. Please try again.",type:"error"})}},P=async fe=>{var ye,Pe,be;console.log("handleDelete called with taskId:",fe),console.log("Current tasks:",f),console.log("Current userInfo:",e);const de=f.find(qe=>qe.id===fe);if(console.log("Found task:",de),!de){G({title:"Error",message:"Task not found",type:"error"});return}if(console.log("Task creator ID:",(ye=de.uploadedBy)==null?void 0:ye.userId),console.log("Can manage task:",N((Pe=de.uploadedBy)==null?void 0:Pe.userId)),!N((be=de.uploadedBy)==null?void 0:be.userId)){G({title:"Permission Denied",message:"You do not have permission to delete this task",type:"error"});return}G({title:"Confirm Delete",message:"Are you sure you want to delete this task? This action cannot be undone.",type:"warning",showCancel:!0,onConfirm:async()=>{try{const qe=await v(fe);if(qe.success)await S(),G({title:"Success",message:"Task deleted successfully!",type:"success"});else throw new Error(qe.error||"Failed to delete task")}catch(qe){G({title:"Error",message:qe.message||"Failed to delete task. Please try again.",type:"error"})}}})},Ke=async fe=>{if(!f.find(ye=>ye.id===fe)){G({title:"Error",message:"Task not found",type:"error"});return}if(!(e.role==="ADMIN"||e.role==="DIRECTOR")){G({title:"Permission Denied",message:"Only ADMIN or DIRECTOR can assign tasks",type:"error"});return}try{const ye=await Re.getUsersByRoleAndCompany(e.companyId,"USER");if(!ye.success)throw new Error("Failed to fetch users");const Pe=ye.data;if(Pe.length===0){G({title:"No Users Available",message:"No USER role users found to assign this task.",type:"info"});return}ie(Pe,fe,"assign")}catch{G({title:"Error",message:"Failed to load users. Please try again.",type:"error"})}},Fe=async fe=>{const de=f.find(ye=>ye.id===fe);if(!de){G({title:"Error",message:"Task not found",type:"error"});return}if(!(e.role==="ADMIN"||e.role==="DIRECTOR")){G({title:"Permission Denied",message:"Only ADMIN or DIRECTOR can unassign tasks",type:"error"});return}if(!de.assignedTo){G({title:"Task Not Assigned",message:"This task is not assigned to anyone.",type:"info"});return}G({title:"Confirm Unassign",message:`Are you sure you want to unassign this task from ${de.assignedTo.name}?`,type:"warning",showCancel:!0,onConfirm:async()=>{try{const ye=await b(fe);if(ye.success)await S(),G({title:"Success",message:"Task unassigned successfully!",type:"success"});else throw new Error(ye.error||"Failed to unassign task")}catch(ye){G({title:"Error",message:ye.message||"Failed to unassign task. Please try again.",type:"error"})}}})},$e=async(fe,de)=>{const ye=f.find(be=>be.id===fe);if(!ye){G({title:"Error",message:"Task not found",type:"error"});return}if(!(e.role==="ADMIN"||e.role==="DIRECTOR"||ye.assignedTo&&ye.assignedTo.userId===e.userId)){G({title:"Permission Denied",message:"You can only update status of tasks assigned to you, or you need ADMIN/DIRECTOR role",type:"error"});return}try{const be=await y(fe,de);if(be.success)G({title:"Success",message:`Task status updated to ${de} successfully!`,type:"success"});else throw new Error(be.error||"Failed to update task status")}catch(be){console.error("❌ Error in handleStatusUpdate:",be),G({title:"Error",message:be.message||"Failed to update task status. Please try again.",type:"error"})}},[Ne,ge]=E.useState(""),[Me,Mt]=E.useState("ALL"),[Qt,oa]=E.useState(!1),Ye=e.role==="ADMIN"||e.role==="DIRECTOR";E.useEffect(()=>{if(!f||f.length===0){u([]);return}const fe=[],de=new Set;f.forEach(ye=>{ye.uploadedBy&&!de.has(ye.uploadedBy)&&(de.add(ye.uploadedBy),fe.push({id:ye.uploadedBy,name:ye.uploadedBy===e.userId?"Me":ye.uploadedByName,role:"CREATOR"}))}),u(fe)},[f,e.userId]),E.useEffect(()=>{if(!f||f.length===0){h([]);return}const fe=[],de=new Set;f.forEach(ye=>{ye.assignedTo&&ye.assignedTo.userId&&!de.has(ye.assignedTo.userId)&&(de.add(ye.assignedTo.userId),fe.push({id:ye.assignedTo.userId,name:ye.assignedTo.userId===e.userId?"Me":ye.assignedTo.name,role:"ASSIGNEE"}))}),h(fe)},[f,e.userId]);const Jt=()=>{ge(""),Mt("ALL"),D("ALL"),j("ALL")},ft=E.useMemo(()=>Ne&&Ne.trim()!==""||Me!=="ALL"||T!=="ALL"||R!=="ALL",[Ne,Me,T,R]),Ta=(fe,de)=>(fe||"").toLowerCase().includes((de||"").toLowerCase()),Ut=E.useMemo(()=>{let fe=[...f];return Ne.trim()&&(fe=fe.filter(de=>{var qe,Xa;const ye=Ta(de.title,Ne),Pe=de.uploadedBy===e.userId?"Me":de.uploadedByName||"",be=((qe=de.assignedTo)==null?void 0:qe.userId)===e.userId?"Me":((Xa=de.assignedTo)==null?void 0:Xa.name)||"";return ye||Ta(Pe,Ne)||Ta(be,Ne)})),T!=="ALL"&&(fe=fe.filter(de=>de.uploadedBy===parseInt(T))),R!=="ALL"&&(fe=fe.filter(de=>{var ye;return((ye=de.assignedTo)==null?void 0:ye.userId)===parseInt(R)})),Me==="NEW"?fe=fe.filter(de=>de.status==="NEW"):Me==="UNDER_PROCESS"?fe=fe.filter(de=>de.status==="UNDER_PROCESS"):Me==="COMPLETED"&&(fe=fe.filter(de=>de.status==="COMPLETED")),fe},[f,Ne,T,R,Me,e.userId]);return a?i.jsxs("div",{className:"flex justify-center items-center p-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading user data..."})]}):s?i.jsxs("div",{className:"text-center text-red-600 p-8",children:[i.jsx("p",{children:s}),i.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Reload Page"})]}):!e.companyId||!e.userId?i.jsxs("div",{className:"text-center text-red-600 p-8",children:[i.jsx("p",{children:"Essential user data is missing. Please log in again."}),i.jsx("button",{onClick:()=>{localStorage.clear(),window.location.href="/"},className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Go to Login"})]}):i.jsxs("div",{className:"flex justify-center items-start p-2",children:[i.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-xl border shadow-sm w-full max-w-[1200px] h-fit",children:[i.jsx("h2",{className:"text-center text-xl p-2 font-bold text-gray-800",children:"Task Management"}),i.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex-1",children:i.jsx(G8,{onRefresh:S,searchTerm:Ne,onSearchChange:ge,loading:m,taskCount:Ut.length,creatorFilter:T,availableCreators:c})}),Ye&&i.jsxs("button",{onClick:()=>oa(!Qt),className:"md:hidden ml-3 p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors relative",title:"Toggle Filters",children:[i.jsx(Nd,{className:"h-5 w-5"}),ft&&i.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-blue-500 rounded-full"})]})]})}),Ye&&i.jsxs("div",{className:`mb-4 p-4 bg-gray-50 rounded-lg transition-all duration-300 ${Qt?"block":"hidden md:block"}`,children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Status"}),i.jsxs("select",{value:Me,onChange:fe=>Mt(fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"ALL",children:"All Task Status"}),i.jsx("option",{value:"NEW",children:"New"}),i.jsx("option",{value:"UNDER_PROCESS",children:"Under Process"}),i.jsx("option",{value:"COMPLETED",children:"Completed"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Created By"}),i.jsxs("select",{value:T,onChange:fe=>D(fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"ALL",children:"All Creators"}),c.map(fe=>i.jsx("option",{value:fe.id,children:fe.name},fe.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),i.jsxs("select",{value:R,onChange:fe=>j(fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[i.jsx("option",{value:"ALL",children:"No Filter"}),d.map(fe=>i.jsx("option",{value:fe.id,children:fe.name},fe.id))]})]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mt-3 pt-3 border-t border-gray-200 gap-3",children:[i.jsxs("div",{className:"text-sm text-gray-600 flex flex-col md:flex-row gap-2 md:gap-4",children:[i.jsxs("span",{children:["Showing ",Ut.length," of ",(f==null?void 0:f.length)||0," tasks"]}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("span",{className:"text-yellow-600",children:["New: ",Ut.filter(fe=>fe.status==="NEW").length]}),i.jsxs("span",{className:"text-blue-600",children:["Under Process: ",Ut.filter(fe=>fe.status==="UNDER_PROCESS").length]}),i.jsxs("span",{className:"text-green-600",children:["Completed: ",Ut.filter(fe=>fe.status==="COMPLETED").length]})]}),T!=="ALL"&&i.jsxs("span",{className:"text-purple-600",children:["Creator: ",((Pr=c.find(fe=>fe.id===parseInt(T)))==null?void 0:Pr.name)||"Unknown"]}),R!=="ALL"&&i.jsxs("span",{className:"text-indigo-600",children:["Assigned: ",((Ct=d.find(fe=>fe.id===parseInt(R)))==null?void 0:Ct.name)||"Unknown"]})]}),ft&&i.jsx("button",{onClick:Jt,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-md transition-colors self-start md:self-auto",children:"Clear Filters"})]})]}),m&&i.jsxs("div",{className:"flex justify-center items-center py-12",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("div",{className:"ml-3 text-gray-600",children:"Loading tasks..."})]}),p&&i.jsxs("div",{className:"text-center p-4 text-red-500 bg-red-50 rounded-lg",children:["Error: ",p]}),(!e.companyId||!e.userId)&&!m&&i.jsxs("div",{className:"text-center p-4 text-yellow-600 bg-yellow-100 rounded-lg",children:[i.jsx("div",{className:"font-semibold",children:"User session expired or not found. Please log in again."}),i.jsxs("div",{className:"mt-2 text-sm",children:["Missing: ",!e.companyId&&"Company ID"," ",!e.userId&&"User ID"]})]}),!m&&!p&&e.companyId&&e.userId&&Ut.length===0&&i.jsxs("div",{className:"text-center p-8 text-gray-500",children:[i.jsx("div",{className:"text-lg font-medium",children:"No tasks found"}),i.jsx("div",{className:"text-sm mt-1",children:((f==null?void 0:f.length)||0)===0?"Upload your first task to get started":"Try adjusting your filters"})]}),!m&&!p&&e.companyId&&e.userId&&Ut.length>0&&i.jsx(H8,{tasks:Ut,onOpen:ce,onDownload:Te,onDelete:P,onAssign:Ke,onUnassign:Fe,onStatusUpdate:$e,role:e.role,canManageTask:N,isTaskAssignedToUser:A,loading:m})]}),i.jsx(ne,{}),i.jsx(he,{})]})},Y8=()=>{const{user:e}=Na(),[t,a]=E.useState({name:"",email:"",phone:"",role:""}),[r,s]=E.useState(!1),[n,l]=E.useState(!1),[o,c]=E.useState("/assets/default-avatar.png"),u=async()=>{var g,b,y;const v=JSON.parse(localStorage.getItem("user")||"{}").userId;if(!v){oe("User not found in local storage.");return}try{const w=await Re.getUserById(v);if(w.success){const N=w.data;a({name:N.name||"",email:N.email||"",phone:N.phone||"",role:N.role||""}),localStorage.setItem("user",JSON.stringify(N)),await d(v)}else{const N=w.error||"Failed to load user";oe("❌ Error loading user info: "+N)}}catch(w){const N=((b=(g=w.response)==null?void 0:g.data)==null?void 0:b.message)||((y=w.response)==null?void 0:y.data)||w.message||"Connection error";oe("❌ Error loading user info: "+N)}},d=async x=>{try{const v=await Re.getAvatar(x);v.success&&v.data?c(v.data):c("/assets/default-avatar.png")}catch{c("/assets/default-avatar.png")}};E.useEffect(()=>{e&&a({name:e.name||"",email:e.email||"",phone:e.phone||"",role:e.role||""}),u()},[e]);const h=x=>{const{name:v,value:g}=x.target;a(b=>({...b,[v]:g}))},f=()=>{s(!1),e&&a({name:e.name||"",email:e.email||"",phone:e.phone||"",role:e.role||""})},m=async x=>{var v;if(x.preventDefault(),!t.name||!t.email||!t.phone){oe("Please fill in all fields.");return}l(!0);try{const g=JSON.parse(localStorage.getItem("user")||"{}"),b=g.userId,y={name:t.name,email:t.email,phone:t.phone,role:t.role},w=await Re.updateProfile(b,y);if(w.success){oe("✅ Account updated successfully!"),s(!1);const N=w.data.user||w.data,A={...g,name:N.name,email:N.email,phone:N.phone,role:N.role};localStorage.setItem("user",JSON.stringify(A)),a({name:N.name||y.name,email:N.email||y.email,phone:N.phone||y.phone,role:N.role||y.role}),w.data.tokenUpdated&&oe("✅ Account and authentication updated successfully!");try{await u()}catch{}}else{const N=w.error||"Failed to update user";oe("❌ Error updating account: "+N)}}catch(g){const b=((v=g.response)==null?void 0:v.data)||g.message||"An error occurred while saving.";oe("❌ "+b)}finally{l(!1)}},p=async x=>{const v=x.target.files[0],g=JSON.parse(localStorage.getItem("user")||"{}");if(!(g!=null&&g.userId)){oe("Please log in to upload your avatar.");return}if(v){const b=new FileReader;b.onload=y=>c(y.target.result),b.readAsDataURL(v);try{c("/assets/uploading.gif");const y=await Re.uploadAvatar(g.userId,v);if(y.success){oe("✅ Avatar uploaded successfully!"),await d(g.userId);const w=await Re.getUserById(g.userId);w.success&&localStorage.setItem("user",JSON.stringify(w.data))}else oe("❌ Error uploading avatar: "+y.error),c("/assets/default-avatar.png")}catch(y){oe("❌ Error uploading avatar: "+y.message),c("/assets/default-avatar.png")}}};return i.jsx("div",{className:"max-w-2xl mx-auto relative",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden relative",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4",children:i.jsxs("div",{className:"flex items-center text-white",children:[i.jsx(Dr,{className:"mr-3",size:24}),i.jsx("h2",{className:"text-xl font-semibold",children:"Account Settings"})]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"flex flex-col items-center mb-8",children:[i.jsxs("div",{className:"relative",children:[i.jsx("img",{src:o,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-gray-200 shadow-lg"}),i.jsx("label",{htmlFor:"avatarInput",className:"absolute bottom-0 right-0 bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full shadow-lg transition-colors cursor-pointer",children:i.jsx($6,{size:16})}),i.jsx("input",{id:"avatarInput",type:"file",className:"hidden",accept:"image/*",onChange:p})]}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900",children:t.name||"User Name"}),i.jsx("p",{className:"text-sm text-gray-500",children:t.role||"User"})]}),i.jsxs("form",{onSubmit:m,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),i.jsx("input",{type:"text",name:"name",value:t.name,onChange:h,readOnly:!r,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ${r?"bg-white border-gray-300 text-gray-900":"bg-gray-50 border-gray-200 text-gray-600"}`})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),i.jsx("input",{type:"email",name:"email",value:t.email,onChange:h,readOnly:!r,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ${r?"bg-white border-gray-300 text-gray-900":"bg-gray-50 border-gray-200 text-gray-600"}`})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),i.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:h,readOnly:!r,className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all ${r?"bg-white border-gray-300 text-gray-900":"bg-gray-50 border-gray-200 text-gray-600"}`})]}),!r&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),i.jsx("input",{type:"text",value:t.role,readOnly:!0,className:"w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-600"})]})]}),i.jsx("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:r?i.jsxs(i.Fragment,{children:[i.jsxs("button",{type:"button",onClick:f,className:"flex items-center px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors",children:[i.jsx(wa,{size:18,className:"mr-2"}),"Cancel"]}),i.jsxs("button",{type:"submit",disabled:n,className:"flex items-center px-6 py-3 bg-green-500 hover:bg-green-600 disabled:bg-green-400 text-white font-medium rounded-lg transition-colors",children:[i.jsx(CS,{size:18,className:"mr-2"}),n?"Saving...":"Save Changes"]})]}):i.jsxs("button",{type:"button",onClick:()=>s(!0),className:"flex items-center px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors",children:[i.jsx(NO,{size:18,className:"mr-2"}),"Edit Profile"]})})]})]}),n&&i.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-50",children:i.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})]})})},q8=()=>{const{user:e}=Na(),t=(e==null?void 0:e.userId)||(e==null?void 0:e.id),a=e==null?void 0:e.companyId,{notifications:r,loading:s,error:n,refreshNotifications:l,clearError:o}=tT(t,a),c=()=>{l()},u=f=>f&&(f.includes("📅")||f.includes("⏰")||f.includes("Follow-up")||f.includes("follow-up")||f.includes("scheduled for")),d=f=>u(f)?"follow-up":"general",h=f=>f?new Date(f).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.6,type:"spring"},children:[i.jsx("div",{className:"sticky top-0 z-10 bg-white p-6 border-b border-gray-100 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Gu,{className:"text-gray-500",size:32}),i.jsx("div",{children:i.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Notifications"})})]}),i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("button",{onClick:c,className:"p-2 text-gray-500 hover:text-gray-700 rounded-full hover:bg-gray-100 transition-colors",title:"Refresh notifications",children:i.jsx(Sd,{size:18,className:s?"animate-spin":""})})})]})}),i.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200",children:i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Total:"}),i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-medium",children:r.length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"Follow-ups:"}),i.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full font-medium",children:r.filter(f=>d(f.message)==="follow-up").length})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-700",children:"General:"}),i.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full font-medium",children:r.filter(f=>d(f.message)==="general").length})]})]})}),i.jsxs("div",{className:"p-6",children:[n&&i.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md flex justify-between items-center",children:[i.jsx("span",{children:n}),i.jsx("button",{onClick:o,className:"text-red-500 hover:text-red-700",children:"×"})]}),s?i.jsx("div",{className:"space-y-4",children:[...Array(5)].map((f,m)=>i.jsxs("div",{className:"animate-pulse bg-gray-100 p-4 rounded-lg",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]},m))}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-gray-200 shadow-sm",children:i.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-sm text-gray-800 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Type"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Message"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Date"})]})}),i.jsx("tbody",{children:r.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:"3",className:"text-center py-8 text-gray-500",children:[i.jsx(Gu,{size:24,className:"mx-auto mb-2 text-gray-300"}),"No notifications found."]})}):r.map(f=>{const m=d(f.message);return i.jsxs("tr",{className:`text-sm hover:bg-gray-50 transition-colors ${m==="follow-up"?"border-l-4 border-l-green-500":""}`,children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center",children:m==="follow-up"?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"📅 Follow-up"}):i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"🔔 General"})})}),i.jsx("td",{className:"px-6 py-4 text-gray-900",children:i.jsx("div",{children:f.message})}),i.jsx("td",{className:"px-6 py-4 text-gray-500",children:h(f.createdAt)})]},f.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-4",children:r.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Gu,{size:24,className:"mx-auto mb-2 text-gray-300"}),"No notifications found."]}):r.map(f=>{const m=d(f.message);return i.jsxs("div",{className:`p-4 border border-gray-200 rounded-lg bg-white ${m==="follow-up"?"border-l-4 border-l-green-500":""}`,children:[i.jsx("div",{className:"flex items-start justify-between mb-2",children:i.jsx("div",{className:"flex items-center gap-2",children:m==="follow-up"?i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"📅 Follow-up"}):i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"🔔 General"})})}),i.jsx("div",{className:"text-sm text-gray-900 mb-2",children:f.message}),i.jsx("div",{className:"text-xs text-gray-500",children:h(f.createdAt)})]},f.id)})})]})]})]})},X8=({admin:e,searchTerm:t,onUpdate:a,onActivate:r,onDeactivate:s,onViewAssignedUsers:n})=>{const[l,o]=E.useState(!1),c=E.useRef(null),u=(h,f)=>{if(!f||!h)return h;const m=new RegExp(`(${f})`,"gi");return h.toString().split(m).map((x,v)=>m.test(x)?i.jsx("mark",{className:"bg-yellow-200 px-1 rounded",children:x},v):x)};E.useEffect(()=>{const h=f=>{c.current&&!c.current.contains(f.target)&&o(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]);const d=e.status==="active"||e.status===!0||e.status===1;return i.jsxs("tr",{className:"text-sm text-gray-700 hover:bg-blue-50 transition-all duration-200 border-b border-gray-100",children:[i.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:i.jsx("button",{onClick:()=>n&&n(e),className:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer transition-colors",title:"Click to view assigned users",children:u(e.name,t)})}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:u(e.email,t)}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:u(e.phone,t)}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.role})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d?"Active":"Inactive"})}),i.jsx("td",{className:"px-2 py-2 text-center",children:i.jsx(Fa,{item:e,actions:[{label:"Update Admin",icon:i.jsx(Ya,{size:14}),onClick:()=>a(e)},d?{label:"Deactivate",icon:i.jsx(ts,{size:14}),onClick:()=>s(e.userId),danger:!0}:{label:"Activate",icon:i.jsx(Oa,{size:14}),onClick:()=>r(e.userId)}]})})]})},K8=({isOpen:e,onClose:t,admin:a})=>{const[r,s]=E.useState([]),[n,l]=E.useState(!1),[o,c]=E.useState(null),{getUsersByAdmin:u}=Rs();E.useEffect(()=>{e&&(a!=null&&a.userId)&&d()},[e,a==null?void 0:a.userId]);const d=async()=>{l(!0),c(null);try{const f=await u(a.userId);f.success?s(f.data||[]):c(f.error||"Failed to load assigned users")}catch{c("Failed to load assigned users")}finally{l(!1)}},h=()=>{s([]),c(null),t()};return e?i.jsx(Jn,{children:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs(wt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(ra,{size:24}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold",children:"Assigned Users"}),i.jsxs("p",{className:"text-blue-100 text-sm",children:["Users assigned to ",a==null?void 0:a.name]})]})]}),i.jsx("button",{onClick:h,className:"p-2 hover:bg-blue-600 rounded-full transition-colors",children:i.jsx(wa,{size:20})})]})}),i.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:n?i.jsx("div",{className:"space-y-4",children:[...Array(3)].map((f,m)=>i.jsxs("div",{className:"animate-pulse bg-gray-100 p-4 rounded-lg",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),i.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]},m))}):o?i.jsxs("div",{className:"text-center py-8",children:[i.jsxs("div",{className:"text-red-500 mb-2",children:["❌ ",o]}),i.jsx("button",{onClick:d,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Retry"})]}):r.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Dr,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{className:"text-lg font-medium",children:"No Users Assigned"}),i.jsx("p",{className:"text-sm",children:"This admin has no users assigned to them."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-gray-200 shadow-sm",children:i.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white",children:[i.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 text-sm text-gray-800",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Name"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Email"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Phone"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Role"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Status"})]})}),i.jsx("tbody",{children:r.map(f=>{const m=f.status==="active"||f.status===!0||f.status===1;return i.jsxs("tr",{className:"text-sm text-gray-700 hover:bg-gray-50 transition-colors border-b border-gray-100",children:[i.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Dr,{size:16,className:"text-gray-400"}),f.name]})}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(gs,{size:14,className:"text-gray-400"}),f.email]})}),i.jsx("td",{className:"px-6 py-4 text-gray-600",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Jr,{size:14,className:"text-gray-400"}),f.phone]})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:f.role})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m?i.jsxs(i.Fragment,{children:[i.jsx(Oa,{size:12,className:"mr-1"}),"Active"]}):i.jsxs(i.Fragment,{children:[i.jsx(ts,{size:12,className:"mr-1"}),"Inactive"]})})})]},f.userId||f.id)})})]})}),i.jsx("div",{className:"md:hidden space-y-4",children:r.map(f=>{const m=f.status==="active"||f.status===!0||f.status===1;return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-lg mb-3 text-gray-900",children:[i.jsx(Dr,{size:18,className:"text-gray-400"}),f.name]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(gs,{size:14,className:"text-gray-400"}),i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:f.email})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Jr,{size:14,className:"text-gray-400"}),i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Phone:"}),i.jsx("span",{className:"text-gray-700",children:f.phone})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Role:"}),i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:f.role})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m?i.jsxs(i.Fragment,{children:[i.jsx(Oa,{size:12,className:"mr-1"}),"Active"]}):i.jsxs(i.Fragment,{children:[i.jsx(ts,{size:12,className:"mr-1"}),"Inactive"]})})]})]})]},f.userId||f.id)})}),i.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:i.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[i.jsx(ra,{size:16}),i.jsxs("span",{className:"font-medium",children:["Total: ",r.length," user",r.length!==1?"s":""," assigned to ",a==null?void 0:a.name]})]})})]})}),i.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:h,className:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})})})]})})}):null},W8=()=>{const{user:e}=Na(),t=e==null?void 0:e.companyId,a=e==null?void 0:e.role,r=(e==null?void 0:e.userId)||(e==null?void 0:e.id),{admins:s,loading:n,error:l,loadAdmins:o,activateAdmin:c,revokeAdmin:u,getAdminsByRoleAndCompany:d,getAllAdmins:h}=QS(a==="DEVELOPER"?null:t,a,r),[f,m]=E.useState(""),[p,x]=E.useState(null),[v,g]=E.useState(null),b=async()=>{if(a==="DEVELOPER"){if(!a||!r)return}else if(!t||!a||!r)return;try{a==="DEVELOPER"?await h():a==="DIRECTOR"&&await d()}catch{}};E.useEffect(()=>{b()},[t,a,r]);const y=async T=>{(await c(T)).success},w=async T=>{(await u(T)).success},N=()=>{x(null),b()},A=()=>{g(null)},S=s.filter(T=>{var R,j,B,X,V,F,q,te,H;const D=f.toLowerCase();return a==="DEVELOPER"?((R=T.name)==null?void 0:R.toLowerCase().includes(D))||((j=T.email)==null?void 0:j.toLowerCase().includes(D))||((B=T.userId)==null?void 0:B.toString().includes(D))||((V=((X=T.company)==null?void 0:X.name)||T.companyName||"")==null?void 0:V.toLowerCase().includes(D)):((F=T.name)==null?void 0:F.toLowerCase().includes(D))||((q=T.email)==null?void 0:q.toLowerCase().includes(D))||((te=T.phone)==null?void 0:te.toLowerCase().includes(D))||((H=T.role)==null?void 0:H.toLowerCase().includes(D))}),C=()=>i.jsx("div",{className:"space-y-4 animate-pulse",children:[...Array(3)].map((T,D)=>i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 p-4 bg-gray-100 rounded-lg",children:[i.jsx("div",{className:"h-4 w-1/3 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-20 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]},D))});return i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",initial:{opacity:0,y:-60},animate:{opacity:1,y:0},transition:{duration:.6,type:"spring"},children:[a==="DEVELOPER"?i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Admins"}),i.jsx("input",{type:"text",placeholder:"Search admins...",value:f,onChange:T=>m(T.target.value),className:"px-4 py-2 border border-gray-300 rounded w-full max-w-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}):i.jsxs("div",{className:"sticky top-0 bg-white z-10 pb-4",children:[i.jsxs("div",{className:"flex justify-center items-center gap-3 mb-3",children:[i.jsx(ra,{className:"text-gray-500",size:28}),i.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Admins Management"})]}),i.jsx("div",{className:"flex justify-center",children:i.jsx("input",{type:"text",placeholder:"Search admins...",value:f,onChange:T=>m(T.target.value),className:"mb-4 px-4 py-2 border border-gray-300 rounded w-full max-w-md"})})]}),n?C():i.jsx(i.Fragment,{children:a==="DEVELOPER"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block",children:i.jsxs("table",{id:"adminTable",className:"min-w-full border border-gray-300",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Admin ID"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Name"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Email"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Phone"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Company"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Status"}),i.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Actions"})]})}),i.jsx("tbody",{children:S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"6",className:"border border-gray-300 px-4 py-8 text-center text-gray-500",children:"No admins found."})}):S.map(T=>{var j;const D=((j=T.company)==null?void 0:j.name)||T.companyName||"No Company",R=T.status==="active"||T.status===!0||T.status===1;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:T.userId}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:T.name}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:T.email}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:T.phone}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:D}),i.jsx("td",{className:"border border-gray-300 px-4 py-2",children:i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${R?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:R?"Active":"Inactive"})}),i.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"})})]},T.userId)})})]})}),i.jsx("div",{className:"space-y-4 md:hidden",children:S.length===0?i.jsx("p",{className:"text-gray-500 text-center",children:"No admins found."}):S.map(T=>{var j;const D=((j=T.company)==null?void 0:j.name)||T.companyName||"No Company",R=T.status==="active"||T.status===!0||T.status===1;return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"font-semibold text-lg text-gray-800",children:T.name}),i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"ID:"}),i.jsx("span",{className:"text-gray-700",children:T.userId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:T.email})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Company:"}),i.jsx("span",{className:"text-gray-700",children:D})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${R?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:R?"Active":"Inactive"})]})]})]},T.userId)})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block max-h-[500px] overflow-y-auto rounded-lg border border-gray-200 shadow-sm",children:i.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-sm text-gray-800 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Name"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Email"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Phone"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Role"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-left font-semibold",children:"Status"}),i.jsx("th",{className:"border-b border-gray-200 px-6 py-4 text-center font-semibold",children:"Actions"})]})}),i.jsx("tbody",{children:S.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"6",className:"text-center py-6 text-gray-500",children:"No admins found."})}):S.map(T=>i.jsx(X8,{admin:T,searchTerm:f,onUpdate:x,onActivate:y,onDeactivate:w,onViewAssignedUsers:g},T.userId))})]})}),i.jsx("div",{className:"space-y-4 md:hidden",children:S.length===0?i.jsx("p",{className:"text-gray-500 text-center",children:"No admins found."}):S.map(T=>{const D=T.status==="active"||T.status===!0||T.status===1;return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("button",{onClick:()=>g(T),className:"font-semibold text-lg text-blue-600 hover:text-blue-800 hover:underline cursor-pointer transition-colors",title:"Click to view assigned users",children:T.name}),i.jsx(Fa,{item:T,actions:[{label:"View Assigned Users",icon:i.jsx(ya,{size:14}),onClick:()=>g(T)},{label:"Update Admin",icon:i.jsx(Ya,{size:14}),onClick:()=>x(T)},D?{label:"Deactivate",icon:i.jsx(ts,{size:14}),onClick:()=>w(T.userId),danger:!0}:{label:"Activate",icon:i.jsx(Oa,{size:14}),onClick:()=>y(T.userId)}]})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:T.email})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Phone:"}),i.jsx("span",{className:"text-gray-700",children:T.phone})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Role:"}),i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:T.role})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-16",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${D?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:D?"Active":"Inactive"})]})]})]},T.userId)})})]})}),p&&a&&(a.toUpperCase()==="DIRECTOR"||a.toUpperCase()==="ADMIN"||a.toUpperCase()==="DEVELOPER")&&i.jsx(Dp,{user:p,onClose:N}),v&&a==="DIRECTOR"&&i.jsx(K8,{isOpen:!!v,admin:v,onClose:A})]})},Z8=({isOpen:e,onClose:t,company:a,onUpdate:r})=>{const[s,n]=E.useState({name:"",email:"",phone:"",maxUsers:"",maxAdmins:""}),[l,o]=E.useState(!1);E.useEffect(()=>{a&&n({name:a.name||"",email:a.email||"",phone:a.phone||"",maxUsers:a.maxUsers||"",maxAdmins:a.maxAdmins||""})},[a]);const c=d=>{n(h=>({...h,[d.target.name]:d.target.value}))},u=async d=>{d.preventDefault(),o(!0);try{const h={name:s.name,email:s.email,phone:s.phone,maxUsers:parseInt(s.maxUsers),maxAdmins:parseInt(s.maxAdmins)},f=await Dt.updateCompany(a.id,h);f.success?(oe("✅ Company updated successfully!"),r&&r(),t()):oe("❌ Failed to update company: "+f.error)}catch{oe("❌ Failed to update company")}finally{o(!1)}};return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center text-white",children:[i.jsx(Fn,{className:"mr-3",size:24}),i.jsx("h2",{className:"text-xl font-semibold",children:"Update Company"})]}),i.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 transition-colors",children:i.jsx(wa,{size:24})})]}),i.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Company Name"}),i.jsx("input",{type:"text",name:"name",required:!0,value:s.name,onChange:c,className:"w-full border border-gray-300 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter company name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email"}),i.jsx("input",{type:"email",name:"email",required:!0,value:s.email,onChange:c,className:"w-full border border-gray-300 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter email address"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Phone"}),i.jsx("input",{type:"text",name:"phone",required:!0,value:s.phone,onChange:c,className:"w-full border border-gray-300 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter phone number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Max Users"}),i.jsx("input",{type:"number",name:"maxUsers",required:!0,min:"1",value:s.maxUsers,onChange:c,className:"w-full border border-gray-300 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter maximum users"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Max Admins"}),i.jsx("input",{type:"number",name:"maxAdmins",required:!0,min:"1",value:s.maxAdmins,onChange:c,className:"w-full border border-gray-300 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter maximum admins"})]}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium",disabled:l,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:l,className:"flex items-center px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:l?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(CS,{className:"mr-2",size:16}),"Update Company"]})})]})]})]})}):null},Q8=({isOpen:e,onClose:t,company:a})=>!e||!a?null:i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},children:[i.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center text-white",children:[i.jsx(Fn,{className:"mr-3",size:24}),i.jsx("h2",{className:"text-xl font-semibold",children:"Company Details"})]}),i.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 transition-colors",children:i.jsx(wa,{size:24})})]}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:a.name}),i.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.status==="active"?"Active":"Inactive"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"Contact Information"}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(gs,{className:"text-gray-500",size:20}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),i.jsx("p",{className:"text-gray-800 font-medium",children:a.email||"N/A"})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Jr,{className:"text-gray-500",size:20}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),i.jsx("p",{className:"text-gray-800 font-medium",children:a.phone||"N/A"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"User Limits"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(ra,{className:"text-blue-500",size:20}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Max Users"}),i.jsx("p",{className:"text-gray-800 font-medium",children:a.maxUsers||"N/A"})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Oa,{className:"text-purple-500",size:20}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Max Admins"}),i.jsx("p",{className:"text-gray-800 font-medium",children:a.maxAdmins||"N/A"})]})]})]})]}),a.id&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"System Information"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Company ID"}),i.jsx("p",{className:"text-gray-800 font-medium",children:a.id})]})]}),i.jsx("div",{className:"flex justify-end pt-4",children:i.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg",children:"Close"})})]})]})}),J8=()=>{const{user:e}=Na(),{companies:t,loading:a,loadAllCompanies:r,revokeCompany:s,unrevokeCompany:n}=CF(),[l,o]=E.useState(""),[c,u]=E.useState(null),[d,h]=E.useState(!1),[f,m]=E.useState(!1);E.useEffect(()=>{(e==null?void 0:e.role)==="DEVELOPER"&&r()},[e==null?void 0:e.role,r]);const p=w=>o(w.target.value.toLowerCase()),x=t.filter(w=>[w.name,w.email,w.phone].some(A=>A==null?void 0:A.toString().toLowerCase().includes(l))),v=async(w,N)=>{try{N?await s(w):await n(w),await r()}catch(A){console.error("Error toggling company status:",A)}},g=w=>{u(w),m(!0)},b=w=>{u(w),h(!0)},y=()=>{h(!1),u(null),r()};return(e==null?void 0:e.role)!=="DEVELOPER"?i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center text-gray-500",children:[i.jsx(Fn,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"You don't have permission to view companies."})]})}):i.jsxs(i.Fragment,{children:[i.jsx(Z8,{isOpen:d,onClose:()=>{h(!1),u(null)},company:c,onUpdate:y}),i.jsx(Q8,{isOpen:f,onClose:()=>{m(!1),u(null)},company:c}),i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.6,type:"spring"},children:[i.jsxs("div",{className:"sticky top-0 z-10 bg-white p-6 border-b border-gray-100 shadow-sm",children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Fn,{className:"text-gray-500",size:32}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Companies Management",i.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",x.length," companies)"]})]})]})}),i.jsx("div",{className:"flex items-center gap-4",children:i.jsxs("div",{className:"relative flex-1 max-w-md",children:[i.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Search companies...",value:l,onChange:p,className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})]}),i.jsx("div",{className:"p-6",children:a?i.jsx("div",{className:"space-y-4",children:[...Array(5)].map((w,N)=>i.jsxs("div",{className:"animate-pulse bg-white p-4 rounded-xl shadow border border-gray-200 space-y-3",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"}),i.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]},N))}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block max-h-[350px] overflow-y-auto rounded-lg border border-gray-200 shadow-sm",children:i.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-sm text-gray-800 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Company Name"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Email"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Phone"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Max Users"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Max Admins"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Status"}),i.jsx("th",{className:"border-b px-6 py-4 text-center font-semibold",children:"Actions"})]})}),i.jsx("tbody",{children:x.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:"7",className:"text-center py-8 text-gray-500",children:[i.jsx(Fn,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"No companies found."})]})}):x.map(w=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"border-b px-6 py-4",children:i.jsx("div",{className:"font-medium text-gray-900",children:w.name})}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:w.email}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:w.phone}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:w.maxUsers||"N/A"}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:w.maxAdmins||"N/A"}),i.jsx("td",{className:"border-b px-6 py-4",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.status==="active"?"Active":"Inactive"})}),i.jsx("td",{className:"border-b px-2 py-2 text-center",children:i.jsx(Fa,{item:w,actions:[{label:"View Details",icon:i.jsx(ya,{size:14}),onClick:()=>g(w)},{label:"Edit Company",icon:i.jsx(Ya,{size:14}),onClick:()=>b(w)},w.status==="active"?{label:"Deactivate Company",icon:i.jsx(ts,{size:14}),onClick:()=>v(w.id,!0),danger:!0}:{label:"Activate Company",icon:i.jsx(Oa,{size:14}),onClick:()=>v(w.id,!1)}]})})]},w.id))})]})}),i.jsx("div",{className:"space-y-4 md:hidden",children:x.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(Fn,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"No companies found."})]}):x.map(w=>i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"font-semibold text-lg text-gray-800",children:w.name}),i.jsx(Fa,{item:w,actions:[{label:"View Details",icon:i.jsx(ya,{size:14}),onClick:()=>g(w)},{label:"Edit Company",icon:i.jsx(Ya,{size:14}),onClick:()=>b(w)},w.status==="active"?{label:"Deactivate Company",icon:i.jsx(ts,{size:14}),onClick:()=>v(w.id,!0),danger:!0}:{label:"Activate Company",icon:i.jsx(Oa,{size:14}),onClick:()=>v(w.id,!1)}]})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-24",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:w.email})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-24",children:"Phone:"}),i.jsx("span",{className:"text-gray-700",children:w.phone})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-24",children:"Max Users:"}),i.jsx("span",{className:"text-gray-700",children:w.maxUsers||"N/A"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-24",children:"Max Admins:"}),i.jsx("span",{className:"text-gray-700",children:w.maxAdmins||"N/A"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-24",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.status==="active"?"Active":"Inactive"})]})]})]},w.id))})]})})]})]})},Av=({director:e,searchTerm:t,onUpdate:a,onActivate:r,onDeactivate:s,isDeveloper:n=!1,isDirector:l=!1,mobileView:o=!1})=>{var d;const c=(h,f)=>{if(!f||!h)return h;const m=new RegExp(`(${f})`,"gi");return h.toString().split(m).map((x,v)=>m.test(x)?i.jsx("mark",{className:"bg-yellow-200 px-1 rounded",children:x},v):x)},u=e.status==="ACTIVE"||e.status===!0||e.status==="active";return o?n?null:i.jsx(Fa,{item:e,actions:[{label:"Update Director",icon:i.jsx(Ya,{size:14}),onClick:()=>a(e)},u?{label:"Deactivate",icon:i.jsx(ts,{size:14}),onClick:()=>s(e.userId),danger:!0}:{label:"Activate",icon:i.jsx(Oa,{size:14}),onClick:()=>r(e.userId)}]}):i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:e.userId}),i.jsx("td",{className:"border-b px-6 py-4",children:i.jsx("div",{className:"font-medium text-gray-900",children:c(e.name,t)})}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:c(e.email,t)}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:c(e.phone,t)}),i.jsx("td",{className:"border-b px-6 py-4 text-gray-600",children:((d=e.company)==null?void 0:d.name)||e.companyName||"N/A"}),i.jsx("td",{className:"border-b px-6 py-4",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${u?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:u?"Active":"Inactive"})}),i.jsx("td",{className:"border-b px-2 py-2 text-center",children:n?i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"}):l||!n?i.jsx(Fa,{item:e,actions:[{label:"Update Director",icon:i.jsx(Ya,{size:14}),onClick:()=>a(e)},u?{label:"Deactivate",icon:i.jsx(ts,{size:14}),onClick:()=>s(e.userId),danger:!0}:{label:"Activate",icon:i.jsx(Oa,{size:14}),onClick:()=>r(e.userId)}]}):i.jsx("span",{className:"text-gray-400 text-sm",children:"No Actions"})})]})},eL=()=>{const{user:e}=Na(),t=e==null?void 0:e.companyId,a=e==null?void 0:e.role,r=(e==null?void 0:e.userId)||(e==null?void 0:e.id),[s,n]=E.useState([]),[l,o]=E.useState(!1),[c,u]=E.useState(""),[d,h]=E.useState(null),f=async()=>{if(!(!a||!r)&&!(a==="DIRECTOR"&&!t)){o(!0);try{let g;a==="DEVELOPER"?g=await Re.getUsersByRole("DIRECTOR"):a==="DIRECTOR"&&(g=await Re.getUsersByRoleAndCompany(t,"DIRECTOR")),g!=null&&g.success?n(g.data||[]):(oe("❌ Failed to load directors"),n([]))}catch(g){console.error("Error loading directors:",g),oe("❌ Failed to load directors"),n([])}finally{o(!1)}}},m=async g=>{try{(await Re.unrevokeUser(g)).success?(oe("✅ Director activated successfully"),f()):oe("❌ Failed to activate director")}catch{oe("❌ Failed to activate director")}},p=async g=>{try{(await Re.revokeUser(g)).success?(oe("✅ Director deactivated successfully"),f()):oe("❌ Failed to deactivate director")}catch{oe("❌ Failed to deactivate director")}};E.useEffect(()=>{f()},[t,a,r]);const x=g=>u(g.target.value.toLowerCase()),v=s.filter(g=>{var y;return[g.name,g.email,g.phone,((y=g.company)==null?void 0:y.name)||g.companyName].some(w=>w==null?void 0:w.toString().toLowerCase().includes(c))});return a!=="DEVELOPER"&&a!=="DIRECTOR"?i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:i.jsxs("div",{className:"text-center text-gray-500",children:[i.jsx(to,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"You don't have permission to view directors."})]})}):i.jsxs(wt.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.6,type:"spring"},children:[d&&i.jsx(Dp,{user:d,onClose:()=>h(null),onUpdate:()=>{h(null),f()}}),i.jsxs("div",{className:"sticky top-0 z-10 bg-white p-6 border-b border-gray-100 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx(to,{className:"text-gray-500",size:32}),i.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["Director Management",i.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",v.length," directors)"]})]})]}),i.jsxs("div",{className:"relative max-w-md",children:[i.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),i.jsx("input",{type:"text",placeholder:"Search directors...",value:c,onChange:x,className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),i.jsx("div",{className:"p-6",children:l?i.jsx("div",{className:"space-y-4",children:[...Array(5)].map((g,b)=>i.jsxs("div",{className:"animate-pulse bg-white p-4 rounded-xl shadow border border-gray-200 space-y-3",children:[i.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/3"}),i.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),i.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]},b))}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"hidden md:block max-h-[350px] overflow-y-auto rounded-lg border border-gray-200 shadow-sm",children:i.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white",children:[i.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-sm text-gray-800 sticky top-0 z-10",children:i.jsxs("tr",{children:[i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"User ID"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Name"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Email"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Phone"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Company"}),i.jsx("th",{className:"border-b px-6 py-4 text-left font-semibold",children:"Status"}),i.jsx("th",{className:"border-b px-6 py-4 text-center font-semibold",children:"Actions"})]})}),i.jsx("tbody",{children:v.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:"7",className:"text-center py-8 text-gray-500",children:[i.jsx(to,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"No directors found."})]})}):v.map(g=>i.jsx(Av,{director:g,searchTerm:c,onUpdate:h,onActivate:m,onDeactivate:p,isDeveloper:a==="DEVELOPER",isDirector:a==="DIRECTOR"},g.userId))})]})}),i.jsx("div",{className:"space-y-4 md:hidden",children:v.length===0?i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(to,{size:48,className:"mx-auto mb-4 text-gray-300"}),i.jsx("p",{children:"No directors found."})]}):v.map(g=>{var w;const b=g.status==="ACTIVE"||g.status===!0||g.status==="active",y=((w=g.company)==null?void 0:w.name)||g.companyName||"N/A";return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"font-semibold text-lg text-gray-800",children:g.name}),a==="DEVELOPER"?i.jsx("span",{className:"text-gray-400 text-sm",children:"View Only"}):i.jsx(Av,{director:g,searchTerm:c,onUpdate:h,onActivate:m,onDeactivate:p,isDeveloper:a==="DEVELOPER",isDirector:a==="DIRECTOR",mobileView:!0})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"ID:"}),i.jsx("span",{className:"text-gray-700",children:g.userId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Email:"}),i.jsx("span",{className:"text-gray-700",children:g.email})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Phone:"}),i.jsx("span",{className:"text-gray-700",children:g.phone})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Company:"}),i.jsx("span",{className:"text-gray-700",children:y})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"font-medium text-gray-500 w-20",children:"Status:"}),i.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${b?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b?"Active":"Inactive"})]})]})]},g.userId)})})]})})]})},tL=({onSuccess:e,onCancel:t})=>{const[a,r]=E.useState({name:"",email:"",phone:"",maxUsers:"",maxAdmins:""}),s=l=>{r(o=>({...o,[l.target.name]:l.target.value}))},n=async l=>{l.preventDefault();const o={...a,maxUsers:parseInt(a.maxUsers),maxAdmins:parseInt(a.maxAdmins)};try{const c=await Dt.addCompany(o);c.success?(oe("✅ Company created successfully!"),r({name:"",email:"",phone:"",maxUsers:"",maxAdmins:""}),e&&e()):oe("❌ Error: "+c.error)}catch(c){oe("❌ Network error: "+c.message)}};return i.jsx(wt.div,{className:"max-w-2xl mx-auto",initial:{opacity:0,y:-40},animate:{opacity:1,y:0},transition:{duration:.6},children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-teal-600 px-6 py-4",children:i.jsxs("div",{className:"flex items-center text-white",children:[i.jsx(Fn,{className:"mr-3",size:24}),i.jsx("h2",{className:"text-xl font-semibold",children:"Add New Company"})]})}),i.jsxs("form",{onSubmit:n,className:"p-8 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Name"}),i.jsx("input",{type:"text",name:"name",required:!0,value:a.name,onChange:s,className:"w-full border px-4 py-2 rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Email"}),i.jsx("input",{type:"email",name:"email",required:!0,value:a.email,onChange:s,className:"w-full border px-4 py-2 rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Phone"}),i.jsx("input",{type:"text",name:"phone",required:!0,value:a.phone,onChange:s,className:"w-full border px-4 py-2 rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Max Users"}),i.jsx("input",{type:"number",name:"maxUsers",required:!0,min:"1",value:a.maxUsers,onChange:s,className:"w-full border px-4 py-2 rounded-lg"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Max Admins"}),i.jsx("input",{type:"number",name:"maxAdmins",required:!0,min:"1",value:a.maxAdmins,onChange:s,className:"w-full border px-4 py-2 rounded-lg"})]}),i.jsxs("div",{className:"flex justify-between items-center mt-6",children:[i.jsxs("button",{type:"button",onClick:t||(()=>e==null?void 0:e()),className:"flex items-center px-5 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg",children:[i.jsx(bp,{className:"mr-2",size:18}),"Cancel"]}),i.jsx("button",{type:"submit",className:"px-6 py-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg",children:"Create Company"})]})]})]})})},aL=({onSuccess:e,onCancel:t})=>{const[a,r]=E.useState({name:"",email:"",phone:"",source:"INSTAGRAM",referenceName:"",status:"",budget:"",location:"",propertyType:"",transactionType:[],additionalRequirements:""}),[s,n]=E.useState(!1),[l,o]=E.useState(!1),c=JSON.parse(localStorage.getItem("user")||"{}"),u=parseInt(localStorage.getItem("companyId"),10),d=c.userId||c.id,h=c.role,{createLead:f}=JS(u,d,h),m=g=>{const{name:b,value:y}=g.target;r(w=>({...w,[b]:y})),b==="source"&&o(y==="REFERENCE"),b==="propertyType"&&r(w=>({...w,transactionType:[]}))},p=g=>{r(b=>{const w=b.transactionType.includes(g)?b.transactionType.filter(N=>N!==g):[...b.transactionType,g];return{...b,transactionType:w}})},x=()=>{const g=[];return a.propertyType&&g.push(a.propertyType),a.transactionType.length>0&&g.push(...a.transactionType),a.additionalRequirements&&g.push(a.additionalRequirements),g.join(", ")},v=async g=>{g.preventDefault(),n(!0);try{const b={name:a.name.trim(),email:a.email.trim()||null,phone:a.phone.trim(),source:a.source,referenceName:a.source==="REFERENCE"?a.referenceName.trim():null,status:"NEW",budget:a.budget.trim()||null,location:a.location.trim()||null,requirement:x(),createdBy:{userId:d}};(await f(b)).success&&(r({name:"",email:"",phone:"",source:"INSTAGRAM",referenceName:"",budget:"",location:"",propertyType:"",transactionType:[],additionalRequirements:""}),e&&e())}catch(b){oe("❌ Error saving lead: "+b.message)}finally{n(!1)}};return i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-4",children:i.jsxs("div",{className:"flex items-center text-white",children:[i.jsx(es,{className:"mr-3",size:24}),i.jsx("h2",{className:"text-xl font-semibold",children:"Add New Lead"})]})}),i.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(yi,{name:"name",label:"Full Name *",value:a.name,onChange:m,required:!0}),i.jsx(yi,{name:"email",label:"Email",type:"email",value:a.email,onChange:m}),i.jsx(yi,{name:"phone",label:"Phone *",type:"tel",value:a.phone,onChange:m,required:!0,pattern:"^[+]?[0-9]{10,15}$"}),i.jsx(yi,{name:"budget",label:"Budget (₹)",value:a.budget,onChange:m}),i.jsx(yi,{name:"location",label:"Location",value:a.location,onChange:m}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lead Source *"}),i.jsxs("select",{name:"source",value:a.source,onChange:m,className:"w-full px-4 py-3 border rounded-lg",required:!0,children:[i.jsx("option",{value:"INSTAGRAM",children:"Instagram"}),i.jsx("option",{value:"FACEBOOK",children:"Facebook"}),i.jsx("option",{value:"YOUTUBE",children:"YouTube"}),i.jsx("option",{value:"REFERENCE",children:"Reference"}),i.jsx("option",{value:"NINETY_NINE_ACRES",children:"99acres"}),i.jsx("option",{value:"MAGIC_BRICKS",children:"MagicBricks"})]})]}),l&&i.jsx(yi,{name:"referenceName",label:"Reference Name *",value:a.referenceName,onChange:m,required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Type *"}),i.jsxs("div",{className:"flex gap-4",children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"radio",name:"propertyType",value:"Commercial",checked:a.propertyType==="Commercial",onChange:m,className:"accent-green-500",required:!0}),"Commercial"]}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"radio",name:"propertyType",value:"Residential",checked:a.propertyType==="Residential",onChange:m,className:"accent-green-500",required:!0}),"Residential"]})]})]}),a.propertyType&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type *"}),i.jsx("div",{className:"flex gap-4",children:a.propertyType==="Commercial"?i.jsxs(i.Fragment,{children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:a.transactionType.includes("Purchase"),onChange:()=>p("Purchase"),className:"accent-green-500"}),"Purchase"]}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:a.transactionType.includes("Lease"),onChange:()=>p("Lease"),className:"accent-green-500"}),"Lease"]}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:a.transactionType.includes("Plot"),onChange:()=>p("Plot"),className:"accent-green-500"}),"Plot"]})]}):a.propertyType==="Residential"?i.jsxs(i.Fragment,{children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:a.transactionType.includes("Rent"),onChange:()=>p("Rent"),className:"accent-green-500"}),"Rent"]}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:a.transactionType.includes("Purchase"),onChange:()=>p("Purchase"),className:"accent-green-500"}),"Purchase"]}),i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:a.transactionType.includes("Plot"),onChange:()=>p("Plot"),className:"accent-green-500"}),"Plot"]})]}):null})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Requirements"}),i.jsx("input",{type:"text",placeholder:"Type any additional requirements...",value:a.additionalRequirements||"",onChange:g=>r(b=>({...b,additionalRequirements:g.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[i.jsxs("button",{type:"button",onClick:t||(()=>e==null?void 0:e()),className:"flex items-center px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg",children:[i.jsx(bp,{className:"mr-2",size:18}),"Cancel"]}),i.jsxs("button",{type:"submit",disabled:s,className:"flex items-center px-6 py-3 bg-green-500 hover:bg-green-600 disabled:bg-green-300 text-white rounded-lg",children:[i.jsx(es,{className:"mr-2",size:18}),s?"Saving...":"Save Lead"]})]})]})]})})},yi=({name:e,label:t,value:a,onChange:r,type:s="text",required:n=!1,...l})=>i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t}),i.jsx("input",{type:s,name:e,value:a,onChange:r,required:n,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",...l})]}),rL=({onCancel:e})=>{const t=JSON.parse(localStorage.getItem("user")||"{}"),a=localStorage.getItem("companyId");let r=null;a?r=parseInt(a,10):t.companyId&&(r=parseInt(t.companyId,10));const s=t.id||t.userId,n=t.role||"USER",{createNote:l}=eT(r,s,n),o=async u=>{try{const d=await l(u);return!!(d&&d.success)}catch{return!1}},c=()=>{e?e():window.location.hash="#ViewNotes"};return i.jsx("div",{className:"max-w-4xl mx-auto",children:i.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:i.jsx(iT,{onSubmit:o,onCancel:c})})})},zf={propertyName:"",type:"Residential",bhk:"",unit:"",floor:"",sizeValue:"",sizeUnit:"sqft",status:"AVAILABLE_FOR_SALE",price:"",sector:"",location:"",source:"Social Media",referenceName:"",ownerName:"",ownerContact:""},sL=({onSuccess:e,onCancel:t})=>{const[a,r]=E.useState(zf),[s,n]=E.useState(!1),[l,o]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),f=JSON.parse(localStorage.getItem("user")||"{}"),m=parseInt(localStorage.getItem("companyId"),10),p=f.userId||f.id,x=f.role,{createProperty:v}=aT(m,p,x);E.useEffect(()=>{b(a.type),y(a.source)},[a.type,a.source]);const g=A=>{const{name:S,value:C}=A.target;r(T=>({...T,[S]:C}))},b=A=>{const S=["Office","Retail","Plot"].includes(A);u(S),S&&r(C=>({...C,bhk:""}))},y=A=>{n(A==="Reference"),o(A==="Broker")},w=async A=>{if(A.preventDefault(),a.source==="Reference"&&!a.referenceName.trim()){alert("Please enter the reference name");return}h(!0);const S={propertyName:a.propertyName,type:a.type,bhk:c?"":a.bhk,size:a.sizeValue?`${a.sizeValue} ${a.sizeUnit}`:"",unitDetails:a.unit||"",floor:a.floor||"",location:a.location||"",status:a.status,price:a.price?Number(a.price):null,sector:a.sector,source:a.source,referenceName:a.source==="Reference"&&a.referenceName||"",ownerName:a.ownerName,ownerContact:a.ownerContact,createdBy:{userId:p}};try{(await v(S)).success&&r(zf)}catch{}finally{h(!1)}},N=()=>["Office","Retail"].includes(a.type)?"Lease Amount":"Price";return i.jsxs(wt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-4xl mx-auto mt-4 md:mt-10 bg-white rounded-xl shadow-xl overflow-hidden",children:[i.jsxs("div",{className:"bg-green-600 text-white py-4 px-6 flex items-center gap-3",children:[i.jsx(es,{className:"w-5 h-5"}),i.jsx("h2",{className:"text-lg font-semibold",children:"Add New Property"})]}),i.jsxs("form",{onSubmit:w,className:"p-4 sm:p-6 grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 bg-white",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Property Name *"}),i.jsx("input",{name:"propertyName",value:a.propertyName,onChange:g,required:!0,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Type *"}),i.jsxs("select",{name:"type",value:a.type,onChange:g,className:"w-full p-2 border rounded",children:[i.jsx("option",{children:"Residential"}),i.jsx("option",{children:"Retail"}),i.jsx("option",{children:"Office"}),i.jsx("option",{children:"Plot"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"BHK"}),i.jsx("input",{name:"bhk",value:a.bhk,onChange:g,disabled:c,required:!c,placeholder:"e.g. 2BHK",className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Unit"}),i.jsx("input",{name:"unit",value:a.unit,onChange:g,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Floor"}),i.jsx("input",{name:"floor",value:a.floor,onChange:g,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Size"}),i.jsx("input",{type:"number",name:"sizeValue",value:a.sizeValue,onChange:g,required:!0,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{className:"w-full sm:w-32",children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Unit"}),i.jsxs("select",{name:"sizeUnit",value:a.sizeUnit,onChange:g,className:"w-full p-2 border rounded",children:[i.jsx("option",{value:"sqft",children:"sqft"}),i.jsx("option",{value:"sqyd",children:"sqyd"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Status *"}),i.jsxs("select",{name:"status",value:a.status,onChange:g,className:"w-full p-2 border rounded",children:[i.jsx("option",{value:"AVAILABLE_FOR_SALE",children:"Available for Sale"}),i.jsx("option",{value:"AVAILABLE_FOR_RENT",children:"Available for Rent"}),i.jsx("option",{value:"RENT_OUT",children:"Rented Out"}),i.jsx("option",{value:"SOLD_OUT",children:"Sold Out"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:N()}),i.jsx("input",{type:"number",name:"price",value:a.price,onChange:g,required:!0,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Sector *"}),i.jsx("input",{name:"sector",value:a.sector,onChange:g,required:!0,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Location"}),i.jsx("input",{name:"location",value:a.location,onChange:g,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Source *"}),i.jsxs("select",{name:"source",value:a.source,onChange:g,className:"w-full p-2 border rounded",children:[i.jsx("option",{children:"Social Media"}),i.jsx("option",{children:"Cold Call"}),i.jsx("option",{children:"Project Call"}),i.jsx("option",{children:"Reference"}),i.jsx("option",{children:"Broker"})]})]}),s&&i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:"Reference Name"}),i.jsx("input",{name:"referenceName",value:a.referenceName,onChange:g,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:l?"Broker Name":"Owner Name"}),i.jsx("input",{name:"ownerName",value:a.ownerName,onChange:g,required:!0,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block mb-1 font-medium",children:l?"Broker Contact":"Owner Contact"}),i.jsx("input",{name:"ownerContact",value:a.ownerContact,onChange:g,required:!0,className:"w-full p-2 border rounded"})]}),i.jsxs("div",{className:"md:col-span-2 flex flex-col-reverse sm:flex-row justify-end gap-3 mt-4",children:[i.jsx("button",{type:"button",onClick:t||(()=>r(zf)),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded w-full sm:w-auto",children:"Cancel"}),i.jsx(wt.button,{type:"submit",disabled:d,whileHover:d?{}:{scale:1.02},whileTap:d?{}:{scale:.98},className:"bg-green-600 hover:bg-green-700 disabled:hover:bg-green-600 text-white px-4 py-2 rounded w-full sm:w-auto flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed",children:d?i.jsxs(i.Fragment,{children:[i.jsx(mO,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Save Property"})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var lT=1252,nL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Op={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fp=function(e){nL.indexOf(e)!=-1&&(lT=Op[0]=e)};function iL(){Fp(1252)}var Or=function(e){Fp(e)};function oT(){Or(1200),iL()}function Cv(e){for(var t=[],a=0,r=e.length;a<r;++a)t[a]=e.charCodeAt(a);return t}function lL(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return t.join("")}function cT(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return t.join("")}var ao=function(e){var t=e.charCodeAt(0),a=e.charCodeAt(1);return t==255&&a==254?lL(e.slice(2)):t==254&&a==255?cT(e.slice(2)):t==65279?e.slice(1):e},yu=function(t){return String.fromCharCode(t)},kv=function(t){return String.fromCharCode(t)},$s,Qs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jv(e){for(var t="",a=0,r=0,s=0,n=0,l=0,o=0,c=0,u=0;u<e.length;)a=e.charCodeAt(u++),n=a>>2,r=e.charCodeAt(u++),l=(a&3)<<4|r>>4,s=e.charCodeAt(u++),o=(r&15)<<2|s>>6,c=s&63,isNaN(r)?o=c=64:isNaN(s)&&(c=64),t+=Qs.charAt(n)+Qs.charAt(l)+Qs.charAt(o)+Qs.charAt(c);return t}function lr(e){var t="",a=0,r=0,s=0,n=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)n=Qs.indexOf(e.charAt(u++)),l=Qs.indexOf(e.charAt(u++)),a=n<<2|l>>4,t+=String.fromCharCode(a),o=Qs.indexOf(e.charAt(u++)),r=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(r)),c=Qs.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ve=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ci=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,a){return a?new Buffer(t,a):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function gn(e){return Ve?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function _v(e){return Ve?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Rr=function(t){return Ve?ci(t,"binary"):t.split("").map(function(a){return a.charCodeAt(0)&255})};function ui(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function Lp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Lp(new Uint8Array(e));for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=e[a];return t}var Ys=Ve?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ci(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,a=0;for(t=0;t<e.length;++t)a+=e[t].length;var r=new Uint8Array(a),s=0;for(t=0,a=0;t<e.length;a+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],a);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),a)}return r}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function oL(e){for(var t=[],a=0,r=e.length+250,s=gn(e.length+255),n=0;n<e.length;++n){var l=e.charCodeAt(n);if(l<128)s[a++]=l;else if(l<2048)s[a++]=192|l>>6&31,s[a++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++n)&1023;s[a++]=240|l>>8&7,s[a++]=128|l>>2&63,s[a++]=128|o>>6&15|(l&3)<<4,s[a++]=128|o&63}else s[a++]=224|l>>12&15,s[a++]=128|l>>6&63,s[a++]=128|l&63;a>r&&(t.push(s.slice(0,a)),a=0,s=gn(65535),r=65530)}return t.push(s.slice(0,a)),Ys(t)}var Da=/\u0000/g,ro=/[\u0001-\u0006]/g;function Qi(e){for(var t="",a=e.length-1;a>=0;)t+=e.charAt(a--);return t}function Fr(e,t){var a=""+e;return a.length>=t?a:vt("0",t-a.length)+a}function Mp(e,t){var a=""+e;return a.length>=t?a:vt(" ",t-a.length)+a}function P0(e,t){var a=""+e;return a.length>=t?a:a+vt(" ",t-a.length)}function cL(e,t){var a=""+Math.round(e);return a.length>=t?a:vt("0",t-a.length)+a}function uL(e,t){var a=""+e;return a.length>=t?a:vt("0",t-a.length)+a}var Rv=Math.pow(2,32);function vi(e,t){if(e>Rv||e<-Rv)return cL(e,t);var a=Math.round(e);return uL(a,t)}function V0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Dv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Hf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dL(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ov={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function z0(e,t,a){for(var r=e<0?-1:1,s=e*r,n=0,l=1,o=0,c=1,u=0,d=0,h=Math.floor(s);u<t&&(h=Math.floor(s),o=h*l+n,d=h*u+c,!(s-h<5e-8));)s=1/(s-h),n=l,l=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=n):(d=u,o=l)),!a)return[0,r*o,d];var f=Math.floor(r*o/d);return[f,r*o-f*d,d]}function Mn(e,t,a){if(e>2958465||e<0)return null;var r=e|0,s=Math.floor(86400*(e-r)),n=0,l=[],o={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++r,++o.D)),r===60)l=a?[1317,10,29]:[1900,2,29],n=3;else if(r===0)l=a?[1317,8,29]:[1900,1,0],n=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],n=c.getDay(),r<60&&(n=(n+6)%7),a&&(n=yL(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=n,o}var uT=new Date(1899,11,31,0,0,0),hL=uT.getTime(),mL=new Date(1900,2,1,0,0,0);function dT(e,t){var a=e.getTime();return t?a-=1461*24*60*60*1e3:e>=mL&&(a+=24*60*60*1e3),(a-(hL+(e.getTimezoneOffset()-uT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Up(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xL(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pL(e){var t=e<0?12:11,a=Up(e.toFixed(12));return a.length<=t||(a=e.toPrecision(10),a.length<=t)?a:e.toExponential(5)}function gL(e){var t=Up(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ic(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return t>=-4&&t<=-1?a=e.toPrecision(10+t):Math.abs(t)<=9?a=pL(e):t===10?a=e.toFixed(10).substr(0,12):a=gL(e),Up(xL(a.toUpperCase()))}function ti(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ic(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Sr(14,dT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yL(e,t){t[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function vL(e,t,a,r){var s="",n=0,l=0,o=a.y,c,u=0;switch(e){case 98:o=a.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=a.m,u=t.length;break;case 3:return Hf[a.m-1][1];case 5:return Hf[a.m-1][0];default:return Hf[a.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=a.d,u=t.length;break;case 3:return Dv[a.q][0];default:return Dv[a.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(a.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=a.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=a.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return a.u===0&&(t=="s"||t=="ss")?Fr(a.S,t.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,n=Math.round(l*(a.S+a.u)),n>=60*l&&(n=0),t==="s"?n===0?"0":""+n/l:(s=Fr(n,2+r),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=a.D*24+a.H;break;case"[m]":case"[mm]":c=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":c=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Fr(c,u):"";return d}function Js(e){var t=3;if(e.length<=t)return e;for(var a=e.length%t,r=e.substr(0,a);a!=e.length;a+=t)r+=(r.length>0?",":"")+e.substr(a,t);return r}var fT=/%/g;function bL(e,t,a){var r=t.replace(fT,""),s=t.length-r.length;return ws(e,r,a*Math.pow(10,2*s))+vt("%",s)}function wL(e,t,a){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return ws(e,t.substr(0,r),a/Math.pow(10,3*(t.length-r)))}function hT(e,t){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),a=(t/Math.pow(10,n)).toPrecision(r+1+(s+n)%s),a.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(l-a.length+n):a+="E+"+(l-n);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+n)%s)+"."+d.substr(n)+"E"})}else a=t.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var mT=/# (\?+)( ?)\/( ?)(\d+)/;function EL(e,t,a){var r=parseInt(e[4],10),s=Math.round(t*r),n=Math.floor(s/r),l=s-n*r,o=r;return a+(n===0?"":""+n)+" "+(l===0?vt(" ",e[1].length+1+e[4].length):Mp(l,e[1].length)+e[2]+"/"+e[3]+Fr(o,e[4].length))}function NL(e,t,a){return a+(t===0?"":""+t)+vt(" ",e[1].length+2+e[4].length)}var xT=/^#*0*\.([0#]+)/,pT=/\).*[0#]/,gT=/\(###\) ###\\?-####/;function Aa(e){for(var t="",a,r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(a)}return t}function Fv(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a}function Lv(e,t){var a=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(a*r)).length?0:Math.round(a*r)}function SL(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function TL(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ur(e,t,a){if(e.charCodeAt(0)===40&&!t.match(pT)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?ur("n",r,a):"("+ur("n",r,-a)+")"}if(t.charCodeAt(t.length-1)===44)return wL(e,t,a);if(t.indexOf("%")!==-1)return bL(e,t,a);if(t.indexOf("E")!==-1)return hT(t,a);if(t.charCodeAt(0)===36)return"$"+ur(e,t.substr(t.charAt(1)==" "?2:1),a);var s,n,l,o,c=Math.abs(a),u=a<0?"-":"";if(t.match(/^00+$/))return u+vi(c,t.length);if(t.match(/^[#?]+$/))return s=vi(a,0),s==="0"&&(s=""),s.length>t.length?s:Aa(t.substr(0,t.length-s.length))+s;if(n=t.match(mT))return EL(n,c,u);if(t.match(/^#+0+$/))return u+vi(c,t.length-t.indexOf("0"));if(n=t.match(xT))return s=Fv(a,n[1].length).replace(/^([^\.]+)$/,"$1."+Aa(n[1])).replace(/\.$/,"."+Aa(n[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+vt("0",Aa(n[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return u+Fv(c,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return u+Js(vi(c,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+ur(e,t,-a):Js(""+(Math.floor(a)+SL(a,n[1].length)))+"."+Fr(Lv(a,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return ur(e,t.replace(/^#,#*,/,""),a);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qi(ur(e,t.replace(/[\\-]/g,""),a)),l=0,Qi(Qi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(gT))return s=ur(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(n[4].length,7),o=z0(c,Math.pow(10,l)-1,!1),s=""+u,d=ws("n",n[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],d=P0(o[2],l),d.length<n[4].length&&(d=Aa(n[4].substr(n[4].length-d.length))+d),s+=d,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(n[1].length,n[4].length),7),o=z0(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Mp(o[1],l)+n[2]+"/"+n[3]+P0(o[2],l):vt(" ",2*l+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=vi(a,0),t.length<=s.length?s:Aa(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var h=t.indexOf(".")-l,f=t.length-s.length-h;return Aa(t.substr(0,h)+s+t.substr(t.length-f))}if(n=t.match(/^00,000\.([#0]*0)$/))return l=Lv(a,n[1].length),a<0?"-"+ur(e,t,-a):Js(TL(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Fr(0,3-p.length):"")+p})+"."+Fr(l,n[1].length);switch(t){case"###,##0.00":return ur(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var m=Js(vi(c,0));return m!=="0"?u+m:"";case"###,###.00":return ur(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return ur(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function AL(e,t,a){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return ws(e,t.substr(0,r),a/Math.pow(10,3*(t.length-r)))}function CL(e,t,a){var r=t.replace(fT,""),s=t.length-r.length;return ws(e,r,a*Math.pow(10,2*s))+vt("%",s)}function yT(e,t){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+yT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),a=(t/Math.pow(10,n)).toPrecision(r+1+(s+n)%s),!a.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(l-a.length+n):a+="E+"+(l-n),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+n)%s)+"."+d.substr(n)+"E"})}else a=t.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Gr(e,t,a){if(e.charCodeAt(0)===40&&!t.match(pT)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Gr("n",r,a):"("+Gr("n",r,-a)+")"}if(t.charCodeAt(t.length-1)===44)return AL(e,t,a);if(t.indexOf("%")!==-1)return CL(e,t,a);if(t.indexOf("E")!==-1)return yT(t,a);if(t.charCodeAt(0)===36)return"$"+Gr(e,t.substr(t.charAt(1)==" "?2:1),a);var s,n,l,o,c=Math.abs(a),u=a<0?"-":"";if(t.match(/^00+$/))return u+Fr(c,t.length);if(t.match(/^[#?]+$/))return s=""+a,a===0&&(s=""),s.length>t.length?s:Aa(t.substr(0,t.length-s.length))+s;if(n=t.match(mT))return NL(n,c,u);if(t.match(/^#+0+$/))return u+Fr(c,t.length-t.indexOf("0"));if(n=t.match(xT))return s=(""+a).replace(/^([^\.]+)$/,"$1."+Aa(n[1])).replace(/\.$/,"."+Aa(n[1])),s=s.replace(/\.(\d*)$/,function(p,x){return"."+x+vt("0",Aa(n[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return u+Js(""+c);if(n=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Gr(e,t,-a):Js(""+a)+"."+vt("0",n[1].length);if(n=t.match(/^#,#*,#0/))return Gr(e,t.replace(/^#,#*,/,""),a);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qi(Gr(e,t.replace(/[\\-]/g,""),a)),l=0,Qi(Qi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(gT))return s=Gr(e,"##########",a),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(n[4].length,7),o=z0(c,Math.pow(10,l)-1,!1),s=""+u,d=ws("n",n[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],d=P0(o[2],l),d.length<n[4].length&&(d=Aa(n[4].substr(n[4].length-d.length))+d),s+=d,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(n[1].length,n[4].length),7),o=z0(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Mp(o[1],l)+n[2]+"/"+n[3]+P0(o[2],l):vt(" ",2*l+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+a,t.length<=s.length?s:Aa(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+a.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var h=t.indexOf(".")-l,f=t.length-s.length-h;return Aa(t.substr(0,h)+s+t.substr(t.length-f))}if(n=t.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Gr(e,t,-a):Js(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Fr(0,3-p.length):"")+p})+"."+Fr(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Js(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Gr(e,t.slice(0,t.lastIndexOf(".")),a)+Aa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ws(e,t,a){return(a|0)===a?Gr(e,t,a):ur(e,t,a)}function kL(e){for(var t=[],a=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(s,r-s),s=r+1}if(t[t.length]=e.substr(s),a===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var vT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Rl(e){for(var t=0,a="",r="";t<e.length;)switch(a=e.charAt(t)){case"G":V0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(r=a;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(vT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++t))>-1||a=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===a;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function jL(e,t,a,r){for(var s=[],n="",l=0,o="",c="t",u,d,h,f="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!V0(e,l))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(n="";(h=e.charCodeAt(++l))!==34&&l<e.length;)n+=String.fromCharCode(h);s[s.length]={t:"t",v:n},++l;break;case"\\":var m=e.charAt(++l),p=m==="("||m===")"?m:"t";s[s.length]={t:p,v:m},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=Mn(t,a,e.charAt(l+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Mn(t,a),u==null))return"";for(n=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)n+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),s[s.length]={t:o,v:n},c=o;break;case"A":case"a":case"上":var x={t:o,v:o};if(u==null&&(u=Mn(t,a)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",f="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",l+=5,f="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(u!=null&&(x.v=u.H>=12?"下午":"上午"),x.t="T",l+=5,f="h"):(x.t="t",++l),u==null&&x.t==="T")return"";s[s.length]=x,c=o;break;case"[":for(n=o;e.charAt(l++)!=="]"&&l<e.length;)n+=e.charAt(l);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(vT)){if(u==null&&(u=Mn(t,a),u==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},c=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",Rl(e)||(s[s.length]={t:"t",v:n}));break;case".":if(u!=null){for(n=o;++l<e.length&&(o=e.charAt(l))==="0";)n+=o;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)n+=o;s[s.length]={t:"n",v:n};break;case"?":for(n=o;e.charAt(++l)===o;)n+=o;s[s.length]={t:o,v:n},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:r===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)n+=e.charAt(l);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:o,v:o},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++l;break}var v=0,g=0,b;for(l=s.length-1,c="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=f,c="h",v<1&&(v=1);break;case"s":(b=s[l].v.match(/\.0+$/))&&(g=Math.max(g,b[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[l].t;break;case"m":c==="s"&&(s[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[l].v.match(/[Hh]/)&&(v=1),v<2&&s[l].v.match(/[Mm]/)&&(v=2),v<3&&s[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",w;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=vL(s[l].t.charCodeAt(0),s[l].v,u,g),s[l].t="t";break;case"n":case"?":for(w=l+1;s[w]!=null&&((o=s[w].t)==="?"||o==="D"||(o===" "||o==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[l].v+=s[w].v,s[w]={v:"",t:";"},++w;y+=s[l].v,l=w-1;break;case"G":s[l].t="t",s[l].v=ti(t,a);break}var N="",A,S;if(y.length>0){y.charCodeAt(0)==40?(A=t<0&&y.charCodeAt(0)===45?-t:t,S=ws("n",y,A)):(A=t<0&&r>1?-t:t,S=ws("n",y,A),A<0&&s[0]&&s[0].t=="t"&&(S=S.substr(1),s[0].v="-"+s[0].v)),w=S.length-1;var C=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){C=l;break}var T=s.length;if(C===s.length&&S.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(w>=s[l].v.length-1?(w-=s[l].v.length,s[l].v=S.substr(w+1,s[l].v.length)):w<0?s[l].v="":(s[l].v=S.substr(0,w+1),w=-1),s[l].t="t",T=l);w>=0&&T<s.length&&(s[T].v=S.substr(0,w+1)+s[T].v)}else if(C!==s.length&&S.indexOf("E")===-1){for(w=S.indexOf(".")-1,l=C;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(d=s[l].v.indexOf(".")>-1&&l===C?s[l].v.indexOf(".")-1:s[l].v.length-1,N=s[l].v.substr(d+1);d>=0;--d)w>=0&&(s[l].v.charAt(d)==="0"||s[l].v.charAt(d)==="#")&&(N=S.charAt(w--)+N);s[l].v=N,s[l].t="t",T=l}for(w>=0&&T<s.length&&(s[T].v=S.substr(0,w+1)+s[T].v),w=S.indexOf(".")+1,l=C;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==C)){for(d=s[l].v.indexOf(".")>-1&&l===C?s[l].v.indexOf(".")+1:0,N=s[l].v.substr(0,d);d<s[l].v.length;++d)w<S.length&&(N+=S.charAt(w++));s[l].v=N,s[l].t="t",T=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(A=r>1&&t<0&&l>0&&s[l-1].v==="-"?-t:t,s[l].v=ws(s[l].t,s[l].v,A),s[l].t="t");var D="";for(l=0;l!==s.length;++l)s[l]!=null&&(D+=s[l].v);return D}var Mv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Uv(e,t){if(t==null)return!1;var a=parseFloat(t[2]);switch(t[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function _L(e,t){var a=kL(e),r=a.length,s=a[r-1].indexOf("@");if(r<4&&s>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof t!="number")return[4,a.length===4||s>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=s>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=s>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=s>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var n=t>0?a[0]:t<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[r,n];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var l=a[0].match(Mv),o=a[1].match(Mv);return Uv(t,l)?[r,a[0]]:Uv(t,o)?[r,a[1]]:[r,a[l!=null&&o!=null?2:1]]}return[r,n]}function Sr(e,t,a){a==null&&(a={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?r=a.dateNF:r=e;break;case"number":e==14&&a.dateNF?r=a.dateNF:r=(a.table!=null?a.table:De)[e],r==null&&(r=a.table&&a.table[Ov[e]]||De[Ov[e]]),r==null&&(r=fL[e]||"General");break}if(V0(r,0))return ti(t,a);t instanceof Date&&(t=dT(t,a.date1904));var s=_L(r,t);if(V0(s[1]))return ti(t,a);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return jL(s[1],t,a,s[0])}function qn(e,t){if(typeof t!="number"){t=+t||-1;for(var a=0;a<392;++a){if(De[a]==null){t<0&&(t=a);continue}if(De[a]==e){t=a;break}}t<0&&(t=391)}return De[t]=e,t}function bT(){De=dL()}var RL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},wT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function DL(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(wT,"(\\d+)"),new RegExp("^"+t+"$")}function OL(e,t,a){var r=-1,s=-1,n=-1,l=-1,o=-1,c=-1;(t.match(wT)||[]).forEach(function(h,f){var m=parseInt(a[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=m;break;case"d":n=m;break;case"h":l=m;break;case"s":c=m;break;case"m":l>=0?o=m:s=m;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:r==-1&&s==-1&&n==-1?d:u+"T"+d}var FL=function(){var e={};e.version="1.2.0";function t(){for(var S=0,C=new Array(256),T=0;T!=256;++T)S=T,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,C[T]=S;return typeof Int32Array<"u"?new Int32Array(C):C}var a=t();function r(S){var C=0,T=0,D=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)R[D]=S[D];for(D=0;D!=256;++D)for(T=S[D],C=256+D;C<4096;C+=256)T=R[C]=T>>>8^S[T&255];var j=[];for(D=1;D!=16;++D)j[D-1]=typeof Int32Array<"u"?R.subarray(D*256,D*256+256):R.slice(D*256,D*256+256);return j}var s=r(a),n=s[0],l=s[1],o=s[2],c=s[3],u=s[4],d=s[5],h=s[6],f=s[7],m=s[8],p=s[9],x=s[10],v=s[11],g=s[12],b=s[13],y=s[14];function w(S,C){for(var T=C^-1,D=0,R=S.length;D<R;)T=T>>>8^a[(T^S.charCodeAt(D++))&255];return~T}function N(S,C){for(var T=C^-1,D=S.length-15,R=0;R<D;)T=y[S[R++]^T&255]^b[S[R++]^T>>8&255]^g[S[R++]^T>>16&255]^v[S[R++]^T>>>24]^x[S[R++]]^p[S[R++]]^m[S[R++]]^f[S[R++]]^h[S[R++]]^d[S[R++]]^u[S[R++]]^c[S[R++]]^o[S[R++]]^l[S[R++]]^n[S[R++]]^a[S[R++]];for(D+=15;R<D;)T=T>>>8^a[(T^S[R++])&255];return~T}function A(S,C){for(var T=C^-1,D=0,R=S.length,j=0,B=0;D<R;)j=S.charCodeAt(D++),j<128?T=T>>>8^a[(T^j)&255]:j<2048?(T=T>>>8^a[(T^(192|j>>6&31))&255],T=T>>>8^a[(T^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,B=S.charCodeAt(D++)&1023,T=T>>>8^a[(T^(240|j>>8&7))&255],T=T>>>8^a[(T^(128|j>>2&63))&255],T=T>>>8^a[(T^(128|B>>6&15|(j&3)<<4))&255],T=T>>>8^a[(T^(128|B&63))&255]):(T=T>>>8^a[(T^(224|j>>12&15))&255],T=T>>>8^a[(T^(128|j>>6&63))&255],T=T>>>8^a[(T^(128|j&63))&255]);return~T}return e.table=a,e.bstr=w,e.buf=N,e.str=A,e}(),ze=function(){var t={};t.version="1.2.1";function a(k,M){for(var O=k.split("/"),L=M.split("/"),U=0,I=0,Q=Math.min(O.length,L.length);U<Q;++U){if(I=O[U].length-L[U].length)return I;if(O[U]!=L[U])return O[U]<L[U]?-1:1}return O.length-L.length}function r(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:r(k.slice(0,-1));var M=k.lastIndexOf("/");return M===-1?k:k.slice(0,M+1)}function s(k){if(k.charAt(k.length-1)=="/")return s(k.slice(0,-1));var M=k.lastIndexOf("/");return M===-1?k:k.slice(M+1)}function n(k,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,k.write_shift(2,O);var L=M.getFullYear()-1980;L=L<<4|M.getMonth()+1,L=L<<5|M.getDate(),k.write_shift(2,L)}function l(k){var M=k.read_shift(2)&65535,O=k.read_shift(2)&65535,L=new Date,U=O&31;O>>>=5;var I=O&15;O>>>=4,L.setMilliseconds(0),L.setFullYear(O+1980),L.setMonth(I-1),L.setDate(U);var Q=M&31;M>>>=5;var se=M&63;return M>>>=6,L.setHours(M),L.setMinutes(se),L.setSeconds(Q<<1),L}function o(k){aa(k,0);for(var M={},O=0;k.l<=k.length-4;){var L=k.read_shift(2),U=k.read_shift(2),I=k.l+U,Q={};switch(L){case 21589:O=k.read_shift(1),O&1&&(Q.mtime=k.read_shift(4)),U>5&&(O&2&&(Q.atime=k.read_shift(4)),O&4&&(Q.ctime=k.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}k.l=I,M[L]=Q}return M}var c;function u(){return c||(c={})}function d(k,M){if(k[0]==80&&k[1]==75)return og(k,M);if((k[0]|32)==109&&(k[1]|32)==105)return KA(k,M);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var O=3,L=512,U=0,I=0,Q=0,se=0,Z=0,ee=[],ae=k.slice(0,512);aa(ae,0);var me=h(ae);switch(O=me[0],O){case 3:L=512;break;case 4:L=4096;break;case 0:if(me[1]==0)return og(k,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}L!==512&&(ae=k.slice(0,L),aa(ae,28));var ve=k.slice(0,L);f(ae,O);var Ee=ae.read_shift(4,"i");if(O===3&&Ee!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ee);ae.l+=4,Q=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),se=ae.read_shift(4,"i"),U=ae.read_shift(4,"i"),Z=ae.read_shift(4,"i"),I=ae.read_shift(4,"i");for(var pe=-1,we=0;we<109&&(pe=ae.read_shift(4,"i"),!(pe<0));++we)ee[we]=pe;var _e=m(k,L);v(Z,I,_e,L,ee);var ht=b(_e,Q,ee,L);ht[Q].name="!Directory",U>0&&se!==B&&(ht[se].name="!MiniFAT"),ht[ee[0]].name="!FAT",ht.fat_addrs=ee,ht.ssz=L;var mt={},ca=[],Fl=[],Ll=[];y(Q,ht,_e,ca,U,mt,Fl,se),p(Fl,Ll,ca),ca.shift();var Ml={FileIndex:Fl,FullPaths:Ll};return M&&M.raw&&(Ml.raw={header:ve,sectors:_e}),Ml}function h(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(X,"Header Signature: "),k.l+=16;var M=k.read_shift(2,"u");return[k.read_shift(2,"u"),M]}function f(k,M){var O=9;switch(k.l+=2,O=k.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function m(k,M){for(var O=Math.ceil(k.length/M)-1,L=[],U=1;U<O;++U)L[U-1]=k.slice(U*M,(U+1)*M);return L[O-1]=k.slice(O*M),L}function p(k,M,O){for(var L=0,U=0,I=0,Q=0,se=0,Z=O.length,ee=[],ae=[];L<Z;++L)ee[L]=ae[L]=L,M[L]=O[L];for(;se<ae.length;++se)L=ae[se],U=k[L].L,I=k[L].R,Q=k[L].C,ee[L]===L&&(U!==-1&&ee[U]!==U&&(ee[L]=ee[U]),I!==-1&&ee[I]!==I&&(ee[L]=ee[I])),Q!==-1&&(ee[Q]=L),U!==-1&&L!=ee[L]&&(ee[U]=ee[L],ae.lastIndexOf(U)<se&&ae.push(U)),I!==-1&&L!=ee[L]&&(ee[I]=ee[L],ae.lastIndexOf(I)<se&&ae.push(I));for(L=1;L<Z;++L)ee[L]===L&&(I!==-1&&ee[I]!==I?ee[L]=ee[I]:U!==-1&&ee[U]!==U&&(ee[L]=ee[U]));for(L=1;L<Z;++L)if(k[L].type!==0){if(se=L,se!=ee[se])do se=ee[se],M[L]=M[se]+"/"+M[L];while(se!==0&&ee[se]!==-1&&se!=ee[se]);ee[L]=-1}for(M[0]+="/",L=1;L<Z;++L)k[L].type!==2&&(M[L]+="/")}function x(k,M,O){for(var L=k.start,U=k.size,I=[],Q=L;O&&U>0&&Q>=0;)I.push(M.slice(Q*j,Q*j+j)),U-=j,Q=Rn(O,Q*4);return I.length===0?Bt(0):Ys(I).slice(0,k.size)}function v(k,M,O,L,U){var I=B;if(k===B){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var Q=O[k],se=(L>>>2)-1;if(!Q)return;for(var Z=0;Z<se&&(I=Rn(Q,Z*4))!==B;++Z)U.push(I);v(Rn(Q,L-4),M-1,O,L,U)}}function g(k,M,O,L,U){var I=[],Q=[];U||(U=[]);var se=L-1,Z=0,ee=0;for(Z=M;Z>=0;){U[Z]=!0,I[I.length]=Z,Q.push(k[Z]);var ae=O[Math.floor(Z*4/L)];if(ee=Z*4&se,L<4+ee)throw new Error("FAT boundary crossed: "+Z+" 4 "+L);if(!k[ae])break;Z=Rn(k[ae],ee)}return{nodes:I,data:qv([Q])}}function b(k,M,O,L){var U=k.length,I=[],Q=[],se=[],Z=[],ee=L-1,ae=0,me=0,ve=0,Ee=0;for(ae=0;ae<U;++ae)if(se=[],ve=ae+M,ve>=U&&(ve-=U),!Q[ve]){Z=[];var pe=[];for(me=ve;me>=0;){pe[me]=!0,Q[me]=!0,se[se.length]=me,Z.push(k[me]);var we=O[Math.floor(me*4/L)];if(Ee=me*4&ee,L<4+Ee)throw new Error("FAT boundary crossed: "+me+" 4 "+L);if(!k[we]||(me=Rn(k[we],Ee),pe[me]))break}I[ve]={nodes:se,data:qv([Z])}}return I}function y(k,M,O,L,U,I,Q,se){for(var Z=0,ee=L.length?2:0,ae=M[k].data,me=0,ve=0,Ee;me<ae.length;me+=128){var pe=ae.slice(me,me+128);aa(pe,64),ve=pe.read_shift(2),Ee=zp(pe,0,ve-ee),L.push(Ee);var we={name:Ee,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},_e=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);_e!==0&&(we.ct=w(pe,pe.l-8));var ht=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);ht!==0&&(we.mt=w(pe,pe.l-8)),we.start=pe.read_shift(4,"i"),we.size=pe.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=B,we.name=""),we.type===5?(Z=we.start,U>0&&Z!==B&&(M[Z].name="!StreamData")):we.size>=4096?(we.storage="fat",M[we.start]===void 0&&(M[we.start]=g(O,we.start,M.fat_addrs,M.ssz)),M[we.start].name=we.name,we.content=M[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:Z!==B&&we.start!==B&&M[Z]&&(we.content=x(we,M[Z].data,(M[se]||{}).data))),we.content&&aa(we.content,0),I[Ee]=we,Q.push(we)}}function w(k,M){return new Date((Ja(k,M+4)/1e7*Math.pow(2,32)+Ja(k,M)/1e7-11644473600)*1e3)}function N(k,M){return u(),d(c.readFileSync(k),M)}function A(k,M){var O=M&&M.type;switch(O||Ve&&Buffer.isBuffer(k)&&(O="buffer"),O||"base64"){case"file":return N(k,M);case"base64":return d(Rr(lr(k)),M);case"binary":return d(Rr(k),M)}return d(k,M)}function S(k,M){var O=M||{},L=O.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=L+"/",k.FileIndex[0]={name:L,type:5}),O.CLSID&&(k.FileIndex[0].clsid=O.CLSID),C(k)}function C(k){var M="Sh33tJ5";if(!ze.find(k,"/"+M)){var O=Bt(4);O[0]=55,O[1]=O[3]=50,O[2]=54,k.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+M),T(k)}}function T(k,M){S(k);for(var O=!1,L=!1,U=k.FullPaths.length-1;U>=0;--U){var I=k.FileIndex[U];switch(I.type){case 0:L?O=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(I.R*I.L*I.C)&&(O=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var Q=new Date(1987,1,19),se=0,Z=Object.create?Object.create(null):{},ee=[];for(U=0;U<k.FullPaths.length;++U)Z[k.FullPaths[U]]=!0,k.FileIndex[U].type!==0&&ee.push([k.FullPaths[U],k.FileIndex[U]]);for(U=0;U<ee.length;++U){var ae=r(ee[U][0]);L=Z[ae],L||(ee.push([ae,{name:s(ae).replace("/",""),type:1,clsid:F,ct:Q,mt:Q,content:null}]),Z[ae]=!0)}for(ee.sort(function(Ee,pe){return a(Ee[0],pe[0])}),k.FullPaths=[],k.FileIndex=[],U=0;U<ee.length;++U)k.FullPaths[U]=ee[U][0],k.FileIndex[U]=ee[U][1];for(U=0;U<ee.length;++U){var me=k.FileIndex[U],ve=k.FullPaths[U];if(me.name=s(ve).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||F,U===0)me.C=ee.length>1?1:-1,me.size=0,me.type=5;else if(ve.slice(-1)=="/"){for(se=U+1;se<ee.length&&r(k.FullPaths[se])!=ve;++se);for(me.C=se>=ee.length?-1:se,se=U+1;se<ee.length&&r(k.FullPaths[se])!=r(ve);++se);me.R=se>=ee.length?-1:se,me.type=1}else r(k.FullPaths[U+1]||"")==r(ve)&&(me.R=U+1),me.type=2}}}function D(k,M){var O=M||{};if(O.fileType=="mad")return WA(k,O);switch(T(k),O.fileType){case"zip":return HA(k,O)}var L=function(Ee){for(var pe=0,we=0,_e=0;_e<Ee.FileIndex.length;++_e){var ht=Ee.FileIndex[_e];if(ht.content){var mt=ht.content.length;mt>0&&(mt<4096?pe+=mt+63>>6:we+=mt+511>>9)}}for(var ca=Ee.FullPaths.length+3>>2,Fl=pe+7>>3,Ll=pe+127>>7,Ml=Fl+we+ca+Ll,Nn=Ml+127>>7,Bd=Nn<=109?0:Math.ceil((Nn-109)/127);Ml+Nn+Bd+127>>7>Nn;)Bd=++Nn<=109?0:Math.ceil((Nn-109)/127);var ls=[1,Bd,Nn,Ll,ca,we,pe,0];return Ee.FileIndex[0].size=pe<<6,ls[7]=(Ee.FileIndex[0].start=ls[0]+ls[1]+ls[2]+ls[3]+ls[4]+ls[5])+(ls[6]+7>>3),ls}(k),U=Bt(L[7]<<9),I=0,Q=0;{for(I=0;I<8;++I)U.write_shift(1,V[I]);for(I=0;I<8;++I)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),I=0;I<3;++I)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,L[2]),U.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:B),U.write_shift(4,L[3]),U.write_shift(-4,L[1]?L[0]-1:B),U.write_shift(4,L[1]),I=0;I<109;++I)U.write_shift(-4,I<L[2]?L[1]+I:-1)}if(L[1])for(Q=0;Q<L[1];++Q){for(;I<236+Q*127;++I)U.write_shift(-4,I<L[2]?L[1]+I:-1);U.write_shift(-4,Q===L[1]-1?B:Q+1)}var se=function(Ee){for(Q+=Ee;I<Q-1;++I)U.write_shift(-4,I+1);Ee&&(++I,U.write_shift(-4,B))};for(Q=I=0,Q+=L[1];I<Q;++I)U.write_shift(-4,q.DIFSECT);for(Q+=L[2];I<Q;++I)U.write_shift(-4,q.FATSECT);se(L[3]),se(L[4]);for(var Z=0,ee=0,ae=k.FileIndex[0];Z<k.FileIndex.length;++Z)ae=k.FileIndex[Z],ae.content&&(ee=ae.content.length,!(ee<4096)&&(ae.start=Q,se(ee+511>>9)));for(se(L[6]+7>>3);U.l&511;)U.write_shift(-4,q.ENDOFCHAIN);for(Q=I=0,Z=0;Z<k.FileIndex.length;++Z)ae=k.FileIndex[Z],ae.content&&(ee=ae.content.length,!(!ee||ee>=4096)&&(ae.start=Q,se(ee+63>>6)));for(;U.l&511;)U.write_shift(-4,q.ENDOFCHAIN);for(I=0;I<L[4]<<2;++I){var me=k.FullPaths[I];if(!me||me.length===0){for(Z=0;Z<17;++Z)U.write_shift(4,0);for(Z=0;Z<3;++Z)U.write_shift(4,-1);for(Z=0;Z<12;++Z)U.write_shift(4,0);continue}ae=k.FileIndex[I],I===0&&(ae.start=ae.size?ae.start-1:B);var ve=I===0&&O.root||ae.name;if(ee=2*(ve.length+1),U.write_shift(64,ve,"utf16le"),U.write_shift(2,ee),U.write_shift(1,ae.type),U.write_shift(1,ae.color),U.write_shift(-4,ae.L),U.write_shift(-4,ae.R),U.write_shift(-4,ae.C),ae.clsid)U.write_shift(16,ae.clsid,"hex");else for(Z=0;Z<4;++Z)U.write_shift(4,0);U.write_shift(4,ae.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ae.start),U.write_shift(4,ae.size),U.write_shift(4,0)}for(I=1;I<k.FileIndex.length;++I)if(ae=k.FileIndex[I],ae.size>=4096)if(U.l=ae.start+1<<9,Ve&&Buffer.isBuffer(ae.content))ae.content.copy(U,U.l,0,ae.size),U.l+=ae.size+511&-512;else{for(Z=0;Z<ae.size;++Z)U.write_shift(1,ae.content[Z]);for(;Z&511;++Z)U.write_shift(1,0)}for(I=1;I<k.FileIndex.length;++I)if(ae=k.FileIndex[I],ae.size>0&&ae.size<4096)if(Ve&&Buffer.isBuffer(ae.content))ae.content.copy(U,U.l,0,ae.size),U.l+=ae.size+63&-64;else{for(Z=0;Z<ae.size;++Z)U.write_shift(1,ae.content[Z]);for(;Z&63;++Z)U.write_shift(1,0)}if(Ve)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function R(k,M){var O=k.FullPaths.map(function(Z){return Z.toUpperCase()}),L=O.map(function(Z){var ee=Z.split("/");return ee[ee.length-(Z.slice(-1)=="/"?2:1)]}),U=!1;M.charCodeAt(0)===47?(U=!0,M=O[0].slice(0,-1)+M):U=M.indexOf("/")!==-1;var I=M.toUpperCase(),Q=U===!0?O.indexOf(I):L.indexOf(I);if(Q!==-1)return k.FileIndex[Q];var se=!I.match(ro);for(I=I.replace(Da,""),se&&(I=I.replace(ro,"!")),Q=0;Q<O.length;++Q)if((se?O[Q].replace(ro,"!"):O[Q]).replace(Da,"")==I||(se?L[Q].replace(ro,"!"):L[Q]).replace(Da,"")==I)return k.FileIndex[Q];return null}var j=64,B=-2,X="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],F="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:F,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(k,M,O){u();var L=D(k,O);c.writeFileSync(M,L)}function H(k){for(var M=new Array(k.length),O=0;O<k.length;++O)M[O]=String.fromCharCode(k[O]);return M.join("")}function le(k,M){var O=D(k,M);switch(M&&M.type||"buffer"){case"file":return u(),c.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:H(O);case"base64":return jv(typeof O=="string"?O:H(O));case"buffer":if(Ve)return Buffer.isBuffer(O)?O:ci(O);case"array":return typeof O=="string"?Rr(O):O}return O}var W;function _(k){try{var M=k.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)W=k;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function G(k,M){if(!W)return ig(k,M);var O=W.InflateRaw,L=new O,U=L._processChunk(k.slice(k.l),L._finishFlushFlag);return k.l+=L.bytesRead,U}function Y(k){return W?W.deflateRawSync(k):de(k)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(k){var M=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(M>>16|M>>8|M)&255}for(var he=typeof Uint8Array<"u",ce=he?new Uint8Array(256):[],Te=0;Te<256;++Te)ce[Te]=ne(Te);function P(k,M){var O=ce[k&255];return M<=8?O>>>8-M:(O=O<<8|ce[k>>8&255],M<=16?O>>>16-M:(O=O<<8|ce[k>>16&255],O>>>24-M))}function Ke(k,M){var O=M&7,L=M>>>3;return(k[L]|(O<=6?0:k[L+1]<<8))>>>O&3}function Fe(k,M){var O=M&7,L=M>>>3;return(k[L]|(O<=5?0:k[L+1]<<8))>>>O&7}function $e(k,M){var O=M&7,L=M>>>3;return(k[L]|(O<=4?0:k[L+1]<<8))>>>O&15}function Ne(k,M){var O=M&7,L=M>>>3;return(k[L]|(O<=3?0:k[L+1]<<8))>>>O&31}function ge(k,M){var O=M&7,L=M>>>3;return(k[L]|(O<=1?0:k[L+1]<<8))>>>O&127}function Me(k,M,O){var L=M&7,U=M>>>3,I=(1<<O)-1,Q=k[U]>>>L;return O<8-L||(Q|=k[U+1]<<8-L,O<16-L)||(Q|=k[U+2]<<16-L,O<24-L)||(Q|=k[U+3]<<24-L),Q&I}function Mt(k,M,O){var L=M&7,U=M>>>3;return L<=5?k[U]|=(O&7)<<L:(k[U]|=O<<L&255,k[U+1]=(O&7)>>8-L),M+3}function Qt(k,M,O){var L=M&7,U=M>>>3;return O=(O&1)<<L,k[U]|=O,M+1}function oa(k,M,O){var L=M&7,U=M>>>3;return O<<=L,k[U]|=O&255,O>>>=8,k[U+1]=O,M+8}function Ye(k,M,O){var L=M&7,U=M>>>3;return O<<=L,k[U]|=O&255,O>>>=8,k[U+1]=O&255,k[U+2]=O>>>8,M+16}function Jt(k,M){var O=k.length,L=2*O>M?2*O:M+5,U=0;if(O>=M)return k;if(Ve){var I=_v(L);if(k.copy)k.copy(I);else for(;U<k.length;++U)I[U]=k[U];return I}else if(he){var Q=new Uint8Array(L);if(Q.set)Q.set(k);else for(;U<O;++U)Q[U]=k[U];return Q}return k.length=L,k}function ft(k){for(var M=new Array(k),O=0;O<k;++O)M[O]=0;return M}function Ta(k,M,O){var L=1,U=0,I=0,Q=0,se=0,Z=k.length,ee=he?new Uint16Array(32):ft(32);for(I=0;I<32;++I)ee[I]=0;for(I=Z;I<O;++I)k[I]=0;Z=k.length;var ae=he?new Uint16Array(Z):ft(Z);for(I=0;I<Z;++I)ee[U=k[I]]++,L<U&&(L=U),ae[I]=0;for(ee[0]=0,I=1;I<=L;++I)ee[I+16]=se=se+ee[I-1]<<1;for(I=0;I<Z;++I)se=k[I],se!=0&&(ae[I]=ee[se+16]++);var me=0;for(I=0;I<Z;++I)if(me=k[I],me!=0)for(se=P(ae[I],L)>>L-me,Q=(1<<L+4-me)-1;Q>=0;--Q)M[se|Q<<me]=me&15|I<<4;return L}var Ut=he?new Uint16Array(512):ft(512),Pr=he?new Uint16Array(32):ft(32);if(!he){for(var Ct=0;Ct<512;++Ct)Ut[Ct]=0;for(Ct=0;Ct<32;++Ct)Pr[Ct]=0}(function(){for(var k=[],M=0;M<32;M++)k.push(5);Ta(k,Pr,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);Ta(O,Ut,288)})();var fe=function(){for(var M=he?new Uint8Array(32768):[],O=0,L=0;O<xe.length-1;++O)for(;L<xe[O+1];++L)M[L]=O;for(;L<32768;++L)M[L]=29;var U=he?new Uint8Array(259):[];for(O=0,L=0;O<ie.length-1;++O)for(;L<ie[O+1];++L)U[L]=O;function I(se,Z){for(var ee=0;ee<se.length;){var ae=Math.min(65535,se.length-ee),me=ee+ae==se.length;for(Z.write_shift(1,+me),Z.write_shift(2,ae),Z.write_shift(2,~ae&65535);ae-- >0;)Z[Z.l++]=se[ee++]}return Z.l}function Q(se,Z){for(var ee=0,ae=0,me=he?new Uint16Array(32768):[];ae<se.length;){var ve=Math.min(65535,se.length-ae);if(ve<10){for(ee=Mt(Z,ee,+(ae+ve==se.length)),ee&7&&(ee+=8-(ee&7)),Z.l=ee/8|0,Z.write_shift(2,ve),Z.write_shift(2,~ve&65535);ve-- >0;)Z[Z.l++]=se[ae++];ee=Z.l*8;continue}ee=Mt(Z,ee,+(ae+ve==se.length)+2);for(var Ee=0;ve-- >0;){var pe=se[ae];Ee=(Ee<<5^pe)&32767;var we=-1,_e=0;if((we=me[Ee])&&(we|=ae&-32768,we>ae&&(we-=32768),we<ae))for(;se[we+_e]==se[ae+_e]&&_e<250;)++_e;if(_e>2){pe=U[_e],pe<=22?ee=oa(Z,ee,ce[pe+1]>>1)-1:(oa(Z,ee,3),ee+=5,oa(Z,ee,ce[pe-23]>>5),ee+=3);var ht=pe<8?0:pe-4>>2;ht>0&&(Ye(Z,ee,_e-ie[pe]),ee+=ht),pe=M[ae-we],ee=oa(Z,ee,ce[pe]>>3),ee-=3;var mt=pe<4?0:pe-2>>1;mt>0&&(Ye(Z,ee,ae-we-xe[pe]),ee+=mt);for(var ca=0;ca<_e;++ca)me[Ee]=ae&32767,Ee=(Ee<<5^se[ae])&32767,++ae;ve-=_e-1}else pe<=143?pe=pe+48:ee=Qt(Z,ee,1),ee=oa(Z,ee,ce[pe]),me[Ee]=ae&32767,++ae}ee=oa(Z,ee,0)-1}return Z.l=(ee+7)/8|0,Z.l}return function(Z,ee){return Z.length<8?I(Z,ee):Q(Z,ee)}}();function de(k){var M=Bt(50+Math.floor(k.length*1.1)),O=fe(k,M);return M.slice(0,O)}var ye=he?new Uint16Array(32768):ft(32768),Pe=he?new Uint16Array(32768):ft(32768),be=he?new Uint16Array(128):ft(128),qe=1,Xa=1;function $c(k,M){var O=Ne(k,M)+257;M+=5;var L=Ne(k,M)+1;M+=5;var U=$e(k,M)+4;M+=4;for(var I=0,Q=he?new Uint8Array(19):ft(19),se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,ee=he?new Uint8Array(8):ft(8),ae=he?new Uint8Array(8):ft(8),me=Q.length,ve=0;ve<U;++ve)Q[z[ve]]=I=Fe(k,M),Z<I&&(Z=I),ee[I]++,M+=3;var Ee=0;for(ee[0]=0,ve=1;ve<=Z;++ve)ae[ve]=Ee=Ee+ee[ve-1]<<1;for(ve=0;ve<me;++ve)(Ee=Q[ve])!=0&&(se[ve]=ae[Ee]++);var pe=0;for(ve=0;ve<me;++ve)if(pe=Q[ve],pe!=0){Ee=ce[se[ve]]>>8-pe;for(var we=(1<<7-pe)-1;we>=0;--we)be[Ee|we<<pe]=pe&7|ve<<3}var _e=[];for(Z=1;_e.length<O+L;)switch(Ee=be[ge(k,M)],M+=Ee&7,Ee>>>=3){case 16:for(I=3+Ke(k,M),M+=2,Ee=_e[_e.length-1];I-- >0;)_e.push(Ee);break;case 17:for(I=3+Fe(k,M),M+=3;I-- >0;)_e.push(0);break;case 18:for(I=11+ge(k,M),M+=7;I-- >0;)_e.push(0);break;default:_e.push(Ee),Z<Ee&&(Z=Ee);break}var ht=_e.slice(0,O),mt=_e.slice(O);for(ve=O;ve<286;++ve)ht[ve]=0;for(ve=L;ve<30;++ve)mt[ve]=0;return qe=Ta(ht,ye,286),Xa=Ta(mt,Pe,30),M}function Md(k,M){if(k[0]==3&&!(k[1]&3))return[gn(M),2];for(var O=0,L=0,U=_v(M||1<<18),I=0,Q=U.length>>>0,se=0,Z=0;!(L&1);){if(L=Fe(k,O),O+=3,L>>>1)L>>1==1?(se=9,Z=5):(O=$c(k,O),se=qe,Z=Xa);else{O&7&&(O+=8-(O&7));var ee=k[O>>>3]|k[(O>>>3)+1]<<8;if(O+=32,ee>0)for(!M&&Q<I+ee&&(U=Jt(U,I+ee),Q=U.length);ee-- >0;)U[I++]=k[O>>>3],O+=8;continue}for(;;){!M&&Q<I+32767&&(U=Jt(U,I+32767),Q=U.length);var ae=Me(k,O,se),me=L>>>1==1?Ut[ae]:ye[ae];if(O+=me&15,me>>>=4,!(me>>>8&255))U[I++]=me;else{if(me==256)break;me-=257;var ve=me<8?0:me-4>>2;ve>5&&(ve=0);var Ee=I+ie[me];ve>0&&(Ee+=Me(k,O,ve),O+=ve),ae=Me(k,O,Z),me=L>>>1==1?Pr[ae]:Pe[ae],O+=me&15,me>>>=4;var pe=me<4?0:me-2>>1,we=xe[me];for(pe>0&&(we+=Me(k,O,pe),O+=pe),!M&&Q<Ee&&(U=Jt(U,Ee+100),Q=U.length);I<Ee;)U[I]=U[I-we],++I}}}return M?[U,O+7>>>3]:[U.slice(0,I),O+7>>>3]}function ig(k,M){var O=k.slice(k.l||0),L=Md(O,M);return k.l+=L[1],L[0]}function lg(k,M){if(k)typeof console<"u"&&console.error(M);else throw new Error(M)}function og(k,M){var O=k;aa(O,0);var L=[],U=[],I={FileIndex:L,FullPaths:U};S(I,{root:M.root});for(var Q=O.length-4;(O[Q]!=80||O[Q+1]!=75||O[Q+2]!=5||O[Q+3]!=6)&&Q>=0;)--Q;O.l=Q+4,O.l+=4;var se=O.read_shift(2);O.l+=6;var Z=O.read_shift(4);for(O.l=Z,Q=0;Q<se;++Q){O.l+=20;var ee=O.read_shift(4),ae=O.read_shift(4),me=O.read_shift(2),ve=O.read_shift(2),Ee=O.read_shift(2);O.l+=8;var pe=O.read_shift(4),we=o(O.slice(O.l+me,O.l+me+ve));O.l+=me+ve+Ee;var _e=O.l;O.l=pe+4,zA(O,ee,ae,I,we),O.l=_e}return I}function zA(k,M,O,L,U){k.l+=2;var I=k.read_shift(2),Q=k.read_shift(2),se=l(k);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var Z=k.read_shift(4),ee=k.read_shift(4),ae=k.read_shift(4),me=k.read_shift(2),ve=k.read_shift(2),Ee="",pe=0;pe<me;++pe)Ee+=String.fromCharCode(k[k.l++]);if(ve){var we=o(k.slice(k.l,k.l+ve));(we[21589]||{}).mt&&(se=we[21589].mt),((U||{})[21589]||{}).mt&&(se=U[21589].mt)}k.l+=ve;var _e=k.slice(k.l,k.l+ee);switch(Q){case 8:_e=G(k,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var ht=!1;I&8&&(Z=k.read_shift(4),Z==134695760&&(Z=k.read_shift(4),ht=!0),ee=k.read_shift(4),ae=k.read_shift(4)),ee!=M&&lg(ht,"Bad compressed size: "+M+" != "+ee),ae!=O&&lg(ht,"Bad uncompressed size: "+O+" != "+ae),Ud(L,Ee,_e,{unsafe:!0,mt:se})}function HA(k,M){var O=M||{},L=[],U=[],I=Bt(1),Q=O.compression?8:0,se=0,Z=0,ee=0,ae=0,me=0,ve=k.FullPaths[0],Ee=ve,pe=k.FileIndex[0],we=[],_e=0;for(Z=1;Z<k.FullPaths.length;++Z)if(Ee=k.FullPaths[Z].slice(ve.length),pe=k.FileIndex[Z],!(!pe.size||!pe.content||Ee=="Sh33tJ5")){var ht=ae,mt=Bt(Ee.length);for(ee=0;ee<Ee.length;++ee)mt.write_shift(1,Ee.charCodeAt(ee)&127);mt=mt.slice(0,mt.l),we[me]=FL.buf(pe.content,0);var ca=pe.content;Q==8&&(ca=Y(ca)),I=Bt(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,se),I.write_shift(2,Q),pe.mt?n(I,pe.mt):I.write_shift(4,0),I.write_shift(-4,we[me]),I.write_shift(4,ca.length),I.write_shift(4,pe.content.length),I.write_shift(2,mt.length),I.write_shift(2,0),ae+=I.length,L.push(I),ae+=mt.length,L.push(mt),ae+=ca.length,L.push(ca),I=Bt(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,se),I.write_shift(2,Q),I.write_shift(4,0),I.write_shift(-4,we[me]),I.write_shift(4,ca.length),I.write_shift(4,pe.content.length),I.write_shift(2,mt.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,ht),_e+=I.l,U.push(I),_e+=mt.length,U.push(mt),++me}return I=Bt(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,me),I.write_shift(2,me),I.write_shift(4,_e),I.write_shift(4,ae),I.write_shift(2,0),Ys([Ys(L),Ys(U),I])}var Yc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function GA(k,M){if(k.ctype)return k.ctype;var O=k.name||"",L=O.match(/\.([^\.]+)$/);return L&&Yc[L[1]]||M&&(L=(O=M).match(/[\.\\]([^\.\\])+$/),L&&Yc[L[1]])?Yc[L[1]]:"application/octet-stream"}function $A(k){for(var M=jv(k),O=[],L=0;L<M.length;L+=76)O.push(M.slice(L,L+76));return O.join(`\r
`)+`\r
`}function YA(k){var M=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var ae=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],L=M.split(`\r
`),U=0;U<L.length;++U){var I=L[U];if(I.length==0){O.push("");continue}for(var Q=0;Q<I.length;){var se=76,Z=I.slice(Q,Q+se);Z.charAt(se-1)=="="?se--:Z.charAt(se-2)=="="?se-=2:Z.charAt(se-3)=="="&&(se-=3),Z=I.slice(Q,Q+se),Q+=se,Q<I.length&&(Z+="="),O.push(Z)}}return O.join(`\r
`)}function qA(k){for(var M=[],O=0;O<k.length;++O){for(var L=k[O];O<=k.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+k[++O];M.push(L)}for(var U=0;U<M.length;++U)M[U]=M[U].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return Rr(M.join(`\r
`))}function XA(k,M,O){for(var L="",U="",I="",Q,se=0;se<10;++se){var Z=M[se];if(!Z||Z.match(/^\s*$/))break;var ee=Z.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":L=ee[2].trim();break;case"content-type":I=ee[2].trim();break;case"content-transfer-encoding":U=ee[2].trim();break}}switch(++se,U.toLowerCase()){case"base64":Q=Rr(lr(M.slice(se).join("")));break;case"quoted-printable":Q=qA(M.slice(se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ae=Ud(k,L.slice(O.length),Q,{unsafe:!0});I&&(ae.ctype=I)}function KA(k,M){if(H(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",L=(Ve&&Buffer.isBuffer(k)?k.toString("binary"):H(k)).split(`\r
`),U=0,I="";for(U=0;U<L.length;++U)if(I=L[U],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),O||(O=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),I.slice(0,O.length)!=O););var Q=(L[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var se="--"+(Q[1]||""),Z=[],ee=[],ae={FileIndex:Z,FullPaths:ee};S(ae);var me,ve=0;for(U=0;U<L.length;++U){var Ee=L[U];Ee!==se&&Ee!==se+"--"||(ve++&&XA(ae,L.slice(me,U),O),me=U)}return ae}function WA(k,M){var O=M||{},L=O.boundary||"SheetJS";L="------="+L;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],I=k.FullPaths[0],Q=I,se=k.FileIndex[0],Z=1;Z<k.FullPaths.length;++Z)if(Q=k.FullPaths[Z].slice(I.length),se=k.FileIndex[Z],!(!se.size||!se.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var ee=se.content,ae=Ve&&Buffer.isBuffer(ee)?ee.toString("binary"):H(ee),me=0,ve=Math.min(1024,ae.length),Ee=0,pe=0;pe<=ve;++pe)(Ee=ae.charCodeAt(pe))>=32&&Ee<128&&++me;var we=me>=ve*4/5;U.push(L),U.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+Q),U.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),U.push("Content-Type: "+GA(se,Q)),U.push(""),U.push(we?YA(ae):$A(ae))}return U.push(L+`--\r
`),U.join(`\r
`)}function ZA(k){var M={};return S(M,k),M}function Ud(k,M,O,L){var U=L&&L.unsafe;U||S(k);var I=!U&&ze.find(k,M);if(!I){var Q=k.FullPaths[0];M.slice(0,Q.length)==Q?Q=M:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+M).replace("//","/")),I={name:s(M),type:2},k.FileIndex.push(I),k.FullPaths.push(Q),U||ze.utils.cfb_gc(k)}return I.content=O,I.size=O?O.length:0,L&&(L.CLSID&&(I.clsid=L.CLSID),L.mt&&(I.mt=L.mt),L.ct&&(I.ct=L.ct)),I}function QA(k,M){S(k);var O=ze.find(k,M);if(O){for(var L=0;L<k.FileIndex.length;++L)if(k.FileIndex[L]==O)return k.FileIndex.splice(L,1),k.FullPaths.splice(L,1),!0}return!1}function JA(k,M,O){S(k);var L=ze.find(k,M);if(L){for(var U=0;U<k.FileIndex.length;++U)if(k.FileIndex[U]==L)return k.FileIndex[U].name=s(O),k.FullPaths[U]=O,!0}return!1}function e4(k){T(k,!0)}return t.find=R,t.read=A,t.parse=d,t.write=le,t.writeFile=te,t.utils={cfb_new:ZA,cfb_add:Ud,cfb_del:QA,cfb_mov:JA,cfb_gc:e4,ReadShift:ko,CheckField:GT,prep_blob:aa,bconcat:Ys,use_zlib:_,_deflateRaw:de,_inflateRaw:ig,consts:q},t}();function LL(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var a=t.read();return t.close(),a}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function as(e){for(var t=Object.keys(e),a=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&a.push(t[r]);return a}function Bp(e){for(var t=[],a=as(e),r=0;r!==a.length;++r)t[e[a[r]]]=a[r];return t}var H0=new Date(1899,11,30,0,0,0);function La(e,t){var a=e.getTime();t&&(a-=1462*24*60*60*1e3);var r=H0.getTime()+(e.getTimezoneOffset()-H0.getTimezoneOffset())*6e4;return(a-r)/(24*60*60*1e3)}var ET=new Date,ML=H0.getTime()+(ET.getTimezoneOffset()-H0.getTimezoneOffset())*6e4,Bv=ET.getTimezoneOffset();function Dd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ML),t.getTimezoneOffset()!==Bv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Bv)*6e4),t}function UL(e){var t=0,a=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(a=1,n>3&&(r=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":a*=24;case"H":a*=60;case"M":if(r)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=a*parseInt(s[n],10)}return t}var Iv=new Date("2017-02-19T19:06:09.000Z"),NT=isNaN(Iv.getFullYear())?new Date("2/19/17"):Iv,BL=NT.getFullYear()==2017;function Zt(e,t){var a=new Date(e);if(BL)return t>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):t<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(NT.getFullYear()==1917&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function ai(e,t){if(Ve&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return no(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return no(cT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return no(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return no(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(n){return a[n]||n})}catch{}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function ia(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=ia(e[a]));return t}function vt(e,t){for(var a="";a.length<t;)a+=e;return a}function Ur(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(s,n){return a=-a,n}),!isNaN(t=Number(r)))?t/a:t}var IL=["january","february","march","april","may","june","july","august","september","october","november","december"];function ml(e){var t=new Date(e),a=new Date(NaN),r=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return a;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&IL.indexOf(l)==-1)return a}else if(l.match(/[a-z]/))return a;return r<0||r>8099?a:(s>0||n>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?a:t}var PL=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,r,s){if(e||typeof r=="string")return a.split(r);for(var n=a.split(r),l=[n[0]],o=1;o<n.length;++o)l.push(s),l.push(n[o]);return l}}();function ST(e){return e?e.content&&e.type?ai(e.content,!0):e.data?ao(e.data):e.asNodeBuffer&&Ve?ao(e.asNodeBuffer().toString("binary")):e.asBinary?ao(e.asBinary()):e._data&&e._data.getContent?ao(ai(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function TT(e){if(!e)return null;if(e.data)return Cv(e.data);if(e.asNodeBuffer&&Ve)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Cv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function VL(e){return e&&e.name.slice(-4)===".bin"?TT(e):ST(e)}function fr(e,t){for(var a=e.FullPaths||as(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),n=0;n<a.length;++n){var l=a[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||s==l)return e.files?e.files[a[n]]:e.FileIndex[n]}return null}function Ip(e,t){var a=fr(e,t);if(a==null)throw new Error("Cannot find file "+t+" in zip");return a}function jt(e,t,a){if(!a)return VL(Ip(e,t));if(!t)return null;try{return jt(e,t)}catch{return null}}function tr(e,t,a){if(!a)return ST(Ip(e,t));if(!t)return null;try{return tr(e,t)}catch{return null}}function AT(e,t,a){if(!a)return TT(Ip(e,t));if(!t)return null;try{return AT(e,t)}catch{return null}}function Pv(e){for(var t=e.FullPaths||as(e.files),a=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&a.push(t[r].replace(/^Root Entry[\/]/,""));return a.sort()}function zL(e,t,a){if(e.FullPaths){if(typeof a=="string"){var r;return Ve?r=ci(a):r=oL(a),ze.utils.cfb_add(e,t,r)}ze.utils.cfb_add(e,t,a)}else e.file(t,a)}function CT(e,t){switch(t.type){case"base64":return ze.read(e,{type:"base64"});case"binary":return ze.read(e,{type:"binary"});case"buffer":case"array":return ze.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function so(e,t){if(e.charAt(0)=="/")return e.slice(1);var a=t.split("/");t.slice(-1)!="/"&&a.pop();for(var r=e.split("/");r.length!==0;){var s=r.shift();s===".."?a.pop():s!=="."&&a.push(s)}return a.join("/")}var kT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Vv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,GL=/<[^>]*>/g,Sa=kT.match(Vv)?Vv:GL,$L=/<\w*:/,YL=/<(\/?)\w+:/;function Ce(e,t,a){for(var r={},s=0,n=0;s!==e.length&&!((n=e.charCodeAt(s))===32||n===10||n===13);++s);if(t||(r[0]=e.slice(0,s)),s===e.length)return r;var l=e.match(HL),o=0,c="",u=0,d="",h="",f=1;if(l)for(u=0;u!=l.length;++u){for(h=l[u],n=0;n!=h.length&&h.charCodeAt(n)!==61;++n);for(d=h.slice(0,n).trim();h.charCodeAt(n+1)==32;)++n;for(f=(s=h.charCodeAt(n+1))==34||s==39?1:0,c=h.slice(n+1+f,h.length-f),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=c,a||(r[d.toLowerCase()]=c);else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(r[m]&&d.slice(o-3,o)=="ext")continue;r[m]=c,a||(r[m.toLowerCase()]=c)}}return r}function ns(e){return e.replace(YL,"<$1")}var jT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qL=Bp(jT),Xe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function a(r){var s=r+"",n=s.indexOf("<![CDATA[");if(n==-1)return s.replace(e,function(o,c){return jT[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=s.indexOf("]]>");return a(s.slice(0,n))+s.slice(n+9,l)+a(s.slice(l+3))}}(),XL=/[&<>'"]/g,KL=/[\u0000-\u001f]/g;function Pp(e){var t=e+"";return t.replace(XL,function(a){return qL[a]}).replace(/\n/g,"<br/>").replace(KL,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var zv=function(){var e=/&#(\d+);/g;function t(a,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function ot(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gf(e){for(var t="",a=0,r=0,s=0,n=0,l=0,o=0;a<e.length;){if(r=e.charCodeAt(a++),r<128){t+=String.fromCharCode(r);continue}if(s=e.charCodeAt(a++),r>191&&r<224){l=(r&31)<<6,l|=s&63,t+=String.fromCharCode(l);continue}if(n=e.charCodeAt(a++),r<240){t+=String.fromCharCode((r&15)<<12|(s&63)<<6|n&63);continue}l=e.charCodeAt(a++),o=((r&7)<<18|(s&63)<<12|(n&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Hv(e){var t=gn(2*e.length),a,r,s=1,n=0,l=0,o;for(r=0;r<e.length;r+=s)s=1,(o=e.charCodeAt(r))<128?a=o:o<224?(a=(o&31)*64+(e.charCodeAt(r+1)&63),s=2):o<240?(a=(o&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),s=3):(s=4,a=(o&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),a-=65536,l=55296+(a>>>10&1023),a=56320+(a&1023)),l!==0&&(t[n++]=l&255,t[n++]=l>>>8,l=0),t[n++]=a%256,t[n++]=a>>>8;return t.slice(0,n).toString("ucs2")}function Gv(e){return ci(e,"binary").toString("utf8")}var vu="foo bar bazâð£",st=Ve&&(Gv(vu)==Gf(vu)&&Gv||Hv(vu)==Gf(vu)&&Hv)||Gf,no=Ve?function(e){return ci(e,"utf8").toString("binary")}:function(e){for(var t=[],a=0,r=0,s=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,s=e.charCodeAt(a++)-56320+(r<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},lc=function(){var e={};return function(a,r){var s=a+"|"+(r||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",r||"")}}(),_T=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(a){for(var r=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)r=r.replace(e[s][0],e[s][1]);return r}}(),WL=function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),ZL=/<\/?(?:vt:)?variant>/g,QL=/<(?:vt:)([^>]*)>([\s\S]*)</;function $v(e,t){var a=Ce(e),r=e.match(WL(a.baseType))||[],s=[];if(r.length!=a.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return s}return r.forEach(function(n){var l=n.replace(ZL,"").match(QL);l&&s.push({v:st(l[2]),t:l[1]})}),s}var JL=/(^\s|\s$|\n)/;function eM(e){return as(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function tM(e,t,a){return"<"+e+(a!=null?eM(a):"")+(t!=null?(t.match(JL)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Vp(e){if(Ve&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return st(ui(Lp(e)));throw new Error("Bad input format: expected Buffer or string")}var oc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,aM={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},rM=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function sM(e,t){for(var a=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,n=5;n>=0;--n)s=s*256+e[t+n];return r==2047?s==0?a*(1/0):NaN:(r==0?r=-1022:(r-=1023,s+=Math.pow(2,52)),a*Math.pow(2,r-52)*s)}function nM(e,t,a){var r=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,l=r?-t:t;isFinite(l)?l==0?s=n=0:(s=Math.floor(Math.log(l)/Math.LN2),n=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var o=0;o<=5;++o,n/=256)e[a+o]=n&255;e[a+6]=(s&15)<<4|n&15,e[a+7]=s>>4|r}var Yv=function(e){for(var t=[],a=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var s=0,n=e[0][r].length;s<n;s+=a)t.push.apply(t,e[0][r].slice(s,s+a));return t},qv=Ve?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ci(t)})):Yv(e)}:Yv,Xv=function(e,t,a){for(var r=[],s=t;s<a;s+=2)r.push(String.fromCharCode(ys(e,s)));return r.join("").replace(Da,"")},zp=Ve?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf16le",t,a).replace(Da,""):Xv(e,t,a)}:Xv,Kv=function(e,t,a){for(var r=[],s=t;s<t+a;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},RT=Ve?function(e,t,a){return Buffer.isBuffer(e)?e.toString("hex",t,t+a):Kv(e,t,a)}:Kv,Wv=function(e,t,a){for(var r=[],s=t;s<a;s++)r.push(String.fromCharCode(Ti(e,s)));return r.join("")},Ic=Ve?function(t,a,r){return Buffer.isBuffer(t)?t.toString("utf8",a,r):Wv(t,a,r)}:Wv,DT=function(e,t){var a=Ja(e,t);return a>0?Ic(e,t+4,t+4+a-1):""},OT=DT,FT=function(e,t){var a=Ja(e,t);return a>0?Ic(e,t+4,t+4+a-1):""},LT=FT,MT=function(e,t){var a=2*Ja(e,t);return a>0?Ic(e,t+4,t+4+a-1):""},UT=MT,BT=function(t,a){var r=Ja(t,a);return r>0?zp(t,a+4,a+4+r):""},IT=BT,PT=function(e,t){var a=Ja(e,t);return a>0?Ic(e,t+4,t+4+a):""},VT=PT,zT=function(e,t){return sM(e,t)},G0=zT,HT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ve&&(OT=function(t,a){if(!Buffer.isBuffer(t))return DT(t,a);var r=t.readUInt32LE(a);return r>0?t.toString("utf8",a+4,a+4+r-1):""},LT=function(t,a){if(!Buffer.isBuffer(t))return FT(t,a);var r=t.readUInt32LE(a);return r>0?t.toString("utf8",a+4,a+4+r-1):""},UT=function(t,a){if(!Buffer.isBuffer(t))return MT(t,a);var r=2*t.readUInt32LE(a);return t.toString("utf16le",a+4,a+4+r-1)},IT=function(t,a){if(!Buffer.isBuffer(t))return BT(t,a);var r=t.readUInt32LE(a);return t.toString("utf16le",a+4,a+4+r)},VT=function(t,a){if(!Buffer.isBuffer(t))return PT(t,a);var r=t.readUInt32LE(a);return t.toString("utf8",a+4,a+4+r)},G0=function(t,a){return Buffer.isBuffer(t)?t.readDoubleLE(a):zT(t,a)},HT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ti=function(e,t){return e[t]},ys=function(e,t){return e[t+1]*256+e[t]},iM=function(e,t){var a=e[t+1]*256+e[t];return a<32768?a:(65535-a+1)*-1},Ja=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Rn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},lM=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ko(e,t){var a="",r,s,n=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,Ve&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)a+=String.fromCharCode(ys(this,u)),u+=2;e*=2;break;case"utf8":a=Ic(this,this.l,this.l+e);break;case"utf16le":e*=2,a=zp(this,this.l,this.l+e);break;case"wstr":return ko.call(this,e,"dbcs");case"lpstr-ansi":a=OT(this,this.l),e=4+Ja(this,this.l);break;case"lpstr-cp":a=LT(this,this.l),e=4+Ja(this,this.l);break;case"lpwstr":a=UT(this,this.l),e=4+2*Ja(this,this.l);break;case"lpp4":e=4+Ja(this,this.l),a=IT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ja(this,this.l),a=VT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(l=Ti(this,this.l+e++))!==0;)n.push(yu(l));a=n.join("");break;case"_wstr":for(e=0,a="";(l=ys(this,this.l+e))!==0;)n.push(yu(l)),e+=2;e+=2,a=n.join("");break;case"dbcs-cont":for(a="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ti(this,u),this.l=u+1,o=ko.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(yu(ys(this,u))),u+=2}a=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=Ti(this,u),this.l=u+1,o=ko.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(yu(Ti(this,u))),u+=1}a=n.join("");break;default:switch(e){case 1:return r=Ti(this,this.l),this.l++,r;case 2:return r=(t==="i"?iM:ys)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?Rn:lM)(this,this.l),this.l+=4,r):(s=Ja(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=G0(this,this.l):s=G0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:a=RT(this,this.l,e);break}}return this.l+=e,a}var oM=function(e,t,a){e[a]=t&255,e[a+1]=t>>>8&255,e[a+2]=t>>>16&255,e[a+3]=t>>>24&255},cM=function(e,t,a){e[a]=t&255,e[a+1]=t>>8&255,e[a+2]=t>>16&255,e[a+3]=t>>24&255},uM=function(e,t,a){e[a]=t&255,e[a+1]=t>>>8&255};function dM(e,t,a){var r=0,s=0;if(a==="dbcs"){for(s=0;s!=t.length;++s)uM(this,t.charCodeAt(s),this.l+2*s);r=2*t.length}else if(a==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;r=t.length}else if(a==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(a==="utf16le"){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,oM(this,t,this.l);break;case 8:if(r=8,a==="f"){nM(this,t,this.l);break}case 16:break;case-4:r=4,cM(this,t,this.l);break}return this.l+=r,this}function GT(e,t){var a=RT(this,this.l,e.length>>1);if(a!==e)throw new Error(t+"Expected "+e+" saw "+a);this.l+=e.length>>1}function aa(e,t){e.l=t,e.read_shift=ko,e.chk=GT,e.write_shift=dM}function Ea(e,t){e.l+=t}function Bt(e){var t=gn(e);return aa(t,0),t}function Ds(e,t,a){if(e){var r,s,n;aa(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=W0[o]||W0[65535];for(r=e.read_shift(1),n=r&127,s=1;s<4&&r&128;++s)n+=((r=e.read_shift(1))&127)<<7*s;c=e.l+n;var d=u.f&&u.f(e,n,a);if(e.l=c,t(d,u,o))return}}}function Cm(){var e=[],t=Ve?256:2048,a=function(u){var d=Bt(u);return aa(d,0),d},r=a(t),s=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},n=function(u){return r&&u<r.length-r.l?r:(s(),r=a(Math.max(u+1,t)))},l=function(){return s(),Ys(e)},o=function(u){s(),r=u,r.l==null&&(r.l=r.length),n(t)};return{next:n,push:o,end:l,_bufs:e}}function jo(e,t,a){var r=ia(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Zv(e,t,a){var r=ia(e);return r.s=jo(r.s,t.s,a),r.e=jo(r.e,t.s,a),r}function _o(e,t){if(e.cRel&&e.c<0)for(e=ia(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ia(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var a=je(e);return!e.cRel&&e.cRel!=null&&(a=mM(a)),!e.rRel&&e.rRel!=null&&(a=fM(a)),a}function $f(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Vt(e.s.c)+":"+(e.e.cRel?"":"$")+Vt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+la(e.s.r)+":"+(e.e.rRel?"":"$")+la(e.e.r):_o(e.s,t.biff)+":"+_o(e.e,t.biff)}function Hp(e){return parseInt(hM(e),10)-1}function la(e){return""+(e+1)}function fM(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hM(e){return e.replace(/\$(\d+)$/,"$1")}function Gp(e){for(var t=xM(e),a=0,r=0;r!==t.length;++r)a=26*a+t.charCodeAt(r)-64;return a-1}function Vt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function mM(e){return e.replace(/^([A-Z])/,"$$$1")}function xM(e){return e.replace(/^\$([A-Z])/,"$1")}function pM(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ra(e){for(var t=0,a=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(a=26*a+(s-64))}return{c:a-1,r:t-1}}function je(e){for(var t=e.c+1,a="";t;t=(t-1)/26|0)a=String.fromCharCode((t-1)%26+65)+a;return a+(e.r+1)}function Dl(e){var t=e.indexOf(":");return t==-1?{s:Ra(e),e:Ra(e)}:{s:Ra(e.slice(0,t)),e:Ra(e.slice(t+1))}}function Ge(e,t){return typeof t>"u"||typeof t=="number"?Ge(e.s,e.e):(typeof e!="string"&&(e=je(e)),typeof t!="string"&&(t=je(t)),e==t?e:e+":"+t)}function Et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,s=0,n=e.length;for(a=0;r<n&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(t.s.c=--a,a=0;r<n&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;if(t.s.r=--a,r===n||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,a=0;r!=n&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)a=26*a+s;for(t.e.c=--a,a=0;r!=n&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)a=10*a+s;return t.e.r=--a,t}function Qv(e,t){var a=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Sr(e.z,a?La(t):t)}catch{}try{return e.w=Sr((e.XF||{}).numFmtId||(a?14:0),a?La(t):t)}catch{return""+t}}function js(e,t,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?hi[e.v]||e.v:t==null?Qv(e,e.v):Qv(e,t))}function En(e,t){var a=t&&t.sheet?t.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function $T(e,t,a){var r=a||{},s=e?Array.isArray(e):r.dense,n=e||(s?[]:{}),l=0,o=0;if(n&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var c=typeof r.origin=="string"?Ra(r.origin):r.origin;l=c.r,o=c.c}n["!ref"]||(n["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=Et(n["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var m={v:t[h][f]},p=l+h,x=o+f;if(u.s.r>p&&(u.s.r=p),u.s.c>x&&(u.s.c=x),u.e.r<p&&(u.e.r=p),u.e.c<x&&(u.e.c=x),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))m=t[h][f];else if(Array.isArray(m.v)&&(m.f=t[h][f][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else if(r.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=r.dateNF||De[14],r.cellDates?(m.t="d",m.w=Sr(m.z,La(m.v))):(m.t="n",m.v=La(m.v),m.w=Sr(m.z,m.v))):m.t="s";if(s)n[p]||(n[p]=[]),n[p][x]&&n[p][x].z&&(m.z=n[p][x].z),n[p][x]=m;else{var v=je({c:x,r:p});n[v]&&n[v].z&&(m.z=n[v].z),n[v]=m}}}return u.s.c<1e7&&(n["!ref"]=Ge(u)),n}function Ol(e,t){return $T(null,e,t)}function gM(e){return e.read_shift(4,"i")}function ba(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yM(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $p(e,t){var a=e.l,r=e.read_shift(1),s=ba(e),n=[],l={t:s,h:s};if(r&1){for(var o=e.read_shift(4),c=0;c!=o;++c)n.push(yM(e));l.r=n}else l.r=[{ich:0,ifnt:0}];return e.l=a+t,l}var vM=$p;function Tr(e){var t=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:a}}function di(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var bM=ba;function Yp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var wM=ba,km=Yp;function qp(e){var t=e.slice(e.l,e.l+4),a=t[0]&1,r=t[0]&2;e.l+=4;var s=r===0?G0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Rn(t,0)>>2;return a?s/100:s}function YT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var fi=YT;function ma(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function EM(e){var t={},a=e.read_shift(1),r=a>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=s;var u=Xn[s];u&&(t.rgb=uc(u));break;case 2:t.rgb=uc([l,o,c]);break;case 3:t.theme=s;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function NM(e){var t=e.read_shift(1);e.l++;var a={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return a}function qT(e,t){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function SM(e){return qT(e,1)}function TM(e){return qT(e,2)}var Xp=2,za=3,bu=11,Jv=12,$0=19,wu=64,AM=65,CM=71,kM=4108,jM=4126,Yt=80,XT=81,_M=[Yt,XT],RM={1:{n:"CodePage",t:Xp},2:{n:"Category",t:Yt},3:{n:"PresentationFormat",t:Yt},4:{n:"ByteCount",t:za},5:{n:"LineCount",t:za},6:{n:"ParagraphCount",t:za},7:{n:"SlideCount",t:za},8:{n:"NoteCount",t:za},9:{n:"HiddenCount",t:za},10:{n:"MultimediaClipCount",t:za},11:{n:"ScaleCrop",t:bu},12:{n:"HeadingPairs",t:kM},13:{n:"TitlesOfParts",t:jM},14:{n:"Manager",t:Yt},15:{n:"Company",t:Yt},16:{n:"LinksUpToDate",t:bu},17:{n:"CharacterCount",t:za},19:{n:"SharedDoc",t:bu},22:{n:"HyperlinksChanged",t:bu},23:{n:"AppVersion",t:za,p:"version"},24:{n:"DigSig",t:AM},26:{n:"ContentType",t:Yt},27:{n:"ContentStatus",t:Yt},28:{n:"Language",t:Yt},29:{n:"Version",t:Yt},255:{},2147483648:{n:"Locale",t:$0},2147483651:{n:"Behavior",t:$0},1919054434:{}},DM={1:{n:"CodePage",t:Xp},2:{n:"Title",t:Yt},3:{n:"Subject",t:Yt},4:{n:"Author",t:Yt},5:{n:"Keywords",t:Yt},6:{n:"Comments",t:Yt},7:{n:"Template",t:Yt},8:{n:"LastAuthor",t:Yt},9:{n:"RevNumber",t:Yt},10:{n:"EditTime",t:wu},11:{n:"LastPrinted",t:wu},12:{n:"CreatedDate",t:wu},13:{n:"ModifiedDate",t:wu},14:{n:"PageCount",t:za},15:{n:"WordCount",t:za},16:{n:"CharCount",t:za},17:{n:"Thumbnail",t:CM},18:{n:"Application",t:Yt},19:{n:"DocSecurity",t:za},255:{},2147483648:{n:"Locale",t:$0},2147483651:{n:"Behavior",t:$0},1919054434:{}},eb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},OM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function FM(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var LM=FM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xn=ia(LM),hi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},KT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function MM(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function UM(e){var t=MM();if(!e||!e.match)return t;var a={};if((e.match(Sa)||[]).forEach(function(r){var s=Ce(r);switch(s[0].replace($L,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":t[tb[s.ContentType]]!==void 0&&t[tb[s.ContentType]].push(s.PartName);break}}),t.xmlns!==aM.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=a,delete t.calcchains,t}var Hi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ro(e,t){var a={"!id":{}};if(!e)return a;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(Sa)||[]).forEach(function(s){var n=Ce(s);if(n[0]==="<Relationship"){var l={};l.Type=n.Type,l.Target=n.Target,l.Id=n.Id,n.TargetMode&&(l.TargetMode=n.TargetMode);var o=n.TargetMode==="External"?n.Target:so(n.Target,t);a[o]=l,r[n.Id]=l}}),a["!id"]=r,a}var BM="application/vnd.oasis.opendocument.spreadsheet";function IM(e,t){for(var a=Vp(e),r,s;r=oc.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if(s=Ce(r[0],!1),s.path=="/"&&s.type!==BM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}var Do=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],PM=function(){for(var e=new Array(Do.length),t=0;t<Do.length;++t){var a=Do[t],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function WT(e){var t={};e=st(e);for(var a=0;a<Do.length;++a){var r=Do[a],s=e.match(PM[a]);s!=null&&s.length>0&&(t[r[1]]=Xe(s[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Zt(t[r[1]]))}return t}var VM=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ZT(e,t,a,r){var s=[];if(typeof e=="string")s=$v(e,r);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(d){return{v:d}}));var l=typeof t=="string"?$v(t,r).map(function(d){return d.v}):t,o=0,c=0;if(l.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":a.Worksheets=c,a.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":a.NamedRanges=c,a.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":a.Chartsheets=c,a.ChartNames=l.slice(o,o+c);break}o+=c}}function zM(e,t,a){var r={};return t||(t={}),e=st(e),VM.forEach(function(s){var n=(e.match(lc(s[0]))||[])[1];switch(s[2]){case"string":n&&(t[s[1]]=Xe(n));break;case"bool":t[s[1]]=n==="true";break;case"raw":var l=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));l&&l.length>0&&(r[s[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&ZT(r.HeadingPairs,r.TitlesOfParts,t,a),t}var HM=/<[^>]+>[^<]*/g;function GM(e,t){var a={},r="",s=e.match(HM);if(s)for(var n=0;n!=s.length;++n){var l=s[n],o=Ce(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Xe(o.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":a[r]=Xe(d);break;case"bool":a[r]=ot(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(d,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(d);break;case"filetime":case"date":a[r]=Zt(d);break;case"cy":case"error":a[r]=Xe(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return a}var $M={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Yf;function YM(e,t,a){Yf||(Yf=Bp($M)),t=Yf[t]||t,e[t]=a}function Kp(e){var t=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function QT(e,t,a){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return s}function JT(e,t,a){var r=e.read_shift(0,"lpwstr");return a&&(e.l+=4-(r.length+1&3)&3),r}function eA(e,t,a){return t===31?JT(e):QT(e,t,a)}function _m(e,t,a){return eA(e,t,a===!1?0:4)}function qM(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return eA(e,t,0)}function XM(e){for(var t=e.read_shift(4),a=[],r=0;r!=t;++r){var s=e.l;a[r]=e.read_shift(0,"lpwstr").replace(Da,""),e.l-s&2&&(e.l+=2)}return a}function KM(e){for(var t=e.read_shift(4),a=[],r=0;r!=t;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(Da,"");return a}function WM(e){var t=e.l,a=Y0(e,XT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=Y0(e,za);return[a,r]}function ZM(e){for(var t=e.read_shift(4),a=[],r=0;r<t/2;++r)a.push(WM(e));return a}function ab(e,t){for(var a=e.read_shift(4),r={},s=0;s!=a;++s){var n=e.read_shift(4),l=e.read_shift(4);r[n]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Da,"").replace(ro,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),r}function tA(e){var t=e.read_shift(4),a=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),a}function QM(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Y0(e,t,a){var r=e.read_shift(2),s,n=a||{};if(e.l+=2,t!==Jv&&r!==t&&_M.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===Jv?r:t){case 2:return s=e.read_shift(2,"i"),n.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return QT(e,r,4).replace(Da,"");case 31:return JT(e);case 64:return Kp(e);case 65:return tA(e);case 71:return QM(e);case 80:return _m(e,r,!n.raw).replace(Da,"");case 81:return qM(e,r).replace(Da,"");case 4108:return ZM(e);case 4126:case 4127:return r==4127?XM(e):KM(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function rb(e,t){var a=e.l,r=e.read_shift(4),s=e.read_shift(4),n=[],l=0,o=0,c=-1,u={};for(l=0;l!=s;++l){var d=e.read_shift(4),h=e.read_shift(4);n[l]=[d,h+a]}n.sort(function(b,y){return b[1]-y[1]});var f={};for(l=0;l!=s;++l){if(e.l!==n[l][1]){var m=!0;if(l>0&&t)switch(t[n[l-1][0]].t){case 2:e.l+2===n[l][1]&&(e.l+=2,m=!1);break;case 80:e.l<=n[l][1]&&(e.l=n[l][1],m=!1);break;case 4108:e.l<=n[l][1]&&(e.l=n[l][1],m=!1);break}if((!t||l==0)&&e.l<=n[l][1]&&(m=!1,e.l=n[l][1]),m)throw new Error("Read Error: Expected address "+n[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[n[l][0]];if(f[p.n]=Y0(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Or(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(n[l][0]===1){if(o=f.CodePage=Y0(e,Xp),Or(o),c!==-1){var x=e.l;e.l=n[c][1],u=ab(e,o),e.l=x}}else if(n[l][0]===0){if(o===0){c=l,e.l=n[l+1][1];continue}u=ab(e,o)}else{var v=u[n[l][0]],g;switch(e[e.l]){case 65:e.l+=4,g=tA(e);break;case 30:e.l+=4,g=_m(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=_m(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=St(e,4);break;case 64:e.l+=4,g=Zt(Kp(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=g}}return e.l=a+r,f}function sb(e,t,a){var r=e.content;if(!r)return{};aa(r,0);var s,n,l,o,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var u=r.read_shift(4),d=r.read_shift(16);if(d!==ze.utils.consts.HEADER_CLSID&&d!==a)throw new Error("Bad PropertySet CLSID "+d);if(s=r.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(n=r.read_shift(16),o=r.read_shift(4),s===1&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);s===2&&(l=r.read_shift(16),c=r.read_shift(4));var h=rb(r,t),f={SystemIdentifier:u};for(var m in h)f[m]=h[m];if(f.FMTID=n,s===1)return f;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);var p;try{p=rb(r,null)}catch{}for(m in p)f[m]=p[m];return f.FMTID=[n,l],f}function Ms(e,t){return e.read_shift(t),null}function JM(e,t,a){for(var r=[],s=e.l+t;e.l<s;)r.push(a(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}function St(e,t){return e.read_shift(t)===1}function _t(e){return e.read_shift(2,"u")}function aA(e,t){return JM(e,t,_t)}function eU(e){var t=e.read_shift(1),a=e.read_shift(1);return a===1?t:t===1}function Pc(e,t,a){var r=e.read_shift(a&&a.biff>=12?2:1),s="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var n=e.read_shift(1);n&&(s="dbcs-cont")}else a.biff==12&&(s="wstr");a.biff>=2&&a.biff<=5&&(s="cpstr");var l=r?e.read_shift(r,s):"";return l}function tU(e){var t=e.read_shift(2),a=e.read_shift(1),r=a&4,s=a&8,n=1+(a&1),l=0,o,c={};s&&(l=e.read_shift(2)),r&&(o=e.read_shift(4));var u=n==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*l),r&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ri(e,t,a){var r;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(t,"cpstr");if(a.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function Vc(e,t,a){var r=e.read_shift(a&&a.biff==2?1:2);return r===0?(e.l++,""):ri(e,r,a)}function mi(e,t,a){if(a.biff>5)return Vc(e,t,a);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function aU(e){var t=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[t,a]}function rU(e){var t=e.read_shift(4),a=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=a);var s=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Da,"");return r&&(e.l+=24),s}function sU(e){for(var t=e.read_shift(2),a="";t-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return a+r.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(n>>1,"utf16le").replace(Da,"");return a+l}function nU(e,t){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return rU(e);case"0303000000000000c000000000000046":return sU(e);default:throw new Error("Unsupported Moniker "+a)}}function Eu(e){var t=e.read_shift(4),a=t>0?e.read_shift(t,"utf16le").replace(Da,""):"";return a}function iU(e,t){var a=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var n,l,o,c,u="",d,h;s&16&&(n=Eu(e,a-e.l)),s&128&&(l=Eu(e,a-e.l)),(s&257)===257&&(o=Eu(e,a-e.l)),(s&257)===1&&(c=nU(e,a-e.l)),s&8&&(u=Eu(e,a-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(h=Kp(e)),e.l=a;var f=l||o||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),s&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var m={Target:f};return d&&(m.guid=d),h&&(m.time=h),n&&(m.Tooltip=n),m}function rA(e){var t=e.read_shift(1),a=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1);return[t,a,r,s]}function sA(e,t){var a=rA(e);return a[3]=0,a}function is(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{r:t,c:a,ixfe:r}}function lU(e){var t=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:t,flags:a}}function oU(e,t,a){return t===0?"":mi(e,t,a)}function cU(e,t,a){var r=a.biff>8?4:2,s=e.read_shift(r),n=e.read_shift(r,"i"),l=e.read_shift(r,"i");return[s,n,l]}function nA(e){var t=e.read_shift(2),a=qp(e);return[t,a]}function uU(e,t,a){e.l+=4,t-=4;var r=e.l+t,s=Pc(e,t,a),n=e.read_shift(2);if(r-=e.l,n!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+n);return e.l+=n,s}function Od(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{s:{c:r,r:t},e:{c:s,r:a}}}function iA(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(1),s=e.read_shift(1);return{s:{c:r,r:t},e:{c:s,r:a}}}var dU=iA;function lA(e){e.l+=4;var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,t,r]}function fU(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function hU(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ua(e){e.l+=2,e.l+=e.read_shift(2)}var mU={0:ua,4:ua,5:ua,6:ua,7:hU,8:ua,9:ua,10:ua,11:ua,12:ua,13:fU,14:ua,15:ua,16:ua,17:ua,18:ua,19:ua,20:ua,21:lA};function xU(e,t){for(var a=e.l+t,r=[];e.l<a;){var s=e.read_shift(2);e.l-=2;try{r.push(mU[s](e,a-e.l))}catch{return e.l=a,r}}return e.l!=a&&(e.l=a),r}function Nu(e,t){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),t-=2,t>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(t),a}function pU(e,t){return t===0||e.read_shift(2),1200}function gU(e,t,a){if(a.enc)return e.l+=t,"";var r=e.l,s=mi(e,0,a);return e.read_shift(t+r-e.l),s}function yU(e,t,a){var r=a&&a.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function vU(e,t,a){var r=e.read_shift(4),s=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var l=Pc(e,0,a);return l.length===0&&(l="Sheet1"),{pos:r,hs:s,dt:n,name:l}}function bU(e,t){for(var a=e.l+t,r=e.read_shift(4),s=e.read_shift(4),n=[],l=0;l!=s&&e.l<a;++l)n.push(tU(e));return n.Count=r,n.Unique=s,n}function wU(e,t){var a={};return a.dsst=e.read_shift(2),e.l+=t-2,a}function EU(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=a/20),t}function NU(e){var t=lU(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var a=e.read_shift(4);return a!==0}function SU(e){return e.read_shift(2),e.read_shift(4)}function nb(e,t,a){var r=0;a&&a.biff==2||(r=e.read_shift(2));var s=e.read_shift(2);a&&a.biff==2&&(r=1-(s>>15),s&=32767);var n={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[n,s]}function TU(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,a],Dim:[r,s],Flags:n,CurTab:l,FirstTab:o,Selected:c,TabRatio:u}}function AU(e,t,a){if(a&&a.biff>=2&&a.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function CU(){}function kU(e,t,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Pc(e,0,a),r}function jU(e){var t=is(e);return t.isst=e.read_shift(4),t}function _U(e,t,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=e.l+t,s=is(e);a.biff==2&&e.l++;var n=Vc(e,r-e.l,a);return s.val=n,s}function RU(e,t,a){var r=e.read_shift(2),s=mi(e,0,a);return[r,s]}var DU=mi;function ib(e,t,a){var r=e.l+t,s=a.biff==8||!a.biff?4:2,n=e.read_shift(s),l=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=r,{s:{r:n,c:o},e:{r:l,c}}}function OU(e){var t=e.read_shift(2),a=e.read_shift(2),r=nA(e);return{r:t,c:a,ixfe:r[0],rknum:r[1]}}function FU(e,t){for(var a=e.l+t-2,r=e.read_shift(2),s=e.read_shift(2),n=[];e.l<a;)n.push(nA(e));if(e.l!==a)throw new Error("MulRK read error");var l=e.read_shift(2);if(n.length!=l-s+1)throw new Error("MulRK length mismatch");return{r,c:s,C:l,rkrec:n}}function LU(e,t){for(var a=e.l+t-2,r=e.read_shift(2),s=e.read_shift(2),n=[];e.l<a;)n.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var l=e.read_shift(2);if(n.length!=l-s+1)throw new Error("MulBlank length mismatch");return{r,c:s,C:l,ixfe:n}}function MU(e,t,a,r){var s={},n=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=OM[o>>26],r.cellStyles&&(s.alc=n&7,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=l&15,s.dgRight=l>>4&15,s.dgTop=l>>8&15,s.dgBottom=l>>12&15,s.icvLeft=l>>16&127,s.icvRight=l>>23&127,s.grbitDiag=l>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function UU(e,t,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=MU(e,t,r.fStyle,a),r}function BU(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function lb(e,t,a){var r=is(e);(a.biff==2||t==9)&&++e.l;var s=eU(e);return r.val=s,r.t=s===!0||s===!1?"b":"e",r}function IU(e,t,a){a.biffguess&&a.biff==2&&(a.biff=5);var r=is(e),s=ma(e);return r.val=s,r}var ob=oU;function PU(e,t,a){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(a.sbcch=n,n==1025||n==14849)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var l=ri(e,n),o=[];r>e.l;)o.push(Vc(e));return[n,s,l,o]}function cb(e,t,a){var r=e.read_shift(2),s,n={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return a.sbcch===14849&&(s=uU(e,t-2,a)),n.body=s||e.read_shift(t-2),typeof s=="string"&&(n.Name=s),n}var VU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ub(e,t,a){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(a&&a.biff==2?1:2),c=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),c=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var u=ri(e,l,a);s&32&&(u=VU[u.charCodeAt(0)]);var d=r-e.l;a&&a.biff==2&&--d;var h=r==e.l||o===0||!(d>0)?[]:E7(e,d,a,o);return{chKey:n,Name:u,itab:c,rgce:h}}function oA(e,t,a){if(a.biff<8)return zU(e,t,a);for(var r=[],s=e.l+t,n=e.read_shift(a.biff>8?4:2);n--!==0;)r.push(cU(e,a.biff>8?12:6,a));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function zU(e,t,a){e[e.l+1]==3&&e[e.l]++;var r=Pc(e,t,a);return r.charCodeAt(0)==3?r.slice(1):r}function HU(e,t,a){if(a.biff<8){e.l+=t;return}var r=e.read_shift(2),s=e.read_shift(2),n=ri(e,r,a),l=ri(e,s,a);return[n,l]}function GU(e,t,a){var r=iA(e);e.l++;var s=e.read_shift(1);return t-=8,[N7(e,t,a),s,r]}function db(e,t,a){var r=dU(e);switch(a.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,b7(e,t,a)]}function $U(e){var t=e.read_shift(4)!==0,a=e.read_shift(4)!==0,r=e.read_shift(4);return[t,a,r]}function YU(e,t,a){if(!(a.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=mi(e,0,a);return a.biff<8&&e.read_shift(1),[{r,c:s},o,l,n]}}function qU(e,t,a){return YU(e,t,a)}function XU(e,t){for(var a=[],r=e.read_shift(2);r--;)a.push(Od(e));return a}function KU(e,t,a){if(a&&a.biff<8)return ZU(e,t,a);var r=lA(e),s=xU(e,t-22,r[1]);return{cmo:r,ft:s}}var WU={8:function(e,t){var a=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=a,{fmt:r}}};function ZU(e,t,a){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((WU[r]||Ea)(e,t,a)),{cmo:[s,r,n],ft:l}}function QU(e,t,a){var r=e.l,s="";try{e.l+=4;var n=(a.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:l=aU(e,6,a);var o=e.read_shift(2);e.read_shift(2),_t(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-r!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],h=ri(e,e.lens[u+1]-e.lens[u]-1);if(s+=h,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=r+t,{t:s}}catch{return e.l=r+t,{t:s}}}function JU(e,t){var a=Od(e);e.l+=16;var r=iU(e,t-24);return[a,r]}function eB(e,t){e.read_shift(2);var a=Od(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(Da,""),[a,r]}function tB(e){var t=[0,0],a;return a=e.read_shift(2),t[0]=eb[a]||a,a=e.read_shift(2),t[1]=eb[a]||a,t}function aB(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(sA(e));return a}function rB(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(sA(e));return a}function sB(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function cA(e,t,a){if(!a.cellStyles)return Ea(e,t);var r=a&&a.biff>=12?4:2,s=e.read_shift(r),n=e.read_shift(r),l=e.read_shift(r),o=e.read_shift(r),c=e.read_shift(2);r==2&&(e.l+=2);var u={s,e:n,w:l,ixfe:o,flags:c};return(a.biff>=5||!a.biff)&&(u.level=c>>8&7),u}function nB(e,t){var a={};return t<32||(e.l+=16,a.header=ma(e),a.footer=ma(e),e.l+=2),a}function iB(e,t,a){var r={area:!1};if(a.biff!=5)return e.l+=t,r;var s=e.read_shift(1);return e.l+=3,s&16&&(r.area=!0),r}var lB=is,oB=aA,cB=Vc;function uB(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s={fmt:t,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}function dB(e,t,a){a.biffguess&&a.biff==5&&(a.biff=2);var r=is(e);++e.l;var s=mi(e,t-7,a);return r.t="str",r.val=s,r}function fB(e){var t=is(e);++e.l;var a=ma(e);return t.t="n",t.val=a,t}function hB(e){var t=is(e);++e.l;var a=e.read_shift(2);return t.t="n",t.val=a,t}function mB(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function xB(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function pB(e,t,a){var r=e.l+t,s=is(e),n=e.read_shift(2),l=ri(e,n,a);return e.l=r,s.t="str",s.val=l,s}var gB=[2,3,48,49,131,139,140,245],fb=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(o,c){var u=[],d=gn(1);switch(c.type){case"base64":d=Rr(lr(o));break;case"binary":d=Rr(o);break;case"buffer":case"array":d=o;break}aa(d,0);var h=d.read_shift(1),f=!!(h&136),m=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,f=!0;break;case 49:m=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,v=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(v=d.read_shift(2));var g=d.read_shift(2),b=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],w={},N=Math.min(d.length,h==2?521:v-10-(m?264:0)),A=p?32:11;d.l<N&&d[d.l]!=13;)switch(w={},w.name=$s.utils.decode(b,d.slice(d.l,d.l+A)).replace(/[\u0000\r\n].*$/g,""),d.l+=A,w.type=String.fromCharCode(d.read_shift(1)),h!=2&&!p&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),h==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&y.push(w),h!=2&&(d.l+=p?13:14),w.type){case"B":(!m||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var S=0,C=0;for(u[0]=[],C=0;C!=y.length;++C)u[0][C]=y[C].name;for(;x-- >0;){if(d[d.l]===42){d.l+=g;continue}for(++d.l,u[++S]=[],C=0,C=0;C!=y.length;++C){var T=d.slice(d.l,d.l+y[C].len);d.l+=y[C].len,aa(T,0);var D=$s.utils.decode(b,T);switch(y[C].type){case"C":D.trim().length&&(u[S][C]=D.replace(/\s+$/,""));break;case"D":D.length===8?u[S][C]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):u[S][C]=D;break;case"F":u[S][C]=parseFloat(D.trim());break;case"+":case"I":u[S][C]=p?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":u[S][C]=!0;break;case"N":case"F":u[S][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[S][C]="##MEMO##"+(p?parseInt(D.trim(),10):T.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(u[S][C]=+D||0);break;case"@":u[S][C]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":u[S][C]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":u[S][C]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][C]=-T.read_shift(-8,"f");break;case"B":if(m&&y[C].len==8){u[S][C]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[C].len;break;case"0":if(y[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[C].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function r(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ol(a(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,c){try{return En(r(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&Or(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Cm(),h=Um(o,{header:1,raw:!0,cellDates:!0}),f=h[0],m=h.slice(1),p=o["!cols"]||[],x=0,v=0,g=0,b=1;for(x=0;x<f.length;++x){if(((p[x]||{}).DBF||{}).name){f[x]=p[x].DBF.name,++g;continue}if(f[x]!=null){if(++g,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(v=0;v<1024;++v)if(f.indexOf(f[x]+"_"+v)==-1){f[x]+="_"+v;break}}}}var y=Et(o["!ref"]),w=[],N=[],A=[];for(x=0;x<=y.e.c-y.s.c;++x){var S="",C="",T=0,D=[];for(v=0;v<m.length;++v)m[v][x]!=null&&D.push(m[v][x]);if(D.length==0||f[x]==null){w[x]="?";continue}for(v=0;v<D.length;++v){switch(typeof D[v]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=D[v]instanceof Date?"D":"C";break;default:C="C"}T=Math.max(T,String(D[v]).length),S=S&&S!=C?"C":C}T>250&&(T=250),C=((p[x]||{}).DBF||{}).type,C=="C"&&p[x].DBF.len>T&&(T=p[x].DBF.len),S=="B"&&C=="N"&&(S="N",A[x]=p[x].DBF.dec,T=p[x].DBF.len),N[x]=S=="C"||C=="N"?T:n[S]||0,b+=N[x],w[x]=S}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*g),R.write_shift(2,b),x=0;x<4;++x)R.write_shift(4,0);for(R.write_shift(4,0|(+t[lT]||3)<<8),x=0,v=0;x<f.length;++x)if(f[x]!=null){var j=d.next(32),B=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,B,"sbcs"),j.write_shift(1,w[x]=="?"?"C":w[x],"sbcs"),j.write_shift(4,v),j.write_shift(1,N[x]||n[w[x]]||0),j.write_shift(1,A[x]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),v+=N[x]||n[w[x]]||0}var X=d.next(264);for(X.write_shift(4,13),x=0;x<65;++x)X.write_shift(4,0);for(x=0;x<m.length;++x){var V=d.next(b);for(V.write_shift(1,0),v=0;v<f.length;++v)if(f[v]!=null)switch(w[v]){case"L":V.write_shift(1,m[x][v]==null?63:m[x][v]?84:70);break;case"B":V.write_shift(8,m[x][v]||0,"f");break;case"N":var F="0";for(typeof m[x][v]=="number"&&(F=m[x][v].toFixed(A[v]||0)),g=0;g<N[v]-F.length;++g)V.write_shift(1,32);V.write_shift(1,F,"sbcs");break;case"D":m[x][v]?(V.write_shift(4,("0000"+m[x][v].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(m[x][v].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+m[x][v].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var q=String(m[x][v]!=null?m[x][v]:"").slice(0,N[v]);for(V.write_shift(1,q,"sbcs"),g=0;g<N[v]-q.length;++g)V.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:r,from_sheet:l}}(),yB=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+as(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(f,m){var p=e[m];return typeof p=="number"?kv(p):p},r=function(f,m,p){var x=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?f:kv(x)};e["|"]=254;function s(f,m){switch(m.type){case"base64":return n(lr(f),m);case"binary":return n(f,m);case"buffer":return n(Ve&&Buffer.isBuffer(f)?f.toString("binary"):ui(f),m);case"array":return n(ai(f),m)}throw new Error("Unrecognized type "+m.type)}function n(f,m){var p=f.split(/[\n\r]+/),x=-1,v=-1,g=0,b=0,y=[],w=[],N=null,A={},S=[],C=[],T=[],D=0,R;for(+m.codepage>=0&&Or(+m.codepage);g!==p.length;++g){D=0;var j=p[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,a),B=j.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),X=B[0],V;if(j.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&w.push(j.slice(3).replace(/;;/g,";"));break;case"C":var F=!1,q=!1,te=!1,H=!1,le=-1,W=-1;for(b=1;b<B.length;++b)switch(B[b].charAt(0)){case"A":break;case"X":v=parseInt(B[b].slice(1))-1,q=!0;break;case"Y":for(x=parseInt(B[b].slice(1))-1,q||(v=0),R=y.length;R<=x;++R)y[R]=[];break;case"K":V=B[b].slice(1),V.charAt(0)==='"'?V=V.slice(1,V.length-1):V==="TRUE"?V=!0:V==="FALSE"?V=!1:isNaN(Ur(V))?isNaN(ml(V).getDate())||(V=Zt(V)):(V=Ur(V),N!==null&&Rl(N)&&(V=Dd(V))),F=!0;break;case"E":H=!0;var _=Ji(B[b].slice(1),{r:x,c:v});y[x][v]=[y[x][v],_];break;case"S":te=!0,y[x][v]=[y[x][v],"S5S"];break;case"G":break;case"R":le=parseInt(B[b].slice(1))-1;break;case"C":W=parseInt(B[b].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+j)}if(F&&(y[x][v]&&y[x][v].length==2?y[x][v][0]=V:y[x][v]=V,N=null),te){if(H)throw new Error("SYLK shared formula cannot have own formula");var G=le>-1&&y[le][W];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");y[x][v][1]=vA(G[1],{r:x-le,c:v-W})}break;case"F":var Y=0;for(b=1;b<B.length;++b)switch(B[b].charAt(0)){case"X":v=parseInt(B[b].slice(1))-1,++Y;break;case"Y":for(x=parseInt(B[b].slice(1))-1,R=y.length;R<=x;++R)y[R]=[];break;case"M":D=parseInt(B[b].slice(1))/20;break;case"F":break;case"G":break;case"P":N=w[parseInt(B[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=B[b].slice(1).split(" "),R=parseInt(T[0],10);R<=parseInt(T[1],10);++R)D=parseInt(T[2],10),C[R-1]=D===0?{hidden:!0}:{wch:D},xl(C[R-1]);break;case"C":v=parseInt(B[b].slice(1))-1,C[v]||(C[v]={});break;case"R":x=parseInt(B[b].slice(1))-1,S[x]||(S[x]={}),D>0?(S[x].hpt=D,S[x].hpx=dc(D)):D===0&&(S[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+j)}Y<1&&(N=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+j)}}return S.length>0&&(A["!rows"]=S),C.length>0&&(A["!cols"]=C),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,A]}function l(f,m){var p=s(f,m),x=p[0],v=p[1],g=Ol(x,m);return as(v).forEach(function(b){g[b]=v[b]}),g}function o(f,m){return En(l(f,m),m)}function c(f,m,p,x){var v="C;Y"+(p+1)+";X"+(x+1)+";K";switch(f.t){case"n":v+=f.v||0,f.f&&!f.F&&(v+=";E"+sP(f.f,{r:p,c:x}));break;case"b":v+=f.v?"TRUE":"FALSE";break;case"e":v+=f.w||f.v;break;case"d":v+='"'+(f.w||f.v)+'"';break;case"s":v+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(f,m){m.forEach(function(p,x){var v="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=X0(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=K0(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&f.push(v)})}function d(f,m){m.forEach(function(p,x){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*pA(p.hpx)+";"),v.length>2&&f.push(v+"R"+(x+1))})}function h(f,m){var p=["ID;PWXL;N;E"],x=[],v=Et(f["!ref"]),g,b=Array.isArray(f),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&u(p,f["!cols"]),f["!rows"]&&d(p,f["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var w=v.s.r;w<=v.e.r;++w)for(var N=v.s.c;N<=v.e.c;++N){var A=je({r:w,c:N});g=b?(f[w]||[])[N]:f[A],!(!g||g.v==null&&(!g.f||g.F))&&x.push(c(g,f,w,N))}return p.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:l,from_sheet:h}}(),vB=function(){function e(n,l){switch(l.type){case"base64":return t(lr(n),l);case"binary":return t(n,l);case"buffer":return t(Ve&&Buffer.isBuffer(n)?n.toString("binary"):ui(n),l);case"array":return t(ai(n),l)}throw new Error("Unrecognized type "+l.type)}function t(n,l){for(var o=n.split(`
`),c=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var f=o[d].trim().split(","),m=f[0],p=f[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[c][u]=!0:x==="FALSE"?h[c][u]=!1:isNaN(Ur(p))?isNaN(ml(p).getDate())?h[c][u]=p:h[c][u]=Zt(p):h[c][u]=Ur(p),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),h}function a(n,l){return Ol(e(n,l),l)}function r(n,l){return En(a(n,l),l)}var s=function(){var n=function(c,u,d,h,f){c.push(u),c.push(d+","+h),c.push('"'+f.replace(/"/g,'""')+'"')},l=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=Et(c["!ref"]),h,f=Array.isArray(c);n(u,"TABLE",0,1,"sheetjs"),n(u,"VECTORS",0,d.e.r-d.s.r+1,""),n(u,"TUPLES",0,d.e.c-d.s.c+1,""),n(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){l(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var x=je({r:m,c:p});if(h=f?(c[m]||[])[p]:c[x],!h){l(u,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?l(u,1,0,"="+h.f):l(u,1,0,""):l(u,0,v,"V");break;case"b":l(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Sr(h.z||De[14],La(Zt(h.v)))),l(u,0,h.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var g=`\r
`,b=u.join(g);return b}}();return{to_workbook:r,to_sheet:a,from_sheet:s}}(),bB=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(h,f){for(var m=h.split(`
`),p=-1,x=-1,v=0,g=[];v!==m.length;++v){var b=m[v].trim().split(":");if(b[0]==="cell"){var y=Ra(b[1]);if(g.length<=y.r)for(p=g.length;p<=y.r;++p)g[p]||(g[p]=[]);switch(p=y.r,x=y.c,b[2]){case"t":g[p][x]=e(b[3]);break;case"v":g[p][x]=+b[3];break;case"vtf":var w=b[b.length-1];case"vtc":switch(b[3]){case"nl":g[p][x]=!!+b[4];break;default:g[p][x]=+b[4];break}b[2]=="vtf"&&(g[p][x]=[g[p][x],w])}}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function r(h,f){return Ol(a(h,f),f)}function s(h,f){return En(r(h,f),f)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],m=[],p,x="",v=Dl(h["!ref"]),g=Array.isArray(h),b=v.s.r;b<=v.e.r;++b)for(var y=v.s.c;y<=v.e.c;++y)if(x=je({r:b,c:y}),p=g?(h[b]||[])[y]:h[x],!(!p||p.v==null||p.t==="z")){switch(m=["cell",x,"t"],p.t){case"s":case"str":m.push(t(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=t(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=La(Zt(p.v));m[2]="vtc",m[3]="nd",m[4]=""+w,m[5]=p.w||Sr(p.z||De[14],w);break;case"e":continue}f.push(m.join(":"))}return f.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[n,l,o,l,u(h),c].join(`
`)}return{to_workbook:s,to_sheet:r,from_sheet:d}}(),cc=function(){function e(d,h,f,m,p){p.raw?h[f][m]=d:d===""||(d==="TRUE"?h[f][m]=!0:d==="FALSE"?h[f][m]=!1:isNaN(Ur(d))?isNaN(ml(d).getDate())?h[f][m]=d:h[f][m]=Zt(d):h[f][m]=Ur(d))}function t(d,h){var f=h||{},m=[];if(!d||d.length===0)return m;for(var p=d.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var v=10,g=0,b=0;b<=x;++b)g=p[b].indexOf(" "),g==-1?g=p[b].length:g++,v=Math.max(v,g);for(b=0;b<=x;++b){m[b]=[];var y=0;for(e(p[b].slice(0,v).trim(),m,b,y,f),y=1;y<=(p[b].length-v)/10+1;++y)e(p[b].slice(v+(y-1)*10,v+y*10).trim(),m,b,y,f)}return f.sheetRows&&(m=m.slice(0,f.sheetRows)),m}var a={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function s(d){for(var h={},f=!1,m=0,p=0;m<d.length;++m)(p=d.charCodeAt(m))==34?f=!f:!f&&p in a&&(h[p]=(h[p]||0)+1);p=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&p.push([h[m],m]);if(!p.length){h=r;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&p.push([h[m],m])}return p.sort(function(x,v){return x[0]-v[0]||r[x[1]]-r[v[1]]}),a[p.pop()[1]]||44}function n(d,h){var f=h||{},m="",p=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=s(d.slice(0,1024)):f&&f.FS?m=f.FS:m=s(d.slice(0,1024));var v=0,g=0,b=0,y=0,w=0,N=m.charCodeAt(0),A=!1,S=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var T=f.dateNF!=null?DL(f.dateNF):null;function D(){var R=d.slice(y,w),j={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)j.t="z";else if(f.raw)j.t="s",j.v=R;else if(R.trim().length===0)j.t="s",j.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(j.t="s",j.v=R.slice(2,-1).replace(/""/g,'"')):iP(R)?(j.t="n",j.f=R.slice(1)):(j.t="s",j.v=R);else if(R=="TRUE")j.t="b",j.v=!0;else if(R=="FALSE")j.t="b",j.v=!1;else if(!isNaN(b=Ur(R)))j.t="n",f.cellText!==!1&&(j.w=R),j.v=b;else if(!isNaN(ml(R).getDate())||T&&R.match(T)){j.z=f.dateNF||De[14];var B=0;T&&R.match(T)&&(R=OL(R,f.dateNF,R.match(T)||[]),B=1),f.cellDates?(j.t="d",j.v=Zt(R,B)):(j.t="n",j.v=La(Zt(R,B))),f.cellText!==!1&&(j.w=Sr(j.z,j.v instanceof Date?La(j.v):j.v)),f.cellNF||delete j.z}else j.t="s",j.v=R;if(j.t=="z"||(f.dense?(p[v]||(p[v]=[]),p[v][g]=j):p[je({c:g,r:v})]=j),y=w+1,C=d.charCodeAt(y),x.e.c<g&&(x.e.c=g),x.e.r<v&&(x.e.r=v),S==N)++g;else if(g=0,++v,f.sheetRows&&f.sheetRows<=v)return!0}e:for(;w<d.length;++w)switch(S=d.charCodeAt(w)){case 34:C===34&&(A=!A);break;case N:case 10:case 13:if(!A&&D())break e;break}return w-y>0&&D(),p["!ref"]=Ge(x),p}function l(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?n(d,h):Ol(t(d,h),h)}function o(d,h){var f="",m=h.type=="string"?[0,0,0,0]:rg(d,h);switch(h.type){case"base64":f=lr(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):h.codepage&&typeof $s<"u"?f=$s.utils.decode(h.codepage,d):f=Ve&&Buffer.isBuffer(d)?d.toString("binary"):ui(d);break;case"array":f=ai(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?f=st(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=st(f):h.type=="binary"&&typeof $s<"u"&&h.codepage&&(f=$s.utils.decode(h.codepage,$s.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?bB.to_sheet(h.type=="string"?f:st(f),h):l(f,h)}function c(d,h){return En(o(d,h),h)}function u(d){for(var h=[],f=Et(d["!ref"]),m,p=Array.isArray(d),x=f.s.r;x<=f.e.r;++x){for(var v=[],g=f.s.c;g<=f.e.c;++g){var b=je({r:x,c:g});if(m=p?(d[x]||[])[g]:d[b],!m||m.v==null){v.push("          ");continue}for(var y=(m.w||(js(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(g===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function wB(e,t){var a=t||{},r=!!a.WTF;a.WTF=!0;try{var s=yB.to_workbook(e,a);return a.WTF=r,s}catch(n){if(a.WTF=r,!n.message.match(/SYLK bad record ID/)&&r)throw n;return cc.to_workbook(e,t)}}var Oo=function(){function e(_,G,Y){if(_){aa(_,_.l||0);for(var z=Y.Enum||le;_.l<_.length;){var ie=_.read_shift(2),xe=z[ie]||z[65535],ne=_.read_shift(2),he=_.l+ne,ce=xe.f&&xe.f(_,ne,Y);if(_.l=he,G(ce,xe,ie))return}}}function t(_,G){switch(G.type){case"base64":return a(Rr(lr(_)),G);case"binary":return a(Rr(_),G);case"buffer":case"array":return a(_,G)}throw"Unsupported type "+G.type}function a(_,G){if(!_)return _;var Y=G||{},z=Y.dense?[]:{},ie="Sheet1",xe="",ne=0,he={},ce=[],Te=[],P={s:{r:0,c:0},e:{r:0,c:0}},Ke=Y.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)Y.Enum=le,e(_,function(ge,Me,Mt){switch(Mt){case 0:Y.vers=ge,ge>=4096&&(Y.qpro=!0);break;case 6:P=ge;break;case 204:ge&&(xe=ge);break;case 222:xe=ge;break;case 15:case 51:Y.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:Mt==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=Y.dateNF||De[14],Y.cellDates&&(ge[1].t="d",ge[1].v=Dd(ge[1].v))),Y.qpro&&ge[3]>ne&&(z["!ref"]=Ge(P),he[ie]=z,ce.push(ie),z=Y.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},ne=ge[3],ie=xe||"Sheet"+(ne+1),xe="");var Qt=Y.dense?(z[ge[0].r]||[])[ge[0].c]:z[je(ge[0])];if(Qt){Qt.t=ge[1].t,Qt.v=ge[1].v,ge[1].z!=null&&(Qt.z=ge[1].z),ge[1].f!=null&&(Qt.f=ge[1].f);break}Y.dense?(z[ge[0].r]||(z[ge[0].r]=[]),z[ge[0].r][ge[0].c]=ge[1]):z[je(ge[0])]=ge[1];break}},Y);else if(_[2]==26||_[2]==14)Y.Enum=W,_[2]==14&&(Y.qpro=!0,_.l=0),e(_,function(ge,Me,Mt){switch(Mt){case 204:ie=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>ne&&(z["!ref"]=Ge(P),he[ie]=z,ce.push(ie),z=Y.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},ne=ge[3],ie="Sheet"+(ne+1)),Ke>0&&ge[0].r>=Ke)break;Y.dense?(z[ge[0].r]||(z[ge[0].r]=[]),z[ge[0].r][ge[0].c]=ge[1]):z[je(ge[0])]=ge[1],P.e.c<ge[0].c&&(P.e.c=ge[0].c),P.e.r<ge[0].r&&(P.e.r=ge[0].r);break;case 27:ge[14e3]&&(Te[ge[14e3][0]]=ge[14e3][1]);break;case 1537:Te[ge[0]]=ge[1],ge[0]==ne&&(ie=ge[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(z["!ref"]=Ge(P),he[xe||ie]=z,ce.push(xe||ie),!Te.length)return{SheetNames:ce,Sheets:he};for(var Fe={},$e=[],Ne=0;Ne<Te.length;++Ne)he[ce[Ne]]?($e.push(Te[Ne]||ce[Ne]),Fe[Te[Ne]]=he[Te[Ne]]||he[ce[Ne]]):($e.push(Te[Ne]),Fe[Te[Ne]]={"!ref":"A1"});return{SheetNames:$e,Sheets:Fe}}function r(_,G){var Y=G||{};if(+Y.codepage>=0&&Or(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var z=Cm(),ie=Et(_["!ref"]),xe=Array.isArray(_),ne=[];kr(z,0,n(1030)),kr(z,6,c(ie));for(var he=Math.min(ie.e.r,8191),ce=ie.s.r;ce<=he;++ce)for(var Te=la(ce),P=ie.s.c;P<=ie.e.c;++P){ce===ie.s.r&&(ne[P]=Vt(P));var Ke=ne[P]+Te,Fe=xe?(_[ce]||[])[P]:_[Ke];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?kr(z,13,m(ce,P,Fe.v)):kr(z,14,x(ce,P,Fe.v));else{var $e=js(Fe);kr(z,15,h(ce,P,$e.slice(0,239)))}}return kr(z,1),z.end()}function s(_,G){var Y=G||{};if(+Y.codepage>=0&&Or(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var z=Cm();kr(z,0,l(_));for(var ie=0,xe=0;ie<_.SheetNames.length;++ie)(_.Sheets[_.SheetNames[ie]]||{})["!ref"]&&kr(z,27,H(_.SheetNames[ie],xe++));var ne=0;for(ie=0;ie<_.SheetNames.length;++ie){var he=_.Sheets[_.SheetNames[ie]];if(!(!he||!he["!ref"])){for(var ce=Et(he["!ref"]),Te=Array.isArray(he),P=[],Ke=Math.min(ce.e.r,8191),Fe=ce.s.r;Fe<=Ke;++Fe)for(var $e=la(Fe),Ne=ce.s.c;Ne<=ce.e.c;++Ne){Fe===ce.s.r&&(P[Ne]=Vt(Ne));var ge=P[Ne]+$e,Me=Te?(he[Fe]||[])[Ne]:he[ge];if(!(!Me||Me.t=="z"))if(Me.t=="n")kr(z,23,D(Fe,Ne,ne,Me.v));else{var Mt=js(Me);kr(z,22,S(Fe,Ne,ne,Mt.slice(0,239)))}}++ne}}return kr(z,1),z.end()}function n(_){var G=Bt(2);return G.write_shift(2,_),G}function l(_){var G=Bt(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var Y=0,z=0,ie=0,xe=0;xe<_.SheetNames.length;++xe){var ne=_.SheetNames[xe],he=_.Sheets[ne];if(!(!he||!he["!ref"])){++ie;var ce=Dl(he["!ref"]);Y<ce.e.r&&(Y=ce.e.r),z<ce.e.c&&(z=ce.e.c)}}return Y>8191&&(Y=8191),G.write_shift(2,Y),G.write_shift(1,ie),G.write_shift(1,z),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(_,G,Y){var z={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&Y.qpro?(z.s.c=_.read_shift(1),_.l++,z.s.r=_.read_shift(2),z.e.c=_.read_shift(1),_.l++,z.e.r=_.read_shift(2),z):(z.s.c=_.read_shift(2),z.s.r=_.read_shift(2),G==12&&Y.qpro&&(_.l+=2),z.e.c=_.read_shift(2),z.e.r=_.read_shift(2),G==12&&Y.qpro&&(_.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(_){var G=Bt(8);return G.write_shift(2,_.s.c),G.write_shift(2,_.s.r),G.write_shift(2,_.e.c),G.write_shift(2,_.e.r),G}function u(_,G,Y){var z=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(z[0].c=_.read_shift(1),z[3]=_.read_shift(1),z[0].r=_.read_shift(2),_.l+=2):(z[2]=_.read_shift(1),z[0].c=_.read_shift(2),z[0].r=_.read_shift(2)),z}function d(_,G,Y){var z=_.l+G,ie=u(_,G,Y);if(ie[1].t="s",Y.vers==20768){_.l++;var xe=_.read_shift(1);return ie[1].v=_.read_shift(xe,"utf8"),ie}return Y.qpro&&_.l++,ie[1].v=_.read_shift(z-_.l,"cstr"),ie}function h(_,G,Y){var z=Bt(7+Y.length);z.write_shift(1,255),z.write_shift(2,G),z.write_shift(2,_),z.write_shift(1,39);for(var ie=0;ie<z.length;++ie){var xe=Y.charCodeAt(ie);z.write_shift(1,xe>=128?95:xe)}return z.write_shift(1,0),z}function f(_,G,Y){var z=u(_,G,Y);return z[1].v=_.read_shift(2,"i"),z}function m(_,G,Y){var z=Bt(7);return z.write_shift(1,255),z.write_shift(2,G),z.write_shift(2,_),z.write_shift(2,Y,"i"),z}function p(_,G,Y){var z=u(_,G,Y);return z[1].v=_.read_shift(8,"f"),z}function x(_,G,Y){var z=Bt(13);return z.write_shift(1,255),z.write_shift(2,G),z.write_shift(2,_),z.write_shift(8,Y,"f"),z}function v(_,G,Y){var z=_.l+G,ie=u(_,G,Y);if(ie[1].v=_.read_shift(8,"f"),Y.qpro)_.l=z;else{var xe=_.read_shift(2);w(_.slice(_.l,_.l+xe),ie),_.l+=xe}return ie}function g(_,G,Y){var z=G&32768;return G&=-32769,G=(z?_:0)+(G>=8192?G-16384:G),(z?"":"$")+(Y?Vt(G):la(G))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(_,G){aa(_,0);for(var Y=[],z=0,ie="",xe="",ne="",he="";_.l<_.length;){var ce=_[_.l++];switch(ce){case 0:Y.push(_.read_shift(8,"f"));break;case 1:xe=g(G[0].c,_.read_shift(2),!0),ie=g(G[0].r,_.read_shift(2),!1),Y.push(xe+ie);break;case 2:{var Te=g(G[0].c,_.read_shift(2),!0),P=g(G[0].r,_.read_shift(2),!1);xe=g(G[0].c,_.read_shift(2),!0),ie=g(G[0].r,_.read_shift(2),!1),Y.push(Te+P+":"+xe+ie)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(_.read_shift(2));break;case 6:{for(var Ke="";ce=_[_.l++];)Ke+=String.fromCharCode(ce);Y.push('"'+Ke.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:he=Y.pop(),ne=Y.pop(),Y.push(["AND","OR"][ce-20]+"("+ne+","+he+")");break;default:if(ce<32&&y[ce])he=Y.pop(),ne=Y.pop(),Y.push(ne+y[ce]+he);else if(b[ce]){if(z=b[ce][1],z==69&&(z=_[_.l++]),z>Y.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+Y.join("|")+"|");return}var Fe=Y.slice(-z);Y.length-=z,Y.push(b[ce][0]+"("+Fe.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}Y.length==1?G[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function N(_){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=_.read_shift(2),G[3]=_[_.l++],G[0].c=_[_.l++],G}function A(_,G){var Y=N(_);return Y[1].t="s",Y[1].v=_.read_shift(G-4,"cstr"),Y}function S(_,G,Y,z){var ie=Bt(6+z.length);ie.write_shift(2,_),ie.write_shift(1,Y),ie.write_shift(1,G),ie.write_shift(1,39);for(var xe=0;xe<z.length;++xe){var ne=z.charCodeAt(xe);ie.write_shift(1,ne>=128?95:ne)}return ie.write_shift(1,0),ie}function C(_,G){var Y=N(_);Y[1].v=_.read_shift(2);var z=Y[1].v>>1;if(Y[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return Y[1].v=z,Y}function T(_,G){var Y=N(_),z=_.read_shift(4),ie=_.read_shift(4),xe=_.read_shift(2);if(xe==65535)return z===0&&ie===3221225472?(Y[1].t="e",Y[1].v=15):z===0&&ie===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var ne=xe&32768;return xe=(xe&32767)-16446,Y[1].v=(1-ne*2)*(ie*Math.pow(2,xe+32)+z*Math.pow(2,xe)),Y}function D(_,G,Y,z){var ie=Bt(14);if(ie.write_shift(2,_),ie.write_shift(1,Y),ie.write_shift(1,G),z==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var xe=0,ne=0,he=0,ce=0;return z<0&&(xe=1,z=-z),ne=Math.log2(z)|0,z/=Math.pow(2,ne-31),ce=z>>>0,ce&2147483648||(z/=2,++ne,ce=z>>>0),z-=ce,ce|=2147483648,ce>>>=0,z*=Math.pow(2,32),he=z>>>0,ie.write_shift(4,he),ie.write_shift(4,ce),ne+=16383+(xe?32768:0),ie.write_shift(2,ne),ie}function R(_,G){var Y=T(_);return _.l+=G-14,Y}function j(_,G){var Y=N(_),z=_.read_shift(4);return Y[1].v=z>>6,Y}function B(_,G){var Y=N(_),z=_.read_shift(8,"f");return Y[1].v=z,Y}function X(_,G){var Y=B(_);return _.l+=G-10,Y}function V(_,G){return _[_.l+G-1]==0?_.read_shift(G,"cstr"):""}function F(_,G){var Y=_[_.l++];Y>G-1&&(Y=G-1);for(var z="";z.length<Y;)z+=String.fromCharCode(_[_.l++]);return z}function q(_,G,Y){if(!(!Y.qpro||G<21)){var z=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var ie=_.read_shift(G-21,"cstr");return[z,ie]}}function te(_,G){for(var Y={},z=_.l+G;_.l<z;){var ie=_.read_shift(2);if(ie==14e3){for(Y[ie]=[0,""],Y[ie][0]=_.read_shift(2);_[_.l];)Y[ie][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return Y}function H(_,G){var Y=Bt(5+_.length);Y.write_shift(2,14e3),Y.write_shift(2,G);for(var z=0;z<_.length;++z){var ie=_.charCodeAt(z);Y[Y.l++]=ie>127?95:ie}return Y[Y.l++]=0,Y}var le={0:{n:"BOF",f:_t},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:V},222:{n:"SHEETNAMELP",f:F},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:V},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:t}}();function EB(e){var t={},a=e.match(Sa),r=0,s=!1;if(a)for(;r!=a.length;++r){var n=Ce(a[r]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=Op[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}var NB=function(){var e=lc("t"),t=lc("rPr");function a(n){var l=n.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Xe(l[1])},c=n.match(t);return c&&(o.s=EB(c[1])),o}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(s).map(a).filter(function(o){return o.v})}}(),SB=function(){var t=/(\r\n|\n)/g;function a(s,n,l){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),n.push('<span style="'+o.join("")+'">'),s.b&&(n.push("<b>"),l.push("</b>")),s.i&&(n.push("<i>"),l.push("</i>")),s.strike&&(n.push("<s>"),l.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(n.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),s}function r(s){var n=[[],s.v,[]];return s.v?(s.s&&a(s.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(r).join("")}}(),TB=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AB=/<(?:\w+:)?r>/,CB=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wp(e,t){var a=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Xe(st(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=st(e),a&&(r.h=Pp(r.t))):e.match(AB)&&(r.r=st(e),r.t=Xe(st((e.replace(CB,"").match(TB)||[]).join("").replace(Sa,""))),a&&(r.h=SB(NB(r.r)))),r):{t:""}}var kB=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jB=/<(?:\w+:)?(?:si|sstItem)>/g,_B=/<\/(?:\w+:)?(?:si|sstItem)>/;function RB(e,t){var a=[],r="";if(!e)return a;var s=e.match(kB);if(s){r=s[2].replace(jB,"").split(_B);for(var n=0;n!=r.length;++n){var l=Wp(r[n].trim(),t);l!=null&&(a[a.length]=l)}s=Ce(s[1]),a.Count=s.count,a.Unique=s.uniqueCount}return a}function DB(e){return[e.read_shift(4),e.read_shift(4)]}function OB(e,t){var a=[],r=!1;return Ds(e,function(n,l,o){switch(o){case 159:a.Count=n[0],a.Unique=n[1];break;case 19:a.push(n);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function uA(e){for(var t=[],a=e.split(""),r=0;r<a.length;++r)t[r]=a[r].charCodeAt(0);return t}function Es(e,t){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),a}function FB(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Es(e,4),t.U=Es(e,4),t.W=Es(e,4),t}function LB(e){for(var t=e.read_shift(4),a=e.l+t-4,r={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=n,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function MB(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(LB(e));return t}function UB(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function BB(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Es(e,4),t.U=Es(e,4),t.W=Es(e,4),t}function IB(e){var t=BB(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function dA(e,t){var a=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=r.Flags==36;break;case 26625:s=r.Flags==4;break;case 0:s=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function fA(e,t){var a={},r=e.l+t;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function PB(e){var t=Es(e);switch(t.Minor){case 2:return[t.Minor,VB(e)];case 3:return[t.Minor,zB()];case 4:return[t.Minor,HB(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function VB(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),r=dA(e,a),s=fA(e,e.length-e.l);return{t:"Std",h:r,v:s}}function zB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function HB(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(Sa,function(n){var l=Ce(n);switch(ns(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){r[o]=l[o]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function GB(e,t){var a={},r=a.EncryptionVersionInfo=Es(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,a.EncryptionHeader=dA(e,s),t-=s,a.EncryptionVerifier=fA(e,t),a}function $B(e){var t={},a=t.EncryptionVersionInfo=Es(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function YB(e){var t=0,a,r=uA(e),s=r.length+1,n,l,o,c,u;for(a=gn(s),a[0]=r.length,n=1;n!=s;++n)a[n]=r[n-1];for(n=s-1;n>=0;--n)l=a[n],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var hA=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},s=function(l,o){return r(l^o)},n=function(l){for(var o=t[l.length-1],c=104,u=l.length-1;u>=0;--u)for(var d=l[u],h=0;h!=7;++h)d&64&&(o^=a[c]),d*=2,--c;return o};return function(l){for(var o=uA(l),c=n(o),u=o.length,d=gn(16),h=0;h!=16;++h)d[h]=0;var f,m,p;for((u&1)===1&&(f=c>>8,d[u]=s(e[0],f),--u,f=c&255,m=o[o.length-1],d[u]=s(m,f));u>0;)--u,f=c>>8,d[u]=s(o[u],f),--u,f=c&255,d[u]=s(o[u],f);for(u=15,p=15-o.length;p>0;)f=c>>8,d[u]=s(e[p],f),--u,--p,f=c&255,d[u]=s(o[u],f),--u,--p;return d}}(),qB=function(e,t,a,r,s){s||(s=t),r||(r=hA(e));var n,l;for(n=0;n!=t.length;++n)l=t[n],l^=r[a],l=(l>>5|l<<3)&255,s[n]=l,++a;return[s,a,r]},XB=function(e){var t=0,a=hA(e);return function(r){var s=qB("",r,t,a);return t=s[1],s[0]}};function KB(e,t,a,r){var s={key:_t(e),verificationBytes:_t(e)};return a.password&&(s.verifier=YB(a.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=XB(a.password)),s}function WB(e,t,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=$B(e):r.Data=GB(e,t),r}function ZB(e,t,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?WB(e,t-2,r):KB(e,a.biff>=8?t:t-2,a,r),r}var QB=function(){function e(s,n){switch(n.type){case"base64":return t(lr(s),n);case"binary":return t(s,n);case"buffer":return t(Ve&&Buffer.isBuffer(s)?s.toString("binary"):ui(s),n);case"array":return t(ai(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var l=n||{},o=l.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,m=0,p,x=-1;p=f.exec(d);){switch(p[0]){case"\\cell":var v=d.slice(m,f.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++x,v.length){var g={v,t:"s"};Array.isArray(o)?o[h][x]=g:o[je({r:h,c:x})]=g}break}m=f.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Ge(u),o}function a(s,n){return En(e(s,n),n)}function r(s){for(var n=["{\\rtf1\\ansi"],l=Et(s["!ref"]),o,c=Array.isArray(s),u=l.s.r;u<=l.e.r;++u){n.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)n.push("\\cellx"+(d+1));for(n.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var h=je({r:u,c:d});o=c?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(n.push(" "+(o.w||(js(o),o.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:r}}();function JB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function uc(e){for(var t=0,a=1;t!=3;++t)a=a*256+(e[t]>255?255:e[t]<0?0:e[t]);return a.toString(16).toUpperCase().slice(1)}function eI(e){var t=e[0]/255,a=e[1]/255,r=e[2]/255,s=Math.max(t,a,r),n=Math.min(t,a,r),l=s-n;if(l===0)return[0,0,t];var o=0,c=0,u=s+n;switch(c=l/(u>1?2-u:u),s){case t:o=((a-r)/l+6)%6;break;case a:o=(r-t)/l+2;break;case r:o=(t-a)/l+4;break}return[o/6,c,u/2]}function tI(e){var t=e[0],a=e[1],r=e[2],s=a*2*(r<.5?r:1-r),n=r-s/2,l=[n,n,n],o=6*t,c;if(a!==0)switch(o|0){case 0:case 6:c=s*o,l[0]+=s,l[1]+=c;break;case 1:c=s*(2-o),l[0]+=c,l[1]+=s;break;case 2:c=s*(o-2),l[1]+=s,l[2]+=c;break;case 3:c=s*(4-o),l[1]+=c,l[2]+=s;break;case 4:c=s*(o-4),l[2]+=s,l[0]+=c;break;case 5:c=s*(6-o),l[2]+=c,l[0]+=s;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function q0(e,t){if(t===0)return e;var a=eI(JB(e));return t<0?a[2]=a[2]*(1+t):a[2]=1-(1-a[2])*(1-t),uc(tI(a))}var mA=6,aI=15,rI=1,Ca=mA;function X0(e){return Math.floor((e+Math.round(128/Ca)/256)*Ca)}function K0(e){return Math.floor((e-5)/Ca*100+.5)/100}function Rm(e){return Math.round((e*Ca+5)/Ca*256)/256}function qf(e){return Rm(K0(X0(e)))}function Zp(e){var t=Math.abs(e-qf(e)),a=Ca;if(t>.005)for(Ca=rI;Ca<aI;++Ca)Math.abs(e-qf(e))<=t&&(t=Math.abs(e-qf(e)),a=Ca);Ca=a}function xl(e){e.width?(e.wpx=X0(e.width),e.wch=K0(e.wpx),e.MDW=Ca):e.wpx?(e.wch=K0(e.wpx),e.width=Rm(e.wch),e.MDW=Ca):typeof e.wch=="number"&&(e.width=Rm(e.wch),e.wpx=X0(e.width),e.MDW=Ca),e.customWidth&&delete e.customWidth}var sI=96,xA=sI;function pA(e){return e*96/xA}function dc(e){return e*xA/96}var nI={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function iI(e,t,a,r){t.Borders=[];var s={},n=!1;(e[0].match(Sa)||[]).forEach(function(l){var o=Ce(l);switch(ns(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=ot(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=ot(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in borders")}})}function lI(e,t,a,r){t.Fills=[];var s={},n=!1;(e[0].match(Sa)||[]).forEach(function(l){var o=Ce(l);switch(ns(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fills")}})}function oI(e,t,a,r){t.Fonts=[];var s={},n=!1;(e[0].match(Sa)||[]).forEach(function(l){var o=Ce(l);switch(ns(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=st(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?ot(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?ot(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?ot(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?ot(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?ot(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?ot(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?ot(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Op[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=ot(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Xn[s.color.index];s.color.index==81&&(c=Xn[1]),c||(c=Xn[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&a.themeElements&&a.themeElements.clrScheme&&(s.color.rgb=q0(a.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fonts")}})}function cI(e,t,a){t.NumberFmt=[];for(var r=as(De),s=0;s<r.length;++s)t.NumberFmt[r[s]]=De[r[s]];var n=e[0].match(Sa);if(n)for(s=0;s<n.length;++s){var l=Ce(n[s]);switch(ns(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Xe(st(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}qn(o,c)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Su=["numFmtId","fillId","fontId","borderId","xfId"],Tu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function uI(e,t,a){t.CellXf=[];var r,s=!1;(e[0].match(Sa)||[]).forEach(function(n){var l=Ce(n),o=0;switch(ns(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],o=0;o<Su.length;++o)r[Su[o]]&&(r[Su[o]]=parseInt(r[Su[o]],10));for(o=0;o<Tu.length;++o)r[Tu[o]]&&(r[Tu[o]]=ot(r[Tu[o]]));if(t.NumberFmt&&r.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[o]){r.numFmtId=o;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=ot(l.wrapText)),r.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var dI=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&cI(h,d,u),(h=o.match(s))&&oI(h,d,c,u),(h=o.match(r))&&lI(h,d,c,u),(h=o.match(n))&&iI(h,d,c,u),(h=o.match(a))&&uI(h,d,u),d}}();function fI(e,t){var a=e.read_shift(2),r=ba(e);return[a,r]}function hI(e,t,a){var r={};r.sz=e.read_shift(2)/20;var s=NM(e);s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1);var n=e.read_shift(2);switch(n===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(r.underline=l);var o=e.read_shift(1);o>0&&(r.family=o);var c=e.read_shift(1);switch(c>0&&(r.charset=c),e.l++,r.color=EM(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ba(e),r}var mI=Ea;function xI(e,t){var a=e.l+t,r=e.read_shift(2),s=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:s}}var pI=Ea;function gI(e,t,a){var r={};r.NumberFmt=[];for(var s in De)r.NumberFmt[s]=De[s];r.CellXf=[],r.Fonts=[];var n=[],l=!1;return Ds(e,function(c,u,d){switch(d){case 44:r.NumberFmt[c[0]]=c[1],qn(c[1],c[0]);break;case 43:r.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=q0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&r.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:n.push(d),l=!0;break;case 38:n.pop(),l=!1;break;default:if(u.T>0)n.push(d);else if(u.T<0)n.pop();else if(!l||a.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}var yI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function vI(e,t,a){t.themeElements.clrScheme=[];var r={};(e[0].match(Sa)||[]).forEach(function(s){var n=Ce(s);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=n.val;break;case"<a:sysClr":r.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[yI.indexOf(n[0])]=r,r={}):r.name=n[0].slice(3,n[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function bI(){}function wI(){}var EI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,NI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,SI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function TI(e,t,a){t.themeElements={};var r;[["clrScheme",EI,vI],["fontScheme",NI,bI],["fmtScheme",SI,wI]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,t,a)})}var AI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function gA(e,t){(!e||e.length===0)&&(e=CI());var a,r={};if(!(a=e.match(AI)))throw new Error("themeElements not found in theme");return TI(a[0],r,t),r.raw=e,r}function CI(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var a=[kT];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function kI(e,t,a){var r=e.l+t,s=e.read_shift(4);if(s!==124226){if(!a.cellStyles){e.l=r;return}var n=e.slice(e.l);e.l=r;var l;try{l=CT(n,{type:"array"})}catch{return}var o=tr(l,"theme/theme/theme1.xml",!0);if(o)return gA(o,a)}}function jI(e){return e.read_shift(4)}function _I(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=RI(e,4);break;case 2:t.xclrValue=rA(e);break;case 3:t.xclrValue=jI(e);break;case 4:e.l+=4;break}return e.l+=8,t}function RI(e,t){return Ea(e,t)}function DI(e,t){return Ea(e,t)}function OI(e){var t=e.read_shift(2),a=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=_I(e);break;case 6:r[1]=DI(e,a);break;case 14:case 15:r[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+a)}return r}function FI(e,t){var a=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(OI(e,a-e.l));return{ixfe:r,ext:n}}function LI(e,t){t.forEach(function(a){switch(a[0]){}})}function MI(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ba(e)}}function UI(e){for(var t=[],a=e.read_shift(4);a-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function BI(e){return e.l+=4,e.read_shift(4)!=0}function II(e,t,a){var r={Types:[],Cell:[],Value:[]},s=a||{},n=[],l=!1,o=2;return Ds(e,function(c,u,d){switch(d){case 335:r.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?r.Cell.push({type:r.Types[h[0]-1].name,index:h[1]}):o==0&&r.Value.push({type:r.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:n.push(d),l=!0;break;case 36:n.pop(),l=!1;break;default:if(!u.T){if(!l||s.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function PI(e,t,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s=!1,n=2,l;return e.replace(Sa,function(o){var c=Ce(o);switch(ns(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<r.Types.length;++u)r.Types[u].name==c.name&&(l=r.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?r.Cell.push({type:r.Types[c.t-1].name,index:+c.v}):n==0&&r.Value.push({type:r.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),r}function VI(e){var t=[];if(!e)return t;var a=1;return(e.match(Sa)||[]).forEach(function(r){var s=Ce(r);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,t.push(s);break}}),t}function zI(e){var t={};t.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),t.r=je(a);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function HI(e,t,a){var r=[];return Ds(e,function(n,l,o){switch(o){case 63:r.push(n);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function GI(e,t,a,r){if(!e)return e;var s=r||{},n=!1;Ds(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!c.T){if(!n||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function $I(e,t){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][a].Target}function hb(e,t,a,r){var s=Array.isArray(e),n;t.forEach(function(l){var o=Ra(l.ref);if(s?(e[o.r]||(e[o.r]=[]),n=e[o.r][o.c]):n=e[l.ref],!n){n={t:"z"},s?e[o.r][o.c]=n:e[l.ref]=n;var c=Et(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Ge(c);u!==e["!ref"]&&(e["!ref"]=u)}n.c||(n.c=[]);var d={a:l.author,t:l.t,r:l.r,T:a};l.h&&(d.h=l.h);for(var h=n.c.length-1;h>=0;--h){if(!a&&n.c[h].T)return;a&&!n.c[h].T&&n.c.splice(h,1)}if(a&&r){for(h=0;h<r.length;++h)if(d.a==r[h].id){d.a=r[h].name||d.a;break}}n.c.push(d)})}function YI(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&a.push(o[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ce(o[0]),u={author:c.authorId&&a[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ra(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&Wp(h[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),r.push(u)}}}}),r}function qI(e,t){var a=[],r=!1,s={},n=0;return e.replace(Sa,function(o,c){var u=Ce(o);switch(ns(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&a.push(s);break;case"<text>":case"<text":n=c+o.length;break;case"</text>":s.t=e.slice(n,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),a}function XI(e,t){var a=[],r=!1;return e.replace(Sa,function(n){var l=Ce(n);switch(ns(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return n}),a}function KI(e){var t={};t.iauthor=e.read_shift(4);var a=fi(e);return t.rfx=a.s,t.ref=je(a.s),e.l+=16,t}var WI=ba;function ZI(e,t){var a=[],r=[],s={},n=!1;return Ds(e,function(o,c,u){switch(u){case 632:r.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}var QI="application/vnd.ms-office.vbaProject";function JI(e){var t=ze.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var s=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ze.utils.cfb_add(t,s,e.FileIndex[r].content)}}),ze.write(t)}function eP(){return{"!type":"dialog"}}function tP(){return{"!type":"dialog"}}function aP(){return{"!type":"macro"}}function rP(){return{"!type":"macro"}}var Ji=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function a(r,s,n,l){var o=!1,c=!1;n.length==0?c=!0:n.charAt(0)=="["&&(c=!0,n=n.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=n.length>0?parseInt(n,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+Vt(d)+(c?"":"$")+la(u)}return function(s,n){return t=n,s.replace(e,a)}}(),yA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sP=function(){return function(t,a){return t.replace(yA,function(r,s,n,l,o,c){var u=Gp(l)-(n?0:a.c),d=Hp(c)-(o?0:a.r),h=d==0?"":o?d+1:"["+d+"]",f=u==0?"":n?u+1:"["+u+"]";return s+"R"+h+"C"+f})}}();function vA(e,t){return e.replace(yA,function(a,r,s,n,l,o){return r+(s=="$"?s+n:Vt(Gp(n)+t.c))+(l=="$"?l+o:la(Hp(o)+t.r))})}function nP(e,t,a){var r=Dl(t),s=r.s,n=Ra(a),l={r:n.r-s.r,c:n.c-s.c};return vA(e,l)}function iP(e){return e.length!=1}function mb(e){return e.replace(/_xlfn\./g,"")}function kt(e){e.l+=1}function yn(e,t){var a=e.read_shift(t==1?1:2);return[a&16383,a>>14&1,a>>15&1]}function bA(e,t,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return wA(e);a.biff==12&&(r=4)}var s=e.read_shift(r),n=e.read_shift(r),l=yn(e,2),o=yn(e,2);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function wA(e){var t=yn(e,2),a=yn(e,2),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:a[0],c:s,cRel:a[1],rRel:a[2]}}}function lP(e,t,a){if(a.biff<8)return wA(e);var r=e.read_shift(a.biff==12?4:2),s=e.read_shift(a.biff==12?4:2),n=yn(e,2),l=yn(e,2);return{s:{r,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function EA(e,t,a){if(a&&a.biff>=2&&a.biff<=5)return oP(e);var r=e.read_shift(a&&a.biff==12?4:2),s=yn(e,2);return{r,c:s[0],cRel:s[1],rRel:s[2]}}function oP(e){var t=yn(e,2),a=e.read_shift(1);return{r:t[0],c:a,cRel:t[1],rRel:t[2]}}function cP(e){var t=e.read_shift(2),a=e.read_shift(2);return{r:t,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function uP(e,t,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return dP(e);var s=e.read_shift(r>=12?4:2),n=e.read_shift(2),l=(n&16384)>>14,o=(n&32768)>>15;if(n&=16383,o==1)for(;s>524287;)s-=1048576;if(l==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:l,rRel:o}}function dP(e){var t=e.read_shift(2),a=e.read_shift(1),r=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),s==1&&a>=128&&(a=a-256),{r:t,c:a,cRel:s,rRel:r}}function fP(e,t,a){var r=(e[e.l++]&96)>>5,s=bA(e,a.biff>=2&&a.biff<=5?6:8,a);return[r,s]}function hP(e,t,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),n=8;if(a)switch(a.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var l=bA(e,n,a);return[r,s,l]}function mP(e,t,a){var r=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}function xP(e,t,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),n=8;if(a)switch(a.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[r,s]}function pP(e,t,a){var r=(e[e.l++]&96)>>5,s=lP(e,t-1,a);return[r,s]}function gP(e,t,a){var r=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[r]}function xb(e){var t=e[e.l+1]&1,a=1;return e.l+=4,[t,a]}function yP(e,t,a){e.l+=2;for(var r=e.read_shift(a&&a.biff==2?1:2),s=[],n=0;n<=r;++n)s.push(e.read_shift(a&&a.biff==2?1:2));return s}function vP(e,t,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function bP(e,t,a){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(a&&a.biff==2?1:2)]}function wP(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EP(e,t,a){var r=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[r]}function NA(e){var t=e.read_shift(1),a=e.read_shift(1);return[t,a]}function NP(e){return e.read_shift(2),NA(e)}function SP(e){return e.read_shift(2),NA(e)}function TP(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=EA(e,0,a);return[r,s]}function AP(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=uP(e,0,a);return[r,s]}function CP(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var n=EA(e,0,a);return[r,s,n]}function kP(e,t,a){var r=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(a&&a.biff<=3?1:2);return[j7[s],AA[s],r]}function jP(e,t,a){var r=e[e.l++],s=e.read_shift(1),n=a&&a.biff<=3?[r==88?-1:0,e.read_shift(1)]:_P(e);return[s,(n[0]===0?AA:k7)[n[1]]]}function _P(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function RP(e,t,a){e.l+=a&&a.biff==2?3:4}function DP(e,t,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function OP(e){return e.l++,hi[e.read_shift(1)]}function FP(e){return e.l++,e.read_shift(2)}function LP(e){return e.l++,e.read_shift(1)!==0}function MP(e){return e.l++,ma(e)}function UP(e,t,a){return e.l++,Pc(e,t-1,a)}function BP(e,t){var a=[e.read_shift(1)];if(t==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=St(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:a[1]=hi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=ma(e);break;case 2:a[1]=mi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function IP(e,t,a){for(var r=e.read_shift(a.biff==12?4:2),s=[],n=0;n!=r;++n)s.push((a.biff==12?fi:Od)(e));return s}function PP(e,t,a){var r=0,s=0;a.biff==12?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,--s==0&&(s=256));for(var n=0,l=[];n!=r&&(l[n]=[]);++n)for(var o=0;o!=s;++o)l[n][o]=BP(e,a.biff);return l}function VP(e,t,a){var r=e.read_shift(1)>>>5&3,s=!a||a.biff>=8?4:2,n=e.read_shift(s);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,n]}function zP(e,t,a){if(a.biff==5)return HP(e);var r=e.read_shift(1)>>>5&3,s=e.read_shift(2),n=e.read_shift(4);return[r,s,n]}function HP(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,a,r]}function GP(e,t,a){var r=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function $P(e,t,a){var r=e.read_shift(1)>>>5&3,s=e.read_shift(a&&a.biff==2?1:2);return[r,s]}function YP(e,t,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[r]}function qP(e,t,a){var r=(e[e.l++]&96)>>5,s=e.read_shift(2),n=4;if(a)switch(a.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[r,s]}var XP=Ea,KP=Ea,WP=Ea;function zc(e,t,a){return e.l+=2,[cP(e)]}function Qp(e){return e.l+=6,[]}var ZP=zc,QP=Qp,JP=Qp,e7=zc;function SA(e){return e.l+=2,[_t(e),e.read_shift(2)&1]}var t7=zc,a7=SA,r7=Qp,s7=zc,n7=zc,i7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function l7(e){e.l+=2;var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),l=i7[a>>2&31];return{ixti:t,coltype:a&3,rt:l,idx:r,c:s,C:n}}function o7(e){return e.l+=2,[e.read_shift(4)]}function c7(e,t,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function u7(e,t,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function d7(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[t,a]}function f7(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[t,a]}function h7(e){return e.l+=4,[0,0]}var pb={1:{n:"PtgExp",f:DP},2:{n:"PtgTbl",f:WP},3:{n:"PtgAdd",f:kt},4:{n:"PtgSub",f:kt},5:{n:"PtgMul",f:kt},6:{n:"PtgDiv",f:kt},7:{n:"PtgPower",f:kt},8:{n:"PtgConcat",f:kt},9:{n:"PtgLt",f:kt},10:{n:"PtgLe",f:kt},11:{n:"PtgEq",f:kt},12:{n:"PtgGe",f:kt},13:{n:"PtgGt",f:kt},14:{n:"PtgNe",f:kt},15:{n:"PtgIsect",f:kt},16:{n:"PtgUnion",f:kt},17:{n:"PtgRange",f:kt},18:{n:"PtgUplus",f:kt},19:{n:"PtgUminus",f:kt},20:{n:"PtgPercent",f:kt},21:{n:"PtgParen",f:kt},22:{n:"PtgMissArg",f:kt},23:{n:"PtgStr",f:UP},26:{n:"PtgSheet",f:c7},27:{n:"PtgEndSheet",f:u7},28:{n:"PtgErr",f:OP},29:{n:"PtgBool",f:LP},30:{n:"PtgInt",f:FP},31:{n:"PtgNum",f:MP},32:{n:"PtgArray",f:gP},33:{n:"PtgFunc",f:kP},34:{n:"PtgFuncVar",f:jP},35:{n:"PtgName",f:VP},36:{n:"PtgRef",f:TP},37:{n:"PtgArea",f:fP},38:{n:"PtgMemArea",f:GP},39:{n:"PtgMemErr",f:XP},40:{n:"PtgMemNoMem",f:KP},41:{n:"PtgMemFunc",f:$P},42:{n:"PtgRefErr",f:YP},43:{n:"PtgAreaErr",f:mP},44:{n:"PtgRefN",f:AP},45:{n:"PtgAreaN",f:pP},46:{n:"PtgMemAreaN",f:d7},47:{n:"PtgMemNoMemN",f:f7},57:{n:"PtgNameX",f:zP},58:{n:"PtgRef3d",f:CP},59:{n:"PtgArea3d",f:hP},60:{n:"PtgRefErr3d",f:qP},61:{n:"PtgAreaErr3d",f:xP},255:{}},m7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},x7={1:{n:"PtgElfLel",f:SA},2:{n:"PtgElfRw",f:s7},3:{n:"PtgElfCol",f:ZP},6:{n:"PtgElfRwV",f:n7},7:{n:"PtgElfColV",f:e7},10:{n:"PtgElfRadical",f:t7},11:{n:"PtgElfRadicalS",f:r7},13:{n:"PtgElfColS",f:QP},15:{n:"PtgElfColSV",f:JP},16:{n:"PtgElfRadicalLel",f:a7},25:{n:"PtgList",f:l7},29:{n:"PtgSxName",f:o7},255:{}},p7={0:{n:"PtgAttrNoop",f:h7},1:{n:"PtgAttrSemi",f:EP},2:{n:"PtgAttrIf",f:bP},4:{n:"PtgAttrChoose",f:yP},8:{n:"PtgAttrGoto",f:vP},16:{n:"PtgAttrSum",f:RP},32:{n:"PtgAttrBaxcel",f:xb},33:{n:"PtgAttrBaxcel",f:xb},64:{n:"PtgAttrSpace",f:NP},65:{n:"PtgAttrSpaceSemi",f:SP},128:{n:"PtgAttrIfError",f:wP},255:{}};function Hc(e,t,a,r){if(r.biff<8)return Ea(e,t);for(var s=e.l+t,n=[],l=0;l!==a.length;++l)switch(a[l][0]){case"PtgArray":a[l][1]=PP(e,0,r),n.push(a[l][1]);break;case"PtgMemArea":a[l][2]=IP(e,a[l][1],r),n.push(a[l][2]);break;case"PtgExp":r&&r.biff==12&&(a[l][1][1]=e.read_shift(4),n.push(a[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[l][0]}return t=s-e.l,t!==0&&n.push(Ea(e,t)),n}function Gc(e,t,a){for(var r=e.l+t,s,n,l=[];r!=e.l;)t=r-e.l,n=e[e.l],s=pb[n]||pb[m7[n]],(n===24||n===25)&&(s=(n===24?x7:p7)[e[e.l+1]]),!s||!s.f?Ea(e,t):l.push([s.n,s.f(e,t,a)]);return l}function g7(e){for(var t=[],a=0;a<e.length;++a){for(var r=e[a],s=[],n=0;n<r.length;++n){var l=r[n];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var y7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function v7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function TA(e,t,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(a.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var s="";if(a.biff>8)switch(e[r[0]][0]){case 357:return s=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[r[0]][0][3]?(s=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function gb(e,t,a){var r=TA(e,t,a);return r=="#REF"?r:v7(r,a)}function fa(e,t,a,r,s){var n=s&&s.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,h=0,f=0,m,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,v="",g=0,b=e[0].length;g<b;++g){var y=e[0][g];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:v=vt(" ",e[0][x][1][1]);break;case 1:v=vt("\r",e[0][x][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+v,x=-1}o.push(u+y7[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=jo(y[1][1],l,s),o.push(_o(d,n));break;case"PtgRefN":d=a?jo(y[1][1],a,s):y[1][1],o.push(_o(d,n));break;case"PtgRef3d":h=y[1][1],d=jo(y[1][2],l,s),p=gb(r,h,s),o.push(p+"!"+_o(d,n));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],N=y[1][1];w||(w=0),w&=127;var A=w==0?[]:o.slice(-w);o.length-=w,N==="User"&&(N=A.shift()),o.push(N+"("+A.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":m=Zv(y[1][1],a?{s:a}:l,s),o.push($f(m,s));break;case"PtgArea":m=Zv(y[1][1],l,s),o.push($f(m,s));break;case"PtgArea3d":h=y[1][1],m=y[1][2],p=gb(r,h,s),o.push(p+"!"+$f(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var S=(r.names||[])[f-1]||(r[0]||[])[f],C=S?S.Name:"SH33TJSNAME"+String(f);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var T=y[1][1];f=y[1][2];var D;if(s.biff<=5)T<0&&(T=-T),r[T]&&(D=r[T][f]);else{var R="";if(((r[T]||[])[0]||[])[0]==14849||(((r[T]||[])[0]||[])[0]==1025?r[T][f]&&r[T][f].itab>0&&(R=r.SheetNames[r[T][f].itab-1]+"!"):R=r.SheetNames[f-1]+"!"),r[T]&&r[T][f])R+=r[T][f].Name;else if(r[0]&&r[0][f])R+=r[0][f].Name;else{var j=(TA(r,T,s)||"").split(";;");j[f-1]?R=j[f-1]:R+="SH33TJSERRX"}o.push(R);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var B="(",X=")";if(x>=0){switch(v="",e[0][x][1][0]){case 2:B=vt(" ",e[0][x][1][1])+B;break;case 3:B=vt("\r",e[0][x][1][1])+B;break;case 4:X=vt(" ",e[0][x][1][1])+X;break;case 5:X=vt("\r",e[0][x][1][1])+X;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(B+o.pop()+X);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var V={c:a.c,r:a.r};if(r.sharedf[je(d)]){var F=r.sharedf[je(d)];o.push(fa(F,l,V,r,s))}else{var q=!1;for(c=0;c!=r.arrayf.length;++c)if(u=r.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(fa(u[1],l,V,r,s)),q=!0;break}q||o.push(y[1])}break;case"PtgArray":o.push("{"+g7(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&te.indexOf(e[0][g][0])==-1){y=e[0][x];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:v=vt(" ",y[1][1]);break;case 5:H=!1;case 1:v=vt("\r",y[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((H?v:"")+o.pop()+(H?"":v)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function b7(e,t,a){var r=e.l+t,s=a.biff==2?1:2,n,l=e.read_shift(s);if(l==65535)return[[],Ea(e,t-2)];var o=Gc(e,l,a);return t!==l+s&&(n=Hc(e,t-l-s,o,a)),e.l=r,[o,n]}function w7(e,t,a){var r=e.l+t,s=a.biff==2?1:2,n,l=e.read_shift(s);if(l==65535)return[[],Ea(e,t-2)];var o=Gc(e,l,a);return t!==l+s&&(n=Hc(e,t-l-s,o,a)),e.l=r,[o,n]}function E7(e,t,a,r){var s=e.l+t,n=Gc(e,r,a),l;return s!==e.l&&(l=Hc(e,s-e.l,n,a)),[n,l]}function N7(e,t,a){var r=e.l+t,s,n=e.read_shift(2),l=Gc(e,n,a);return n==65535?[[],Ea(e,t-2)]:(t!==n+2&&(s=Hc(e,r-n-2,l,a)),[l,s])}function S7(e){var t;if(ys(e,e.l+6)!==65535)return[ma(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Xf(e,t,a){var r=e.l+t,s=is(e);a.biff==2&&++e.l;var n=S7(e),l=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var o=w7(e,r-e.l,a);return{cell:s,val:n[0],formula:o,shared:l>>3&1,tt:n[1]}}function Fd(e,t,a){var r=e.read_shift(4),s=Gc(e,r,a),n=e.read_shift(4),l=n>0?Hc(e,n,s,a):null;return[s,l]}var T7=Fd,Ld=Fd,A7=Fd,C7=Fd,k7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},j7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yb(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Kf(e){var t=e.split(":"),a=t[0].split(".")[0];return[a,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Fo={},el={};function Lo(e,t){if(e){var a=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function CA(e,t,a,r,s,n){try{r.cellNF&&(e.z=De[t])}catch(o){if(r.WTF)throw o}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Zt(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&qn(RL[t]||"General",t),e.t==="e")e.w=e.w||hi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ic(e.v);else if(e.t==="d"){var l=La(e.v);(l|0)===l?e.w=l.toString(10):e.w=ic(l)}else{if(e.v===void 0)return"";e.w=ti(e.v,el)}else e.t==="d"?e.w=Sr(t,La(e.v),el):e.w=Sr(t,e.v,el)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&a!=null)try{e.s=n.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=q0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=q0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&n.Fills)throw o}}}function _7(e,t){var a=Et(t);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=Ge(a))}var R7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,D7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,O7=/<(?:\w:)?hyperlink [^>]*>/mg,F7=/"(\w*:\w*)"/,L7=/<(?:\w:)?col\b[^>]*[\/]?>/g,M7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,U7=/<(?:\w:)?pageMargins[^>]*\/>/g,kA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,B7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,I7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function P7(e,t,a,r,s,n,l){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=e.match(D7);h?(u=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):u=d=e;var f=u.match(kA);f?Jp(f[0],o,s,a):(f=u.match(B7))&&V7(f[0],f[1]||"",o,s,a);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var p=u.slice(m,m+50).match(F7);p&&_7(o,p[1])}var x=u.match(I7);x&&x[1]&&q7(x[1],s);var v=[];if(t.cellStyles){var g=u.match(L7);g&&G7(v,g)}h&&X7(h[1],o,t,c,n,l);var b=d.match(M7);b&&(o["!autofilter"]=$7(b[0]));var y=[],w=d.match(R7);if(w)for(m=0;m!=w.length;++m)y[m]=Et(w[m].slice(w[m].indexOf('"')+1));var N=d.match(O7);N&&z7(o,N,r);var A=d.match(U7);if(A&&(o["!margins"]=H7(Ce(A[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ge(c)),t.sheetRows>0&&o["!ref"]){var S=Et(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ge(S))}return v.length>0&&(o["!cols"]=v),y.length>0&&(o["!merges"]=y),o}function Jp(e,t,a,r){var s=Ce(e);a.Sheets[r]||(a.Sheets[r]={}),s.codeName&&(a.Sheets[r].CodeName=Xe(st(s.codeName)))}function V7(e,t,a,r,s){Jp(e.slice(0,e.indexOf(">")),a,r,s)}function z7(e,t,a){for(var r=Array.isArray(e),s=0;s!=t.length;++s){var n=Ce(st(t[s]),!0);if(!n.ref)return;var l=((a||{})["!id"]||[])[n.id];l?(n.Target=l.Target,n.location&&(n.Target+="#"+Xe(n.location))):(n.Target="#"+Xe(n.location),l={Target:n.Target,TargetMode:"Internal"}),n.Rel=l,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var o=Et(n.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=je({c:u,r:c});r?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=n):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=n)}}}function H7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(t[a]=parseFloat(e[a]))}),t}function G7(e,t){for(var a=!1,r=0;r!=t.length;++r){var s=Ce(t[r],!0);s.hidden&&(s.hidden=ot(s.hidden));var n=parseInt(s.min,10)-1,l=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!a&&s.width&&(a=!0,Zp(s.width)),xl(s);n<=l;)e[n++]=ia(s)}}function $7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var Y7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function q7(e,t){t.Views||(t.Views=[{}]),(e.match(Y7)||[]).forEach(function(a,r){var s=Ce(a);t.Views[r]||(t.Views[r]={}),+s.zoomScale&&(t.Views[r].zoom=+s.zoomScale),ot(s.rightToLeft)&&(t.Views[r].RTL=!0)})}var X7=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=lc("v"),l=lc("f");return function(c,u,d,h,f,m){for(var p=0,x="",v=[],g=[],b=0,y=0,w=0,N="",A,S,C=0,T=0,D,R,j=0,B=0,X=Array.isArray(m.CellXf),V,F=[],q=[],te=Array.isArray(u),H=[],le={},W=!1,_=!!d.sheetStubs,G=c.split(t),Y=0,z=G.length;Y!=z;++Y){x=G[Y].trim();var ie=x.length;if(ie!==0){var xe=0;e:for(p=0;p<ie;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(S=Ce(x.slice(xe,p),!0),C=S.r!=null?parseInt(S.r,10):C+1,T=-1,d.sheetRows&&d.sheetRows<C)continue;le={},W=!1,S.ht&&(W=!0,le.hpt=parseFloat(S.ht),le.hpx=dc(le.hpt)),S.hidden=="1"&&(W=!0,le.hidden=!0),S.outlineLevel!=null&&(W=!0,le.level=+S.outlineLevel),W&&(H[C-1]=le)}break;case"<":xe=p;break}if(xe>=p)break;if(S=Ce(x.slice(xe,p),!0),C=S.r!=null?parseInt(S.r,10):C+1,T=-1,!(d.sheetRows&&d.sheetRows<C)){h.s.r>C-1&&(h.s.r=C-1),h.e.r<C-1&&(h.e.r=C-1),d&&d.cellStyles&&(le={},W=!1,S.ht&&(W=!0,le.hpt=parseFloat(S.ht),le.hpx=dc(le.hpt)),S.hidden=="1"&&(W=!0,le.hidden=!0),S.outlineLevel!=null&&(W=!0,le.level=+S.outlineLevel),W&&(H[C-1]=le)),v=x.slice(p).split(e);for(var ne=0;ne!=v.length&&v[ne].trim().charAt(0)=="<";++ne);for(v=v.slice(ne),p=0;p!=v.length;++p)if(x=v[p].trim(),x.length!==0){if(g=x.match(a),b=p,y=0,w=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,g!=null&&g.length===2){for(b=0,N=g[1],y=0;y!=N.length&&!((w=N.charCodeAt(y)-64)<1||w>26);++y)b=26*b+w;--b,T=b}else++T;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,S=Ce(x.slice(0,y),!0),S.r||(S.r=je({r:C-1,c:T})),N=x.slice(y),A={t:""},(g=N.match(n))!=null&&g[1]!==""&&(A.v=Xe(g[1])),d.cellFormula){if((g=N.match(l))!=null&&g[1]!==""){if(A.f=Xe(st(g[1])).replace(/\r\n/g,`
`),d.xlfn||(A.f=mb(A.f)),g[0].indexOf('t="array"')>-1)A.F=(N.match(s)||[])[1],A.F.indexOf(":")>-1&&F.push([Et(A.F),A.F]);else if(g[0].indexOf('t="shared"')>-1){R=Ce(g[0]);var he=Xe(st(g[1]));d.xlfn||(he=mb(he)),q[parseInt(R.si,10)]=[R,he,S.r]}}else(g=N.match(/<f[^>]*\/>/))&&(R=Ce(g[0]),q[R.si]&&(A.f=nP(q[R.si][1],q[R.si][2],S.r)));var ce=Ra(S.r);for(y=0;y<F.length;++y)ce.r>=F[y][0].s.r&&ce.r<=F[y][0].e.r&&ce.c>=F[y][0].s.c&&ce.c<=F[y][0].e.c&&(A.F=F[y][1])}if(S.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(_)A.t="z";else continue;else A.t=S.t||"n";switch(h.s.c>T&&(h.s.c=T),h.e.c<T&&(h.e.c=T),A.t){case"n":if(A.v==""||A.v==null){if(!_)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!_)continue;A.t="z"}else D=Fo[parseInt(A.v,10)],A.v=D.t,A.r=D.r,d.cellHTML&&(A.h=D.h);break;case"str":A.t="s",A.v=A.v!=null?st(A.v):"",d.cellHTML&&(A.h=Pp(A.v));break;case"inlineStr":g=N.match(r),A.t="s",g!=null&&(D=Wp(g[1]))?(A.v=D.t,d.cellHTML&&(A.h=D.h)):A.v="";break;case"b":A.v=ot(A.v);break;case"d":d.cellDates?A.v=Zt(A.v,1):(A.v=La(Zt(A.v,1)),A.t="n");break;case"e":(!d||d.cellText!==!1)&&(A.w=A.v),A.v=KT[A.v];break}if(j=B=0,V=null,X&&S.s!==void 0&&(V=m.CellXf[S.s],V!=null&&(V.numFmtId!=null&&(j=V.numFmtId),d.cellStyles&&V.fillId!=null&&(B=V.fillId))),CA(A,j,B,d,f,m),d.cellDates&&X&&A.t=="n"&&Rl(De[j])&&(A.t="d",A.v=Dd(A.v)),S.cm&&d.xlmeta){var Te=(d.xlmeta.Cell||[])[+S.cm-1];Te&&Te.type=="XLDAPR"&&(A.D=!0)}if(te){var P=Ra(S.r);u[P.r]||(u[P.r]=[]),u[P.r][P.c]=A}else u[S.r]=A}}}}H.length>0&&(u["!rows"]=H)}}();function K7(e,t){var a={},r=e.l+t;a.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=r,n&7&&(a.level=n&7),n&16&&(a.hidden=!0),n&32&&(a.hpt=s/20),a}var W7=fi;function Z7(){}function Q7(e,t){var a={},r=e[e.l];return++e.l,a.above=!(r&64),a.left=!(r&128),e.l+=18,a.name=bM(e),a}function J7(e){var t=Tr(e);return[t]}function e9(e){var t=di(e);return[t]}function t9(e){var t=Tr(e),a=e.read_shift(1);return[t,a,"b"]}function a9(e){var t=di(e),a=e.read_shift(1);return[t,a,"b"]}function r9(e){var t=Tr(e),a=e.read_shift(1);return[t,a,"e"]}function s9(e){var t=di(e),a=e.read_shift(1);return[t,a,"e"]}function n9(e){var t=Tr(e),a=e.read_shift(4);return[t,a,"s"]}function i9(e){var t=di(e),a=e.read_shift(4);return[t,a,"s"]}function l9(e){var t=Tr(e),a=ma(e);return[t,a,"n"]}function jA(e){var t=di(e),a=ma(e);return[t,a,"n"]}function o9(e){var t=Tr(e),a=qp(e);return[t,a,"n"]}function c9(e){var t=di(e),a=qp(e);return[t,a,"n"]}function u9(e){var t=Tr(e),a=$p(e);return[t,a,"is"]}function d9(e){var t=Tr(e),a=ba(e);return[t,a,"str"]}function f9(e){var t=di(e),a=ba(e);return[t,a,"str"]}function h9(e,t,a){var r=e.l+t,s=Tr(e);s.r=a["!row"];var n=e.read_shift(1),l=[s,n,"b"];if(a.cellFormula){e.l+=2;var o=Ld(e,r-e.l,a);l[3]=fa(o,null,s,a.supbooks,a)}else e.l=r;return l}function m9(e,t,a){var r=e.l+t,s=Tr(e);s.r=a["!row"];var n=e.read_shift(1),l=[s,n,"e"];if(a.cellFormula){e.l+=2;var o=Ld(e,r-e.l,a);l[3]=fa(o,null,s,a.supbooks,a)}else e.l=r;return l}function x9(e,t,a){var r=e.l+t,s=Tr(e);s.r=a["!row"];var n=ma(e),l=[s,n,"n"];if(a.cellFormula){e.l+=2;var o=Ld(e,r-e.l,a);l[3]=fa(o,null,s,a.supbooks,a)}else e.l=r;return l}function p9(e,t,a){var r=e.l+t,s=Tr(e);s.r=a["!row"];var n=ba(e),l=[s,n,"str"];if(a.cellFormula){e.l+=2;var o=Ld(e,r-e.l,a);l[3]=fa(o,null,s,a.supbooks,a)}else e.l=r;return l}var g9=fi;function y9(e,t){var a=e.l+t,r=fi(e),s=Yp(e),n=ba(e),l=ba(e),o=ba(e);e.l=a;var c={rfx:r,relId:s,loc:n,display:o};return l&&(c.Tooltip=l),c}function v9(){}function b9(e,t,a){var r=e.l+t,s=YT(e),n=e.read_shift(1),l=[s];if(l[2]=n,a.cellFormula){var o=T7(e,r-e.l,a);l[1]=o}else e.l=r;return l}function w9(e,t,a){var r=e.l+t,s=fi(e),n=[s];if(a.cellFormula){var l=C7(e,r-e.l,a);n[1]=l,e.l=r}else e.l=r;return n}var E9=["left","right","top","bottom","header","footer"];function N9(e){var t={};return E9.forEach(function(a){t[a]=ma(e)}),t}function S9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function T9(){}function A9(){}function C9(e,t,a,r,s,n,l){if(!e)return e;var o=t||{};r||(r={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,m,p,x,v,g,b,y,w,N,A=[];o.biff=12,o["!row"]=0;var S=0,C=!1,T=[],D={},R=o.supbooks||s.supbooks||[[]];if(R.sharedf=D,R.arrayf=T,R.SheetNames=s.SheetNames||s.Sheets.map(function(te){return te.name}),!o.supbooks&&(o.supbooks=R,s.Names))for(var j=0;j<s.Names.length;++j)R[0][j+1]=s.Names[j];var B=[],X=[],V=!1;W0[16]={n:"BrtShortReal",f:jA};var F;if(Ds(e,function(H,le,W){if(!f)switch(W){case 148:u=H;break;case 0:m=H,o.sheetRows&&o.sheetRows<=m.r&&(f=!0),w=la(v=m.r),o["!row"]=m.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=dc(H.hpt)),X[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:H[2]},H[2]){case"n":p.v=H[1];break;case"s":y=Fo[H[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!H[1];break;case"e":p.v=H[1],o.cellText!==!1&&(p.w=hi[p.v]);break;case"str":p.t="s",p.v=H[1];break;case"is":p.t="s",p.v=H[1].t;break}if((x=l.CellXf[H[0].iStyleRef])&&CA(p,x.numFmtId,null,o,n,l),g=H[0].c==-1?g+1:H[0].c,o.dense?(c[v]||(c[v]=[]),c[v][g]=p):c[Vt(g)+w]=p,o.cellFormula){for(C=!1,S=0;S<T.length;++S){var _=T[S];m.r>=_[0].s.r&&m.r<=_[0].e.r&&g>=_[0].s.c&&g<=_[0].e.c&&(p.F=Ge(_[0]),C=!0)}!C&&H.length>3&&(p.f=H[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>g&&(d.s.c=g),d.e.r<m.r&&(d.e.r=m.r),d.e.c<g&&(d.e.c=g),o.cellDates&&x&&p.t=="n"&&Rl(De[x.numFmtId])){var G=Mn(p.v);G&&(p.t="d",p.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}F&&(F.type=="XLDAPR"&&(p.D=!0),F=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},g=H[0].c==-1?g+1:H[0].c,o.dense?(c[v]||(c[v]=[]),c[v][g]=p):c[Vt(g)+w]=p,d.s.r>m.r&&(d.s.r=m.r),d.s.c>g&&(d.s.c=g),d.e.r<m.r&&(d.e.r=m.r),d.e.c<g&&(d.e.c=g),F&&(F.type=="XLDAPR"&&(p.D=!0),F=void 0);break;case 176:A.push(H);break;case 49:F=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var Y=r["!id"][H.relId];for(Y?(H.Target=Y.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=Y):H.relId==""&&(H.Target="#"+H.loc),v=H.rfx.s.r;v<=H.rfx.e.r;++v)for(g=H.rfx.s.c;g<=H.rfx.e.c;++g)o.dense?(c[v]||(c[v]=[]),c[v][g]||(c[v][g]={t:"z",v:void 0}),c[v][g].l=H):(b=je({c:g,r:v}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=H);break;case 426:if(!o.cellFormula)break;T.push(H),N=o.dense?c[v][g]:c[Vt(g)+w],N.f=fa(H[1],d,{r:m.r,c:g},R,o),N.F=Ge(H[0]);break;case 427:if(!o.cellFormula)break;D[je(H[0].s)]=H[1],N=o.dense?c[v][g]:c[Vt(g)+w],N.f=fa(H[1],d,{r:m.r,c:g},R,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)B[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},V||(V=!0,Zp(H.w/256)),xl(B[H.e+1]);break;case 161:c["!autofilter"]={ref:Ge(H)};break;case 476:c["!margins"]=H;break;case 147:s.Sheets[a]||(s.Sheets[a]={}),H.name&&(s.Sheets[a].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!le.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ge(u||d)),o.sheetRows&&c["!ref"]){var q=Et(c["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>d.e.r&&(q.e.r=d.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>d.e.c&&(q.e.c=d.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ge(q))}return A.length>0&&(c["!merges"]=A),B.length>0&&(c["!cols"]=B),X.length>0&&(c["!rows"]=X),c}function k9(e){var t=[],a=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var l=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=a?+l[2]:l[2])});var s=Xe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){r=n.replace(/<.*?>/g,"")}),[t,s,r]}function j9(e,t,a,r,s,n){var l=n||{"!type":"chart"};if(!e)return n;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=k9(h);d.s.r=d.s.c=0,d.e.c=o,u=Vt(o),f[0].forEach(function(m,p){l[u+la(p)]={t:"n",v:m,z:f[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(l["!ref"]=Ge(d)),l}function _9(e,t,a,r,s){if(!e)return e;r||(r={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(kA);return o&&Jp(o[0],n,s,a),(l=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=l[1]),r["!id"][n["!rel"]]&&(n["!drawel"]=r["!id"][n["!rel"]]),n}function R9(e,t){e.l+=10;var a=ba(e);return{name:a}}function D9(e,t,a,r,s){if(!e)return e;r||(r={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ds(e,function(c,u,d){switch(d){case 550:n["!rel"]=c;break;case 651:s.Sheets[a]||(s.Sheets[a]={}),c.name&&(s.Sheets[a].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),r["!id"][n["!rel"]]&&(n["!drawel"]=r["!id"][n["!rel"]]),n}var _A=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],O9=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],F9=[],L9=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vb(e,t){for(var a=0;a!=e.length;++a)for(var r=e[a],s=0;s!=t.length;++s){var n=t[s];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=ot(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function bb(e,t){for(var a=0;a!=t.length;++a){var r=t[a];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=ot(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function RA(e){bb(e.WBProps,_A),bb(e.CalcPr,L9),vb(e.WBView,O9),vb(e.Sheets,F9),el.date1904=ot(e.WBProps.date1904)}var M9="][*?/\\".split("");function U9(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var a=!0;return M9.forEach(function(r){if(e.indexOf(r)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");a=!1}}),a}var B9=/<\w+:workbook/;function I9(e,t){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",n={},l=0;if(e.replace(Sa,function(c,u){var d=Ce(c);switch(ns(d[0])){case"<?xml":break;case"<workbook":c.match(B9)&&(s="xmlns"+c.match(/<(\w+):/)[1]),a.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],a.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":_A.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":a.WBProps[h[0]]=ot(d[h[0]]);break;case"int":a.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:a.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(a.WBProps.CodeName=st(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],a.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Xe(st(d.name)),delete d[0],a.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":n={},n.Name=st(d.name),d.comment&&(n.Comment=d.comment),d.localSheetId&&(n.Sheet=+d.localSheetId),ot(d.hidden||"0")&&(n.Hidden=!0),l=u+c.length;break;case"</definedName>":n.Ref=Xe(st(e.slice(l,u))),a.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete d[0],a.CalcPr=d;break;case"<calcPr/>":delete d[0],a.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),rM.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return RA(a),a}function P9(e,t){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=km(e),a.name=ba(e),a}function V9(e,t){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var s=t>8?ba(e):"";return s.length>0&&(a.CodeName=s),a.autoCompressPictures=!!(r&65536),a.backupFile=!!(r&64),a.checkCompatibility=!!(r&4096),a.date1904=!!(r&1),a.filterPrivacy=!!(r&8),a.hidePivotFieldList=!!(r&1024),a.promptedSolutions=!!(r&16),a.publishItems=!!(r&2048),a.refreshAllConnections=!!(r&262144),a.saveExternalLinkValues=!!(r&128),a.showBorderUnselectedTables=!!(r&4),a.showInkAnnotation=!!(r&32),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(r&32768),a.updateLinks=["userSet","never","always"][r>>8&3],a}function z9(e,t){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=t-8,a}function H9(e,t,a){var r=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=wM(e),l=A7(e,0,a),o=Yp(e);e.l=r;var c={Name:n,Ptg:l};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function G9(e,t){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;t||(t={}),t.biff=12;var n=[],l=[[]];return l.SheetNames=[],l.XTI=[],W0[16]={n:"BrtFRTArchID$",f:z9},Ds(e,function(c,u,d){switch(d){case 156:l.SheetNames.push(c.name),a.Sheets.push(c);break;case 153:a.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=fa(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,n.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,c]):l[0]=[d,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(d),s=!0;break;case 36:r.pop(),s=!1;break;case 37:r.push(d),s=!0;break;case 38:r.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),RA(a),a.Names=n,a.supbooks=l,a}function $9(e,t,a){return t.slice(-4)===".bin"?G9(e,a):I9(e,a)}function Y9(e,t,a,r,s,n,l,o){return t.slice(-4)===".bin"?C9(e,r,a,s,n,l,o):P7(e,r,a,s,n,l,o)}function q9(e,t,a,r,s,n,l,o){return t.slice(-4)===".bin"?D9(e,r,a,s,n):_9(e,r,a,s,n)}function X9(e,t,a,r,s,n,l,o){return t.slice(-4)===".bin"?aP():rP()}function K9(e,t,a,r,s,n,l,o){return t.slice(-4)===".bin"?eP():tP()}function W9(e,t,a,r){return t.slice(-4)===".bin"?gI(e,a,r):dI(e,a,r)}function Z9(e,t,a){return gA(e,a)}function Q9(e,t,a){return t.slice(-4)===".bin"?OB(e,a):RB(e,a)}function J9(e,t,a){return t.slice(-4)===".bin"?ZI(e,a):YI(e,a)}function eV(e,t,a){return t.slice(-4)===".bin"?HI(e):VI(e)}function tV(e,t,a,r){return a.slice(-4)===".bin"?GI(e,t,a,r):void 0}function aV(e,t,a){return t.slice(-4)===".bin"?II(e,t,a):PI(e,t,a)}var DA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,OA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Cr(e,t){var a=e.split(/\s+/),r=[];if(t||(r[0]=a[0]),a.length===1)return r;var s=e.match(DA),n,l,o,c;if(s)for(c=0;c!=s.length;++c)n=s[c].match(OA),(l=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(l+1),r[o]=n[2].slice(1,n[2].length-1));return r}function rV(e){var t=e.split(/\s+/),a={};if(t.length===1)return a;var r=e.match(DA),s,n,l,o;if(r)for(o=0;o!=r.length;++o)s=r[o].match(OA),(n=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(n+1),a[l]=s[2].slice(1,s[2].length-1));return a}var Mo;function sV(e,t){var a=Mo[e]||Xe(e);return a==="General"?ti(t):Sr(a,t)}function nV(e,t,a,r){var s=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ot(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=Zt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[Xe(t)]=s}function iV(e,t,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||hi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ic(e.v):e.w=ti(e.v):e.w=sV(t||"General",e.v)}catch(n){if(a.WTF)throw n}try{var r=Mo[t]||t||"General";if(a.cellNF&&(e.z=r),a.cellDates&&e.t=="n"&&Rl(r)){var s=Mn(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(n){if(a.WTF)throw n}}}function lV(e,t,a){if(a.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=nI[r.Pattern]||r.Pattern)}e[t.ID]=t}function oV(e,t,a,r,s,n,l,o,c,u){var d="General",h=r.StyleID,f={};u=u||{};var m=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&l&&(h=l.StyleID);n[h]!==void 0&&(n[h].nf&&(d=n[h].nf),n[h].Interior&&m.push(n[h].Interior),!!n[h].Parent);)h=n[h].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=ot(e);break;case"String":r.t="s",r.r=zv(Xe(e)),r.v=e.indexOf("<")>-1?Xe(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Zt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Xe(e):r.v<60&&(r.v=r.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=KT[e],u.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=zv(t||e));break}if(iV(r,d,u),u.cellFormula!==!1)if(r.Formula){var x=Xe(r.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),r.f=Ji(x,s),delete r.Formula,r.ArrayRange=="RC"?r.F=Ji("RC:RC",s):r.ArrayRange&&(r.F=Ji(r.ArrayRange,s),c.push([Et(r.F),r.F]))}else for(p=0;p<c.length;++p)s.r>=c[p][0].s.r&&s.r<=c[p][0].e.r&&s.c>=c[p][0].s.c&&s.c<=c[p][0].e.c&&(r.F=c[p][1]);u.cellStyles&&(m.forEach(function(v){!f.patternType&&v.patternType&&(f.patternType=v.patternType)}),r.s=f),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function cV(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Wf(e,t){var a=t||{};bT();var r=ao(Vp(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(r=st(r));var s=r.slice(0,1024).toLowerCase(),n=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var l=ia(a);return l.type="string",cc.to_workbook(r,l)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){s.indexOf("<"+Me)>=0&&(n=!0)}),n)return yV(r,a);Mo={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},h=[],f=a.dense?[]:{},m="",p={},x={},v=Cr('<Data ss:Type="String">'),g=0,b=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},A={},S="",C=0,T=[],D={},R={},j=0,B=[],X=[],V={},F=[],q,te=!1,H=[],le=[],W={},_=0,G=0,Y={Sheets:[],WBProps:{date1904:!1}},z={};oc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";o=oc.exec(r);)switch(o[3]=(ie=o[3]).toLowerCase()){case"data":if(ie=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?oV(r.slice(g,o.index),S,v,c[c.length-1][0]=="comment"?V:p,{c:b,r:y},N,F[b],x,H,a):(S="",v=Cr(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(X.length>0&&(p.c=X),(!a.sheetRows||a.sheetRows>y)&&p.v!==void 0&&(a.dense?(f[y]||(f[y]=[]),f[y][b]=p):f[Vt(b)+la(y)]=p),p.HRef&&(p.l={Target:Xe(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(_=b+(parseInt(p.MergeAcross,10)|0),G=y+(parseInt(p.MergeDown,10)|0),T.push({s:{c:b,r:y},e:{c:_,r:G}})),!a.sheetStubs)p.MergeAcross?b=_+1:++b;else if(p.MergeAcross||p.MergeDown){for(var xe=b;xe<=_;++xe)for(var ne=y;ne<=G;++ne)(xe>b||ne>y)&&(a.dense?(f[ne]||(f[ne]=[]),f[ne][xe]={t:"z"}):f[Vt(xe)+la(ne)]={t:"z"});b=_+1}else++b;else p=rV(o[0]),p.Index&&(b=+p.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),o[0].slice(-2)==="/>"&&++b,X=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),o[0].slice(-2)==="/>"&&(x=Cr(o[0]),x.Index&&(y=+x.Index-1)),b=0,++y):(x=Cr(o[0]),x.Index&&(y=+x.Index-1),W={},(x.AutoFitHeight=="0"||x.Height)&&(W.hpx=parseInt(x.Height,10),W.hpt=pA(W.hpx),le[y]=W),x.Hidden=="1"&&(W.hidden=!0,le[y]=W));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=Ge(w),a.sheetRows&&a.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=a.sheetRows-1,f["!ref"]=Ge(w))),T.length&&(f["!merges"]=T),F.length>0&&(f["!cols"]=F),le.length>0&&(f["!rows"]=le),d[m]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,c.push([o[3],!1]),u=Cr(o[0]),m=Xe(u.Name),f=a.dense?[]:{},T=[],H=[],le=[],z={name:m,Hidden:0},Y.Sheets.push(z);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),F=[],te=!1}break;case"style":o[1]==="/"?lV(N,A,a):A=Cr(o[0]);break;case"numberformat":A.nf=Xe(Cr(o[0]).Format||"General"),Mo[A.nf]&&(A.nf=Mo[A.nf]);for(var he=0;he!=392&&De[he]!=A.nf;++he);if(he==392){for(he=57;he!=392;++he)if(De[he]==null){qn(A.nf,he);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(q=Cr(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!te&&q.wpx>10){te=!0,Ca=mA;for(var ce=0;ce<F.length;++ce)F[ce]&&xl(F[ce])}te&&xl(q),F[q.Index-1||F.length]=q;for(var Te=0;Te<+q.Span;++Te)F[F.length]=ia(q);break;case"namedrange":if(o[1]==="/")break;Y.Names||(Y.Names=[]);var P=Ce(o[0]),Ke={Name:P.Name,Ref:Ji(P.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Ke.Sheet=Y.Sheets.length-1),Y.Names.push(Ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=r.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!a.cellStyles)break;A.Interior=Cr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?YM(D,ie,r.slice(j,o.index)):j=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));cV(V),X.push(V)}else c.push([o[3],!1]),u=Cr(o[0]),V={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Fe=Cr(o[0]);f["!autofilter"]={ref:Ji(Fe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Ab(r,a);var $e=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:$e=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:$e=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:$e=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:$e=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(r.slice(j,o.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else j=o.index+o[0].length;break;case"header":f["!margins"]||Lo(f["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(f["!margins"].header=+Ce(o[0]).Margin);break;case"footer":f["!margins"]||Lo(f["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(f["!margins"].footer=+Ce(o[0]).Margin);break;case"pagemargins":var Ne=Ce(o[0]);f["!margins"]||Lo(f["!margins"]={},"xlml"),isNaN(+Ne.Top)||(f["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(f["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(f["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(f["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:$e=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:$e=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:$e=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:$e=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:$e=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:$e=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:$e=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:$e=!1}break;case"smarttags":break;default:$e=!1;break}if($e||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?nV(R,ie,B,r.slice(j,o.index)):(B=o,j=o.index+o[0].length);break}if(a.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var ge={};return!a.bookSheets&&!a.bookProps&&(ge.Sheets=d),ge.SheetNames=h,ge.Workbook=Y,ge.SSF=ia(De),ge.Props=D,ge.Custprops=R,ge}function Dm(e,t){switch(ag(t=t||{}),t.type||"base64"){case"base64":return Wf(lr(e),t);case"binary":case"buffer":case"file":return Wf(e,t);case"array":return Wf(ui(e),t)}}function uV(e){var t={},a=e.content;if(a.l=28,t.AnsiUserType=a.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=SM(a),a.length-a.l<=4)return t;var r=a.read_shift(4);if(r==0||r>40||(a.l-=4,t.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(r=a.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=TM(a),r=a.read_shift(4),r==0||r>40))return t;a.l-=4,t.Reserved2=a.read_shift(0,"lpwstr")}var dV=[60,1084,2066,2165,2175];function fV(e,t,a,r,s){var n=r,l=[],o=a.slice(a.l,a.l+n);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}l.push(o),a.l+=n;for(var c=ys(a,a.l),u=Om[c],d=0;u!=null&&dV.indexOf(c)>-1;)n=ys(a,a.l+2),d=a.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=a.slice(d,a.l+4+n),l.push(o),a.l+=4+n,u=Om[c=ys(a,a.l)];var h=Ys(l);aa(h,0);var f=0;h.lens=[];for(var m=0;m<l.length;++m)h.lens.push(f),f+=l[m].length;if(h.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+r;return t.f(h,h.length,s)}function Hr(e,t,a){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[r])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||hi[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ic(e.v):e.w=ti(e.v):e.w=Sr(r,e.v,{date1904:!!a,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&r&&e.t=="n"&&Rl(De[r]||String(r))){var s=Mn(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Au(e,t,a){return{v:e,ixfe:t,t:a}}function hV(e,t){var a={opts:{}},r={},s=t.dense?[]:{},n={},l={},o=null,c=[],u="",d={},h,f="",m,p,x,v,g={},b=[],y,w,N=[],A=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},T=function(de){return de<8?Xn[de]:de<64&&A[de-8]||Xn[de]},D=function(de,ye,Pe){var be=ye.XF.data;if(!(!be||!be.patternType||!Pe||!Pe.cellStyles)){ye.s={},ye.s.patternType=be.patternType;var qe;(qe=uc(T(be.icvFore)))&&(ye.s.fgColor={rgb:qe}),(qe=uc(T(be.icvBack)))&&(ye.s.bgColor={rgb:qe})}},R=function(de,ye,Pe){if(!(W>1)&&!(Pe.sheetRows&&de.r>=Pe.sheetRows)){if(Pe.cellStyles&&ye.XF&&ye.XF.data&&D(de,ye,Pe),delete ye.ixfe,delete ye.XF,h=de,f=je(de),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),de.r<l.s.r&&(l.s.r=de.r),de.c<l.s.c&&(l.s.c=de.c),de.r+1>l.e.r&&(l.e.r=de.r+1),de.c+1>l.e.c&&(l.e.c=de.c+1),Pe.cellFormula&&ye.f){for(var be=0;be<b.length;++be)if(!(b[be][0].s.c>de.c||b[be][0].s.r>de.r)&&!(b[be][0].e.c<de.c||b[be][0].e.r<de.r)){ye.F=Ge(b[be][0]),(b[be][0].s.c!=de.c||b[be][0].s.r!=de.r)&&delete ye.f,ye.f&&(ye.f=""+fa(b[be][1],l,de,H,j));break}}Pe.dense?(s[de.r]||(s[de.r]=[]),s[de.r][de.c]=ye):s[f]=ye}},j={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(j.password=t.password);var B,X=[],V=[],F=[],q=[],te=!1,H=[];H.SheetNames=j.snames,H.sharedf=j.sharedf,H.arrayf=j.arrayf,H.names=[],H.XTI=[];var le=0,W=0,_=0,G=[],Y=[],z;j.codepage=1200,Or(1200);for(var ie=!1;e.l<e.length-1;){var xe=e.l,ne=e.read_shift(2);if(ne===0&&le===10)break;var he=e.l===e.length?0:e.read_shift(2),ce=Om[ne];if(ce&&ce.f){if(t.bookSheets&&le===133&&ne!==133)break;if(le=ne,ce.r===2||ce.r==12){var Te=e.read_shift(2);if(he-=2,!j.enc&&Te!==ne&&((Te&255)<<8|Te>>8)!==ne)throw new Error("rt mismatch: "+Te+"!="+ne);ce.r==12&&(e.l+=10,he-=10)}var P={};if(ne===10?P=ce.f(e,he,j):P=fV(ne,ce,e,he,j),W==0&&[9,521,1033,2057].indexOf(le)===-1)continue;switch(ne){case 34:a.opts.Date1904=S.WBProps.date1904=P;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(j.enc||(e.l=0),j.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=P;break;case 66:var Ke=Number(P);switch(Ke){case 21010:Ke=1200;break;case 32768:Ke=1e4;break;case 32769:Ke=1252;break}Or(j.codepage=Ke),ie=!0;break;case 317:j.rrtabid=P;break;case 25:j.winlocked=P;break;case 439:a.opts.RefreshAll=P;break;case 12:a.opts.CalcCount=P;break;case 16:a.opts.CalcDelta=P;break;case 17:a.opts.CalcIter=P;break;case 13:a.opts.CalcMode=P;break;case 14:a.opts.CalcPrecision=P;break;case 95:a.opts.CalcSaveRecalc=P;break;case 15:j.CalcRefMode=P;break;case 2211:a.opts.FullCalc=P;break;case 129:P.fDialog&&(s["!type"]="dialog"),P.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),P.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:N.push(P);break;case 430:H.push([P]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(P);break;case 24:case 536:z={Name:P.Name,Ref:fa(P.rgce,l,null,H,j)},P.itab>0&&(z.Sheet=P.itab-1),H.names.push(z),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(Y[P.itab-1]={ref:Ge(P.rgce[0][0][1][2])});break;case 22:j.ExternCount=P;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(P),H.XTI=H.XTI.concat(P);break;case 2196:if(j.biff<8)break;z!=null&&(z.Comment=P[1]);break;case 18:s["!protect"]=P;break;case 19:P!==0&&j.WTF&&console.error("Password verifier: "+P);break;case 133:n[P.pos]=P,j.snames.push(P.name);break;case 10:{if(--W)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,s["!ref"]=Ge(l),t.sheetRows&&t.sheetRows<=l.e.r){var Fe=l.e.r;l.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ge(l),l.e.r=Fe}l.e.r++,l.e.c++}X.length>0&&(s["!merges"]=X),V.length>0&&(s["!objects"]=V),F.length>0&&(s["!cols"]=F),q.length>0&&(s["!rows"]=q),S.Sheets.push(C)}u===""?d=s:r[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),j.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(j.biff=5,ie=!0,Or(j.codepage=28591)),j.biff==8&&P.BIFFVer==0&&P.dt==16&&(j.biff=2),W++)break;if(s=t.dense?[]:{},j.biff<8&&!ie&&(ie=!0,Or(j.codepage=t.codepage||1252)),j.biff<5||P.BIFFVer==0&&P.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var $e={pos:e.l-he,name:u};n[$e.pos]=$e,j.snames.push(u)}else u=(n[xe]||{name:""}).name;P.dt==32&&(s["!type"]="chart"),P.dt==64&&(s["!type"]="macro"),X=[],V=[],j.arrayf=b=[],F=[],q=[],te=!1,C={Hidden:(n[xe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[P.r]||[])[P.c]:s[je({c:P.c,r:P.r})])&&++P.c,y={ixfe:P.ixfe,XF:N[P.ixfe]||{},v:P.val,t:"n"},_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:P.c,r:P.r},y,t);break;case 5:case 517:y={ixfe:P.ixfe,XF:N[P.ixfe],v:P.val,t:P.t},_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:P.c,r:P.r},y,t);break;case 638:y={ixfe:P.ixfe,XF:N[P.ixfe],v:P.rknum,t:"n"},_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:P.c,r:P.r},y,t);break;case 189:for(var Ne=P.c;Ne<=P.C;++Ne){var ge=P.rkrec[Ne-P.c][0];y={ixfe:ge,XF:N[ge],v:P.rkrec[Ne-P.c][1],t:"n"},_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:Ne,r:P.r},y,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){o=P;break}if(y=Au(P.val,P.cell.ixfe,P.tt),y.XF=N[y.ixfe],t.cellFormula){var Me=P.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var Mt=Me[0][0][1][0],Qt=Me[0][0][1][1],oa=je({r:Mt,c:Qt});g[oa]?y.f=""+fa(P.formula,l,P.cell,H,j):y.F=((t.dense?(s[Mt]||[])[Qt]:s[oa])||{}).F}else y.f=""+fa(P.formula,l,P.cell,H,j)}_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R(P.cell,y,t),o=P}break;case 7:case 519:if(o)o.val=P,y=Au(P,o.cell.ixfe,"s"),y.XF=N[y.ixfe],t.cellFormula&&(y.f=""+fa(o.formula,l,o.cell,H,j)),_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(P);var Ye=je(P[0].s);if(m=t.dense?(s[P[0].s.r]||[])[P[0].s.c]:s[Ye],t.cellFormula&&m){if(!o||!Ye||!m)break;m.f=""+fa(P[1],l,P[0],H,j),m.F=Ge(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;g[je(o.cell)]=P[0],m=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[je(o.cell)],(m||{}).f=""+fa(P[0],l,h,H,j)}}break;case 253:y=Au(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(y.h=c[P.isst].h),y.XF=N[y.ixfe],_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:P.c,r:P.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:P.ixfe,XF:N[P.ixfe],t:"z"},_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:P.c,r:P.r},y,t));break;case 190:if(t.sheetStubs)for(var Jt=P.c;Jt<=P.C;++Jt){var ft=P.ixfe[Jt-P.c];y={ixfe:ft,XF:N[ft],t:"z"},_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:Jt,r:P.r},y,t)}break;case 214:case 516:case 4:y=Au(P.val,P.ixfe,"s"),y.XF=N[y.ixfe],_>0&&(y.z=G[y.ixfe>>8&63]),Hr(y,t,a.opts.Date1904),R({c:P.c,r:P.r},y,t);break;case 0:case 512:W===1&&(l=P);break;case 252:c=P;break;case 1054:if(j.biff==4){G[_++]=P[1];for(var Ta=0;Ta<_+163&&De[Ta]!=P[1];++Ta);Ta>=163&&qn(P[1],_+163)}else qn(P[1],P[0]);break;case 30:{G[_++]=P;for(var Ut=0;Ut<_+163&&De[Ut]!=P;++Ut);Ut>=163&&qn(P,_+163)}break;case 229:X=X.concat(P);break;case 93:V[P.cmo[0]]=j.lastobj=P;break;case 438:j.lastobj.TxO=P;break;case 127:j.lastobj.ImData=P;break;case 440:for(v=P[0].s.r;v<=P[0].e.r;++v)for(x=P[0].s.c;x<=P[0].e.c;++x)m=t.dense?(s[v]||[])[x]:s[je({c:x,r:v})],m&&(m.l=P[1]);break;case 2048:for(v=P[0].s.r;v<=P[0].e.r;++v)for(x=P[0].s.c;x<=P[0].e.c;++x)m=t.dense?(s[v]||[])[x]:s[je({c:x,r:v})],m&&m.l&&(m.l.Tooltip=P[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;m=t.dense?(s[P[0].r]||[])[P[0].c]:s[je(P[0])];var Pr=V[P[2]];m||(t.dense?(s[P[0].r]||(s[P[0].r]=[]),m=s[P[0].r][P[0].c]={t:"z"}):m=s[je(P[0])]={t:"z"},l.e.r=Math.max(l.e.r,P[0].r),l.s.r=Math.min(l.s.r,P[0].r),l.e.c=Math.max(l.e.c,P[0].c),l.s.c=Math.min(l.s.c,P[0].c)),m.c||(m.c=[]),p={a:P[1],t:Pr.TxO.t},m.c.push(p)}break;case 2173:LI(N[P.ixfe],P.ext);break;case 125:{if(!j.cellStyles)break;for(;P.e>=P.s;)F[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},te||(te=!0,Zp(P.w/256)),xl(F[P.e+1])}break;case 520:{var Ct={};P.level!=null&&(q[P.r]=Ct,Ct.level=P.level),P.hidden&&(q[P.r]=Ct,Ct.hidden=!0),P.hpt&&(q[P.r]=Ct,Ct.hpt=P.hpt,Ct.hpx=dc(P.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Lo(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ne]]=P;break;case 161:s["!margins"]||Lo(s["!margins"]={}),s["!margins"].header=P.header,s["!margins"].footer=P.footer;break;case 574:P.RTL&&(S.Views[0].RTL=!0);break;case 146:A=P;break;case 2198:B=P;break;case 140:w=P;break;case 442:u?C.CodeName=P||C.name:S.WBProps.CodeName=P||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+ne.toString(16)),e.l+=he}return a.SheetNames=as(n).sort(function(fe,de){return Number(fe)-Number(de)}).map(function(fe){return n[fe].name}),t.bookSheets||(a.Sheets=r),!a.SheetNames.length&&d["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=d)):a.Preamble=d,a.Sheets&&Y.forEach(function(fe,de){a.Sheets[a.SheetNames[de]]["!autofilter"]=fe}),a.Strings=c,a.SSF=ia(De),j.enc&&(a.Encryption=j.enc),B&&(a.Themes=B),a.Metadata={},w!==void 0&&(a.Metadata.Country=w),H.names.length>0&&(S.Names=H.names),a.Workbook=S,a}var wb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mV(e,t,a){var r=ze.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=sb(r,RM,wb.DSI);for(var n in s)t[n]=s[n]}catch(u){if(a.WTF)throw u}var l=ze.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=sb(l,DM,wb.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(a.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(ZT(t.HeadingPairs,t.TitlesOfParts,t,a),delete t.HeadingPairs,delete t.TitlesOfParts)}function FA(e,t){t||(t={}),ag(t),oT(),t.codepage&&Fp(t.codepage);var a,r;if(e.FullPaths){if(ze.find(e,"/encryption"))throw new Error("File is password-protected");a=ze.find(e,"!CompObj"),r=ze.find(e,"/Workbook")||ze.find(e,"/Book")}else{switch(t.type){case"base64":e=Rr(lr(e));break;case"binary":e=Rr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}aa(e,0),r={content:e}}var s,n;if(a&&uV(a),t.bookProps&&!t.bookSheets)s={};else{var l=Ve?"buffer":"array";if(r&&r.content)s=hV(r.content,t);else if((n=ze.find(e,"PerfectOffice_MAIN"))&&n.content)s=Oo.to_workbook(n.content,(t.type=l,t));else if((n=ze.find(e,"NativeContent_MAIN"))&&n.content)s=Oo.to_workbook(n.content,(t.type=l,t));else throw(n=ze.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ze.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=JI(e))}var o={};return e.FullPaths&&mV(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var W0={0:{f:K7},1:{f:J7},2:{f:o9},3:{f:r9},4:{f:t9},5:{f:l9},6:{f:d9},7:{f:n9},8:{f:p9},9:{f:x9},10:{f:h9},11:{f:m9},12:{f:e9},13:{f:c9},14:{f:s9},15:{f:a9},16:{f:jA},17:{f:f9},18:{f:i9},19:{f:$p},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:H9},40:{},42:{},43:{f:hI},44:{f:fI},45:{f:mI},46:{f:pI},47:{f:xI},48:{},49:{f:gM},50:{},51:{f:UI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:cA},62:{f:u9},63:{f:zI},64:{f:T9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ea,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:S9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Q7},148:{f:W7,p:16},151:{f:v9},152:{},153:{f:V9},154:{},155:{},156:{f:P9},157:{},158:{},159:{T:1,f:DB},160:{T:-1},161:{T:1,f:fi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:g9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:MI},336:{T:-1},337:{f:BI,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:km},357:{},358:{},359:{},360:{T:1},361:{},362:{f:oA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:b9},427:{f:w9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:N9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Z7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:y9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:km},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:WI},633:{T:1},634:{T:-1},635:{T:1,f:KI},636:{T:-1},637:{f:vM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:R9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:A9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Om={6:{f:Xf},10:{f:Ms},12:{f:_t},13:{f:_t},14:{f:St},15:{f:St},16:{f:ma},17:{f:St},18:{f:St},19:{f:_t},20:{f:ob},21:{f:ob},23:{f:oA},24:{f:ub},25:{f:St},26:{},27:{},28:{f:qU},29:{},34:{f:St},35:{f:cb},38:{f:ma},39:{f:ma},40:{f:ma},41:{f:ma},42:{f:St},43:{f:St},47:{f:ZB},49:{f:kU},51:{f:_t},60:{},61:{f:TU},64:{f:St},65:{f:CU},66:{f:_t},77:{},80:{},81:{},82:{},85:{f:_t},89:{},90:{},91:{},92:{f:gU},93:{f:KU},94:{},95:{f:St},96:{},97:{},99:{f:St},125:{f:cA},128:{f:BU},129:{f:yU},130:{f:_t},131:{f:St},132:{f:St},133:{f:vU},134:{},140:{f:tB},141:{f:_t},144:{},146:{f:rB},151:{},152:{},153:{},154:{},155:{},156:{f:_t},157:{},158:{},160:{f:oB},161:{f:nB},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:FU},190:{f:LU},193:{f:Ms},197:{},198:{},199:{},200:{},201:{},202:{f:St},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_t},220:{},221:{f:St},222:{},224:{f:UU},225:{f:pU},226:{f:Ms},227:{},229:{f:XU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bU},253:{f:jU},255:{f:wU},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:St},353:{f:Ms},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:PU},431:{f:St},432:{},433:{},434:{},437:{},438:{f:QU},439:{f:St},440:{f:JU},441:{},442:{f:Vc},443:{},444:{f:_t},445:{},446:{},448:{f:Ms},449:{f:SU,r:2},450:{f:Ms},512:{f:ib},513:{f:lB},515:{f:IU},516:{f:_U},517:{f:lb},519:{f:cB},520:{f:EU},523:{},545:{f:db},549:{f:nb},566:{},574:{f:AU},638:{f:OU},659:{},1048:{},1054:{f:RU},1084:{},1212:{f:GU},2048:{f:eB},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Nu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ms},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sB,r:12},2173:{f:FI,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:St,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HU,r:12},2197:{},2198:{f:kI,r:12},2199:{},2200:{},2201:{},2202:{f:$U,r:12},2203:{f:Ms},2204:{},2205:{},2206:{},2207:{},2211:{f:NU},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_t},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:iB},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aB},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ib},1:{},2:{f:hB},3:{f:fB},4:{f:dB},5:{f:lb},7:{f:mB},8:{},9:{f:Nu},11:{},22:{f:_t},30:{f:DU},31:{},32:{},33:{f:db},36:{},37:{f:nb},50:{f:xB},62:{},52:{},67:{},68:{f:_t},69:{},86:{},126:{},127:{f:uB},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pB},223:{},234:{},354:{},421:{},518:{f:Xf},521:{f:Nu},536:{f:ub},547:{f:cb},561:{},579:{},1030:{f:Xf},1033:{f:Nu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kr(e,t,a,r){var s=t;if(!isNaN(s)){var n=r||(a||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,n),n>0&&HT(a)&&e.push(a)}}function Eb(e,t){var a=t||{},r=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),l=s.index,o=n&&n.index||e.length,c=PL(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,f=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<c.length;++l){var x=c[l].trim(),v=x.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,a.sheetRows&&a.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var g=x.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var b=g[o].trim();if(b.match(/<t[dh]/i)){for(var y=b,w=0;y.charAt(0)=="<"&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var N=0;N<p.length;++N){var A=p[N];A.s.c==d&&A.s.r<u&&u<=A.e.r&&(d=A.e.c+1,N=-1)}var S=Ce(b.slice(0,b.indexOf(">")));f=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||f>1)&&p.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+f-1}});var C=S.t||S["data-t"]||"";if(!y.length){d+=f;continue}if(y=_T(y),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!y.length){d+=f;continue}var T={t:"s",v:y};a.raw||!y.trim().length||C=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Ur(y))?isNaN(ml(y).getDate())||(T={t:"d",v:Zt(y)},a.cellDates||(T={t:"n",v:La(T.v)}),T.z=a.dateNF||De[14]):T={t:"n",v:Ur(y)}),a.dense?(r[u]||(r[u]=[]),r[u][d]=T):r[je({r:u,c:d})]=T,d+=f}}}}return r["!ref"]=Ge(m),p.length&&(r["!merges"]=p),r}function xV(e,t,a,r){for(var s=e["!merges"]||[],n=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>a||s[u].s.c>l)&&!(s[u].e.r<a||s[u].e.c<l)){if(s[u].s.r<a||s[u].s.c<l){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=je({r:a,c:l}),h=r.dense?(e[a]||[])[l]:e[d],f=h&&h.v!=null&&(h.h||Pp(h.w||(js(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),m.id=(r.id||"sjs")+"-"+d,n.push(tM("td",f,m))}}var p="<tr>";return p+n.join("")+"</tr>"}var pV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gV="</body></html>";function yV(e,t){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return En(Eb(a[0],t),t);var r=sg();return a.forEach(function(s,n){ng(r,Eb(s,t),"Sheet"+(n+1))}),r}function vV(e,t,a){var r=[];return r.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function bV(e,t){var a=t||{},r=a.header!=null?a.header:pV,s=a.footer!=null?a.footer:gV,n=[r],l=Dl(e["!ref"]);a.dense=Array.isArray(e),n.push(vV(e,l,a));for(var o=l.s.r;o<=l.e.r;++o)n.push(xV(e,l,o,a));return n.push("</table>"+s),n.join("")}function LA(e,t,a){var r=a||{},s=0,n=0;if(r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var l=typeof r.origin=="string"?Ra(r.origin):r.origin;s=l.r,n=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var d=Dl(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],f=0,m=e["!rows"]||(e["!rows"]=[]),p=0,x=0,v=0,g=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&x<c;++p){var w=o[p];if(Nb(w)){if(r.display)continue;m[x]={hidden:!0}}var N=w.children;for(v=g=0;v<N.length;++v){var A=N[v];if(!(r.display&&Nb(A))){var S=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):_T(A.innerHTML),C=A.getAttribute("data-z")||A.getAttribute("z");for(f=0;f<h.length;++f){var T=h[f];T.s.c==g+n&&T.s.r<x+s&&x+s<=T.e.r&&(g=T.e.c+1-n,f=-1)}y=+A.getAttribute("colspan")||1,((b=+A.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:x+s,c:g+n},e:{r:x+s+(b||1)-1,c:g+n+(y||1)-1}});var D={t:"s",v:S},R=A.getAttribute("data-t")||A.getAttribute("t")||"";S!=null&&(S.length==0?D.t=R||"z":r.raw||S.trim().length==0||R=="s"||(S==="TRUE"?D={t:"b",v:!0}:S==="FALSE"?D={t:"b",v:!1}:isNaN(Ur(S))?isNaN(ml(S).getDate())||(D={t:"d",v:Zt(S)},r.cellDates||(D={t:"n",v:La(D.v)}),D.z=r.dateNF||De[14]):D={t:"n",v:Ur(S)})),D.z===void 0&&C!=null&&(D.z=C);var j="",B=A.getElementsByTagName("A");if(B&&B.length)for(var X=0;X<B.length&&!(B[X].hasAttribute("href")&&(j=B[X].getAttribute("href"),j.charAt(0)!="#"));++X);j&&j.charAt(0)!="#"&&(D.l={Target:j}),r.dense?(e[x+s]||(e[x+s]=[]),e[x+s][g+n]=D):e[je({c:g+n,r:x+s})]=D,u.e.c<g+n&&(u.e.c=g+n),g+=y}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,x-1+s),e["!ref"]=Ge(u),x>=c&&(e["!fullref"]=Ge((u.e.r=o.length-p+x-1+s,u))),e}function MA(e,t){var a=t||{},r=a.dense?[]:{};return LA(r,e,t)}function wV(e,t){return En(MA(e,t),t)}function Nb(e){var t="",a=EV(e);return a&&(t=a(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function EV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function NV(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=Xe(t.replace(/<[^>]*>/g,""));return[a]}var Sb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function UA(e,t){var a=t||{},r=Vp(e),s=[],n,l,o={name:""},c="",u=0,d,h,f={},m=[],p=a.dense?[]:{},x,v,g={value:""},b="",y=0,w=[],N=-1,A=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,T={},D=[],R={},j=0,B=0,X=[],V=1,F=1,q=[],te={Names:[]},H={},le=["",""],W=[],_={},G="",Y=0,z=!1,ie=!1,xe=0;for(oc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=oc.exec(r);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"工作表":x[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=Ge(S):p["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=a.sheetRows-1,p["!ref"]=Ge(S)),D.length&&(p["!merges"]=D),X.length&&(p["!rows"]=X),d.name=d.名称||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),f[d.name]=p,ie=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=Ce(x[0],!1),N=A=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=a.dense?[]:{},D=[],X=[],ie=!0);break;case"table-row-group":x[1]==="/"?--C:++C;break;case"table-row":case"行":if(x[1]==="/"){N+=V,V=1;break}if(h=Ce(x[0],!1),h.行号?N=h.行号-1:N==-1&&(N=0),V=+h["number-rows-repeated"]||1,V<10)for(xe=0;xe<V;++xe)C>0&&(X[N+xe]={level:C});A=-1;break;case"covered-table-cell":x[1]!=="/"&&++A,a.sheetStubs&&(a.dense?(p[N]||(p[N]=[]),p[N][A]={t:"z"}):p[je({r:N,c:A})]={t:"z"}),b="",w=[];break;case"table-cell":case"数据":if(x[0].charAt(x[0].length-2)==="/")++A,g=Ce(x[0],!1),F=parseInt(g["number-columns-repeated"]||"1",10),v={t:"z",v:null},g.formula&&a.cellFormula!=!1&&(v.f=yb(Xe(g.formula))),(g.数据类型||g["value-type"])=="string"&&(v.t="s",v.v=Xe(g["string-value"]||""),a.dense?(p[N]||(p[N]=[]),p[N][A]=v):p[je({r:N,c:A})]=v),A+=F-1;else if(x[1]!=="/"){++A,b="",y=0,w=[],F=1;var ne=V?N+V-1:N;if(A>S.e.c&&(S.e.c=A),A<S.s.c&&(S.s.c=A),N<S.s.r&&(S.s.r=N),ne>S.e.r&&(S.e.r=ne),g=Ce(x[0],!1),W=[],_={},v={t:g.数据类型||g["value-type"],v:null},a.cellFormula)if(g.formula&&(g.formula=Xe(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(j=parseInt(g["number-matrix-rows-spanned"],10)||0,B=parseInt(g["number-matrix-columns-spanned"],10)||0,R={s:{r:N,c:A},e:{r:N+j-1,c:A+B-1}},v.F=Ge(R),q.push([R,v.F])),g.formula)v.f=yb(g.formula);else for(xe=0;xe<q.length;++xe)N>=q[xe][0].s.r&&N<=q[xe][0].e.r&&A>=q[xe][0].s.c&&A<=q[xe][0].e.c&&(v.F=q[xe][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(j=parseInt(g["number-rows-spanned"],10)||0,B=parseInt(g["number-columns-spanned"],10)||0,R={s:{r:N,c:A},e:{r:N+j-1,c:A+B-1}},D.push(R)),g["number-columns-repeated"]&&(F=parseInt(g["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=ot(g["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(g.value);break;case"percentage":v.t="n",v.v=parseFloat(g.value);break;case"currency":v.t="n",v.v=parseFloat(g.value);break;case"date":v.t="d",v.v=Zt(g["date-value"]),a.cellDates||(v.t="n",v.v=La(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=UL(g["time-value"])/86400,a.cellDates&&(v.t="d",v.v=Dd(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(g.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",g["string-value"]!=null&&(b=Xe(g["string-value"]),w=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(z=!1,v.t==="s"&&(v.v=b||"",w.length&&(v.R=w),z=y==0),H.Target&&(v.l=H),W.length>0&&(v.c=W,W=[]),b&&a.cellText!==!1&&(v.w=b),z&&(v.t="z",delete v.v),(!z||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=N))for(var he=0;he<V;++he){if(F=parseInt(g["number-columns-repeated"]||"1",10),a.dense)for(p[N+he]||(p[N+he]=[]),p[N+he][A]=he==0?v:ia(v);--F>0;)p[N+he][A+F]=ia(v);else for(p[je({r:N+he,c:A})]=v;--F>0;)p[je({r:N+he,c:A+F})]=ia(v);S.e.c<=A&&(S.e.c=A)}F=parseInt(g["number-columns-repeated"]||"1",10),A+=F-1,F=0,v={},b="",w=[]}H={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((n=s.pop())[0]!==x[3])throw"Bad state: "+n}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((n=s.pop())[0]!==x[3])throw"Bad state: "+n;_.t=b,w.length&&(_.R=w),_.a=G,W.push(_)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);G="",Y=0,b="",y=0,w=[];break;case"creator":x[1]==="/"?G=r.slice(Y,x.index):Y=x.index+x[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((n=s.pop())[0]!==x[3])throw"Bad state: "+n}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);b="",y=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(T[o.name]=c,(n=s.pop())[0]!==x[3])throw"Bad state: "+n}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=Ce(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":l=Ce(x[0],!1),c+=Sb[x[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":l=Ce(x[0],!1),c+=Sb[x[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=r.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":l=Ce(x[0],!1),le=Kf(l["cell-range-address"]);var ce={Name:l.name,Ref:le[0]+"!"+le[1]};ie&&(ce.Sheet=m.length),te.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!g||!g["string-value"])){var Te=NV(r.slice(y,x.index));b=(b.length>0?b+`
`:"")+Te[0]}else Ce(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{le=Kf(Ce(x[0])["target-range-address"]),f[le[0]]["!autofilter"]={ref:le[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(H=Ce(x[0],!1),!H.href)break;H.Target=Xe(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(le=Kf(H.Target.slice(1)),H.Target="#"+le[0]+"!"+le[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(a.WTF)throw new Error(x)}}var P={Sheets:f,SheetNames:m,Workbook:te};return a.bookSheets&&delete P.Sheets,P}function Tb(e,t){t=t||{},fr(e,"META-INF/manifest.xml")&&IM(jt(e,"META-INF/manifest.xml"),t);var a=tr(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=UA(st(a),t);return fr(e,"meta.xml")&&(r.Props=WT(jt(e,"meta.xml"))),r}function Ab(e,t){return UA(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function eg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):st(ui(e))}function Lm(e){var t=e.reduce(function(s,n){return s+n.length},0),a=new Uint8Array(t),r=0;return e.forEach(function(s){a.set(s,r),r+=s.length}),a}function Cb(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function SV(e,t){for(var a=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,s=t+13;s>=t;--s)r=r*256+e[s];return(e[t+15]&128?-r:r)*Math.pow(10,a-6176)}function fc(e,t){var a=t?t[0]:0,r=e[a]&127;e:if(e[a++]>=128&&(r|=(e[a]&127)<<7,e[a++]<128||(r|=(e[a]&127)<<14,e[a++]<128)||(r|=(e[a]&127)<<21,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(r+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return t&&(t[0]=a),r}function Ht(e){var t=0,a=e[t]&127;e:if(e[t++]>=128){if(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128))break e;a|=(e[t]&127)<<28}return a}function va(e){for(var t=[],a=[0];a[0]<e.length;){var r=a[0],s=fc(e,a),n=s&7;s=Math.floor(s/8);var l=0,o;if(s==0)break;switch(n){case 0:{for(var c=a[0];e[a[0]++]>=128;);o=e.slice(c,a[0])}break;case 5:l=4,o=e.slice(a[0],a[0]+l),a[0]+=l;break;case 1:l=8,o=e.slice(a[0],a[0]+l),a[0]+=l;break;case 2:l=fc(e,a),o=e.slice(a[0],a[0]+l),a[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(r))}var u={data:o,type:n};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function tg(e,t){return(e==null?void 0:e.map(function(a){return t(a.data)}))||[]}function TV(e){for(var t,a=[],r=[0];r[0]<e.length;){var s=fc(e,r),n=va(e.slice(r[0],r[0]+s));r[0]+=s;var l={id:Ht(n[1][0].data),messages:[]};n[2].forEach(function(o){var c=va(o.data),u=Ht(c[3][0].data);l.messages.push({meta:c,data:e.slice(r[0],r[0]+u)}),r[0]+=u}),(t=n[3])!=null&&t[0]&&(l.merge=Ht(n[3][0].data)>>>0>0),a.push(l)}return a}function AV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=fc(t,a),s=[];a[0]<t.length;){var n=t[a[0]]&3;if(n==0){var l=t[a[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[a[0]],o>1&&(l|=t[a[0]+1]<<8),o>2&&(l|=t[a[0]+2]<<16),o>3&&(l|=t[a[0]+3]<<24),l>>>=0,l++,a[0]+=o}s.push(t.slice(a[0],a[0]+l)),a[0]+=l;continue}else{var c=0,u=0;if(n==1?(u=(t[a[0]]>>2&7)+4,c=(t[a[0]++]&224)<<3,c|=t[a[0]++]):(u=(t[a[0]++]>>2)+1,n==2?(c=t[a[0]]|t[a[0]+1]<<8,a[0]+=2):(c=(t[a[0]]|t[a[0]+1]<<8|t[a[0]+2]<<16|t[a[0]+3]<<24)>>>0,a[0]+=4)),s=[Lm(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Lm(s);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function CV(e){for(var t=[],a=0;a<e.length;){var r=e[a++],s=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,t.push(AV(r,e.slice(a,a+s))),a+=s}if(a!==e.length)throw new Error("data is not a valid framed stream!");return Lm(t)}function kV(e,t,a,r){var s=eg(e),n=s.getUint32(4,!0),l=(r>1?12:8)+Cb(n&(r>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);n&512&&(o=s.getUint32(l,!0),l+=4),l+=Cb(n&(r>1?12288:4096))*4,n&16&&(c=s.getUint32(l,!0),l+=4),n&32&&(u=s.getFloat64(l,!0),l+=8),n&64&&(d.setTime(d.getTime()+s.getFloat64(l,!0)*1e3),l+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:a[o]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function jV(e,t,a){var r=eg(e),s=r.getUint32(8,!0),n=12,l=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=SV(e,n),n+=16),s&2&&(u=r.getFloat64(n,!0),n+=8),s&4&&(d.setTime(d.getTime()+r.getFloat64(n,!0)*1e3),n+=8),s&8&&(o=r.getUint32(n,!0),n+=4),s&16&&(l=r.getUint32(n,!0),n+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:a[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function _V(e,t,a){switch(e[0]){case 0:case 1:case 2:case 3:return kV(e,t,a,e[0]);case 5:return jV(e,t,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function un(e){var t=va(e);return fc(t[1][0].data)}function kb(e,t){var a=va(t.data),r=Ht(a[1][0].data),s=a[3],n=[];return(s||[]).forEach(function(l){var o=va(l.data),c=Ht(o[1][0].data)>>>0;switch(r){case 1:n[c]=Fm(o[3][0].data);break;case 8:{var u=e[un(o[9][0].data)][0],d=va(u.data),h=e[un(d[1][0].data)][0],f=Ht(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var m=va(h.data);n[c]=m[3].map(function(p){return Fm(p.data)}).join("")}break}}),n}function RV(e,t){var a,r,s,n,l,o,c,u,d,h,f,m,p,x,v=va(e),g=Ht(v[1][0].data)>>>0,b=Ht(v[2][0].data)>>>0,y=((r=(a=v[8])==null?void 0:a[0])==null?void 0:r.data)&&Ht(v[8][0].data)>0||!1,w,N;if((n=(s=v[7])==null?void 0:s[0])!=null&&n.data&&t!=0)w=(o=(l=v[7])==null?void 0:l[0])==null?void 0:o.data,N=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(d=v[4])==null?void 0:d[0])!=null&&h.data&&t!=1)w=(m=(f=v[4])==null?void 0:f[0])==null?void 0:m.data,N=(x=(p=v[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var A=y?4:1,S=eg(w),C=[],T=0;T<w.length/2;++T){var D=S.getUint16(T*2,!0);D<65535&&C.push([T,D])}if(C.length!=b)throw"Expected ".concat(b," cells, found ").concat(C.length);var R=[];for(T=0;T<C.length-1;++T)R[C[T][0]]=N.subarray(C[T][1]*A,C[T+1][1]*A);return C.length>=1&&(R[C[C.length-1][0]]=N.subarray(C[C.length-1][1]*A)),{R:g,cells:R}}function DV(e,t){var a,r=va(t.data),s=(a=r==null?void 0:r[7])!=null&&a[0]?Ht(r[7][0].data)>>>0>0?1:0:-1,n=tg(r[5],function(l){return RV(l,s)});return{nrows:Ht(r[4][0].data)>>>0,data:n.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,u){if(l[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));l[o.R][u]=c}),l},[])}}function OV(e,t,a){var r,s=va(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(Ht(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(Ht(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));a["!ref"]=Ge(n);var l=va(s[4][0].data),o=kb(e,e[un(l[4][0].data)][0]),c=(r=l[17])!=null&&r[0]?kb(e,e[un(l[17][0].data)][0]):[],u=va(l[3][0].data),d=0;u[1].forEach(function(h){var f=va(h.data),m=e[un(f[2][0].data)][0],p=Ht(m.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=DV(e,m);x.data.forEach(function(v,g){v.forEach(function(b,y){var w=je({r:d+g,c:y}),N=_V(b,o,c);N&&(a[w]=N)})}),d+=x.nrows})}function FV(e,t){var a=va(t.data),r={"!ref":"A1"},s=e[un(a[2][0].data)],n=Ht(s[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return OV(e,s[0],r),r}function LV(e,t){var a,r=va(t.data),s={name:(a=r[1])!=null&&a[0]?Fm(r[1][0].data):"",sheets:[]},n=tg(r[2],un);return n.forEach(function(l){e[l].forEach(function(o){var c=Ht(o.meta[1][0].data);c==6e3&&s.sheets.push(FV(e,o))})}),s}function MV(e,t){var a=sg(),r=va(t.data),s=tg(r[1],un);if(s.forEach(function(n){e[n].forEach(function(l){var o=Ht(l.meta[1][0].data);if(o==2){var c=LV(e,l);c.sheets.forEach(function(u,d){ng(a,u,d==0?c.name:c.name+"_"+d,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Zf(e){var t,a,r,s,n={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=CV(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var d;try{d=TV(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){n[h.id]=h.messages,l.push(h.id)})}}),!l.length)throw new Error("File has no messages");var o=((s=(r=(a=(t=n==null?void 0:n[1])==null?void 0:t[0])==null?void 0:a.meta)==null?void 0:r[1])==null?void 0:s[0].data)&&Ht(n[1][0].meta[1][0].data)==1&&n[1][0];if(o||l.forEach(function(c){n[c].forEach(function(u){var d=Ht(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return MV(n,o)}function UV(e){return function(a){for(var r=0;r!=e.length;++r){var s=e[r];a[s[0]]===void 0&&(a[s[0]]=s[1]),s[2]==="n"&&(a[s[0]]=Number(a[s[0]]))}}}function ag(e){UV([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function BV(e){return Hi.WS.indexOf(e)>-1?"sheet":e==Hi.CS?"chart":e==Hi.DS?"dialog":e==Hi.MS?"macro":e&&e.length?e:"sheet"}function IV(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,BV(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function PV(e,t,a,r,s,n,l,o,c,u,d,h){try{n[r]=Ro(tr(e,a,!0),t);var f=jt(e,t),m;switch(o){case"sheet":m=Y9(f,t,s,c,n[r],u,d,h);break;case"chart":if(m=q9(f,t,s,c,n[r],u,d,h),!m||!m["!drawel"])break;var p=so(m["!drawel"].Target,t),x=jm(p),v=$I(tr(e,p,!0),Ro(tr(e,x,!0),p)),g=so(v,p),b=jm(g);m=j9(tr(e,g,!0),g,c,Ro(tr(e,b,!0),g),u,m);break;case"macro":m=X9(f,t,s,c,n[r],u,d,h);break;case"dialog":m=K9(f,t,s,c,n[r],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}l[r]=m;var y=[];n&&n[r]&&as(n[r]).forEach(function(w){var N="";if(n[r][w].Type==Hi.CMNT){N=so(n[r][w].Target,t);var A=J9(jt(e,N,!0),N,c);if(!A||!A.length)return;hb(m,A,!1)}n[r][w].Type==Hi.TCMNT&&(N=so(n[r][w].Target,t),y=y.concat(qI(jt(e,N,!0),c)))}),y&&y.length&&hb(m,y,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function cr(e){return e.charAt(0)=="/"?e.slice(1):e}function VV(e,t){if(bT(),t=t||{},ag(t),fr(e,"META-INF/manifest.xml")||fr(e,"objectdata.xml"))return Tb(e,t);if(fr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Zf<"u"){if(e.FileIndex)return Zf(e);var a=ze.utils.cfb_new();return Pv(e).forEach(function(X){zL(a,X,AT(e,X))}),Zf(a)}throw new Error("Unsupported NUMBERS file")}if(!fr(e,"[Content_Types].xml"))throw fr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Pv(e),s=UM(tr(e,"[Content_Types].xml")),n=!1,l,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",jt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!jt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),n=!0}s.workbooks[0].slice(-3)=="bin"&&(n=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Fo=[],s.sst)try{Fo=Q9(jt(e,cr(s.sst)),s.sst,t)}catch(X){if(t.WTF)throw X}t.cellStyles&&s.themes.length&&(c=Z9(tr(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=W9(jt(e,cr(s.style)),s.style,c,t))}s.links.map(function(X){try{var V=Ro(tr(e,jm(cr(X))),X);return tV(jt(e,cr(X)),V,X,t)}catch{}});var d=$9(jt(e,cr(s.workbooks[0])),s.workbooks[0],t),h={},f="";s.coreprops.length&&(f=jt(e,cr(s.coreprops[0]),!0),f&&(h=WT(f)),s.extprops.length!==0&&(f=jt(e,cr(s.extprops[0]),!0),f&&zM(f,h,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(f=tr(e,cr(s.custprops[0]),!0),f&&(m=GM(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(V){return V.name}):h.Worksheets&&h.SheetNames.length>0&&(l=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=m),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var x={};t.bookDeps&&s.calcchain&&(x=eV(jt(e,cr(s.calcchain)),s.calcchain));var v=0,g={},b,y;{var w=d.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var N=0;N!=w.length;++N)h.SheetNames[N]=w[N].name}var A=n?"bin":"xml",S=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,S+1)+"_rels/"+s.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");fr(e,C)||(C="xl/_rels/workbook."+A+".rels");var T=Ro(tr(e,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=aV(jt(e,cr(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=XI(jt(e,cr(s.people[0])),t)),T&&(T=IV(T,d.Sheets));var D=jt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=h.Worksheets;++v){var R="sheet";if(T&&T[v]?(b="xl/"+T[v][1].replace(/[\/]?xl\//,""),fr(e,b)||(b=T[v][1]),fr(e,b)||(b=C.replace(/_rels\/.*$/,"")+T[v][1]),R=T[v][2]):(b="xl/worksheets/sheet"+(v+1-D)+"."+A,b=b.replace(/sheet0\./,"sheet.")),y=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(h.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var j=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==v&&(j=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==h.SheetNames[v].toLowerCase()&&(j=1);if(!j)continue e}}PV(e,b,y,h.SheetNames[v],v,g,l,R,t,d,c,u)}return p={Directory:s,Workbook:d,Props:h,Custprops:m,Deps:x,Sheets:l,SheetNames:h.SheetNames,Strings:Fo,Styles:u,Themes:c,SSF:ia(De)},t&&t.bookFiles&&(e.files?(p.keys=r,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(X,V){X=X.replace(/^Root Entry[\/]/,""),p.keys.push(X),p.files[X]=e.FileIndex[V]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=jt(e,cr(s.vba[0]),!0):s.defaults&&s.defaults.bin===QI&&(p.vbaraw=jt(e,"xl/vbaProject.bin",!0))),p}function zV(e,t){var a=t||{},r="Workbook",s=ze.find(e,r);try{if(r="/!DataSpaces/Version",s=ze.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(FB(s.content),r="/!DataSpaces/DataSpaceMap",s=ze.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var n=MB(s.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=ze.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=UB(s.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=ze.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);IB(s.content)}catch{}if(r="/EncryptionInfo",s=ze.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=PB(s.content);if(r="/EncryptedPackage",s=ze.find(e,r),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,a.password||"",a);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,a.password||"",a);throw new Error("File is password-protected")}function rg(e,t){var a="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=lr(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function HV(e,t){return ze.find(e,"EncryptedPackage")?zV(e,t):FA(e,t)}function GV(e,t){var a,r=e,s=t||{};return s.type||(s.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),a=CT(r,s),VV(a,s)}function BA(e,t){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Dm(e.slice(a),t);default:break e}return cc.to_workbook(e,t)}function $V(e,t){var a="",r=rg(e,t);switch(t.type){case"base64":a=lr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=ai(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(a=st(a)),t.type="binary",BA(a,t)}function YV(e,t){var a=e;return t.type=="base64"&&(a=lr(a)),a=$s.utils.decode(1200,a.slice(2),"str"),t.type="binary",BA(a,t)}function qV(e){return e.match(/[^\x00-\x7F]/)?no(e):e}function Qf(e,t,a,r){return r?(a.type="string",cc.to_workbook(e,a)):cc.to_workbook(t,a)}function Mm(e,t){oT();var a=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mm(new Uint8Array(e),(a=ia(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var r=e,s=[0,0,0,0],n=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),el={},a.dateNF&&(el.dateNF=a.dateNF),a.type||(a.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=Ve?"buffer":"binary",r=LL(e),typeof Uint8Array<"u"&&!Ve&&(a.type="array")),a.type=="string"&&(n=!0,a.type="binary",a.codepage=65001,r=qV(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return a=ia(a),a.type="array",Mm(Lp(r),a)}switch((s=rg(r,a))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return HV(ze.read(r,a),a);break;case 9:if(s[1]<=8)return FA(r,a);break;case 60:return Dm(r,a);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return wB(r,a);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return vB.to_workbook(r,a);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?GV(r,a):Qf(e,r,a,n);case 239:return s[3]===60?Dm(r,a):Qf(e,r,a,n);case 255:if(s[1]===254)return YV(r,a);if(s[1]===0&&s[2]===2&&s[3]===0)return Oo.to_workbook(r,a);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Oo.to_workbook(r,a);break;case 3:case 131:case 139:case 140:return fb.to_workbook(r,a);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return QB.to_workbook(r,a);break;case 10:case 13:case 32:return $V(r,a);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return gB.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?fb.to_workbook(r,a):Qf(e,r,a,n)}function XV(e,t,a,r,s,n,l,o){var c=la(a),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:a,enumerable:!1})}catch{f.__rowNum__=a}else f.__rowNum__=a;if(!l||e[a])for(var m=t.s.c;m<=t.e.c;++m){var p=l?e[a][m]:e[r[m]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;n[m]!=null&&(f[n[m]]=u);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(n[m]!=null){if(x==null)if(p.t=="e"&&x===null)f[n[m]]=null;else if(u!==void 0)f[n[m]]=u;else if(d&&x===null)f[n[m]]=null;else continue;else f[n[m]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?x:js(p,x,o);x!=null&&(h=!1)}}return{row:f,isempty:h}}function Um(e,t){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},r=0,s=1,n=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof d){case"string":c=Et(d);break;case"number":c=Et(e["!ref"]),c.s.r=d;break;default:c=d}r>0&&(s=0);var h=la(c.s.r),f=[],m=[],p=0,x=0,v=Array.isArray(e),g=c.s.r,b=0,y={};v&&!e[g]&&(e[g]=[]);var w=u.skipHidden&&e["!cols"]||[],N=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(w[b]||{}).hidden)switch(f[b]=Vt(b),a=v?e[g][b]:e[f[b]+h],r){case 1:n[b]=b-c.s.c;break;case 2:n[b]=f[b];break;case 3:n[b]=u.header[b-c.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),o=l=js(a,null,u),x=y[l]||0,!x)y[l]=1;else{do o=l+"_"+x++;while(y[o]);y[l]=x,y[o]=1}n[b]=o}for(g=c.s.r+s;g<=c.e.r;++g)if(!(N[g]||{}).hidden){var A=XV(e,c,g,f,r,n,v,u);(A.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(m[p++]=A.row)}return m.length=p,m}var jb=/"/g;function KV(e,t,a,r,s,n,l,o){for(var c=!0,u=[],d="",h=la(a),f=t.s.c;f<=t.e.c;++f)if(r[f]){var m=o.dense?(e[a]||[])[f]:e[r[f]+h];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:js(m,null,o));for(var p=0,x=0;p!==d.length;++p)if((x=d.charCodeAt(p))===s||x===n||x===34||o.forceQuotes){d='"'+d.replace(jb,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(jb,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(l)}function IA(e,t){var a=[],r=t??{};if(e==null||e["!ref"]==null)return"";var s=Et(e["!ref"]),n=r.FS!==void 0?r.FS:",",l=n.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,c=o.charCodeAt(0),u=new RegExp((n=="|"?"\\|":n)+"+$"),d="",h=[];r.dense=Array.isArray(e);for(var f=r.skipHidden&&e["!cols"]||[],m=r.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(f[p]||{}).hidden||(h[p]=Vt(p));for(var x=0,v=s.s.r;v<=s.e.r;++v)(m[v]||{}).hidden||(d=KV(e,s,v,h,l,c,n,r),d!=null&&(r.strip&&(d=d.replace(u,"")),(d||r.blankrows!==!1)&&a.push((x++?o:"")+d)));return delete r.dense,a.join("")}function WV(e,t){t||(t={}),t.FS="	",t.RS=`
`;var a=IA(e,t);return a}function ZV(e){var t="",a,r="";if(e==null||e["!ref"]==null)return[];var s=Et(e["!ref"]),n="",l=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)l[o]=Vt(o);for(var d=s.s.r;d<=s.e.r;++d)for(n=la(d),o=s.s.c;o<=s.e.c;++o)if(t=l[o]+n,a=u?(e[d]||[])[o]:e[t],r="",a!==void 0){if(a.F!=null){if(t=a.F,!a.f)continue;r=a.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(a.f!=null)r=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)r=""+a.v;else if(a.t=="b")r=a.v?"TRUE":"FALSE";else if(a.w!==void 0)r="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?r="'"+a.v:r=""+a.v}}c[c.length]=t+"="+r}return c}function PA(e,t,a){var r=a||{},s=+!r.skipHeader,n=e||{},l=0,o=0;if(n&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var c=typeof r.origin=="string"?Ra(r.origin):r.origin;l=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+s}};if(n["!ref"]){var h=Et(n["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),l==-1&&(l=h.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var f=r.header||[],m=0;t.forEach(function(x,v){as(x).forEach(function(g){(m=f.indexOf(g))==-1&&(f[m=f.length]=g);var b=x[g],y="z",w="",N=je({c:o+m,r:l+v+s});u=hc(n,N),b&&typeof b=="object"&&!(b instanceof Date)?n[N]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",r.cellDates||(y="n",b=La(b)),w=r.dateNF||De[14]):b===null&&r.nullError&&(y="e",b=0),u?(u.t=y,u.v=b,delete u.w,delete u.R,w&&(u.z=w)):n[N]=u={t:y,v:b},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var p=la(l);if(s)for(m=0;m<f.length;++m)n[Vt(m+o)+p]={t:"s",v:f[m]};return n["!ref"]=Ge(d),n}function QV(e,t){return PA(null,e,t)}function hc(e,t,a){if(typeof t=="string"){if(Array.isArray(e)){var r=Ra(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?hc(e,je(t)):hc(e,je({r:t,c:a||0}))}function JV(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var a=e.SheetNames.indexOf(t);if(a>-1)return a;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function sg(){return{SheetNames:[],Sheets:{}}}function ng(e,t,a,r){var s=1;if(!a)for(;s<=65535&&e.SheetNames.indexOf(a="Sheet"+s)!=-1;++s,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var n=a.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var l=n&&n[1]||a;for(++s;s<=65535&&e.SheetNames.indexOf(a=l+s)!=-1;++s);}if(U9(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=t,a}function ez(e,t,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=JV(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a}function tz(e,t){return e.z=t,e}function VA(e,t,a){return t?(e.l={Target:t},a&&(e.l.Tooltip=a)):delete e.l,e}function az(e,t,a){return VA(e,"#"+t,a)}function rz(e,t,a){e.c||(e.c=[]),e.c.push({t,a:a||"SheetJS"})}function sz(e,t,a,r){for(var s=typeof t!="string"?t:Et(t),n=typeof t=="string"?t:Ge(t),l=s.s.r;l<=s.e.r;++l)for(var o=s.s.c;o<=s.e.c;++o){var c=hc(e,l,o);c.t="n",c.F=n,delete c.v,l==s.s.r&&o==s.s.c&&(c.f=a,r&&(c.D=!0))}return e}var nz={encode_col:Vt,encode_row:la,encode_cell:je,encode_range:Ge,decode_col:Gp,decode_row:Hp,split_cell:pM,decode_cell:Ra,decode_range:Dl,format_cell:js,sheet_add_aoa:$T,sheet_add_json:PA,sheet_add_dom:LA,aoa_to_sheet:Ol,json_to_sheet:QV,table_to_sheet:MA,table_to_book:wV,sheet_to_csv:IA,sheet_to_txt:WV,sheet_to_json:Um,sheet_to_html:bV,sheet_to_formulae:ZV,sheet_to_row_object_array:Um,sheet_get_cell:hc,book_new:sg,book_append_sheet:ng,book_set_sheet_visibility:ez,cell_set_number_format:tz,cell_set_hyperlink:VA,cell_set_internal_link:az,cell_add_comment:rz,sheet_set_array_formula:sz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iz=({onUpload:e,onCancel:t,loading:a=!1})=>{const[r,s]=E.useState(""),[n,l]=E.useState(null),[o,c]=E.useState(!1),[u,d]=E.useState(""),[h,f]=E.useState(null),m=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"],p=()=>{const A=document.getElementById("excelFile");A&&(A.value="")},x=async A=>{if(d(""),console.log("TaskUploadForm: Validating file:",{name:A.name,type:A.type,size:A.size}),!m.includes(A.type)&&!A.name.match(/\.(xlsx|xls)$/i)){console.error("TaskUploadForm: Invalid file type"),d("❌ Please select a valid Excel file (.xlsx or .xls)");return}if(A.size>10*1024*1024){console.error("TaskUploadForm: File too large"),d("❌ File size must be under 10MB");return}try{console.log("TaskUploadForm: Validating Excel dimensions");const S=await v(A);if(console.log("TaskUploadForm: Dimension validation result:",S),!S.valid){console.error("TaskUploadForm: Dimension validation failed:",S.error),d(`❌ ${S.error}`);return}console.log("TaskUploadForm: File validation successful"),l(A),f({columns:S.columns,rows:S.rows})}catch(S){console.error("TaskUploadForm: File validation error:",S),d("❌ Error validating file dimensions. Please try again.")}},v=A=>new Promise(S=>{const C=new FileReader;C.onload=T=>{try{const D=new Uint8Array(T.target.result),R=Mm(D,{type:"array"}),j=R.SheetNames[0],B=R.Sheets[j],X=nz.decode_range(B["!ref"]||"A1"),V=X.e.r+1,F=X.e.c+1;if(F>6){S({valid:!1,error:`File has ${F} columns. Maximum allowed is 6 columns.`});return}if(V>600){S({valid:!1,error:`File has ${V} rows. Maximum allowed is 600 rows.`});return}S({valid:!0,columns:F,rows:V})}catch(D){console.error("Excel parsing error:",D),S({valid:!1,error:"Unable to read Excel file. Please ensure it's a valid Excel file."})}},C.onerror=()=>{S({valid:!1,error:"Error reading file. Please try again."})},C.readAsArrayBuffer(A)}),g=A=>{const S=A.target.files[0];S&&x(S)},b=A=>{A.preventDefault(),A.stopPropagation(),c(["dragenter","dragover"].includes(A.type))},y=A=>{A.preventDefault(),A.stopPropagation(),c(!1);const S=A.dataTransfer.files[0];S&&x(S)},w=async A=>{if(A.preventDefault(),console.log("TaskUploadForm: Submit started"),!r.trim()){d("❌ Task title is required");return}if(!n){d("❌ Please select an Excel file");return}const S={title:r.trim(),file:n};console.log("TaskUploadForm: Calling onUpload with:",{title:S.title,fileName:S.file.name,fileSize:S.file.size,fileType:S.file.type});try{const C=await e(S);if(console.log("TaskUploadForm: Upload result:",C),C!=null&&C.success)s(""),l(null),f(null),p(),d("");else{const T=(C==null?void 0:C.error)||"❌ Upload failed";console.error("TaskUploadForm: Upload failed:",T),d(T)}}catch(C){console.error("TaskUploadForm: Upload exception:",C),d("❌ Upload error: "+C.message)}},N=()=>{l(null),f(null),p(),d("")};return i.jsx("div",{className:"w-full",children:i.jsxs("form",{onSubmit:w,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title"}),i.jsx("input",{type:"text",id:"title",value:r,onChange:A=>s(A.target.value),placeholder:"Enter task title",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Excel File"}),i.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 transition-colors ${o?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:b,onDragLeave:b,onDragOver:b,onDrop:y,children:[i.jsx("input",{type:"file",id:"excelFile",accept:".xls,.xlsx",onChange:g,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:a}),n?i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(lO,{className:"h-8 w-8 text-green-500"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[(n.size/1024/1024).toFixed(2)," MB",h&&i.jsxs("span",{className:"ml-2 text-green-600",children:["• ",h.columns," cols × ",h.rows," rows"]})]})]})]}),i.jsx("button",{type:"button",onClick:N,className:"text-red-500 hover:text-red-700",disabled:a,children:i.jsx(wa,{className:"h-5 w-5"})})]}):i.jsxs("div",{className:"text-center",children:[i.jsx(sv,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[i.jsx("span",{className:"font-medium text-blue-600 hover:text-blue-500",children:"Click to upload"})," ","or drag and drop"]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Excel files (.xlsx, .xls) under 10MB, max 6 columns × 600 rows"})]})]})]}),u&&i.jsx("div",{className:"text-red-600 text-sm bg-red-50 border border-red-200 rounded-md p-3",children:u}),i.jsxs("div",{className:"flex gap-3",children:[t&&i.jsx("button",{type:"button",onClick:t,disabled:a,className:"flex-1 flex items-center justify-center px-4 py-2 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),i.jsx("button",{type:"submit",disabled:a||!r.trim()||!n,className:"flex-1 flex items-center justify-center px-4 py-2 rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:a?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Uploading..."]}):i.jsxs(i.Fragment,{children:[i.jsx(sv,{className:"h-4 w-4 mr-2"}),"Upload Task"]})})]})]})})},lz=({onCancel:e})=>{const{user:t,loading:a}=Na(),r=t==null?void 0:t.companyId,s=(t==null?void 0:t.userId)||(t==null?void 0:t.id),n=t==null?void 0:t.role;Vb.useEffect(()=>{t&&!r&&console.error("User authenticated but missing companyId:",t)},[t,r]);const{uploadExcelFile:l}=Rp(r,s,n),[o,c]=E.useState(!1),u=E.useCallback(async d=>{var h,f;if(console.log("AddTaskForm: Upload started with:",{title:d.title,fileName:(h=d.file)==null?void 0:h.name,fileSize:(f=d.file)==null?void 0:f.size,companyId:r,userId:s,role:n}),!r)return console.error("AddTaskForm: Missing companyId"),oe("❌ Company ID is required. Please log in again."),{success:!1,error:"Missing company ID"};if(!s)return console.error("AddTaskForm: Missing userId"),oe("❌ User ID is required. Please log in again."),{success:!1,error:"Missing user ID"};if(typeof l!="function")return console.error("AddTaskForm: Upload function not available"),oe("❌ Upload function not available."),{success:!1,error:"Upload handler not ready"};c(!0);try{console.log("AddTaskForm: Calling uploadExcelFile");const m=await l(d);if(console.log("AddTaskForm: Upload result:",m),m.success)oe("✅ Task uploaded successfully!");else{const p=m.error||"Unknown error";console.error("AddTaskForm: Upload failed:",p),oe("❌ Failed to upload task: "+p)}return m}catch(m){return console.error("AddTaskForm: Upload exception:",m),oe("❌ Upload error: "+m.message),{success:!1,error:m.message}}finally{c(!1)}},[l,s,r,n]);return a?i.jsxs("div",{className:"flex items-center justify-center h-64",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading..."})]}):t?r?i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsx(iz,{onUpload:u,onCancel:e,loading:o})}):i.jsx("div",{className:"text-center text-red-600 p-8",children:i.jsx("p",{children:"Company information is missing. Please log in again."})}):i.jsx("div",{className:"text-center text-red-600 p-8",children:i.jsx("p",{children:"Please log in to upload tasks."})})},_b=({onSuccess:e,onCancel:t})=>{const{user:a}=Na(),r=a==null?void 0:a.companyId,s=a==null?void 0:a.role,n=(a==null?void 0:a.userId)||(a==null?void 0:a.id),{createUser:l,loading:o}=Rs(r,s,n),[c,u]=E.useState(!1),d=s==="DEVELOPER"?c:o,[h,f]=E.useState({name:"",email:"",phone:"",password:"",confirmPassword:"",role:s==="DEVELOPER"?"DIRECTOR":"USER",adminId:"",companyId:s==="DEVELOPER"?"":r}),[m,p]=E.useState([]),[x,v]=E.useState(!1),[g,b]=E.useState([]),[y,w]=E.useState(!1),A=E.useCallback(()=>{const j=[];return s==="DEVELOPER"?j.push({value:"DIRECTOR",label:"Director"}):s==="DIRECTOR"?j.push({value:"ADMIN",label:"Admin"},{value:"USER",label:"User"}):s==="ADMIN"&&j.push({value:"USER",label:"User"}),j},[s])(),S=E.useCallback(async()=>{if(s==="DEVELOPER"){w(!0);try{const j=await Dt.getAllCompanies();j.success?b(j.data||[]):(b([]),oe("❌ Failed to load companies: "+j.error))}catch(j){b([]),oe("❌ Error loading companies: "+j.message)}finally{w(!1)}}},[s]);E.useEffect(()=>{s==="DEVELOPER"&&S()},[s,S]);const C=E.useCallback(async()=>{if(!(!r||s!=="DIRECTOR")){v(!0);try{const j=await Re.getAdminRoleByCompany(r);if(j.success&&j.data&&j.data.length>0)p(j.data||[]);else{const B=await Re.getAllUsersByCompany(r);if(B.success){const X=B.data.filter(V=>V.role==="ADMIN");p(X)}else p([])}}catch{p([])}finally{v(!1)}}},[r,s]);E.useEffect(()=>{h.role==="USER"&&s==="DIRECTOR"&&C()},[h.role,s,C]),E.useEffect(()=>{s==="DIRECTOR"&&C()},[s,C]);const T=E.useCallback(()=>{const j=s==="DEVELOPER"?h.companyId:r,B=h.name.trim()&&h.email.trim()&&h.phone.trim()&&h.password.trim()&&h.confirmPassword.trim()&&h.role&&j&&A.length>0;return s==="DIRECTOR"&&h.role==="USER"||s==="ADMIN"&&h.role==="USER"||s==="DIRECTOR"&&h.role==="ADMIN",B},[h,r,A,s]),D=E.useCallback(async j=>{j.preventDefault();const B=s==="DEVELOPER"?h.companyId:r;if(!B){oe(s==="DEVELOPER"?"❌ Please select a company.":"❌ Company ID not found. Please login again.");return}if(h.password!==h.confirmPassword){oe("❌ Passwords do not match!");return}try{const X=s==="ADMIN"?"USER":s==="DEVELOPER"?"DIRECTOR":h.role,V=s==="ADMIN"?n:h.adminId,F={name:h.name,email:h.email,phone:h.phone,password:h.password,confirmPassword:h.confirmPassword,role:X,company:{id:parseInt(B,10)},admin:X==="USER"&&V?{userId:parseInt(V,10)}:null};delete F.confirmPassword;let q;if(s==="DEVELOPER"){u(!0);try{q=await Re.createUser(F)}finally{u(!1)}}else q=await l(F);q.success?(oe(`✅ ${X==="DIRECTOR"?"Director":X==="ADMIN"?"Admin":"User"} created successfully!`),f({name:"",email:"",phone:"",password:"",confirmPassword:"",role:s==="DEVELOPER"?"DIRECTOR":"USER",adminId:"",companyId:s==="DEVELOPER"?"":r}),e==null||e()):oe(q.error||"Failed to create user")}catch(X){oe(X.message||"Error adding user")}},[h,r,l,e,s,n]),R=E.useCallback(j=>{const{name:B,value:X}=j.target;f(V=>({...V,[B]:X})),B==="role"&&X==="USER"&&s==="DIRECTOR"&&C(),B==="role"&&X==="ADMIN"&&f(V=>({...V,adminId:""}))},[s,C]);return i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4",children:i.jsxs("div",{className:"flex items-center text-white",children:[i.jsx(es,{className:"mr-3",size:24}),i.jsx("h2",{className:"text-xl font-semibold",children:"Add New User"})]})}),i.jsxs("div",{className:"p-6",children:[!r&&s!=="DEVELOPER"&&i.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:"⚠️ Company ID not found. Please login again."}),s==="USER"&&i.jsx("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded",children:"⚠️ You don't have permission to create users."}),s==="DEVELOPER"&&i.jsx("div",{className:"mb-4 p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded",children:"ℹ️ As a Developer, you can create Directors for any company. Please select the company first."}),i.jsxs("form",{onSubmit:D,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s==="DEVELOPER"&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Company *"}),i.jsxs("select",{name:"companyId",value:h.companyId,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:y,children:[i.jsx("option",{value:"",children:y?"Loading companies...":"Select Company"}),g.map(j=>i.jsx("option",{value:j.id,children:j.name},j.id))]}),g.length===0&&!y&&i.jsx("div",{className:"text-sm text-red-600 mt-1",children:i.jsx("p",{children:"No companies available. Please create a company first."})}),g.length>0&&!y&&i.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[g.length," company(ies) available"]}),i.jsx("button",{type:"button",onClick:S,disabled:y,className:"text-xs text-blue-600 hover:text-blue-800 mt-1",children:y?"Loading...":"Refresh Companies"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),i.jsx("input",{type:"text",name:"name",value:h.name,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),i.jsx("input",{type:"email",name:"email",value:h.email,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),i.jsx("input",{type:"tel",name:"phone",value:h.phone,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),i.jsx("input",{type:"password",name:"password",value:h.password,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),i.jsx("input",{type:"password",name:"confirmPassword",value:h.confirmPassword,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(s==="DEVELOPER"||s==="DIRECTOR")&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),i.jsx("select",{name:"role",value:h.role,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:A.map(j=>i.jsx("option",{value:j.value,children:j.label},j.value))})]}),h.role==="USER"&&s==="DIRECTOR"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Admin (Optional)"}),i.jsxs("select",{name:"adminId",value:h.adminId,onChange:R,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:x,children:[i.jsx("option",{value:"",children:x?"Loading admins...":"Select Admin"}),m.map(j=>i.jsx("option",{value:j.userId,children:j.name},j.userId))]}),m.length===0&&!x&&i.jsx("div",{className:"text-sm text-red-600 mt-1",children:i.jsx("p",{children:"No admins available. Please create an admin first."})}),m.length>0&&!x&&i.jsxs("p",{className:"text-sm text-green-600 mt-1",children:[m.length," admin(s) available for assignment"]}),i.jsx("button",{type:"button",onClick:C,disabled:x,className:"text-xs text-blue-600 hover:text-blue-800 mt-1",children:x?"Loading...":"Refresh Admins"})]}),s==="ADMIN"&&i.jsx("div",{className:"md:col-span-2",children:i.jsx("div",{className:"p-3 bg-blue-100 border border-blue-400 text-blue-700 rounded",children:"ℹ️ As an Admin, you can only create Users. The user will be automatically assigned to you."})}),s==="DEVELOPER"&&i.jsx("div",{className:"md:col-span-2",children:i.jsx("div",{className:"p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:"ℹ️ As a Developer, you can create Directors for any company. Directors will manage their company operations and can create admins and users."})})]}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[i.jsxs("button",{type:"button",onClick:t||(()=>e==null?void 0:e()),className:"flex items-center px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors",children:[i.jsx(bp,{size:18,className:"mr-2"}),"Cancel"]}),i.jsxs("button",{type:"submit",disabled:d||!T(),className:`flex items-center px-6 py-3 text-white font-medium rounded-lg transition-colors duration-200 ${d?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} ${!T()&&!d?"bg-gray-400 cursor-not-allowed":""}`,children:[i.jsx(es,{size:18,className:"mr-2"}),d?"Adding...":"Add User"]})]})]})]})]})})};function oz(){const[e,t]=E.useState(""),[a,r]=E.useState(""),[s,n]=E.useState(""),[l,o]=E.useState(""),[c,u]=E.useState("SmartProCare"),[d,h]=E.useState(!1),[f,m]=E.useState(!0),{currentSection:p,navigateToSection:x,goBack:v}=jF("ViewDashboard");if(E.useEffect(()=>{console.log("Dashboard: Active section changed to:",p)},[p]),E.useEffect(()=>{const A=setTimeout(()=>{const S=localStorage.getItem("user"),C=localStorage.getItem("token");if(S&&C)try{const T=JSON.parse(S),D=T.userId||T.id||"",R=T.role||"",j=T.companyId||"";if(!D||!R){localStorage.clear(),window.location.href="/";return}t(R),r(T.name||""),n(D),o(j||""),T.companyName&&u(T.companyName),m(!1)}catch{localStorage.clear(),window.location.href="/"}else localStorage.clear(),window.location.href="/"},100);return()=>clearTimeout(A)},[]),f)return i.jsx("div",{className:"flex h-screen bg-gray-100 items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});const g=()=>{localStorage.clear(),window.location.href="/"},b=N=>{console.log("🎯 Dashboard: handleAddAction called with action:",N),console.log("🎯 Dashboard: Current section before add action:",p),console.log("🎯 Dashboard: About to navigate to:",N),x(N)},y=N=>{console.log("🧭 Dashboard: Sidebar navigation to section:",N),console.log("🧭 Dashboard: Current section before sidebar navigation:",p),console.log("🧭 Dashboard: About to navigate to:",N),x(N)},w=()=>{switch(p){case"ViewDashboard":return i.jsx(MF,{});case"ViewUsers":return i.jsx(zF,{});case"ViewLead":return i.jsx(h8,{userRole:e,userId:s,companyId:l});case"ViewProperty":return i.jsx(j8,{userRole:e,userId:s,companyId:l});case"ViewNotes":return i.jsx(z8,{});case"ViewTask":return i.jsx($8,{userRole:e,userId:s,companyId:l});case"ViewNotification":return i.jsx(q8,{});case"ViewAccount":return i.jsx(Y8,{});case"ViewCompany":return i.jsx(J8,{});case"addCompany":return i.jsx(tL,{onCancel:v});case"User":return i.jsx(_b,{onCancel:v});case"AddAdmin":return i.jsx(_b,{onCancel:v});case"Lead":return i.jsx(aL,{onCancel:v});case"Properties":return i.jsx(sL,{onCancel:v});case"Notes":return i.jsx(rL,{onCancel:v});case"Task":return i.jsx(lz,{onCancel:v});case"ViewAdmins":return i.jsx(W8,{});case"ViewDirectors":return i.jsx(eL,{});case"logout":return g(),null;default:return i.jsx("div",{className:"text-center text-red-500",children:"🚫 No Access"})}};return i.jsxs("div",{className:"flex h-screen bg-gray-50 text-gray-900 overflow-hidden",children:[i.jsx("div",{className:"hidden lg:block",children:i.jsx(nv,{userRole:e,activeSection:p,onSectionChange:y,companyName:c,userName:a})}),i.jsx(Jn,{children:d&&i.jsxs(wt.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{duration:.3},className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex lg:hidden",children:[i.jsx(nv,{userRole:e,activeSection:p,onSectionChange:N=>{y(N),h(!1)},companyName:c,userName:a}),i.jsx("div",{className:"flex-1",onClick:()=>h(!1)})]})}),i.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[i.jsx(OF,{userName:a,userRole:e,companyName:c,onLogout:g,onAddAction:b,onSectionChange:y,onSidebarToggle:()=>h(!0)}),i.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50",children:i.jsxs("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-2 md:py-3 max-w-7xl",children:[i.jsx(FF,{currentSection:p,onSectionClick:y}),i.jsx("div",{className:"min-h-fit",children:w()})]})})]})]})}const cz=({onBack:e})=>{const[t,a]=E.useState(""),[r,s]=E.useState(""),[n,l]=E.useState(""),[o,c]=E.useState(!1),[u,d]=E.useState(!1),[h,f]=E.useState(!1),[m,p]=E.useState(!1),{sendOtp:x,verifyOtp:v,resetPasswordWithOtp:g}=Na(),b=async()=>{if(!t)return oe("❌ Email is required");d(!0);const N=await x(t);d(!1),oe(N.success?"📨 OTP sent to your email":`❌ ${N.error}`)},y=async()=>{if(!r)return oe("❌ Enter OTP to verify");f(!0);try{const N=await v(t,r);f(!1),N.success&&N.valid?oe("✅ OTP Verified"):oe(`❌ ${N.error||"Invalid OTP"}`)}catch(N){f(!1),oe(`❌ Network error: ${N.message}`)}},w=async()=>{if(!n)return oe("❌ Enter new password");p(!0);try{const N=await g(t,n);p(!1),N.success?(oe("✅ Password changed successfully"),e&&e()):oe(`❌ ${N.error}`)}catch(N){p(!1),oe(`❌ Network error: ${N.message}`)}};return i.jsxs("div",{className:"space-y-6",children:[i.jsx("h2",{className:"text-xl font-bold text-[#1c69ff] text-center mb-4",children:"Forget Password?"}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold text-[#1c69ff] mb-1 block",children:"Enter your email"}),i.jsxs("div",{className:"flex items-center bg-blue-50 rounded px-3 py-2",children:[i.jsx(Dr,{size:16,className:"mr-2 text-[#1c69ff]"}),i.jsx("input",{type:"email",value:t,onChange:N=>a(N.target.value),placeholder:"Email",className:"w-full outline-none bg-transparent text-sm"}),i.jsx("button",{onClick:b,disabled:u,className:`bg-[#1c69ff] text-white text-xs px-3 py-1 rounded ml-2 transition duration-200 ${u?"opacity-50 cursor-not-allowed":""}`,children:u?"Sending...":"Send OTP"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold text-[#1c69ff] mb-1 block",children:"Enter OTP"}),i.jsxs("div",{className:"flex items-center bg-blue-50 rounded px-3 py-2",children:[i.jsx(gs,{size:16,className:"mr-2 text-[#1c69ff]"}),i.jsx("input",{type:"text",value:r,onChange:N=>s(N.target.value),placeholder:"OTP",className:"w-full outline-none bg-transparent text-sm"}),i.jsx("button",{onClick:y,disabled:h,className:`bg-[#1c69ff] text-white text-xs px-3 py-1 rounded ml-2 ${h?"opacity-50 cursor-not-allowed":""}`,children:h?"Verifying...":"Verify"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-semibold text-[#1c69ff] mb-1 block",children:"Enter New Password"}),i.jsxs("div",{className:"flex items-center bg-blue-50 rounded px-3 py-2 relative",children:[i.jsx(AS,{size:16,className:"mr-2 text-[#1c69ff]"}),i.jsx("input",{type:o?"text":"password",value:n,onChange:N=>l(N.target.value),placeholder:"New Password",className:"w-full outline-none bg-transparent text-sm pr-6",autoComplete:"new-password"}),i.jsx("div",{className:"absolute right-3 cursor-pointer text-[#1c69ff]",onClick:()=>c(!o),children:o?i.jsx(SS,{size:16}):i.jsx(ya,{size:16})})]})]}),i.jsx("button",{onClick:w,disabled:m,className:`w-full bg-[#1c69ff] hover:bg-[#1554cc] text-white font-bold py-2 rounded text-sm ${m?"opacity-50 cursor-not-allowed":""}`,children:m?"Saving...":"SAVE CHANGES"}),i.jsx("p",{className:"text-center text-xs text-gray-500 mt-4 cursor-pointer hover:underline",onClick:e,children:"Back to Login"})]})},uz=({isOpen:e,onClose:t,userEmail:a})=>{const[r,s]=E.useState(null),[n,l]=E.useState(!0),[o,c]=E.useState(!1);E.useEffect(()=>{e&&a&&u()},[e,a]);const u=async()=>{l(!0);try{const m=await fetch(`/api/users/role-by-email?email=${encodeURIComponent(a)}`);if(m.ok){const p=await m.json();s(p.role)}else{const p=localStorage.getItem("user");if(p){const x=JSON.parse(p);s(x.role||"USER")}else s("USER")}}catch{s("USER")}finally{l(!1)}},d=()=>{c(!0),t()},h=()=>{switch(r){case"USER":return{title:"Contact Admin",description:"Your account has been deactivated. Please contact your Admin to reactivate your account.",contacts:[{type:"SMS",icon:i.jsx($u,{className:"w-5 h-5"}),label:"Send SMS to Admin",action:()=>window.open("sms:+1234567890?body=Hello Admin, my account has been deactivated. Please help me reactivate it."),color:"bg-green-500 hover:bg-green-600"},{type:"Email",icon:i.jsx(gs,{className:"w-5 h-5"}),label:"Email Admin",action:()=>window.open("mailto:admin@company.com?subject=Account Deactivation&body=Hello Admin, my account has been deactivated. Please help me reactivate it."),color:"bg-blue-500 hover:bg-blue-600"},{type:"Call",icon:i.jsx(Jr,{className:"w-5 h-5"}),label:"Call Admin",action:()=>window.open("tel:+1234567890"),color:"bg-purple-500 hover:bg-purple-600"}],roleIcon:i.jsx(Dr,{className:"w-8 h-8 text-blue-500"}),roleColor:"text-blue-600"};case"ADMIN":return{title:"Contact Director",description:"Your admin account has been deactivated. Please contact your Director to reactivate your account.",contacts:[{type:"SMS",icon:i.jsx($u,{className:"w-5 h-5"}),label:"Send SMS to Director",action:()=>window.open("sms:+1234567891?body=Hello Director, my admin account has been deactivated. Please help me reactivate it."),color:"bg-green-500 hover:bg-green-600"},{type:"Email",icon:i.jsx(gs,{className:"w-5 h-5"}),label:"Email Director",action:()=>window.open("mailto:director@company.com?subject=Admin Account Deactivation&body=Hello Director, my admin account has been deactivated. Please help me reactivate it."),color:"bg-blue-500 hover:bg-blue-600"},{type:"Call",icon:i.jsx(Jr,{className:"w-5 h-5"}),label:"Call Director",action:()=>window.open("tel:+1234567891"),color:"bg-purple-500 hover:bg-purple-600"}],roleIcon:i.jsx(F0,{className:"w-8 h-8 text-orange-500"}),roleColor:"text-orange-600"};case"DIRECTOR":return{title:"Contact Support",description:"Your director account has been deactivated. Please contact our support team for assistance.",contacts:[{type:"SMS",icon:i.jsx($u,{className:"w-5 h-5"}),label:"Send SMS to Support",action:()=>window.open("sms:+1234567892?body=Hello Support, my director account has been deactivated. Please help me reactivate it."),color:"bg-green-500 hover:bg-green-600"},{type:"Email",icon:i.jsx(gs,{className:"w-5 h-5"}),label:"Email Support",action:()=>window.open("mailto:support@leadstracker.com?subject=Director Account Deactivation&body=Hello Support Team, my director account has been deactivated. Please help me reactivate it."),color:"bg-blue-500 hover:bg-blue-600"},{type:"Call",icon:i.jsx(Jr,{className:"w-5 h-5"}),label:"Call Support",action:()=>window.open("tel:+1234567892"),color:"bg-purple-500 hover:bg-purple-600"}],roleIcon:i.jsx(to,{className:"w-8 h-8 text-red-500"}),roleColor:"text-red-600"};default:return{title:"Contact Support",description:"Your account has been deactivated. Please contact support for assistance.",contacts:[{type:"Email",icon:i.jsx(gs,{className:"w-5 h-5"}),label:"Email Support",action:()=>window.open("mailto:support@leadstracker.com?subject=Account Deactivation&body=Hello Support Team, my account has been deactivated. Please help me reactivate it."),color:"bg-blue-500 hover:bg-blue-600"}],roleIcon:i.jsx(Dr,{className:"w-8 h-8 text-gray-500"}),roleColor:"text-gray-600"}}};if(!e)return null;const f=h();return i.jsx(Jn,{children:i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:i.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[i.jsx(wt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:o?t:void 0}),i.jsxs(wt.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[f.roleIcon,i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Account Deactivated"}),i.jsxs("p",{className:`text-sm font-medium ${f.roleColor}`,children:["Role: ",r]})]})]}),i.jsx("button",{onClick:o?t:void 0,disabled:!o,className:`transition-colors ${o?"text-gray-400 hover:text-gray-600 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,children:i.jsx(wa,{className:"w-6 h-6"})})]}),n?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading..."})]}):i.jsxs(i.Fragment,{children:[!o&&i.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:i.jsx("p",{className:"text-sm text-yellow-800 text-center font-medium",children:"⚠️ Please read this message carefully before proceeding"})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:f.title}),i.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:f.description}),i.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:i.jsxs("p",{className:"text-xs text-gray-500",children:[i.jsx("strong",{children:"Account:"})," ",a]})})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h5",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Contact Options:"}),f.contacts.map((m,p)=>i.jsxs(wt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:m.action,className:`w-full flex items-center justify-center space-x-3 px-4 py-3 rounded-lg text-white font-medium transition-all duration-200 ${m.color}`,children:[m.icon,i.jsx("span",{children:m.label})]},p))]}),i.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:i.jsx("button",{onClick:d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200",children:"OK, I Understand"})}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Once your account is reactivated, you'll be able to log in normally."})})]})]})]})})})},dz=()=>{const[e,t]=E.useState({email:"",password:""}),[a,r]=E.useState(""),[s,n]=E.useState(!1),[l,o]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[f,m]=E.useState(""),[p,x]=E.useState(!1),v=UE(),{login:g}=Na();E.useEffect(()=>{if(a){const w=setTimeout(()=>r(""),4e3);return()=>clearTimeout(w)}},[a]);const b=w=>t({...e,[w.target.name]:w.target.value}),y=async w=>{w.preventDefault(),r(""),u(!0);try{const N=await _p.login(e);if(N.success){g(N.user,N.token);const A=localStorage.getItem("redirectUrl");A?(localStorage.removeItem("redirectUrl"),v(A)):v("/dashboard")}else N.isDeactivated?(m(N.userEmail||e.email),h(!0),x(!0)):r(N.error||"Login failed")}catch(N){r((N==null?void 0:N.message)||"Login failed")}finally{u(!1)}};return i.jsxs("div",{className:"flex min-h-screen bg-white font-sans flex-col md:flex-row",children:[i.jsxs("div",{className:"md:hidden flex flex-col items-center justify-center pt-8 pb-4 text-[#1c69ff]",children:[i.jsx("h1",{className:"text-3xl font-extrabold tracking-wide uppercase",children:"LEADS TRACKER"}),i.jsx("p",{className:"text-xs tracking-wider mt-1",children:"Track Leads, Close Faster"})]}),i.jsxs(wt.div,{className:"hidden md:flex md:w-1/2 flex-col justify-center items-center text-[#1c69ff]",initial:{opacity:0,x:-100},animate:{opacity:1,x:0},transition:{duration:.8},children:[i.jsx("h1",{className:"text-5xl font-extrabold tracking-wide mb-2 uppercase",children:"LEADS TRACKER"}),i.jsx("p",{className:"text-sm tracking-wider mb-10",children:"Track Leads, Close Faster"}),i.jsx("img",{src:"/images/building-logo.jpeg",alt:"Logo",className:"w-48 sm:w-72 md:w-[420px] h-auto"})]}),i.jsx("div",{className:"w-full md:w-1/2 flex flex-1 justify-center items-center px-4 py-8 md:py-0",style:{perspective:"1200px"},children:i.jsxs(wt.div,{className:"relative w-full max-w-[500px] min-h-[520px] md:h-[600px] rounded-xl shadow-xl",animate:{rotateY:s?180:0},transition:{duration:.8},style:{transformStyle:"preserve-3d"},children:[i.jsxs("div",{className:"absolute w-full h-full bg-white border border-gray-200 rounded-xl p-6 sm:p-8 md:p-10 overflow-y-auto",style:{backfaceVisibility:"hidden"},children:[p&&i.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 z-10 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:"🔒"}),i.jsx("p",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Account Deactivated"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Please check the modal above for instructions"})]})}),i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-[#1c69ff] text-center mb-8",children:"Welcome Back!"}),a&&i.jsx(wt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4 shadow-sm",children:i.jsx("p",{className:"text-red-600 text-sm text-center font-medium",children:a})}),i.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-[#1c69ff] mb-1",children:"Your Email"}),i.jsxs("div",{className:"flex items-center border border-black rounded px-3 py-3 bg-gray-100",children:[i.jsx(gs,{size:18,className:"mr-2 text-black"}),i.jsx("input",{name:"email",type:"email",placeholder:"Username",value:e.email,onChange:b,className:"w-full outline-none text-sm bg-transparent",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-[#1c69ff] mb-1",children:"Password"}),i.jsxs("div",{className:"flex items-center border border-black rounded px-3 py-3 bg-gray-100 relative",children:[i.jsx(AS,{size:18,className:"mr-2 text-black"}),i.jsx("input",{name:"password",type:l?"text":"password",placeholder:"Password",value:e.password,onChange:b,className:"w-full outline-none text-sm bg-transparent pr-6",required:!0}),i.jsx("div",{className:"absolute right-3 cursor-pointer text-black",onClick:()=>o(!l),children:l?i.jsx(SS,{size:18}):i.jsx(ya,{size:18})})]})]}),i.jsx("div",{className:"text-right text-xs text-black hover:underline cursor-pointer",onClick:()=>n(!0),children:"Forgot Password?"}),i.jsx("button",{type:"submit",disabled:c,className:`w-full bg-[#1c69ff] hover:bg-[#1554cc] text-white font-bold py-3 rounded text-sm transition-all duration-200 ${c?"opacity-50 cursor-not-allowed":""}`,children:c?"Logging in...":"Log in"})]})]}),i.jsxs("div",{className:"absolute w-full h-full bg-white border border-gray-200 rounded-xl p-6 sm:p-8 md:p-10 overflow-y-auto",style:{transform:"rotateY(180deg)",backfaceVisibility:"hidden"},children:[p&&i.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 z-10 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:"🔒"}),i.jsx("p",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Account Deactivated"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Please check the modal above for instructions"})]})}),i.jsx(cz,{onBack:()=>n(!1)})]})]})}),d&&i.jsx(uz,{isOpen:d,onClose:()=>{h(!1),x(!1)},userEmail:f}),d&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:i.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full m-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Deactivated"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Your account has been deactivated. Please contact your administrator to reactivate it."}),i.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Account: ",f]}),i.jsx("button",{onClick:()=>{h(!1),x(!1)},className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg",children:"OK, I Understand"})]})})]})},fz=({onClose:e})=>{const{taskId:t}=BE(),{user:a,loading:r}=Na(),s=a==null?void 0:a.companyId,n=(a==null?void 0:a.userId)||(a==null?void 0:a.id),l=a==null?void 0:a.role,{updateCell:o,deleteColumn:c,previewExcel:u}=Rp(s,n,l),[d,h]=E.useState([]),[f,m]=E.useState(!1),[p,x]=E.useState(""),[v,g]=E.useState(null),[b,y]=E.useState(""),w=E.useRef(null);E.useEffect(()=>{t&&s&&N()},[t,s]);const N=async()=>{m(!0),x("");try{const B=await u(t);B.success?(h(B.data||[]),y(`Task #${t}`)):x(B.error||"Failed to load preview")}catch{x("Failed to load preview data")}finally{m(!1)}},A=B=>{let X="",V=B;for(;V>=0;)X=String.fromCharCode(65+V%26)+X,V=Math.floor(V/26)-1;return X},S=async(B,X,V)=>{var te;const F=((te=d[B])==null?void 0:te[X])||"",q=[...d];q[B]||(q[B]=[]),q[B][X]=V,h(q);try{const H=await o(t,B,X,V);if(!H.success){const le=[...d];le[B][X]=F,h(le),x(H.error||"Failed to update cell")}}catch{const le=[...d];le[B][X]=F,h(le),x("Failed to update cell")}},C=async()=>{if(v===null){x("Please select a column to delete");return}try{const B=await c(t,v);if(B.success){const X=d.map(V=>{const F=[...V];return F.splice(v,1),F});h(X),g(null),x("")}else x(B.error||"Failed to delete column")}catch{x("Failed to delete column")}},T=B=>{g(v===B?null:B)},D=()=>{w.current&&w.current.scrollBy({left:-200,behavior:"smooth"})},R=()=>{w.current&&w.current.scrollBy({left:200,behavior:"smooth"})},j=d.length>0?Math.max(...d.map(B=>B.length)):0;return r?i.jsxs("div",{className:"h-screen flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading..."})]}):a?i.jsxs("div",{className:"h-screen flex flex-col bg-white",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Excel Editor"}),i.jsx("p",{className:"text-sm text-gray-600",children:b})]}),i.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100",children:i.jsx(wa,{className:"h-6 w-6"})})]}),i.jsxs("div",{className:"flex items-center gap-2 p-4 bg-gray-50 border-b border-gray-200 flex-wrap",children:[i.jsxs("button",{onClick:C,disabled:v===null,className:"flex items-center px-3 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Fc,{className:"h-4 w-4 mr-1"}),"Delete Column ",v!==null?A(v):""]}),i.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[i.jsx("button",{onClick:D,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded",children:i.jsx(Ep,{className:"h-4 w-4"})}),i.jsx("button",{onClick:R,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded",children:i.jsx(Ed,{className:"h-4 w-4"})})]})]}),p&&i.jsx("div",{className:"mx-4 mt-2 text-red-600 text-sm bg-red-50 border border-red-200 rounded-md p-3",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:p}),i.jsx("button",{onClick:()=>x(""),className:"text-red-500 hover:text-red-700",children:"×"})]})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:f?i.jsxs("div",{className:"flex items-center justify-center h-full",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading..."})]}):i.jsx("div",{ref:w,className:"h-full overflow-auto p-4",children:i.jsxs("table",{className:"border-collapse min-w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"sticky left-0 z-10 bg-gray-100 border border-gray-300 p-2 text-center font-semibold min-w-16",children:"Row"}),Array.from({length:j},(B,X)=>i.jsx("th",{className:`sticky top-0 border border-gray-300 p-2 text-center font-semibold min-w-20 cursor-pointer ${v===X?"bg-blue-200":"bg-gray-100 hover:bg-gray-200"}`,onClick:()=>T(X),children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("span",{children:A(X)}),i.jsx("div",{className:"mt-1 text-xs text-gray-500",children:v===X?"Selected":"Click to select"})]})},X))]})}),i.jsx("tbody",{children:d.map((B,X)=>i.jsxs("tr",{children:[i.jsx("td",{className:"sticky left-0 z-10 bg-gray-50 border border-gray-300 p-2 text-center font-medium",children:X+1}),Array.from({length:j},(V,F)=>i.jsx("td",{className:`border border-gray-300 p-0 min-w-20 ${v===F?"bg-blue-50":""}`,children:i.jsx("input",{type:"text",value:B[F]||"",onChange:q=>{const te=[...d];te[X]||(te[X]=[]),te[X][F]=q.target.value,h(te)},onBlur:q=>S(X,F,q.target.value),className:"w-full h-full p-2 border-none outline-none focus:bg-blue-50 focus:ring-2 focus:ring-blue-400"})},F))]},X))})]})})})]}):i.jsx("div",{className:"h-screen flex items-center justify-center",children:i.jsxs("div",{className:"text-center text-red-600",children:[i.jsx("p",{children:"Please log in to access the Excel editor."}),i.jsx("button",{onClick:e,className:"mt-4 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close"})]})})},hz=()=>{const{taskId:e}=BE();UE();const t=()=>{window.close()};return e||localStorage.getItem("currentTaskId")?i.jsx("div",{className:"min-h-screen bg-gray-100",children:i.jsx("div",{className:"container mx-auto p-4",children:i.jsx(fz,{onClose:t})})}):i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Invalid Task ID"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 mb-4",children:"No task ID provided."}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close"})]})]})})};class mz{constructor(){this.blockedIPs=new Set,this.suspiciousPatterns=[/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/data:text\/html/gi,/vbscript:/gi,/expression\s*\(/gi]}sanitizeRequestData(t){if(!t||typeof t!="object")return t;const a={};for(const[r,s]of Object.entries(t))this.isValidField(r)&&this.isValidValue(s)&&(a[r]=this.sanitizeValue(s));return a}isValidField(t){return!(typeof t!="string"||["__proto__","constructor","prototype"].includes(t)||this.suspiciousPatterns.some(r=>r.test(t)))}isValidValue(t){return!(t==null||typeof t=="string"&&(this.suspiciousPatterns.some(a=>a.test(t))||t.length>1e4))}sanitizeValue(t){return typeof t=="string"&&(t=t.replace(/<[^>]*>/g,""),t=t.replace(/[<>\"'&]/g,""),t=t.trim()),t}addSecurityHeaders(t={}){return{...t,"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Permissions-Policy":"geolocation=(), microphone=(), camera=()","X-Request-ID":this.generateRequestId(),"X-Timestamp":Date.now().toString()}}generateRequestId(){return`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}validateResponse(t){if(!t)throw new Error("Invalid response received");if(t.data&&typeof t.data=="object"){const a=JSON.stringify(t.data);if(this.suspiciousPatterns.some(r=>r.test(a)))throw new Error("Suspicious content detected in response")}return t}shouldBlockRequest(t){return!!(t.url&&[/javascript:/,/data:text\/html/,/vbscript:/,/file:\/\//,/ftp:\/\//].some(r=>r.test(t.url))||t.headers&&["X-Forwarded-For","X-Real-IP","X-Forwarded-Host"].some(r=>t.headers[r]))}logSecurityEvent(t,a={}){new Date().toISOString(),navigator.userAgent,window.location.href}}const io=new mz;class xz{constructor(){this.axios=K,this.security=io}async secureGet(t,a={}){try{if(this.security.shouldBlockRequest({url:t,...a}))throw new Error("Request blocked for security reasons");const r={...a,headers:this.security.addSecurityHeaders(a.headers)},s=await this.axios.get(t,r);return this.security.validateResponse(s)}catch(r){throw this.security.logSecurityEvent("API_GET_ERROR",{url:t,error:r.message}),r}}async securePost(t,a={},r={}){try{if(this.security.shouldBlockRequest({url:t,...r}))throw new Error("Request blocked for security reasons");const s=this.security.sanitizeRequestData(a),n={...r,headers:this.security.addSecurityHeaders(r.headers)},l=await this.axios.post(t,s,n);return this.security.validateResponse(l)}catch(s){throw this.security.logSecurityEvent("API_POST_ERROR",{url:t,error:s.message}),s}}async securePut(t,a={},r={}){try{if(this.security.shouldBlockRequest({url:t,...r}))throw new Error("Request blocked for security reasons");const s=this.security.sanitizeRequestData(a),n={...r,headers:this.security.addSecurityHeaders(r.headers)},l=await this.axios.put(t,s,n);return this.security.validateResponse(l)}catch(s){throw this.security.logSecurityEvent("API_PUT_ERROR",{url:t,error:s.message}),s}}async secureDelete(t,a={}){try{if(this.security.shouldBlockRequest({url:t,...a}))throw new Error("Request blocked for security reasons");const r={...a,headers:this.security.addSecurityHeaders(a.headers)},s=await this.axios.delete(t,r);return this.security.validateResponse(s)}catch(r){throw this.security.logSecurityEvent("API_DELETE_ERROR",{url:t,error:r.message}),r}}async securePatch(t,a={},r={}){try{if(this.security.shouldBlockRequest({url:t,...r}))throw new Error("Request blocked for security reasons");const s=this.security.sanitizeRequestData(a),n={...r,headers:this.security.addSecurityHeaders(r.headers)},l=await this.axios.patch(t,s,n);return this.security.validateResponse(l)}catch(s){throw this.security.logSecurityEvent("API_PATCH_ERROR",{url:t,error:s.message}),s}}async secureFileUpload(t,a,r={}){try{if(this.security.shouldBlockRequest({url:t,...r}))throw new Error("Request blocked for security reasons");if(!a||!(a instanceof FormData))throw new Error("Invalid file data");const s={...r,headers:{...this.security.addSecurityHeaders(r.headers),"Content-Type":"multipart/form-data"}},n=await this.axios.post(t,a,s);return this.security.validateResponse(n)}catch(s){throw this.security.logSecurityEvent("API_FILE_UPLOAD_ERROR",{url:t,error:s.message}),s}}async secureBatch(t){try{const a=t.map(({method:r,url:s,data:n,config:l})=>{switch(r.toLowerCase()){case"get":return this.secureGet(s,l);case"post":return this.securePost(s,n,l);case"put":return this.securePut(s,n,l);case"delete":return this.secureDelete(s,l);case"patch":return this.securePatch(s,n,l);default:throw new Error(`Unsupported HTTP method: ${r}`)}});return await Promise.all(a)}catch(a){throw this.security.logSecurityEvent("API_BATCH_ERROR",{error:a.message}),a}}getSecurityStatus(){return{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,isSecure:window.location.protocol==="https:",hasValidToken:!!localStorage.getItem("token"),securityFeatures:{rateLimiting:!0,requestValidation:!0,responseValidation:!0,headerSecurity:!0,dataSanitization:!0}}}}const Xl=new xz,Rb={production:{api:{baseURL:({}.VITE_API_BASE_URL||"http://localhost:8083")+"/api",timeout:3e4,maxRetries:3,enableHTTPS:!0,enableRateLimiting:!0,maxRequestsPerMinute:100},security:{enableRequestValidation:!0,enableResponseValidation:!0,enableHeaderSecurity:!0,enableDataSanitization:!0,enableXSSProtection:!0,enableCSRFProtection:!0,enableContentSecurityPolicy:!0},logging:{enableDebugMode:!1,enableConsoleLogs:!1,enableNetworkLogs:!1,enableSecurityLogs:!0},build:{enableSourceMaps:!1,enableMinification:!0,enableCompression:!0}},development:{api:{baseURL:{}.VITE_API_BASE_URL||"http://localhost:8083",timeout:3e4,maxRetries:3,enableHTTPS:!1,enableRateLimiting:!0,maxRequestsPerMinute:1e3},security:{enableRequestValidation:!0,enableResponseValidation:!0,enableHeaderSecurity:!0,enableDataSanitization:!0,enableXSSProtection:!0,enableCSRFProtection:!1,enableContentSecurityPolicy:!1},logging:{enableDebugMode:!0,enableConsoleLogs:!0,enableNetworkLogs:!0,enableSecurityLogs:!0},build:{enableSourceMaps:!0,enableMinification:!1,enableCompression:!1}}},Jf=()=>Rb["production"]||Rb.development,bi={isProduction:()=>!0,isHTTPSEnabled:()=>Jf().api.enableHTTPS,isSecurityFeatureEnabled:e=>Jf().security[e]||!1,getApiBaseURL:()=>Jf().api.baseURL,isSecureURL:e=>!(!e||["javascript:","data:","vbscript:","file:","ftp:"].some(a=>e.toLowerCase().startsWith(a))||!e.startsWith("https://")),generateSecureRandom:(e=32)=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let r=0;r<e;r++)a+=t.charAt(Math.floor(Math.random()*t.length));return a},hashData:e=>{typeof e!="string"&&(e=JSON.stringify(e));let t=0;for(let a=0;a<e.length;a++){const r=e.charCodeAt(a);t=(t<<5)-t+r,t=t&t}return t.toString(36)}},pz=()=>{const[e,t]=E.useState({}),[a,r]=E.useState(!1),[s,n]=E.useState(null),l=()=>{try{const x=Xl.getSecurityStatus();n(x),t(v=>({...v,securityStatus:{success:!0,data:x}}))}catch(x){t(v=>({...v,securityStatus:{success:!1,error:x.message}}))}},o=()=>{try{const x={isProduction:bi.isProduction(),isHTTPSEnabled:bi.isHTTPSEnabled(),isSecureURL:bi.isSecureURL("https://api.example.com"),randomString:bi.generateSecureRandom(16),hashedData:bi.hashData("test data")};t(v=>({...v,securityUtils:{success:!0,data:x}}))}catch(x){t(v=>({...v,securityUtils:{success:!1,error:x.message}}))}},c=()=>{try{const x={name:'<script>alert("xss")<\/script>John',email:"john@example.com",message:'Hello<script>alert("xss")<\/script>'},v=io.sanitizeRequestData(x),g=io.addSecurityHeaders({"Custom-Header":"value"}),b={data:{message:"Success"}},y=io.validateResponse(b),w={originalInput:x,sanitizedData:v,secureHeaders:g,validatedResponse:y};t(N=>({...N,securityMiddleware:{success:!0,data:w}}))}catch(x){t(v=>({...v,securityMiddleware:{success:!1,error:x.message}}))}},u=async()=>{r(!0);try{const x={serviceAvailable:!!Xl,methods:Object.getOwnPropertyNames(Object.getPrototypeOf(Xl)),hasSecureMethods:!!Xl.secureGet&&!!Xl.securePost};t(v=>({...v,secureApiService:{success:!0,data:x}}))}catch(x){t(v=>({...v,secureApiService:{success:!1,error:x.message}}))}finally{r(!1)}},d=()=>{try{const v=['<script>alert("xss")<\/script>','javascript:alert("xss")',`onload="alert('xss')"`,'data:text/html,<script>alert("xss")<\/script>'].map(g=>({payload:g,isBlocked:io.shouldBlockRequest({url:g,data:{message:g}})}));t(g=>({...g,xssPrevention:{success:!0,data:v}}))}catch(x){t(v=>({...v,xssPrevention:{success:!1,error:x.message}}))}},h=()=>{try{const x={rateLimitEnabled:!0,maxRequestsPerMinute:100,timeWindow:"1 minute",note:"Rate limiting is active in the axios configuration"};t(v=>({...v,rateLimiting:{success:!0,data:x}}))}catch(x){t(v=>({...v,rateLimiting:{success:!1,error:x.message}}))}},f=()=>{try{const x={currentProtocol:window.location.protocol,isHTTPS:window.location.protocol==="https:",productionEnforcement:bi.isHTTPSEnabled(),note:"HTTPS is enforced in production builds"};t(v=>({...v,httpsEnforcement:{success:!0,data:x}}))}catch(x){t(v=>({...v,httpsEnforcement:{success:!1,error:x.message}}))}},m=async()=>{r(!0),t({}),l(),o(),c(),await u(),d(),h(),f(),r(!1)},p=()=>{t({}),n(null)};return i.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:i.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"🔒 Security Features Test Page"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"This page demonstrates and tests all the security features implemented in your CRM application."}),i.jsxs("div",{className:"flex gap-4 mb-6",children:[i.jsx("button",{onClick:m,disabled:a,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:a?"Running Tests...":"🚀 Run All Tests"}),i.jsx("button",{onClick:p,className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"🗑️ Clear Results"})]}),s&&i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"🛡️ Current Security Status"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Protocol:"}),i.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${s.isSecure?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.isSecure?"HTTPS":"HTTP"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Token:"}),i.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${s.hasValidToken?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.hasValidToken?"Valid":"Invalid"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Rate Limiting:"}),i.jsx("span",{className:"ml-2 px-2 py-1 rounded text-xs bg-green-100 text-green-800",children:"Active"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Validation:"}),i.jsx("span",{className:"ml-2 px-2 py-1 rounded text-xs bg-green-100 text-green-800",children:"Active"})]})]})]})]}),i.jsx("div",{className:"space-y-6",children:Object.entries(e).map(([x,v])=>i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4 capitalize",children:x.replace(/([A-Z])/g," $1").trim()}),v.success?i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center mb-2",children:[i.jsx("span",{className:"text-green-600 text-xl mr-2",children:"✅"}),i.jsx("span",{className:"text-green-800 font-medium",children:"Test Passed"})]}),i.jsx("pre",{className:"text-sm text-green-700 bg-green-100 p-3 rounded overflow-x-auto",children:JSON.stringify(v.data,null,2)})]}):i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center mb-2",children:[i.jsx("span",{className:"text-red-600 text-xl mr-2",children:"❌"}),i.jsx("span",{className:"text-red-800 font-medium",children:"Test Failed"})]}),i.jsx("p",{className:"text-red-700",children:v.error})]})]},x))}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mt-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"📋 How to Test Security Features"}),i.jsxs("div",{className:"space-y-3 text-blue-700",children:[i.jsxs("div",{className:"flex items-start",children:[i.jsx("span",{className:"font-medium mr-2",children:"1."}),i.jsx("span",{children:'Click "Run All Tests" to test all security features'})]}),i.jsxs("div",{className:"flex items-start",children:[i.jsx("span",{className:"font-medium mr-2",children:"2."}),i.jsx("span",{children:"Check the Network tab in DevTools to see secure API calls"})]}),i.jsxs("div",{className:"flex items-start",children:[i.jsx("span",{className:"font-medium mr-2",children:"3."}),i.jsx("span",{children:"Open Console to see security event logging"})]}),i.jsxs("div",{className:"flex items-start",children:[i.jsx("span",{className:"font-medium mr-2",children:"4."}),i.jsx("span",{children:"Try to inject malicious scripts - they should be blocked"})]}),i.jsxs("div",{className:"flex items-start",children:[i.jsx("span",{className:"font-medium mr-2",children:"5."}),i.jsx("span",{children:"Check that HTTPS is enforced in production"})]})]})]})]})})},gz=({message:e,onClose:t})=>i.jsx(Jn,{children:e&&i.jsx(wt.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-xl px-6 py-5 w-[90%] max-w-sm text-center",children:[i.jsx("p",{className:"text-gray-800 text-base font-medium mb-4",children:e}),i.jsx("button",{onClick:t,className:"px-5 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition",children:"OK"})]})})});function yz(){const[e,t]=E.useState("");return E.useEffect(()=>{TF(t)},[]),i.jsx(Wj,{children:i.jsxs(Qj,{children:[i.jsx(qj,{children:i.jsxs($j,{children:[i.jsx(Jl,{path:"/",element:i.jsx(dz,{})}),i.jsx(Jl,{path:"/dashboard",element:i.jsx(oz,{})}),i.jsx(Jl,{path:"/excel-preview/:taskId",element:i.jsx(hz,{})}),i.jsx(Jl,{path:"/security-test",element:i.jsx(pz,{})})]})}),i.jsx(gz,{message:e,onClose:()=>t("")})]})})}tj.createRoot(document.getElementById("root")).render(i.jsx(E.StrictMode,{children:i.jsx(yz,{})}));
